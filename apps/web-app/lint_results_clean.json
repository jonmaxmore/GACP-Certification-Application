[{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\(auth)\\forgot-password\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\(auth)\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\(auth)\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\(auth)\\login\\AccountTypeSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\(auth)\\login\\LoginOverlays.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\(auth)\\login\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":17,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":17,"endColumn":17},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\(auth)\\login\\page.tsx:34:13\n  32 |         const remembered = AuthService.getRememberMe();\n  33 |         if (remembered) {\n> 34 |             setAccountType(remembered.accountType || \"INDIVIDUAL\");\n     |             ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  35 |             setIdentifier(remembered.identifier || \"\");\n  36 |             setRememberMe(true);\n  37 |         }","line":34,"column":13,"nodeType":null,"endLine":34,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":67,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":67,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { IconLock, PersonIcon, Icons, EyeIcon, BuildingIcon, GroupIcon } from \"@/components/ui/icons\";\r\nimport { formatThaiId } from \"@/utils/thai-id-validator\";\r\nimport { AuthService } from \"@/lib/services/auth-service\";\r\n\r\nconst ACCOUNT_TYPES = [\r\n    { type: \"INDIVIDUAL\", label: \"เธเธธเธเธเธฅเธเธฃเธฃเธกเธ”เธฒ\", subtitle: \"เน€เธเธฉเธ•เธฃเธเธฃเธฃเธฒเธขเธขเนเธญเธข\", idLabel: \"เน€เธฅเธเธเธฑเธกเธฒเธเธฃเธฐเธเธฒเธเธ 13 เธซเธฅเธฑเธ\", idHint: \"1-2345-67890-12-3\", icon: PersonIcon },\r\n    { type: \"JURISTIC\", label: \"เธเธดเธ•เธดเธเธธเธเธเธฅ\", subtitle: \"เธเธฃเธดเธฉเธฑเธ— / เธซเนเธฒเธเธซเธธเนเธเธชเนเธงเธ\", idLabel: \"เน€เธฅเธเธ—เธฐเน€เธเธตเธขเธเธเธดเธ•เธดเธเธธเธเธเธฅ 13 เธซเธฅเธฑเธ\", idHint: \"0-1055-12345-67-8\", icon: BuildingIcon },\r\n    { type: \"COMMUNITY_ENTERPRISE\", label: \"เธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ\", subtitle: \"เธเธฅเธธเนเธกเน€เธเธฉเธ•เธฃเธเธฃ\", idLabel: \"เน€เธฅเธเธ—เธฐเน€เธเธตเธขเธเธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ\", idHint: \"XXXX-XXXX-XXX\", icon: GroupIcon },\r\n];\r\n\r\nexport default function LoginPage() {\r\n    const router = useRouter();\r\n    const [accountType, setAccountType] = useState(\"INDIVIDUAL\");\r\n    const [identifier, setIdentifier] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [showPassword, setShowPassword] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [loginState, setLoginState] = useState<'idle' | 'loading' | 'success' | 'error'>('idle');\r\n    const [error, setError] = useState(\"\");\r\n    const [rememberMe, setRememberMe] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (AuthService.isAuthenticated()) {\r\n            window.location.href = \"/farmer/dashboard\";\r\n            return;\r\n        }\r\n        const remembered = AuthService.getRememberMe();\r\n        if (remembered) {\r\n            setAccountType(remembered.accountType || \"INDIVIDUAL\");\r\n            setIdentifier(remembered.identifier || \"\");\r\n            setRememberMe(true);\r\n        }\r\n    }, []);\r\n\r\n    const currentConfig = ACCOUNT_TYPES.find((t) => t.type === accountType)!;\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError(\"\");\r\n        setIsLoading(true);\r\n        setLoginState('loading');\r\n\r\n        const cleanIdentifier = identifier.replace(/-/g, \"\").replace(/[<>'\"&]/g, \"\");\r\n        const cleanPassword = password.trim();\r\n\r\n        try {\r\n            const result = await AuthService.login({ accountType, identifier: cleanIdentifier, password: cleanPassword });\r\n\r\n            if (!result.success) {\r\n                setError(result.error || 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ');\r\n                setLoginState('error');\r\n                setIsLoading(false);\r\n                return;\r\n            }\r\n\r\n            if (rememberMe) AuthService.saveRememberMe(accountType, cleanIdentifier);\r\n            else AuthService.clearRememberMe();\r\n\r\n            setLoginState('success');\r\n            setTimeout(() => { window.location.href = \"/farmer/dashboard\"; }, 1500);\r\n\r\n        } catch (err) {\r\n            setError(\"เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เน€เธเธทเนเธญเธกเธ•เนเธญเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเนเธ”เน\");\r\n            setLoginState('error');\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"auth-card animate-slide-up relative overflow-hidden group\">\r\n            {/* Form Success Overlay */}\r\n            {loginState === 'success' && (\r\n                <div className=\"absolute inset-0 bg-primary/95 backdrop-blur-md z-40 flex flex-col items-center justify-center text-white animate-fade-in p-8\">\r\n                    <div className=\"w-24 h-24 bg-white/20 rounded-full flex items-center justify-center mb-8 animate-scale-in\">\r\n                        <Icons.CheckCircle className=\"w-12 h-12 text-white\" />\r\n                    </div>\r\n                    <h2 className=\"text-3xl font-black mb-2\">เน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธเธชเธณเน€เธฃเนเธ!</h2>\r\n                    <p className=\"opacity-80 font-medium\">เธขเธดเธเธ”เธตเธ•เนเธญเธเธฃเธฑเธเธเธฅเธฑเธเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ...</p>\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"relative z-10\">\r\n                <div className=\"mb-10\">\r\n                    <h2 className=\"text-3xl font-black text-slate-800 leading-tight\">เน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ</h2>\r\n                    <p className=\"text-slate-500 font-medium mt-2\">เธฅเธเธเธทเนเธญเน€เธเนเธฒเนเธเนเธเธฒเธเน€เธเธทเนเธญเธเธฑเธ”เธเธฒเธฃเนเธเธฃเธฑเธเธฃเธญเธ GACP เธเธญเธเธเธธเธ“</p>\r\n                </div>\r\n\r\n                {/* Account Type Selection */}\r\n                <div className=\"mb-8\">\r\n                    <label className=\"text-xs font-black uppercase tracking-widest text-slate-400 mb-4 block\">เธเธฃเธฐเน€เธ เธ—เธเธนเนเนเธเนเธเธฒเธ</label>\r\n                    <div className=\"grid grid-cols-3 gap-3\">\r\n                        {ACCOUNT_TYPES.map((type) => {\r\n                            const isSelected = accountType === type.type;\r\n                            const Icon = type.icon;\r\n                            return (\r\n                                <button\r\n                                    key={type.type}\r\n                                    type=\"button\"\r\n                                    onClick={() => { setAccountType(type.type); setIdentifier(\"\"); setError(\"\"); }}\r\n                                    className={`\r\n                                        flex flex-col items-center justify-center p-4 rounded-3xl border-2 transition-all duration-300\r\n                                        ${isSelected\r\n                                            ? 'bg-primary border-primary text-white shadow-elevated shadow-primary/20 scale-[1.02]'\r\n                                            : 'bg-white border-slate-100 text-slate-400 hover:border-primary/20 hover:bg-primary-50'\r\n                                        }\r\n                                    `}\r\n                                >\r\n                                    <Icon color={isSelected ? \"white\" : undefined} className=\"w-6 h-6 mb-2\" />\r\n                                    <span className=\"text-[11px] font-black uppercase tracking-tight text-center leading-tight\">{type.label}</span>\r\n                                </button>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n\r\n                {error && (\r\n                    <div className=\"mb-6 p-4 bg-rose-50 border border-rose-100 rounded-2xl text-rose-600 text-sm font-bold flex items-center gap-3 animate-head-shake\">\r\n                        <Icons.Warning className=\"w-5 h-5 flex-shrink-0\" />\r\n                        {error}\r\n                    </div>\r\n                )}\r\n\r\n                <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n                    <div>\r\n                        <label className=\"text-xs font-black uppercase tracking-widest text-slate-400 mb-2 block\">{currentConfig.idLabel}</label>\r\n                        <div className=\"relative group\">\r\n                            <div className=\"absolute left-5 top-1/2 -translate-y-1/2 text-slate-300 group-focus-within:text-primary transition-colors\">\r\n                                <PersonIcon className=\"w-5 h-5\" />\r\n                            </div>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={identifier}\r\n                                onChange={(e) => setIdentifier(formatThaiId(e.target.value))}\r\n                                placeholder={currentConfig.idHint}\r\n                                maxLength={17}\r\n                                className=\"w-full bg-slate-50 border-2 border-slate-50 rounded-2.5xl py-4 pl-14 pr-6 text-lg font-mono tracking-wider focus:bg-white focus:border-primary outline-none transition-all placeholder:text-slate-300 text-slate-800\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div>\r\n                        <div className=\"flex justify-between items-center mb-2\">\r\n                            <label className=\"text-xs font-black uppercase tracking-widest text-slate-400 block\">เธฃเธซเธฑเธชเธเนเธฒเธ</label>\r\n                            <Link href=\"/forgot-password\" title=\"Forgot Password\" className=\"text-xs font-bold text-primary hover:underline\">เธฅเธทเธกเธฃเธซเธฑเธชเธเนเธฒเธ?</Link>\r\n                        </div>\r\n                        <div className=\"relative group\">\r\n                            <div className=\"absolute left-5 top-1/2 -translate-y-1/2 text-slate-300 group-focus-within:text-primary transition-colors\">\r\n                                <IconLock className=\"w-5 h-5\" />\r\n                            </div>\r\n                            <input\r\n                                type={showPassword ? \"text\" : \"password\"}\r\n                                value={password}\r\n                                onChange={(e) => setPassword(e.target.value)}\r\n                                placeholder=\"โ€ขโ€ขโ€ขโ€ขโ€ขโ€ขโ€ขโ€ข\"\r\n                                className=\"w-full bg-slate-50 border-2 border-slate-50 rounded-2.5xl py-4 pl-14 pr-14 focus:bg-white focus:border-primary outline-none transition-all placeholder:text-slate-300 text-slate-800\"\r\n                                required\r\n                            />\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={() => setShowPassword(!showPassword)}\r\n                                className=\"absolute right-5 top-1/2 -translate-y-1/2 text-slate-400 hover:text-primary transition-colors\"\r\n                            >\r\n                                <EyeIcon open={showPassword} />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <label className=\"flex items-center gap-3 cursor-pointer group w-fit\">\r\n                        <div className={`w-5 h-5 rounded-md border flex items-center justify-center transition-all ${rememberMe ? 'bg-primary border-primary scale-95 shadow-lg shadow-primary/20' : 'bg-slate-50 border-slate-100 group-hover:border-primary/30'}`}>\r\n                            {rememberMe && <Icons.CheckCircle className=\"w-4 h-4 text-white\" />}\r\n                        </div>\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            className=\"hidden\"\r\n                            checked={rememberMe}\r\n                            onChange={(e) => setRememberMe(e.target.checked)}\r\n                        />\r\n                        <span className=\"text-sm font-bold text-slate-500 group-hover:text-slate-800 transition-colors\">เธเธ”เธเธณเธเธฒเธฃเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ</span>\r\n                    </label>\r\n\r\n                    <button\r\n                        type=\"submit\"\r\n                        disabled={isLoading}\r\n                        className=\"w-full gacp-btn-primary py-5 rounded-2.5xl text-lg font-black tracking-tight\"\r\n                    >\r\n                        {isLoading ? (\r\n                            <div className=\"w-6 h-6 border-3 border-white/30 border-t-white rounded-full animate-spin\"></div>\r\n                        ) : (\r\n                            <>\r\n                                เน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ\r\n                                <Icons.ArrowRight className=\"w-6 h-6 ml-2\" />\r\n                            </>\r\n                        )}\r\n                    </button>\r\n                </form>\r\n\r\n                <div className=\"mt-10 pt-10 border-t border-slate-50 text-center\">\r\n                    <p className=\"text-slate-400 text-sm font-medium mb-4\">เธขเธฑเธเนเธกเนเธกเธตเธเธฑเธเธเธตเนเธเนเธเธฒเธ?</p>\r\n                    <Link\r\n                        href=\"/register\"\r\n                        className=\"gacp-btn-secondary w-full py-4 rounded-2.5xl border-primary/10 text-primary font-black hover:bg-primary-50 transition-all shadow-none\"\r\n                    >\r\n                        เธฅเธเธ—เธฐเน€เธเธตเธขเธเธเธนเนเนเธเนเนเธซเธกเน\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\(auth)\\register\\page.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\(auth)\\register\\page.tsx:49:17\n  47 |             try {\n  48 |                 const data = JSON.parse(savedData);\n> 49 |                 setStep(data.step || 0);\n     |                 ^^^^^^^ Avoid calling setState() directly within an effect\n  50 |                 setAccountType(data.accountType || \"\");\n  51 |                 setIdentifier(data.identifier || \"\");\n  52 |                 setFirstName(data.firstName || \"\");","line":49,"column":17,"nodeType":null,"endLine":49,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":123,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":123,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { formatThaiId } from \"@/utils/thai-id-validator\";\r\nimport { AuthService } from \"@/lib/services/auth-service\";\r\nimport { Icons, PersonIcon, BuildingIcon, GroupIcon, EyeIcon } from \"@/components/ui/icons\";\r\nimport { useLanguage } from \"@/lib/i18n/LanguageContext\";\r\n\r\nconst ACCOUNT_TYPES = [\r\n    { type: \"INDIVIDUAL\", label: \"เธเธธเธเธเธฅเธเธฃเธฃเธกเธ”เธฒ\", subtitle: \"เน€เธเธฉเธ•เธฃเธเธฃเธฃเธฒเธขเธขเธญเธ”\", idLabel: \"เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธ 13 เธซเธฅเธฑเธ\", idHint: \"1-2345-67890-12-3\", icon: PersonIcon },\r\n    { type: \"JURISTIC\", label: \"เธเธดเธ•เธดเธเธธเธเธเธฅ\", subtitle: \"เธเธฃเธดเธฉเธฑเธ— / เธซเนเธฒเธเธซเธธเนเธเธชเนเธงเธ\", idLabel: \"เน€เธฅเธเธ—เธฐเน€เธเธตเธขเธเธเธดเธ•เธดเธเธธเธเธเธฅ 13 เธซเธฅเธฑเธ\", idHint: \"0-1055-12345-67-8\", icon: BuildingIcon },\r\n    { type: \"COMMUNITY_ENTERPRISE\", label: \"เธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ\", subtitle: \"เธเธฅเธธเนเธกเน€เธเธฉเธ•เธฃเธเธฃ\", idLabel: \"เน€เธฅเธเธ—เธฐเน€เธเธตเธขเธเธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ\", idHint: \"XXXX-XXXX-XXX\", icon: GroupIcon },\r\n];\r\n\r\nconst STEPS = [\"PDPA\", \"ACCOUNT\", \"IDENTITY\", \"PERSONAL\", \"SECURITY\"];\r\n\r\nexport default function RegisterPage() {\r\n    const router = useRouter();\r\n    const { dict } = useLanguage();\r\n    const [step, setStep] = useState(0);\r\n    const [accountType, setAccountType] = useState(\"\");\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState(\"\");\r\n\r\n    const [identifier, setIdentifier] = useState(\"\");\r\n    const [firstName, setFirstName] = useState(\"\");\r\n    const [lastName, setLastName] = useState(\"\");\r\n    const [companyName, setCompanyName] = useState(\"\");\r\n    const [representativeName, setRepresentativeName] = useState(\"\");\r\n    const [communityName, setCommunityName] = useState(\"\");\r\n    const [phone, setPhone] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [confirmPassword, setConfirmPassword] = useState(\"\");\r\n    const [acceptTerms, setAcceptTerms] = useState(false);\r\n    const [pdpaAccepted, setPdpaAccepted] = useState(false);\r\n    const [pdpaScrolled, setPdpaScrolled] = useState(false);\r\n    const [showPassword, setShowPassword] = useState(false);\r\n    const [showConfirmPassword, setShowConfirmPassword] = useState(false);\r\n    const [email, setEmail] = useState(\"\");\r\n    const [fieldErrors, setFieldErrors] = useState<Record<string, string>>({});\r\n\r\n    useEffect(() => {\r\n        const savedData = localStorage.getItem(\"register_draft\");\r\n        if (savedData) {\r\n            try {\r\n                const data = JSON.parse(savedData);\r\n                setStep(data.step || 0);\r\n                setAccountType(data.accountType || \"\");\r\n                setIdentifier(data.identifier || \"\");\r\n                setFirstName(data.firstName || \"\");\r\n                setLastName(data.lastName || \"\");\r\n                setCompanyName(data.companyName || \"\");\r\n                setRepresentativeName(data.representativeName || \"\");\r\n                setCommunityName(data.communityName || \"\");\r\n                setPhone(data.phone || \"\");\r\n                setEmail(data.email || \"\");\r\n                setPdpaAccepted(data.pdpaAccepted || false);\r\n                setPdpaScrolled(data.pdpaScrolled || false);\r\n            } catch { }\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const data = { step, accountType, identifier, firstName, lastName, companyName, representativeName, communityName, phone, email, pdpaAccepted, pdpaScrolled };\r\n        localStorage.setItem(\"register_draft\", JSON.stringify(data));\r\n    }, [step, accountType, identifier, firstName, lastName, companyName, representativeName, communityName, phone, email, pdpaAccepted, pdpaScrolled]);\r\n\r\n    const validateField = (field: string, value: string) => {\r\n        const errors = { ...fieldErrors };\r\n        switch (field) {\r\n            case 'phone':\r\n                if (value.length > 0 && value.length < 10) errors.phone = `เธเธฃเธญเธเนเธฅเน ${value.length}/10 เธซเธฅเธฑเธ`;\r\n                else if (value.length === 10 && !/^0[689]\\d{8}$/.test(value)) errors.phone = \"เน€เธเธญเธฃเนเธ•เนเธญเธเธเธถเนเธเธ•เนเธเธ”เนเธงเธข 06, 08, เธซเธฃเธทเธญ 09\";\r\n                else delete errors.phone;\r\n                break;\r\n            case 'confirmPassword':\r\n                if (value && value !== password) errors.confirmPassword = \"เธฃเธซเธฑเธชเธเนเธฒเธเนเธกเนเธ•เธฃเธเธเธฑเธ\";\r\n                else delete errors.confirmPassword;\r\n                break;\r\n        }\r\n        setFieldErrors(errors);\r\n    };\r\n\r\n    const currentConfig = ACCOUNT_TYPES.find((t) => t.type === accountType);\r\n\r\n    const canProceed = () => {\r\n        switch (step) {\r\n            case 0: return pdpaAccepted;\r\n            case 1: return accountType !== \"\";\r\n            case 2: return identifier.replace(/-/g, \"\").length >= 10;\r\n            case 3:\r\n                if (accountType === \"INDIVIDUAL\") return firstName && lastName && phone.length >= 10;\r\n                if (accountType === \"JURISTIC\") return companyName && representativeName && phone.length >= 10;\r\n                return communityName && representativeName && phone.length >= 10;\r\n            case 4: return password.length >= 8 && password === confirmPassword && acceptTerms;\r\n            default: return false;\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        setError(\"\");\r\n        setIsLoading(true);\r\n\r\n        const sanitize = (str: string) => str.trim().replace(/[<>'\"&]/g, \"\");\r\n        const cleanIdentifier = identifier.replace(/-/g, \"\").replace(/[<>'\"&]/g, \"\");\r\n        const cleanPhone = phone.replace(/[<>'\"&]/g, \"\");\r\n        const cleanPassword = password.trim();\r\n\r\n        const data: Record<string, string> = { accountType, identifier: cleanIdentifier, phoneNumber: cleanPhone, password: cleanPassword };\r\n        if (accountType === \"INDIVIDUAL\") { data.firstName = sanitize(firstName); data.lastName = sanitize(lastName); }\r\n        else if (accountType === \"JURISTIC\") { data.companyName = sanitize(companyName); data.representativeName = sanitize(representativeName); }\r\n        else { data.communityName = sanitize(communityName); data.representativeName = sanitize(representativeName); }\r\n\r\n        try {\r\n            const result = await AuthService.register(data);\r\n            if (!result.success) { setError(result.error || \"เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเธฅเธเธ—เธฐเน€เธเธตเธขเธ\"); setIsLoading(false); return; }\r\n\r\n            localStorage.removeItem(\"register_draft\");\r\n            const name = accountType === \"INDIVIDUAL\" ? `${firstName} ${lastName}` : accountType === \"JURISTIC\" ? companyName : communityName;\r\n            router.push(`/register/success?type=${accountType}&id=${encodeURIComponent(identifier)}&name=${encodeURIComponent(name)}`);\r\n        } catch (err) {\r\n            setError(\"เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เน€เธเธทเนเธญเธกเธ•เนเธญเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเนเธ”เน\");\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"auth-card animate-slide-up\">\r\n            {/* Header */}\r\n            <div className=\"mb-10\">\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                    <h2 className=\"text-3xl font-black text-slate-800 tracking-tight\">เธฅเธเธ—เธฐเน€เธเธตเธขเธ</h2>\r\n                    <span className=\"text-xs font-black text-primary px-3 py-1 bg-primary/10 rounded-full uppercase tracking-widest\">\r\n                        Step {step + 1} of {STEPS.length}\r\n                    </span>\r\n                </div>\r\n\r\n                {/* Progress Bar */}\r\n                <div className=\"flex gap-2 mb-8\">\r\n                    {STEPS.map((_, i) => (\r\n                        <div key={i} className=\"flex-1 overflow-hidden\">\r\n                            <div className={`h-1.5 rounded-full transition-all duration-500 ${i <= step ? 'bg-primary' : 'bg-slate-100'}`} />\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {error && (\r\n                <div className=\"mb-8 p-4 bg-rose-50 border border-rose-100 rounded-2xl text-rose-600 text-sm font-bold flex items-center gap-3\">\r\n                    <Icons.Warning className=\"w-5 h-5 flex-shrink-0\" />\r\n                    {error}\r\n                </div>\r\n            )}\r\n\r\n            {/* Step 0: PDPA */}\r\n            {step === 0 && (\r\n                <div className=\"animate-fade-in\">\r\n                    <h3 className=\"text-xl font-black text-slate-800 mb-4\">เธเนเธขเธเธฒเธขเธเธงเธฒเธกเน€เธเนเธเธชเนเธงเธเธ•เธฑเธง</h3>\r\n                    <div\r\n                        onScroll={(e) => {\r\n                            const { scrollTop, scrollHeight, clientHeight } = e.currentTarget;\r\n                            if (scrollTop + clientHeight >= scrollHeight - 30) setPdpaScrolled(true);\r\n                        }}\r\n                        className=\"h-64 overflow-y-auto p-6 bg-slate-50 rounded-3xl mb-6 text-sm text-slate-500 leading-relaxed border border-slate-100\"\r\n                    >\r\n                        <p className=\"font-bold text-slate-700 mb-4 uppercase tracking-wider\">เธเนเธญเธเธณเธซเธเธ”เนเธฅเธฐเน€เธเธทเนเธญเธเนเธเธเธฒเธฃเนเธเนเธเธฃเธดเธเธฒเธฃ</p>\r\n                        <p className=\"mb-4\">เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ (DTAM) เธกเธตเธเธงเธฒเธกเธเธณเน€เธเนเธเธ•เนเธญเธเน€เธเนเธเธฃเธงเธเธฃเธงเธกเธเนเธญเธกเธนเธฅเธชเนเธงเธเธเธธเธเธเธฅเธเธญเธเธ—เนเธฒเธ เน€เธเธทเนเธญเนเธเนเนเธเธเธฃเธฐเธเธงเธเธเธฒเธฃเธเธดเธเธฒเธฃเธ“เธฒเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP Thailand...</p>\r\n                        <div className=\"space-y-4\">\r\n                            <div>\r\n                                <h4 className=\"font-bold text-slate-700\">1. เธเธฒเธฃเธเธฑเธ”เน€เธเนเธเธเนเธญเธกเธนเธฅ</h4>\r\n                                <p>เน€เธฃเธฒเธเธฑเธ”เน€เธเนเธเธเนเธญเธกเธนเธฅเธเธทเนเธญ เธเธฒเธกเธชเธเธธเธฅ เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธ เนเธฅเธฐเธเธดเธเธฑเธ”เธชเธ–เธฒเธเธเธฃเธฐเธเธญเธเธเธฒเธฃเธเธญเธเธ—เนเธฒเธ...</p>\r\n                            </div>\r\n                            <div>\r\n                                <h4 className=\"font-bold text-slate-700\">2. เธงเธฑเธ•เธ–เธธเธเธฃเธฐเธชเธเธเน</h4>\r\n                                <p>เน€เธเธทเนเธญเธฃเธฐเธเธธเธ•เธฑเธงเธ•เธเนเธฅเธฐเธขเธทเธเธขเธฑเธเธชเธดเธ—เธเธดเนเธเธเธฒเธฃเธ–เธทเธญเธเธฃเธญเธเนเธเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธเน€เธเธฉเธ•เธฃเธเธฅเธญเธ”เธ เธฑเธข...</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <label className={`\r\n                        flex items-start gap-4 p-6 rounded-3xl border-2 transition-all cursor-pointer\r\n                        ${pdpaAccepted ? 'bg-primary/5 border-primary' : 'bg-white border-slate-100 hover:border-slate-200'}\r\n                        ${!pdpaScrolled ? 'opacity-50 grayscale cursor-not-allowed' : ''}\r\n                    `}>\r\n                        <div className={`\r\n                            w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all mt-0.5\r\n                            ${pdpaAccepted ? 'bg-primary border-primary' : 'bg-white border-slate-200'}\r\n                        `}>\r\n                            {pdpaAccepted && <Icons.CheckCircle className=\"w-4 h-4 text-white\" />}\r\n                        </div>\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            className=\"hidden\"\r\n                            checked={pdpaAccepted}\r\n                            disabled={!pdpaScrolled}\r\n                            onChange={(e) => setPdpaAccepted(e.target.checked)}\r\n                        />\r\n                        <span className={`text-sm font-bold ${pdpaAccepted ? 'text-primary' : 'text-slate-500'}`}>\r\n                            {pdpaScrolled ? 'เธเธฑเธเนเธ”เนเธญเนเธฒเธเนเธฅเธฐเธขเธญเธกเธฃเธฑเธเธ•เธฒเธกเน€เธเธทเนเธญเธเนเธเธ—เธตเนเธฃเธฐเธเธธเธเนเธฒเธเธ•เนเธ' : 'เธเธฃเธธเธ“เธฒเน€เธฅเธทเนเธญเธเธญเนเธฒเธเธเนเธญเธกเธนเธฅเนเธซเนเธเธเน€เธเธทเนเธญเธขเธญเธกเธฃเธฑเธเน€เธเธทเนเธญเธเนเธ'}\r\n                        </span>\r\n                    </label>\r\n                </div>\r\n            )}\r\n\r\n            {/* Step 1: Account Type */}\r\n            {step === 1 && (\r\n                <div className=\"animate-fade-in\">\r\n                    <h3 className=\"text-xl font-black text-slate-800 mb-6\">เน€เธฅเธทเธญเธเธเธฃเธฐเน€เธ เธ—เธเธฑเธเธเธตเธเธญเธเธเธธเธ“</h3>\r\n                    <div className=\"space-y-4\">\r\n                        {ACCOUNT_TYPES.map((type) => {\r\n                            const isSelected = accountType === type.type;\r\n                            const Icon = type.icon;\r\n                            return (\r\n                                <button\r\n                                    key={type.type}\r\n                                    type=\"button\"\r\n                                    onClick={() => setAccountType(type.type)}\r\n                                    className={`\r\n                                        w-full flex items-center gap-6 p-6 rounded-3xl border-2 transition-all text-left\r\n                                        ${isSelected\r\n                                            ? 'bg-primary border-primary text-white shadow-elevated shadow-primary/20'\r\n                                            : 'bg-white border-slate-100 text-slate-400 hover:border-primary/30'\r\n                                        }\r\n                                    `}\r\n                                >\r\n                                    <div className={`w-14 h-14 rounded-2xl flex items-center justify-center ${isSelected ? 'bg-white/20' : 'bg-slate-50'}`}>\r\n                                        <Icon className=\"w-8 h-8\" color={isSelected ? 'white' : undefined} />\r\n                                    </div>\r\n                                    <div className=\"flex-1\">\r\n                                        <div className={`text-lg font-black uppercase tracking-tight ${isSelected ? 'text-white' : 'text-slate-800'}`}>{type.label}</div>\r\n                                        <div className={`text-xs font-bold ${isSelected ? 'text-emerald-100/70' : 'text-slate-400'}`}>{type.subtitle}</div>\r\n                                    </div>\r\n                                    {isSelected && <div className=\"w-6 h-6 bg-white rounded-full flex items-center justify-center\"><Icons.CheckCircle className=\"w-4 h-4 text-primary\" /></div>}\r\n                                </button>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Step 2: Identity */}\r\n            {step === 2 && currentConfig && (\r\n                <div className=\"animate-fade-in\">\r\n                    <h3 className=\"text-xl font-black text-slate-800 mb-2\">เธขเธทเธเธขเธฑเธเธ•เธฑเธงเธ•เธ</h3>\r\n                    <p className=\"text-slate-500 text-sm mb-8 font-medium\">เธเธฃเธธเธ“เธฒเธฃเธฐเธเธธ{currentConfig.idLabel}</p>\r\n\r\n                    <div className=\"relative group mb-6\">\r\n                        <div className=\"absolute left-5 top-1/2 -translate-y-1/2 text-slate-300 group-focus-within:text-primary transition-colors\">\r\n                            <PersonIcon className=\"w-6 h-6\" />\r\n                        </div>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={identifier}\r\n                            onChange={(e) => setIdentifier(formatThaiId(e.target.value))}\r\n                            placeholder={currentConfig.idHint}\r\n                            maxLength={17}\r\n                            className=\"w-full bg-slate-50 border-2 border-slate-50 rounded-2.5xl py-5 pl-14 pr-14 text-xl font-mono tracking-[0.1em] focus:bg-white focus:border-primary outline-none transition-all placeholder:text-slate-200 text-slate-800\"\r\n                        />\r\n                        {identifier.replace(/-/g, '').length === 13 && (\r\n                            <div className=\"absolute right-5 top-1/2 -translate-y-1/2 text-emerald-500 animate-scale-in\">\r\n                                <Icons.CheckCircle className=\"w-6 h-6\" />\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"p-5 bg-primary/5 rounded-3xl border border-primary/10 flex items-start gap-3\">\r\n                        <div className=\"p-2 bg-primary/10 rounded-xl text-primary mt-0.5\"><Icons.Info className=\"w-4 h-4\" /></div>\r\n                        <p className=\"text-sm font-bold text-primary/80 leading-snug\">เธซเธกเธฒเธขเน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธตเนเธเธฐเธ–เธนเธเนเธเนเน€เธเนเธเธเธทเนเธญเธเธนเนเนเธเนเธเธฒเธ (Username) เธชเธณเธซเธฃเธฑเธเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ เนเธฅเธฐเนเธเนเนเธเธเธฒเธฃเธ•เธฃเธงเธเธชเธญเธเธชเธดเธ—เธเธดเน€เธเธทเนเธญเธเธ•เนเธ</p>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Step 3: Info */}\r\n            {step === 3 && (\r\n                <div className=\"animate-fade-in overflow-y-auto max-h-[500px] no-scrollbar px-1\">\r\n                    <h3 className=\"text-xl font-black text-slate-800 mb-6\">{accountType === \"INDIVIDUAL\" ? \"เธเนเธญเธกเธนเธฅเธชเนเธงเธเธ•เธฑเธง\" : \"เธเนเธญเธกเธนเธฅเธชเธ–เธฒเธเธเธฃเธฐเธเธญเธเธเธฒเธฃ\"}</h3>\r\n                    <div className=\"space-y-6\">\r\n                        {accountType === \"INDIVIDUAL\" ? (\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"text-xs font-black uppercase text-slate-400 tracking-widest px-1\">เธเธทเนเธญ</label>\r\n                                    <input type=\"text\" value={firstName} onChange={(e) => setFirstName(e.target.value)} placeholder=\"เธชเธกเธเธฒเธข\" className=\"w-full bg-slate-50 border-2 border-slate-50 rounded-2xl py-3.5 px-5 focus:bg-white focus:border-primary outline-none transition-all\" />\r\n                                </div>\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"text-xs font-black uppercase text-slate-400 tracking-widest px-1\">เธเธฒเธกเธชเธเธธเธฅ</label>\r\n                                    <input type=\"text\" value={lastName} onChange={(e) => setLastName(e.target.value)} placeholder=\"เนเธเธ”เธต\" className=\"w-full bg-slate-50 border-2 border-slate-50 rounded-2xl py-3.5 px-5 focus:bg-white focus:border-primary outline-none transition-all\" />\r\n                                </div>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-xs font-black uppercase text-slate-400 tracking-widest px-1\">{accountType === 'JURISTIC' ? 'เธเธทเนเธญเธเธฃเธดเธฉเธฑเธ—' : 'เธเธทเนเธญเธงเธดเธชเธฒเธซเธเธดเธ'}</label>\r\n                                <input type=\"text\" value={accountType === 'JURISTIC' ? companyName : communityName} onChange={(e) => accountType === 'JURISTIC' ? setCompanyName(e.target.value) : setCommunityName(e.target.value)} className=\"w-full bg-slate-50 border-2 border-slate-50 rounded-2xl py-3.5 px-5 focus:bg-white focus:border-primary outline-none transition-all\" />\r\n                            </div>\r\n                        )}\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-xs font-black uppercase text-slate-400 tracking-widest px-1\">เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เน (10 เธซเธฅเธฑเธ)</label>\r\n                            <input\r\n                                type=\"tel\"\r\n                                value={phone}\r\n                                placeholder=\"08XXXXXXXX\"\r\n                                onChange={(e) => { const val = e.target.value.replace(/\\D/g, \"\").slice(0, 10); setPhone(val); validateField('phone', val); }}\r\n                                className=\"w-full bg-slate-50 border-2 border-slate-50 rounded-2xl py-3.5 px-5 font-mono text-lg focus:bg-white focus:border-primary outline-none transition-all\"\r\n                            />\r\n                            {fieldErrors.phone && <p className=\"text-xs font-bold text-rose-500 px-1\">{fieldErrors.phone}</p>}\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-xs font-black uppercase text-slate-400 tracking-widest px-1\">เธญเธตเน€เธกเธฅ (เธ–เนเธฒเธกเธต)</label>\r\n                            <input type=\"email\" value={email} onChange={(e) => setEmail(e.target.value)} placeholder=\"email@example.com\" className=\"w-full bg-slate-50 border-2 border-slate-50 rounded-2xl py-3.5 px-5 focus:bg-white focus:border-primary outline-none transition-all\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Step 4: Security */}\r\n            {step === 4 && (\r\n                <div className=\"animate-fade-in\">\r\n                    <h3 className=\"text-xl font-black text-slate-800 mb-6\">เธ•เธฑเนเธเธฃเธซเธฑเธชเธเนเธฒเธเธ—เธตเนเธเธฅเธญเธ”เธ เธฑเธข</h3>\r\n                    <div className=\"space-y-6\">\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-xs font-black uppercase text-slate-400 tracking-widest px-1\">เธเธณเธซเธเธ”เธฃเธซเธฑเธชเธเนเธฒเธเนเธซเธกเน</label>\r\n                            <div className=\"relative group\">\r\n                                <input\r\n                                    type={showPassword ? \"text\" : \"password\"}\r\n                                    value={password} onChange={(e) => setPassword(e.target.value)}\r\n                                    placeholder=\"โ€ขโ€ขโ€ขโ€ขโ€ขโ€ขโ€ขโ€ข\"\r\n                                    className=\"w-full bg-slate-50 border-2 border-slate-50 rounded-2.5xl py-4 px-6 focus:bg-white focus:border-primary outline-none transition-all\"\r\n                                />\r\n                                <button type=\"button\" onClick={() => setShowPassword(!showPassword)} className=\"absolute right-5 top-1/2 -translate-y-1/2 text-slate-400 hover:text-primary transition-colors\">\r\n                                    <EyeIcon open={showPassword} />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-xs font-black uppercase text-slate-400 tracking-widest px-1\">เธขเธทเธเธขเธขเธฑเธเธฃเธซเธฑเธชเธเนเธฒเธ</label>\r\n                            <div className=\"relative group\">\r\n                                <input\r\n                                    type={showConfirmPassword ? \"text\" : \"password\"}\r\n                                    value={confirmPassword}\r\n                                    onChange={(e) => { setConfirmPassword(e.target.value); validateField('confirmPassword', e.target.value); }}\r\n                                    placeholder=\"โ€ขโ€ขโ€ขโ€ขโ€ขโ€ขโ€ขโ€ข\"\r\n                                    className={`w-full bg-slate-50 border-2 rounded-2.5xl py-4 px-6 focus:bg-white focus:border-primary outline-none transition-all ${confirmPassword ? (password === confirmPassword ? 'border-emerald-500' : 'border-rose-500') : 'border-slate-50'}`}\r\n                                />\r\n                                <button type=\"button\" onClick={() => setShowConfirmPassword(!showConfirmPassword)} className=\"absolute right-5 top-1/2 -translate-y-1/2 text-slate-400 hover:text-primary transition-colors\">\r\n                                    <EyeIcon open={showConfirmPassword} />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <label className=\"flex items-center gap-4 p-6 rounded-3xl border-2 border-primary/5 bg-primary/5 cursor-pointer group hover:bg-primary/10 transition-all\">\r\n                            <div className={`\r\n                                w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all mt-0.5\r\n                                ${acceptTerms ? 'bg-primary border-primary' : 'bg-white border-primary/20 group-hover:border-primary/40'}\r\n                            `}>\r\n                                {acceptTerms && <Icons.CheckCircle className=\"w-4 h-4 text-white\" />}\r\n                            </div>\r\n                            <input type=\"checkbox\" className=\"hidden\" checked={acceptTerms} onChange={(e) => setAcceptTerms(e.target.checked)} />\r\n                            <span className=\"text-sm font-bold text-primary/80\">เธเนเธฒเธเน€เธเนเธฒเธขเธญเธกเธฃเธฑเธเน€เธเธทเนเธญเธเนเธเธเธฒเธฃเนเธเนเธเธฒเธเนเธฅเธฐเธเนเธขเธเธฒเธขเธเธงเธฒเธกเน€เธเนเธเธชเนเธงเธเธ•เธฑเธง</span>\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Navigation Buttons */}\r\n            <div className=\"flex gap-4 mt-12\">\r\n                {step > 0 && (\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={() => setStep(step - 1)}\r\n                        className=\"flex-1 py-5 rounded-3xl border-2 border-slate-100 font-black text-slate-400 uppercase tracking-widest hover:bg-slate-50 transition-all\"\r\n                    >\r\n                        {dict?.common?.back || 'เธขเนเธญเธเธเธฅเธฑเธ'}\r\n                    </button>\r\n                )}\r\n                <button\r\n                    type=\"button\"\r\n                    onClick={() => step < 4 ? setStep(step + 1) : handleSubmit()}\r\n                    disabled={!canProceed() || isLoading}\r\n                    className=\"flex-[2] gacp-btn-primary py-5 rounded-3xl font-black text-lg tracking-tight\"\r\n                >\r\n                    {isLoading ? (\r\n                        <div className=\"w-6 h-6 border-3 border-white/30 border-t-white rounded-full animate-spin\"></div>\r\n                    ) : (\r\n                        <>\r\n                            {step < 4 ? 'เธ”เธณเน€เธเธดเธเธเธฒเธฃเธ•เนเธญ' : 'เธขเธทเธเธขเธฑเธเธฅเธเธ—เธฐเน€เธเธตเธขเธ'}\r\n                            <Icons.ArrowRight className=\"w-6 h-6 ml-2\" />\r\n                        </>\r\n                    )}\r\n                </button>\r\n            </div>\r\n\r\n            {step === 0 && (\r\n                <div className=\"mt-8 pt-8 border-t border-slate-50 text-center\">\r\n                    <p className=\"text-slate-400 text-sm font-medium mb-4\">เธกเธตเธเธฑเธเธเธตเธเธนเนเนเธเนเธเธฒเธเธญเธขเธนเนเนเธฅเนเธง?</p>\r\n                    <Link href=\"/login\" className=\"text-primary font-black hover:underline uppercase tracking-widest text-xs\">เน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธเธ—เธตเนเธเธตเน</Link>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\(auth)\\register\\success\\page.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\(auth)\\register\\success\\page.tsx:16:21\n  14 |     const name = searchParams.get(\"name\") || \"\";\n  15 |\n> 16 |     useEffect(() => setMounted(true), []);\n     |                     ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  17 |\n  18 |     const getAccountTypeThai = () => {\n  19 |         switch (accountType) {","line":16,"column":21,"nodeType":null,"endLine":16,"endColumn":31}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { Suspense, useEffect, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useSearchParams } from \"next/navigation\";\r\nimport { Icons } from \"@/components/ui/icons\";\r\n\r\nfunction RegisterSuccessContent() {\r\n    const searchParams = useSearchParams();\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    const identifier = searchParams.get(\"id\") || \"\";\r\n    const accountType = searchParams.get(\"type\") || \"\";\r\n    const name = searchParams.get(\"name\") || \"\";\r\n\r\n    useEffect(() => setMounted(true), []);\r\n\r\n    const getAccountTypeThai = () => {\r\n        switch (accountType) {\r\n            case \"INDIVIDUAL\": return \"เธเธธเธเธเธฅเธเธฃเธฃเธกเธ”เธฒ\";\r\n            case \"JURISTIC\": return \"เธเธดเธ•เธดเธเธธเธเธเธฅ\";\r\n            case \"COMMUNITY_ENTERPRISE\": return \"เธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ\";\r\n            default: return \"เน€เธเธฉเธ•เธฃเธเธฃ\";\r\n        }\r\n    };\r\n\r\n    if (!mounted) {\r\n        return (\r\n            <div className=\"flex flex-col items-center justify-center min-h-[40vh]\">\r\n                <div className=\"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"auth-card animate-scale-in text-center\">\r\n            {/* Success Icon */}\r\n            <div className=\"relative mb-10 inline-block\">\r\n                <div className=\"absolute inset-0 bg-primary/20 rounded-full blur-2xl animate-pulse scale-150\"></div>\r\n                <div className=\"w-24 h-24 bg-gradient-to-br from-primary to-emerald-600 rounded-full flex items-center justify-center relative z-10 shadow-premium\">\r\n                    <Icons.CheckCircle className=\"w-12 h-12 text-white\" />\r\n                </div>\r\n            </div>\r\n\r\n            <h1 className=\"text-4xl font-black text-slate-800 mb-2\">เธฅเธเธ—เธฐเน€เธเธตเธขเธเธชเธณเน€เธฃเนเธ!</h1>\r\n            <p className=\"text-slate-500 font-bold mb-10 tracking-tight\">เธเธธเธ“เธเธฃเนเธญเธกเธชเธณเธซเธฃเธฑเธเธเธฒเธฃเธขเธทเนเธเธเธญเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP เนเธฅเนเธง</p>\r\n\r\n            {/* Account Info Box */}\r\n            <div className=\"bg-slate-50/80 rounded-[2rem] p-8 text-left mb-10 border border-slate-100 shadow-inner\">\r\n                <div className=\"flex flex-col gap-4\">\r\n                    <div className=\"flex justify-between items-center border-b border-slate-100 pb-3\">\r\n                        <span className=\"text-[10px] font-black uppercase tracking-[0.2em] text-slate-400\">Account Type</span>\r\n                        <span className=\"text-sm font-black text-primary bg-primary/5 px-3 py-1 rounded-full\">{getAccountTypeThai()}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center border-b border-slate-100 pb-3\">\r\n                        <span className=\"text-[10px] font-black uppercase tracking-[0.2em] text-slate-400\">Username / ID</span>\r\n                        <span className=\"text-sm font-black text-slate-700 font-mono tracking-wider\">{identifier}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center\">\r\n                        <span className=\"text-[10px] font-black uppercase tracking-[0.2em] text-slate-400\">Registered Name</span>\r\n                        <span className=\"text-sm font-black text-slate-700\">{name}</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Next Steps Guide */}\r\n            <div className=\"text-left mb-10 px-4\">\r\n                <h3 className=\"text-xs font-black uppercase tracking-widest text-slate-400 mb-4 text-center\">เธชเธฒเธกเธเธฑเนเธเธ•เธญเธเธชเธนเนเธกเธฒเธ•เธฃเธเธฒเธ GACP</h3>\r\n                <div className=\"grid grid-cols-3 gap-4\">\r\n                    <div className=\"flex flex-col items-center text-center gap-2\">\r\n                        <div className=\"w-8 h-8 rounded-full bg-primary/10 text-primary flex items-center justify-center font-black text-xs\">1</div>\r\n                        <span className=\"text-[10px] font-bold text-slate-500\">เน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธเธเธฃเธฑเนเธเนเธฃเธ</span>\r\n                    </div>\r\n                    <div className=\"flex flex-col items-center text-center gap-2\">\r\n                        <div className=\"w-8 h-8 rounded-full bg-primary/10 text-primary flex items-center justify-center font-black text-xs\">2</div>\r\n                        <span className=\"text-[10px] font-bold text-slate-500\">เธขเธทเธเธขเธฑเธเธ•เธฑเธงเธ•เธ (KYC)</span>\r\n                    </div>\r\n                    <div className=\"flex flex-col items-center text-center gap-2\">\r\n                        <div className=\"w-8 h-8 rounded-full bg-primary/10 text-primary flex items-center justify-center font-black text-xs\">3</div>\r\n                        <span className=\"text-[10px] font-bold text-slate-500\">เธขเธทเนเธเนเธเธเธเธญเธฃเธฑเธเธฃเธญเธ</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <Link\r\n                href=\"/login\"\r\n                className=\"gacp-btn-primary w-full py-5 rounded-2.5xl text-lg font-black\"\r\n            >\r\n                เนเธเธซเธเนเธฒเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ\r\n                <Icons.ArrowRight className=\"w-6 h-6 ml-2\" />\r\n            </Link>\r\n\r\n            <p className=\"mt-8 text-[10px] font-bold text-slate-400 uppercase tracking-widest\">\r\n                Safe and Secure Authentication by DTAM\r\n            </p>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction LoadingFallback() {\r\n    return (\r\n        <div className=\"flex flex-col items-center justify-center min-vh-[50vh]\">\r\n            <div className=\"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin\"></div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default function RegisterSuccessPage() {\r\n    return (\r\n        <Suspense fallback={<LoadingFallback />}>\r\n            <RegisterSuccessContent />\r\n        </Suspense>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\(auth)\\verify-identity\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GroupIcon' is defined but never used.","line":6,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":52},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'retryCount' is assigned a value but never used.","line":20,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":102,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4112,4115],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4112,4115],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useAuth } from '@/lib/services/auth-provider';\r\nimport { Icons, PersonIcon, BuildingIcon, GroupIcon } from '@/components/ui/icons';\r\n\r\nexport default function VerifyIdentityPage() {\r\n    const { user, isAuthenticated, isLoading, updateUser } = useAuth();\r\n    const router = useRouter();\r\n\r\n    // Form State\r\n    const [laserCode, setLaserCode] = useState('');\r\n    const [taxId, setTaxId] = useState('');\r\n    const [idCardFile, setIdCardFile] = useState<File | null>(null);\r\n    const [companyCertFile, setCompanyCertFile] = useState<File | null>(null);\r\n\r\n    // Status State\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [retryCount, setRetryCount] = useState(0);\r\n    const [canManual, setCanManual] = useState(false);\r\n    const [isManualRequest, setManualRequest] = useState(false);\r\n    const [isLocked, setIsLocked] = useState(false);\r\n\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [success, setSuccess] = useState(false);\r\n\r\n    const [aiResult, setAiResult] = useState<{ confidence: number; message: string; extractedSnippet: string } | null>(null);\r\n\r\n    // Redirect if not logged in OR if already verified\r\n    useEffect(() => {\r\n        if (!isLoading) {\r\n            if (!isAuthenticated) {\r\n                router.push('/login');\r\n            } else if (user?.verificationStatus === 'APPROVED') {\r\n                router.push('/farmer/dashboard');\r\n            }\r\n        }\r\n    }, [isLoading, isAuthenticated, user, router]);\r\n\r\n    const isJuristic = user?.role === 'JURISTIC_FARMER' || user?.role === 'ENTREPRENEUR';\r\n\r\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>, type: 'id' | 'company') => {\r\n        if (e.target.files && e.target.files[0]) {\r\n            const file = e.target.files[0];\r\n            if (file.size > 10 * 1024 * 1024) {\r\n                setError('เธเธเธฒเธ”เนเธเธฅเนเธ•เนเธญเธเนเธกเนเน€เธเธดเธ 10MB');\r\n                return;\r\n            }\r\n            if (type === 'id') setIdCardFile(file);\r\n            else setCompanyCertFile(file);\r\n            setError(null);\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError(null);\r\n        setIsSubmitting(true);\r\n\r\n        try {\r\n            const formData = new FormData();\r\n            if (laserCode) formData.append('laserCode', laserCode);\r\n            if (taxId) formData.append('taxId', taxId);\r\n            if (idCardFile) formData.append('idCardImage', idCardFile);\r\n            if (companyCertFile) formData.append('companyCertImage', companyCertFile);\r\n\r\n            if (isManualRequest) formData.append('forceManual', 'true');\r\n\r\n            if (!idCardFile && !companyCertFile) {\r\n                throw new Error('เธเธฃเธธเธ“เธฒเธญเธฑเธเนเธซเธฅเธ”เน€เธญเธเธชเธฒเธฃเธขเธทเธเธขเธฑเธเธ•เธฑเธงเธ•เธ');\r\n            }\r\n\r\n            const token = localStorage.getItem('accessToken');\r\n            const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000/api'}/identity/verify`, {\r\n                method: 'POST',\r\n                headers: { 'Authorization': `Bearer ${token}` },\r\n                body: formData\r\n            });\r\n\r\n            const data = await res.json();\r\n            if (data.aiAnalysis) setAiResult(data.aiAnalysis);\r\n\r\n            if (res.ok) {\r\n                setSuccess(true);\r\n                if (user) {\r\n                    updateUser({\r\n                        ...user,\r\n                        verificationStatus: data.status === 'APPROVED' ? 'APPROVED' : 'PENDING',\r\n                        verificationSubmittedAt: new Date().toISOString()\r\n                    });\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (!data.success) {\r\n                if (data.attempts !== undefined) setRetryCount(data.attempts);\r\n                if (data.canManual) setCanManual(true);\r\n                if (data.isLocked) setIsLocked(true);\r\n                throw new Error(data.error || 'เธเธฒเธฃเธขเธทเธเธขเธฑเธเธ•เธฑเธงเธ•เธเธฅเนเธกเน€เธซเธฅเธง');\r\n            }\r\n        } catch (err: any) {\r\n            setError(err.message || 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเธชเนเธเธเนเธญเธกเธนเธฅ');\r\n        } finally {\r\n            setIsSubmitting(false);\r\n            setManualRequest(false);\r\n        }\r\n    };\r\n\r\n    if (isLoading) return (\r\n        <div className=\"auth-card flex flex-col items-center justify-center py-20\">\r\n            <div className=\"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin mb-4\"></div>\r\n            <p className=\"text-slate-400 font-bold uppercase tracking-widest text-xs\">Loading Security Context...</p>\r\n        </div>\r\n    );\r\n\r\n    // View: Pending Review\r\n    if (user?.verificationStatus === 'PENDING' || success) {\r\n        return (\r\n            <div className=\"auth-card animate-scale-in text-center\">\r\n                <div className=\"relative mb-10 inline-block\">\r\n                    <div className=\"absolute inset-0 bg-amber-400/20 rounded-full blur-2xl animate-pulse scale-150\"></div>\r\n                    <div className=\"w-24 h-24 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center relative z-10 shadow-premium\">\r\n                        <Icons.Clock className=\"w-12 h-12 text-white\" />\r\n                    </div>\r\n                </div>\r\n                <h2 className=\"text-3xl font-black text-slate-800 mb-2\">เธเธณเธฅเธฑเธเธฃเธญเธเธฒเธฃเธ•เธฃเธงเธเธชเธญเธ</h2>\r\n                <p className=\"text-slate-500 font-medium mb-10\">เธฃเธฐเธเธเนเธ”เนเธฃเธฑเธเน€เธญเธเธชเธฒเธฃเธเธญเธเธ—เนเธฒเธเนเธฅเนเธง เนเธฅเธฐเธเธณเธฅเธฑเธเธญเธขเธนเนเนเธเธฃเธฐเธซเธงเนเธฒเธเธเธฒเธฃเธขเธทเธเธขเธฑเธเธเธงเธฒเธกเธ–เธนเธเธ•เนเธญเธ</p>\r\n\r\n                <div className=\"bg-slate-50 border border-slate-100 rounded-[2rem] p-8 text-left mb-10 shadow-inner\">\r\n                    <div className=\"flex flex-col gap-4\">\r\n                        <div className=\"flex justify-between items-center border-b border-slate-200/50 pb-4\">\r\n                            <span className=\"text-[10px] font-black uppercase tracking-[0.2em] text-slate-400\">Submission Date</span>\r\n                            <span className=\"text-sm font-black text-slate-700\">\r\n                                {new Date(user?.verificationSubmittedAt || new Date()).toLocaleDateString('th-TH', {\r\n                                    year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit'\r\n                                })}\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"flex justify-between items-center\">\r\n                            <span className=\"text-[10px] font-black uppercase tracking-[0.2em] text-slate-400\">Estimate Time</span>\r\n                            <span className=\"text-sm font-black text-primary\">1-2 เธงเธฑเธเธ—เธณเธเธฒเธฃ</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"p-6 bg-primary/5 rounded-3xl border border-primary/10 mb-10 text-left flex gap-4\">\r\n                    <Icons.Info className=\"w-6 h-6 text-primary flex-shrink-0 mt-1\" />\r\n                    <p className=\"text-sm font-bold text-primary/80 leading-relaxed\">\r\n                        เธฃเธฐเธซเธงเนเธฒเธเธฃเธญเธเธฒเธฃเธ•เธฃเธงเธเธชเธญเธ เธ—เนเธฒเธเธขเธฑเธเธชเธฒเธกเธฒเธฃเธ–เธชเธณเธฃเธงเธเน€เธกเธเธนเธ•เนเธฒเธเน เนเธฅเธฐเน€เธ•เธฃเธตเธขเธกเธเนเธญเธกเธนเธฅเน€เธเธทเนเธญเธเธ•เนเธเธชเธณเธซเธฃเธฑเธเน€เธฃเธดเนเธกเธเธญเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธเนเธ”เน\r\n                    </p>\r\n                </div>\r\n\r\n                <button\r\n                    onClick={() => router.push('/farmer/dashboard')}\r\n                    className=\"gacp-btn-primary w-full py-5 rounded-2.5xl text-lg font-black\"\r\n                >\r\n                    เน€เธเนเธฒเธชเธนเนเธซเธเนเธฒเนเธ”เธเธเธญเธฃเนเธ”\r\n                    <Icons.ArrowRight className=\"w-6 h-6 ml-2\" />\r\n                </button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const isRejected = user?.verificationStatus === 'REJECTED';\r\n\r\n    return (\r\n        <div className=\"auth-card animate-slide-up max-h-[85vh] overflow-y-auto no-scrollbar\">\r\n            <div className=\"mb-8\">\r\n                <h2 className=\"text-3xl font-black text-slate-800 leading-tight\">เธขเธทเธเธขเธฑเธเธ•เธฑเธงเธ•เธ (e-KYC)</h2>\r\n                <p className=\"text-slate-500 font-medium mt-2\">เน€เธเธทเนเธญเธเธงเธฒเธกเธเธฅเธญเธ”เธ เธฑเธขเนเธฅเธฐเธกเธฒเธ•เธฃเธเธฒเธ GACP เนเธเธฃเธ”เธขเธทเธเธขเธฑเธเธ•เธฑเธงเธ•เธเน€เธเธทเนเธญเน€เธฃเธดเนเธกเนเธเนเธเธฒเธเธฃเธฐเธเธเธญเธขเนเธฒเธเน€เธ•เนเธกเธฃเธนเธเนเธเธ</p>\r\n            </div>\r\n\r\n            {isRejected && (\r\n                <div className=\"mb-8 p-6 bg-rose-50 border border-rose-100 rounded-3xl text-rose-600 animate-head-shake\">\r\n                    <div className=\"flex gap-4\">\r\n                        <Icons.Warning className=\"w-6 h-6 flex-shrink-0 mt-1\" />\r\n                        <div>\r\n                            <h4 className=\"font-black uppercase tracking-wider text-sm mb-1\">เธเธฒเธฃเธขเธทเธเธขเธฑเธเธ•เธฑเธงเธ•เธเนเธกเนเธเนเธฒเธ</h4>\r\n                            <p className=\"text-sm font-bold opacity-80\">{user?.verificationNote || 'เน€เธญเธเธชเธฒเธฃเนเธกเนเธเธฑเธ”เน€เธเธเธซเธฃเธทเธญเนเธกเนเธ–เธนเธเธ•เนเธญเธ เธเธฃเธธเธ“เธฒเธญเธฑเธเนเธซเธฅเธ”เน€เธญเธเธชเธฒเธฃเนเธซเธกเนเธญเธตเธเธเธฃเธฑเนเธ'}</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            <form onSubmit={handleSubmit} className=\"space-y-8 pb-4\">\r\n                {/* Section 1: Data */}\r\n                <div className=\"space-y-6\">\r\n                    <div className=\"flex items-center gap-3 mb-2\">\r\n                        <div className=\"w-8 h-8 bg-primary/10 rounded-xl flex items-center justify-center text-primary\">\r\n                            {isJuristic ? <BuildingIcon className=\"w-5 h-5\" /> : <PersonIcon className=\"w-5 h-5\" />}\r\n                        </div>\r\n                        <h3 className=\"text-lg font-black text-slate-700 tracking-tight\">{isJuristic ? 'เธเนเธญเธกเธนเธฅเธเธดเธ•เธดเธเธธเธเธเธฅ' : 'เธเนเธญเธกเธนเธฅเธฃเธซเธฑเธชเธซเธฅเธฑเธเธเธฑเธ•เธฃ'}</h3>\r\n                    </div>\r\n\r\n                    {isJuristic ? (\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-xs font-black uppercase tracking-widest text-slate-400 px-1\">เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธต</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={taxId}\r\n                                onChange={e => setTaxId(e.target.value)}\r\n                                className=\"w-full bg-slate-50 border-2 border-slate-50 rounded-2xl py-4 px-6 focus:bg-white focus:border-primary outline-none transition-all font-mono\"\r\n                                placeholder=\"01055XXXXXXXX\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"space-y-2\">\r\n                            <label className=\"text-xs font-black uppercase tracking-widest text-slate-400 px-1\">Laser Code (เธฃเธซเธฑเธชเธซเธฅเธฑเธเธเธฑเธ•เธฃ)</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={laserCode}\r\n                                onChange={e => setLaserCode(e.target.value)}\r\n                                className=\"w-full bg-slate-50 border-2 border-slate-50 rounded-2xl py-4 px-6 focus:bg-white focus:border-primary outline-none transition-all font-mono uppercase tracking-widest\"\r\n                                placeholder=\"ME0-1234567-89\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Section 2: Uploads */}\r\n                <div className=\"space-y-6\">\r\n                    <div className=\"flex items-center gap-3 mb-2\">\r\n                        <div className=\"w-8 h-8 bg-primary/10 rounded-xl flex items-center justify-center text-primary\">\r\n                            <Icons.Document className=\"w-5 h-5\" />\r\n                        </div>\r\n                        <h3 className=\"text-lg font-black text-slate-700 tracking-tight\">เธญเธฑเธเนเธซเธฅเธ”เน€เธญเธเธชเธฒเธฃ</h3>\r\n                    </div>\r\n\r\n                    <div className=\"grid gap-4\">\r\n                        {/* File Area */}\r\n                        <label className={`\r\n                            relative h-44 rounded-3xl border-2 border-dashed transition-all cursor-pointer flex flex-col items-center justify-center overflow-hidden\r\n                            ${idCardFile ? 'border-primary bg-primary/5' : 'border-slate-200 bg-slate-50/50 hover:border-primary/40 hover:bg-slate-100'}\r\n                         `}>\r\n                            {idCardFile ? (\r\n                                <div className=\"text-center animate-scale-in p-4\">\r\n                                    <div className=\"w-16 h-16 bg-primary rounded-2xl flex items-center justify-center mx-auto mb-3 shadow-lg shadow-primary/20\">\r\n                                        <Icons.CheckCircle className=\"w-8 h-8 text-white\" />\r\n                                    </div>\r\n                                    <p className=\"text-sm font-black text-primary truncate max-w-[200px]\">{idCardFile.name}</p>\r\n                                    <p className=\"text-[10px] font-bold text-slate-400 mt-1\">เนเธเธฅเนเนเธ”เนเธฃเธฑเธเธเธฒเธฃเน€เธฅเธทเธญเธเนเธฅเนเธง เธเธฅเธดเธเน€เธเธทเนเธญเน€เธเธฅเธตเนเธขเธ</p>\r\n                                </div>\r\n                            ) : (\r\n                                <div className=\"text-center\">\r\n                                    <Icons.Upload className=\"w-10 h-10 text-slate-300 mx-auto mb-3\" />\r\n                                    <p className=\"text-sm font-black text-slate-500\">{isJuristic ? 'เธชเธณเน€เธเธฒเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธเธเธฃเธฃเธกเธเธฒเธฃ' : 'เธฃเธนเธเธ–เนเธฒเธขเธซเธเนเธฒเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธ'}</p>\r\n                                    <p className=\"text-[10px] font-bold text-slate-400 mt-1 uppercase tracking-widest\">Supports JPG, PNG (Max 10MB)</p>\r\n                                </div>\r\n                            )}\r\n                            <input type=\"file\" className=\"hidden\" onChange={e => handleFileChange(e, 'id')} accept=\"image/*,.pdf\" />\r\n                        </label>\r\n\r\n                        {isJuristic && (\r\n                            <label className={`\r\n                                relative h-44 rounded-3xl border-2 border-dashed transition-all cursor-pointer flex flex-col items-center justify-center overflow-hidden\r\n                                ${companyCertFile ? 'border-primary bg-primary/5' : 'border-slate-200 bg-slate-50/50 hover:border-primary/40 hover:bg-slate-100'}\r\n                             `}>\r\n                                {companyCertFile ? (\r\n                                    <div className=\"text-center animate-scale-in p-4\">\r\n                                        <div className=\"w-16 h-16 bg-primary rounded-2xl flex items-center justify-center mx-auto mb-3 shadow-lg shadow-primary/20\">\r\n                                            <Icons.CheckCircle className=\"w-8 h-8 text-white\" />\r\n                                        </div>\r\n                                        <p className=\"text-sm font-black text-primary truncate max-w-[200px]\">{companyCertFile.name}</p>\r\n                                        <p className=\"text-[10px] font-bold text-slate-400 mt-1\">เนเธเธฅเนเนเธ”เนเธฃเธฑเธเธเธฒเธฃเน€เธฅเธทเธญเธเนเธฅเนเธง เธเธฅเธดเธเน€เธเธทเนเธญเน€เธเธฅเธตเนเธขเธ</p>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"text-center\">\r\n                                        <Icons.Upload className=\"w-10 h-10 text-slate-300 mx-auto mb-3\" />\r\n                                        <p className=\"text-sm font-black text-slate-500\">เธซเธเธฑเธเธชเธทเธญเธฃเธฑเธเธฃเธญเธเธเธฃเธดเธฉเธฑเธ—</p>\r\n                                        <p className=\"text-[10px] font-bold text-slate-400 mt-1 uppercase tracking-widest\">Registration Document (Max 10MB)</p>\r\n                                    </div>\r\n                                )}\r\n                                <input type=\"file\" className=\"hidden\" onChange={e => handleFileChange(e, 'company')} accept=\"image/*,.pdf\" />\r\n                            </label>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* AI & Errors */}\r\n                {error && (\r\n                    <div className=\"p-4 bg-rose-50 border border-rose-100 rounded-2xl text-rose-600 text-sm font-bold flex flex-col gap-3\">\r\n                        <div className=\"flex gap-3\">\r\n                            <Icons.Warning className=\"w-5 h-5 flex-shrink-0\" />\r\n                            {error}\r\n                        </div>\r\n                        {canManual && !isLocked && (\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={() => {\r\n                                    setManualRequest(true);\r\n                                    setTimeout(() => {\r\n                                        const form = document.getElementById('verify-form') as HTMLFormElement;\r\n                                        if (form) form.requestSubmit();\r\n                                    }, 100);\r\n                                }}\r\n                                className=\"w-full py-3 bg-white border border-rose-200 rounded-xl text-xs font-black uppercase tracking-widest hover:bg-rose-100 transition-all\"\r\n                            >\r\n                                เธชเนเธเนเธซเนเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธ•เธฃเธงเธเธชเธญเธ (Manual Review)\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                )}\r\n\r\n                {aiResult && !success && (\r\n                    <div className=\"p-5 bg-indigo-50 border border-indigo-100 rounded-3xl animate-fade-in\">\r\n                        <h4 className=\"text-xs font-black uppercase tracking-widest text-indigo-400 mb-2 flex items-center gap-2\">\r\n                            <Icons.Search className=\"w-4 h-4\" />\r\n                            AI Analysis Engine\r\n                        </h4>\r\n                        <p className=\"text-sm font-bold text-indigo-700 leading-snug\">{aiResult.message}</p>\r\n                    </div>\r\n                )}\r\n\r\n                <div className=\"pt-4\">\r\n                    {isLocked ? (\r\n                        <div className=\"w-full bg-slate-100 border border-slate-200 text-slate-400 py-5 rounded-3xl text-center font-black uppercase tracking-widest text-sm\">\r\n                            Account Temporarily Locked\r\n                        </div>\r\n                    ) : (\r\n                        <button\r\n                            type=\"submit\"\r\n                            id=\"verify-form-btn\"\r\n                            disabled={isSubmitting}\r\n                            className=\"w-full gacp-btn-primary py-5 rounded-3xl text-lg font-black tracking-tight\"\r\n                        >\r\n                            {isSubmitting ? (\r\n                                <div className=\"w-6 h-6 border-3 border-white/30 border-t-white rounded-full animate-spin\"></div>\r\n                            ) : (\r\n                                <>\r\n                                    เธขเธทเธเธขเธฑเธเนเธฅเธฐเธชเนเธเธ•เธฃเธงเธเธชเธญเธ\r\n                                    <Icons.ArrowRight className=\"w-6 h-6 ml-2\" />\r\n                                </>\r\n                            )}\r\n                        </button>\r\n                    )}\r\n                </div>\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\admin\\config\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":8,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":17},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'config'. Either include it or remove the dependency array.","line":32,"column":8,"nodeType":"ArrayExpression","endLine":32,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [config]","fix":{"range":[1109,1111],"text":"[config]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { AdminService } from \"@/lib/services/admin-service\";\r\n\r\nexport default function AdminConfigPage() {\r\n    const router = useRouter();\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n    const [config, setConfig] = useState<Record<string, string>>({\r\n        \"fee.review\": \"5000\",\r\n        \"fee.inspection\": \"15000\",\r\n        \"fee.vat\": \"7\"\r\n    });\r\n\r\n    useEffect(() => {\r\n        const fetchConfig = async () => {\r\n            setIsLoading(true);\r\n            const result = await AdminService.getConfigs();\r\n            if (result.success && result.data) {\r\n                const newConfig: Record<string, string> = { ...config };\r\n                // Map array to object\r\n                result.data.forEach(item => {\r\n                    newConfig[item.key] = item.value;\r\n                });\r\n                setConfig(newConfig);\r\n            }\r\n            setIsLoading(false);\r\n        };\r\n        fetchConfig();\r\n    }, []);\r\n\r\n    const handleChange = (key: string, value: string) => {\r\n        setConfig(prev => ({ ...prev, [key]: value }));\r\n    };\r\n\r\n    const handleSave = async () => {\r\n        setIsSaving(true);\r\n        try {\r\n            // Save each config key\r\n            const promises = Object.keys(config).map(key =>\r\n                AdminService.updateConfig(key, config[key])\r\n            );\r\n            await Promise.all(promises);\r\n            alert(\"เธเธฑเธเธ—เธถเธเธเธฒเธฃเธ•เธฑเนเธเธเนเธฒเนเธฅเนเธง\");\r\n        } catch (error) {\r\n            alert(\"เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเธเธฑเธเธ—เธถเธ\");\r\n            console.error(error);\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"font-sans\">\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n                <div>\r\n                    <h1 className=\"text-2xl font-bold text-slate-800\">เธ•เธฑเนเธเธเนเธฒเธฃเธฐเธเธ (System Configuration)</h1>\r\n                    <p className=\"text-sm text-slate-500\">เธเธณเธซเธเธ”เธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธกเนเธฅเธฐเธเธฒเธฃเธฒเธกเธดเน€เธ•เธญเธฃเนเธเธญเธเธฃเธฐเธเธ</p>\r\n                </div>\r\n                <button\r\n                    onClick={handleSave}\r\n                    disabled={isLoading || isSaving}\r\n                    className=\"px-6 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors disabled:opacity-50\"\r\n                >\r\n                    {isSaving ? \"เธเธณเธฅเธฑเธเธเธฑเธเธ—เธถเธ...\" : \"เธเธฑเธเธ—เธถเธเธเธฒเธฃเน€เธเธฅเธตเนเธขเธเนเธเธฅเธ\"}\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                {/* Fees Section */}\r\n                <div className=\"bg-white rounded-xl shadow-sm border border-slate-200 p-6\">\r\n                    <h3 className=\"text-lg font-semibold mb-6 flex items-center gap-2\">\r\n                        <span className=\"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center text-blue-600\">๐’ฐ</span>\r\n                        เธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธก (Fees)\r\n                    </h3>\r\n\r\n                    <div className=\"space-y-6\">\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-slate-700 mb-2\">เธเนเธฒเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃเธเธณเธเธญ (เธเธฒเธ—)</label>\r\n                            <div className=\"relative\">\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={config[\"fee.review\"]}\r\n                                    onChange={(e) => handleChange(\"fee.review\", e.target.value)}\r\n                                    className=\"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none\"\r\n                                />\r\n                                <span className=\"absolute right-4 top-2 text-slate-400\">THB</span>\r\n                            </div>\r\n                            <p className=\"text-xs text-slate-400 mt-1\">เน€เธฃเธตเธขเธเน€เธเนเธเน€เธกเธทเนเธญเธขเธทเนเธเธเธณเธเธญ</p>\r\n                        </div>\r\n\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-slate-700 mb-2\">เธเนเธฒเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธเนเธเธฅเธ (เธเธฒเธ—)</label>\r\n                            <div className=\"relative\">\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={config[\"fee.inspection\"]}\r\n                                    onChange={(e) => handleChange(\"fee.inspection\", e.target.value)}\r\n                                    className=\"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none\"\r\n                                />\r\n                                <span className=\"absolute right-4 top-2 text-slate-400\">THB</span>\r\n                            </div>\r\n                            <p className=\"text-xs text-slate-400 mt-1\">เน€เธฃเธตเธขเธเน€เธเนเธเธเนเธญเธเธเธฑเธ”เธซเธกเธฒเธขเธ•เธฃเธงเธเนเธเธฅเธ</p>\r\n                        </div>\r\n\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-slate-700 mb-2\">เธญเธฑเธ•เธฃเธฒเธ เธฒเธฉเธตเธกเธนเธฅเธเนเธฒเน€เธเธดเนเธก (%)</label>\r\n                            <div className=\"relative\">\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={config[\"fee.vat\"]}\r\n                                    onChange={(e) => handleChange(\"fee.vat\", e.target.value)}\r\n                                    className=\"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none\"\r\n                                />\r\n                                <span className=\"absolute right-4 top-2 text-slate-400\">%</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* System Parameters (Placeholder) */}\r\n                <div className=\"bg-white rounded-xl shadow-sm border border-slate-200 p-6 opacity-60\">\r\n                    <h3 className=\"text-lg font-semibold mb-6 flex items-center gap-2\">\r\n                        <span className=\"w-8 h-8 rounded-lg bg-purple-100 flex items-center justify-center text-purple-600\">โ๏ธ</span>\r\n                        เธ•เธฑเนเธเธเนเธฒเธญเธทเนเธเน (Coming Soon)\r\n                    </h3>\r\n                    <div className=\"space-y-4\">\r\n                        <div className=\"h-4 bg-slate-100 rounded w-3/4\"></div>\r\n                        <div className=\"h-10 bg-slate-50 rounded border border-slate-200\"></div>\r\n                        <div className=\"h-4 bg-slate-100 rounded w-1/2 mt-4\"></div>\r\n                        <div className=\"h-10 bg-slate-50 rounded border border-slate-200\"></div>\r\n                    </div>\r\n                    <div className=\"mt-6 p-4 bg-slate-50 rounded-lg border border-slate-200 text-center text-slate-500 text-sm\">\r\n                        เธชเนเธงเธเธเธตเนเธญเธขเธนเนเธฃเธฐเธซเธงเนเธฒเธเธเธฒเธฃเธเธฑเธ’เธเธฒ\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\admin\\dashboard\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IconCalendar' is defined but never used.","line":7,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IconCreditCard' is defined but never used.","line":7,"column":49,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":63},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IconUser' is defined but never used.","line":7,"column":65,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":73},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IconLeaf' is assigned a value but never used.","line":26,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isLoading' is assigned a value but never used.","line":51,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":51,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { AdminService } from \"@/lib/services/admin-service\";\r\nimport { IconDocument, IconChart, IconCalendar, IconCreditCard, IconUser, IconCheckCircle, IconClock } from \"@/components/ui/icons\";\r\n\r\n// Additional icons\r\nconst IconUsers = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\" />\r\n        <circle cx=\"9\" cy=\"7\" r=\"4\" />\r\n        <path d=\"M23 21v-2a4 4 0 0 0-3-3.87\" />\r\n        <path d=\"M16 3.13a4 4 0 0 1 0 7.75\" />\r\n    </svg>\r\n);\r\n\r\nconst IconSettings = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <circle cx=\"12\" cy=\"12\" r=\"3\" />\r\n        <path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\" />\r\n    </svg>\r\n);\r\n\r\nconst IconLeaf = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M6.3 20.3a2.4 2.4 0 0 0 3.4 0L12 18l2.3 2.3a2.4 2.4 0 0 0 3.4-3.4L15.4 14.6l6-6c4.5-4.5.5-8.5-4-4l-6.3 6.3-2.4-2.4a2.4 2.4 0 0 0-3.4 3.4L7.7 14.3l-4 4a2.4 2.4 0 0 0 0 3.4l2.6-1.4z\" />\r\n    </svg>\r\n);\r\n\r\ninterface StaffUser {\r\n    username: string;\r\n    email: string;\r\n    role: string;\r\n    department?: string;\r\n    firstName?: string;\r\n    lastName?: string;\r\n}\r\n\r\nconst AdminDashboardContent = () => {\r\n    const router = useRouter();\r\n    const [user, setUser] = useState<StaffUser | null>(null);\r\n    const [statsData, setStatsData] = useState({\r\n        total: 0,\r\n        pending: 0,\r\n        approved: 0,\r\n        officers: 0,\r\n        revenue: 0\r\n    });\r\n    const [isLoading, setIsLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const checkAuth = async () => {\r\n            const stored = localStorage.getItem(\"staff_user\");\r\n            if (!stored) {\r\n                router.push(\"/staff/login\");\r\n                return;\r\n            }\r\n            setUser(JSON.parse(stored));\r\n\r\n            // Fetch stats\r\n            const result = await AdminService.getDashboardStats();\r\n            if (result.success && result.data) {\r\n                setStatsData({\r\n                    total: result.data.total,\r\n                    pending: result.data.pending,\r\n                    approved: result.data.approved,\r\n                    officers: 12, // Mock for now or fetch if API available\r\n                    revenue: 0\r\n                });\r\n            }\r\n            setIsLoading(false);\r\n        };\r\n        checkAuth();\r\n    }, [router]);\r\n\r\n    if (!user) return null;\r\n\r\n    const stats = [\r\n        { label: \"เธเธณเธเธญเธ—เธฑเนเธเธซเธกเธ”\", value: statsData.total.toLocaleString(), Icon: IconDocument, bgColor: \"bg-emerald-500\" },\r\n        { label: \"เธฃเธญเธ•เธฃเธงเธเธชเธญเธ\", value: statsData.pending.toLocaleString(), Icon: IconClock, bgColor: \"bg-amber-500\" },\r\n        { label: \"เธญเธเธธเธกเธฑเธ•เธดเนเธฅเนเธง\", value: statsData.approved.toLocaleString(), Icon: IconCheckCircle, bgColor: \"bg-emerald-500\" },\r\n        { label: \"เธฃเธฒเธขเนเธ”เนเธฃเธงเธก (เธเธฒเธ—)\", value: \"เธฟ\" + (statsData.revenue || 0).toLocaleString(), Icon: IconChart, bgColor: \"bg-blue-500\" }, // Changed from Officers to Revenue for better utility\r\n    ];\r\n\r\n    const recentActivities = [\r\n        { action: \"เธญเธเธธเธกเธฑเธ•เธดเธเธณเธเธญ #12345\", time: \"5 เธเธฒเธ—เธตเธ—เธตเนเนเธฅเนเธง\", user: \"เธเธนเนเธ•เธฃเธงเธเธชเธญเธ A\" },\r\n        { action: \"เธชเธฃเนเธฒเธเธเธฑเธเธเธตเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเนเธซเธกเน\", time: \"1 เธเธฑเนเธงเนเธกเธเธ—เธตเนเนเธฅเนเธง\", user: \"Admin\" },\r\n        { action: \"เธญเธญเธเนเธเธฃเธฑเธเธฃเธญเธ GACP-2024-001234\", time: \"2 เธเธฑเนเธงเนเธกเธเธ—เธตเนเนเธฅเนเธง\", user: \"เธเธนเนเธ•เธฃเธงเธเธชเธญเธ B\" },\r\n    ];\r\n\r\n    const quickActions = [\r\n        { Icon: IconUsers, label: \"เธเธฑเธ”เธเธฒเธฃเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเน\", href: \"/admin/users\", color: \"bg-slate-600\" },\r\n        { Icon: IconDocument, label: \"เธเธฑเธ”เธเธฒเธฃเธเธทเธ\", href: \"/admin/plants\", color: \"bg-emerald-500\" },\r\n        { Icon: IconChart, label: \"เธฃเธฒเธขเธเธฒเธเธชเธ–เธดเธ•เธด\", href: \"/admin/reports\", color: \"bg-blue-500\" },\r\n        { Icon: IconSettings, label: \"เธ•เธฑเนเธเธเนเธฒเธฃเธฐเธเธ\", href: \"/admin/config\", color: \"bg-slate-500\" },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"font-sans\">\r\n            {/* Welcome */}\r\n            <div className=\"mb-8\">\r\n                <h2 className=\"text-2xl font-semibold m-0 text-slate-800\">\r\n                    เธชเธงเธฑเธชเธ”เธต, {user.firstName || user.username}!\r\n                </h2>\r\n                <p className=\"text-slate-500 mt-1\">\r\n                    เธขเธดเธเธ”เธตเธ•เนเธญเธเธฃเธฑเธเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธเธเธฑเธ”เธเธฒเธฃ GACP เธชเธณเธซเธฃเธฑเธเธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธ\r\n                </p>\r\n            </div>\r\n\r\n            {/* Stats Grid */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\r\n                {stats.map((stat, i) => (\r\n                    <div\r\n                        key={i}\r\n                        className=\"bg-white border border-slate-200 rounded-xl p-6 text-center shadow-sm hover:shadow-md transition-shadow\"\r\n                    >\r\n                        <div className={`w-12 h-12 mx-auto rounded-xl ${stat.bgColor} flex items-center justify-center mb-3 shadow-sm`}>\r\n                            <stat.Icon size={24} className=\"text-white\" />\r\n                        </div>\r\n                        <div className=\"text-3xl font-bold text-slate-800\">{stat.value}</div>\r\n                        <div className=\"text-sm text-slate-400\">{stat.label}</div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Quick Actions & Activity */}\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n                {/* Quick Actions Panel */}\r\n                <div className=\"lg:col-span-2 bg-white border border-slate-200 rounded-xl p-6 shadow-sm\">\r\n                    <h3 className=\"text-lg font-semibold mb-4 text-slate-800\">เธเธฒเธฃเธ”เธณเน€เธเธดเธเธเธฒเธฃเธ”เนเธงเธ</h3>\r\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                        {quickActions.map((action, i) => (\r\n                            <Link\r\n                                key={i}\r\n                                href={action.href}\r\n                                className=\"p-4 bg-slate-50 border border-slate-100 rounded-xl text-slate-700 hover:bg-emerald-50 hover:border-emerald-200 hover:text-emerald-700 transition-all text-center flex flex-col items-center gap-2\"\r\n                            >\r\n                                <div className={`w-10 h-10 rounded-lg ${action.color} flex items-center justify-center shadow-sm`}>\r\n                                    <action.Icon size={20} className=\"text-white\" />\r\n                                </div>\r\n                                <div className=\"text-sm font-medium\">{action.label}</div>\r\n                            </Link>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Recent Activity */}\r\n                <div className=\"bg-white border border-slate-200 rounded-xl p-6 shadow-sm\">\r\n                    <h3 className=\"text-lg font-semibold mb-4 text-slate-800\">เธเธดเธเธเธฃเธฃเธกเธฅเนเธฒเธชเธธเธ”</h3>\r\n                    <div className=\"flex flex-col gap-3\">\r\n                        {recentActivities.map((activity, i) => (\r\n                            <div\r\n                                key={i}\r\n                                className=\"p-3 bg-slate-50 border border-slate-100 rounded-lg\"\r\n                            >\r\n                                <div className=\"text-sm font-medium text-slate-700\">{activity.action}</div>\r\n                                <div className=\"text-xs text-slate-400 mt-1\">\r\n                                    {activity.user} โ€ข {activity.time}\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default AdminDashboardContent;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\admin\\kpi\\page.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadKPIData` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\admin\\kpi\\page.tsx:59:9\n  57 |\n  58 |         // Load initial data\n> 59 |         loadKPIData();\n     |         ^^^^^^^^^^^ `loadKPIData` accessed before it is declared\n  60 |\n  61 |         // Auto-refresh every 5 minutes\n  62 |         const interval = setInterval(() => {\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\admin\\kpi\\page.tsx:69:5\n   67 |     }, [router, timeRange]);\n   68 |\n>  69 |     const loadKPIData = () => {\n      |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  70 |         // Mock KPI data\n      | ^^^^^^^^^^^^^^^^^^^^^^^^\n>  71 |         setKpi({\n      โ€ฆ\n      | ^^^^^^^^^^^^^^^^^^^^^^^^\n>  98 |         setLastUpdate(new Date());\n      | ^^^^^^^^^^^^^^^^^^^^^^^^\n>  99 |     };\n      | ^^^^^^^ `loadKPIData` is declared here\n  100 |\n  101 |     const formatCurrency = (amount: number) => {\n  102 |         return new Intl.NumberFormat(\"th-TH\", { style: \"currency\", currency: \"THB\" }).format(amount);","line":59,"column":9,"nodeType":null,"endLine":59,"endColumn":20}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\n\r\ninterface KPIData {\r\n    totalApplications: number;\r\n    pendingReview: number;\r\n    pendingAudit: number;\r\n    approved: number;\r\n    rejected: number;\r\n    conversionRate: number;\r\n    avgReviewTime: number;\r\n    avgAuditTime: number;\r\n    slaBreach: number;\r\n    rejectionRate: number;\r\n    penaltyTriggered: number;\r\n    revenuePhase1: number;\r\n    revenuePhase2: number;\r\n    todayStats: {\r\n        reviewed: number;\r\n        audited: number;\r\n        approved: number;\r\n    };\r\n}\r\n\r\ninterface StaffPerformance {\r\n    name: string;\r\n    role: string;\r\n    reviewed: number;\r\n    audited: number;\r\n    avgTime: string;\r\n}\r\n\r\nexport default function KPIDashboardPage() {\r\n    const router = useRouter();\r\n    const [kpi, setKpi] = useState<KPIData | null>(null);\r\n    const [staffPerformance, setStaffPerformance] = useState<StaffPerformance[]>([]);\r\n    const [lastUpdate, setLastUpdate] = useState<Date>(new Date());\r\n    const [timeRange, setTimeRange] = useState<\"today\" | \"week\" | \"month\">(\"today\");\r\n\r\n    useEffect(() => {\r\n        const token = localStorage.getItem(\"staff_token\");\r\n        const userData = localStorage.getItem(\"staff_user\");\r\n\r\n        if (!token || !userData) {\r\n            router.push(\"/staff/login\");\r\n            return;\r\n        }\r\n\r\n        const parsedUser = JSON.parse(userData);\r\n        if (![\"ADMIN\", \"SUPER_ADMIN\"].includes(parsedUser.role)) {\r\n            router.push(\"/staff/dashboard\");\r\n            return;\r\n        }\r\n\r\n        // Load initial data\r\n        loadKPIData();\r\n\r\n        // Auto-refresh every 5 minutes\r\n        const interval = setInterval(() => {\r\n            loadKPIData();\r\n        }, 5 * 60 * 1000);\r\n\r\n        return () => clearInterval(interval);\r\n    }, [router, timeRange]);\r\n\r\n    const loadKPIData = () => {\r\n        // Mock KPI data\r\n        setKpi({\r\n            totalApplications: 156,\r\n            pendingReview: 12,\r\n            pendingAudit: 8,\r\n            approved: 98,\r\n            rejected: 15,\r\n            conversionRate: 72.5,\r\n            avgReviewTime: 4.2,\r\n            avgAuditTime: 2.5,\r\n            slaBreach: 3,\r\n            rejectionRate: 42,\r\n            penaltyTriggered: 5,\r\n            revenuePhase1: 780000,\r\n            revenuePhase2: 2450000,\r\n            todayStats: {\r\n                reviewed: 15,\r\n                audited: 4,\r\n                approved: 3,\r\n            },\r\n        });\r\n\r\n        setStaffPerformance([\r\n            { name: \"เธชเธกเธเธฒเธข เธฃเธฑเธเธเธฒเธ\", role: \"REVIEWER_AUDITOR\", reviewed: 45, audited: 12, avgTime: \"3.2 เธเธก.\" },\r\n            { name: \"เธชเธกเธซเธเธดเธ เนเธเน€เธขเนเธ\", role: \"SCHEDULER\", reviewed: 0, audited: 0, avgTime: \"-\" },\r\n            { name: \"เธงเธดเธเธฑเธข เธ—เธณเธ”เธต\", role: \"REVIEWER_AUDITOR\", reviewed: 38, audited: 8, avgTime: \"4.1 เธเธก.\" },\r\n        ]);\r\n\r\n        setLastUpdate(new Date());\r\n    };\r\n\r\n    const formatCurrency = (amount: number) => {\r\n        return new Intl.NumberFormat(\"th-TH\", { style: \"currency\", currency: \"THB\" }).format(amount);\r\n    };\r\n\r\n    if (!kpi) {\r\n        return <div className=\"min-h-screen flex items-center justify-center\"><div className=\"w-10 h-10 border-3 border-slate-200 border-t-emerald-600 rounded-full animate-spin\" /></div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-slate-100\">\r\n            {/* Header */}\r\n            <header className=\"bg-slate-800 text-white shadow-lg\">\r\n                <div className=\"max-w-7xl mx-auto px-6 py-4 flex justify-between items-center\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <Link href=\"/staff/dashboard\" className=\"text-slate-400 hover:text-white\">โ เธเธฅเธฑเธ</Link>\r\n                        <div className=\"h-6 w-px bg-slate-600\" />\r\n                        <h1 className=\"font-bold\">KPI Dashboard</h1>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <div className=\"flex items-center gap-2 text-sm\">\r\n                            <span className=\"animate-pulse w-2 h-2 bg-green-500 rounded-full\"></span>\r\n                            <span className=\"text-slate-400\">เธญเธฑเธเน€เธ”เธ—เธฅเนเธฒเธชเธธเธ”: {lastUpdate.toLocaleTimeString(\"th-TH\")}</span>\r\n                        </div>\r\n                        <button\r\n                            onClick={loadKPIData}\r\n                            className=\"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 text-sm\"\r\n                        >\r\n                            เธฃเธตเน€เธเธฃเธ\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </header>\r\n\r\n            <main className=\"max-w-7xl mx-auto px-6 py-8\">\r\n                {/* Time Range Selector */}\r\n                <div className=\"flex gap-2 mb-6\">\r\n                    {[\r\n                        { value: \"today\", label: \"เธงเธฑเธเธเธตเน\" },\r\n                        { value: \"week\", label: \"เธชเธฑเธเธ”เธฒเธซเนเธเธตเน\" },\r\n                        { value: \"month\", label: \"เน€เธ”เธทเธญเธเธเธตเน\" },\r\n                    ].map((option) => (\r\n                        <button\r\n                            key={option.value}\r\n                            onClick={() => setTimeRange(option.value as typeof timeRange)}\r\n                            className={`px-4 py-2 rounded-lg text-sm transition-all ${timeRange === option.value\r\n                                ? \"bg-slate-800 text-white\"\r\n                                : \"bg-white text-slate-600 hover:bg-slate-50\"\r\n                                }`}\r\n                        >\r\n                            {option.label}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Business Volume */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6\">\r\n                    <div className=\"bg-white rounded-xl p-5 shadow\">\r\n                        <p className=\"text-3xl font-bold text-slate-800\">{kpi.totalApplications}</p>\r\n                        <p className=\"text-sm text-slate-500\">เธเธณเธเธญเธ—เธฑเนเธเธซเธกเธ”</p>\r\n                    </div>\r\n                    <div className=\"bg-amber-50 border border-amber-200 rounded-xl p-5\">\r\n                        <p className=\"text-3xl font-bold text-amber-600\">{kpi.pendingReview}</p>\r\n                        <p className=\"text-sm text-amber-700\">เธฃเธญเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ</p>\r\n                    </div>\r\n                    <div className=\"bg-blue-50 border border-blue-200 rounded-xl p-5\">\r\n                        <p className=\"text-3xl font-bold text-blue-600\">{kpi.pendingAudit}</p>\r\n                        <p className=\"text-sm text-blue-700\">เธฃเธญเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ</p>\r\n                    </div>\r\n                    <div className=\"bg-green-50 border border-green-200 rounded-xl p-5\">\r\n                        <p className=\"text-3xl font-bold text-green-600\">{kpi.approved}</p>\r\n                        <p className=\"text-sm text-green-700\">เธญเธเธธเธกเธฑเธ•เธดเนเธฅเนเธง</p>\r\n                    </div>\r\n                    <div className=\"bg-red-50 border border-red-200 rounded-xl p-5\">\r\n                        <p className=\"text-3xl font-bold text-red-600\">{kpi.rejected}</p>\r\n                        <p className=\"text-sm text-red-700\">เนเธกเนเธเนเธฒเธ</p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Efficiency & Quality */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6\">\r\n                    {/* Operational Efficiency */}\r\n                    <div className=\"bg-white rounded-2xl shadow-lg p-6\">\r\n                        <h3 className=\"font-semibold mb-4\">เธเธฃเธฐเธชเธดเธ—เธเธดเธ เธฒเธเธเธฒเธฃเธ—เธณเธเธฒเธ</h3>\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div className=\"p-4 bg-slate-50 rounded-xl\">\r\n                                <p className=\"text-2xl font-bold\">{kpi.avgReviewTime} <span className=\"text-sm font-normal\">เธเธก.</span></p>\r\n                                <p className=\"text-sm text-slate-500\">เน€เธงเธฅเธฒเน€เธเธฅเธตเนเธขเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ</p>\r\n                            </div>\r\n                            <div className=\"p-4 bg-slate-50 rounded-xl\">\r\n                                <p className=\"text-2xl font-bold\">{kpi.avgAuditTime} <span className=\"text-sm font-normal\">เธงเธฑเธ</span></p>\r\n                                <p className=\"text-sm text-slate-500\">เน€เธงเธฅเธฒเน€เธเธฅเธตเนเธขเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ</p>\r\n                            </div>\r\n                            <div className=\"p-4 bg-slate-50 rounded-xl\">\r\n                                <p className=\"text-2xl font-bold text-emerald-600\">{kpi.conversionRate}%</p>\r\n                                <p className=\"text-sm text-slate-500\">Conversion Rate</p>\r\n                            </div>\r\n                            <div className={`p-4 rounded-xl ${kpi.slaBreach > 0 ? \"bg-red-50\" : \"bg-green-50\"}`}>\r\n                                <p className={`text-2xl font-bold ${kpi.slaBreach > 0 ? \"text-red-600\" : \"text-green-600\"}`}>\r\n                                    {kpi.slaBreach}\r\n                                </p>\r\n                                <p className=\"text-sm text-slate-500\">SLA Breach</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Quality Control */}\r\n                    <div className=\"bg-white rounded-2xl shadow-lg p-6\">\r\n                        <h3 className=\"font-semibold mb-4\">Quality Control</h3>\r\n                        <div className=\"space-y-4\">\r\n                            <div>\r\n                                <div className=\"flex justify-between mb-1\">\r\n                                    <span className=\"text-sm text-slate-600\">Rejection Rate</span>\r\n                                    <span className=\"text-sm font-semibold\">{kpi.rejectionRate}%</span>\r\n                                </div>\r\n                                <div className=\"w-full h-3 bg-slate-100 rounded-full overflow-hidden\">\r\n                                    <div\r\n                                        className={`h-full rounded-full ${kpi.rejectionRate > 50 ? \"bg-red-500\" : \"bg-amber-500\"}`}\r\n                                        style={{ width: `${kpi.rejectionRate}%` }}\r\n                                    />\r\n                                </div>\r\n                                <p className=\"text-xs text-slate-400 mt-1\">เธญเธฑเธ•เธฃเธฒเธเธฒเธฃเธชเนเธเธเธทเธเนเธเนเนเธ (เน€เธเนเธฒ: &lt;40%)</p>\r\n                            </div>\r\n                            <div className=\"p-4 bg-red-50 rounded-xl flex justify-between items-center\">\r\n                                <div>\r\n                                    <p className=\"text-sm text-slate-600\">Penalty Triggered</p>\r\n                                    <p className=\"text-xs text-slate-400\">เธเธเธ—เธตเนเนเธ”เธเธเธฃเธฑเธเน€เธเธดเธเธฃเธญเธเธ—เธตเน 3</p>\r\n                                </div>\r\n                                <p className=\"text-2xl font-bold text-red-600\">{kpi.penaltyTriggered}</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Revenue & Staff Performance */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6\">\r\n                    {/* Revenue */}\r\n                    <div className=\"bg-gradient-to-br from-emerald-600 to-emerald-700 rounded-2xl shadow-lg p-6 text-white\">\r\n                        <h3 className=\"font-semibold mb-4\">เธฃเธฒเธขเนเธ”เน</h3>\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div>\r\n                                <p className=\"text-sm opacity-80\">เธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธกเธเธงเธ” 1 (5,000)</p>\r\n                                <p className=\"text-2xl font-bold\">{formatCurrency(kpi.revenuePhase1)}</p>\r\n                            </div>\r\n                            <div>\r\n                                <p className=\"text-sm opacity-80\">เธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธกเธเธงเธ” 2 (25,000)</p>\r\n                                <p className=\"text-2xl font-bold\">{formatCurrency(kpi.revenuePhase2)}</p>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"mt-4 pt-4 border-t border-white/20\">\r\n                            <p className=\"text-sm opacity-80\">เธฃเธฒเธขเนเธ”เนเธฃเธงเธก</p>\r\n                            <p className=\"text-3xl font-bold\">{formatCurrency(kpi.revenuePhase1 + kpi.revenuePhase2)}</p>\r\n                        </div>\r\n                        <Link href=\"/admin/revenue\" className=\"block mt-4 text-center py-2 bg-white/20 rounded-lg hover:bg-white/30\">\r\n                            เธ”เธนเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ” โ’\r\n                        </Link>\r\n                    </div>\r\n\r\n                    {/* Staff Performance */}\r\n                    <div className=\"bg-white rounded-2xl shadow-lg p-6\">\r\n                        <h3 className=\"font-semibold mb-4\">เธเธฅเธเธฒเธเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเน</h3>\r\n                        <div className=\"space-y-3\">\r\n                            {staffPerformance.map((staff, i) => (\r\n                                <div key={i} className=\"flex items-center gap-4 p-3 bg-slate-50 rounded-xl\">\r\n                                    <div className=\"w-10 h-10 bg-slate-200 rounded-full flex items-center justify-center\"><svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#64748b\" strokeWidth=\"1.5\"><circle cx=\"12\" cy=\"7\" r=\"4\" /><path d=\"M5.5 21a7.5 7.5 0 0 1 13 0\" /></svg></div>\r\n                                    <div className=\"flex-1\">\r\n                                        <p className=\"font-medium\">{staff.name}</p>\r\n                                        <p className=\"text-xs text-slate-500\">{staff.role === \"REVIEWER_AUDITOR\" ? \"เธเธนเนเธ•เธฃเธงเธ\" : \"เธเธฑเธ”เธเธดเธง\"}</p>\r\n                                    </div>\r\n                                    <div className=\"text-right text-sm\">\r\n                                        <p>เธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ: <span className=\"font-semibold\">{staff.reviewed}</span></p>\r\n                                        <p>เธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ: <span className=\"font-semibold\">{staff.audited}</span></p>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Today Stats */}\r\n                <div className=\"bg-white rounded-2xl shadow-lg p-6\">\r\n                    <div className=\"flex justify-between items-center mb-4\">\r\n                        <h3 className=\"font-semibold\">เธชเธ–เธดเธ•เธดเธงเธฑเธเธเธตเน (Real-time)</h3>\r\n                        <span className=\"text-sm text-slate-500 flex items-center gap-2\">\r\n                            <span className=\"animate-pulse w-2 h-2 bg-green-500 rounded-full\"></span>\r\n                            เธญเธฑเธเน€เธ”เธ—เธ—เธธเธ 5 เธเธฒเธ—เธต\r\n                        </span>\r\n                    </div>\r\n                    <div className=\"grid grid-cols-3 gap-6\">\r\n                        <div className=\"text-center p-6 bg-blue-50 rounded-xl\">\r\n                            <p className=\"text-4xl font-bold text-blue-600\">{kpi.todayStats.reviewed}</p>\r\n                            <p className=\"text-slate-600 mt-1\">เธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃเธงเธฑเธเธเธตเน</p>\r\n                        </div>\r\n                        <div className=\"text-center p-6 bg-purple-50 rounded-xl\">\r\n                            <p className=\"text-4xl font-bold text-purple-600\">{kpi.todayStats.audited}</p>\r\n                            <p className=\"text-slate-600 mt-1\">เธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธเธงเธฑเธเธเธตเน</p>\r\n                        </div>\r\n                        <div className=\"text-center p-6 bg-green-50 rounded-xl\">\r\n                            <p className=\"text-4xl font-bold text-green-600\">{kpi.todayStats.approved}</p>\r\n                            <p className=\"text-slate-600 mt-1\">เธญเธเธธเธกเธฑเธ•เธดเธงเธฑเธเธเธตเน</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Export Buttons */}\r\n                <div className=\"mt-6 flex justify-end gap-4\">\r\n                    <button className=\"px-6 py-3 bg-white border border-slate-300 rounded-xl hover:bg-slate-50 flex items-center gap-2\">\r\n                        Export PDF\r\n                    </button>\r\n                    <button className=\"px-6 py-3 bg-white border border-slate-300 rounded-xl hover:bg-slate-50 flex items-center gap-2\">\r\n                        Export Excel\r\n                    </button>\r\n                </div>\r\n            </main>\r\n        </div >\r\n    );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\admin\\layout.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\admin\\layout.tsx:15:9\n  13 |\n  14 |     useEffect(() => {\n> 15 |         setMounted(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  16 |         const token = localStorage.getItem(\"staff_token\");\n  17 |         if (!token) {\n  18 |             // Redirect to staff login if not authenticated","line":15,"column":9,"nodeType":null,"endLine":15,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n\"use client\";\r\n\r\nimport Link from \"next/link\";\r\nimport { usePathname, useRouter } from \"next/navigation\";\r\nimport { useState, useEffect } from \"react\";\r\n\r\nexport default function AdminLayout({ children }: { children: React.ReactNode }) {\r\n    const pathname = usePathname();\r\n    const router = useRouter();\r\n    const [isSidebarOpen, setIsSidebarOpen] = useState(true);\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        const token = localStorage.getItem(\"staff_token\");\r\n        if (!token) {\r\n            // Redirect to staff login if not authenticated\r\n            router.push(\"/staff/login\");\r\n        }\r\n    }, [router]);\r\n\r\n    const menuItems = [\r\n        { label: \"เธ เธฒเธเธฃเธงเธก (Dashboard)\", href: \"/admin/dashboard\", icon: \"๐“\" },\r\n        { label: \"เธเธฑเธ”เธเธฒเธฃเธเธนเนเนเธเนเธเธฒเธ (Users)\", href: \"/admin/users\", icon: \"๐‘ฅ\" },\r\n        { label: \"เธเธฑเธ”เธเธฒเธฃเธเธทเธ (Plants)\", href: \"/admin/plants\", icon: \"๐ฟ\" },\r\n        { label: \"เธฃเธฒเธขเธเธฒเธ (Reports)\", href: \"/admin/reports\", icon: \"๐“‘\" },\r\n        { label: \"เธ•เธฑเนเธเธเนเธฒเธฃเธฐเธเธ (Config)\", href: \"/admin/config\", icon: \"โ๏ธ\" },\r\n    ];\r\n\r\n    const handleLogout = () => {\r\n        // Clear Staff Auth\r\n        localStorage.removeItem(\"staff_token\");\r\n        localStorage.removeItem(\"staff_user\");\r\n        document.cookie = 'staff_token=; path=/; max-age=0';\r\n\r\n        window.location.href = \"/staff/login\";\r\n    };\r\n\r\n    if (!mounted) return null; // Prevent flash of content\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-slate-50 flex\">\r\n            {/* Sidebar */}\r\n            <aside\r\n                className={`bg-slate-900 text-white transition-all duration-300 flex flex-col ${isSidebarOpen ? \"w-64\" : \"w-20\"\r\n                    }`}\r\n            >\r\n                <div className=\"p-6 flex items-center justify-between\">\r\n                    {isSidebarOpen && <h1 className=\"text-xl font-bold text-emerald-400\">GACP Admin</h1>}\r\n                    <button onClick={() => setIsSidebarOpen(!isSidebarOpen)} className=\"text-slate-400 hover:text-white\">\r\n                        {isSidebarOpen ? \"โ—€\" : \"โ–ถ\"}\r\n                    </button>\r\n                </div>\r\n\r\n                <nav className=\"flex-1 px-4 space-y-2 mt-4\">\r\n                    {menuItems.map((item) => {\r\n                        const isActive = pathname.startsWith(item.href);\r\n                        return (\r\n                            <Link\r\n                                key={item.href}\r\n                                href={item.href}\r\n                                className={`flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${isActive\r\n                                    ? \"bg-emerald-600 text-white shadow-lg shadow-emerald-900/20\"\r\n                                    : \"text-slate-400 hover:bg-slate-800 hover:text-white\"\r\n                                    }`}\r\n                            >\r\n                                <span className=\"text-xl\">{item.icon}</span>\r\n                                {isSidebarOpen && <span className=\"font-medium text-sm\">{item.label}</span>}\r\n                            </Link>\r\n                        );\r\n                    })}\r\n                </nav>\r\n\r\n                <div className=\"p-4 border-t border-slate-800\">\r\n                    <button\r\n                        onClick={handleLogout}\r\n                        className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-red-400 hover:bg-red-900/20 hover:text-red-300 transition-all ${!isSidebarOpen && \"justify-center\"\r\n                            }`}\r\n                    >\r\n                        <span className=\"text-xl\">๐ช</span>\r\n                        {isSidebarOpen && <span className=\"font-medium text-sm\">เธญเธญเธเธเธฒเธเธฃเธฐเธเธ</span>}\r\n                    </button>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* Main Content */}\r\n            <main className=\"flex-1 overflow-auto h-screen\">\r\n                <header className=\"bg-white border-b border-slate-200 px-8 py-4 flex justify-between items-center sticky top-0 z-10\">\r\n                    <h2 className=\"text-slate-500 text-sm\">\r\n                        Department of Thai Traditional and Alternative Medicine\r\n                    </h2>\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-700 font-bold text-xs ring-2 ring-white shadow-sm\">\r\n                            A\r\n                        </div>\r\n                        <span className=\"text-sm font-semibold text-slate-700\">Admin User</span>\r\n                    </div>\r\n                </header>\r\n                <div className=\"p-8\">\r\n                    {children}\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\admin\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\admin\\plants\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":51,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":51,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { AdminService, Plant } from \"@/lib/services/admin-service\";\r\n\r\nexport default function PlantsPage() {\r\n    const [plants, setPlants] = useState<Plant[]>([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [showModal, setShowModal] = useState(false);\r\n\r\n    // Form State\r\n    const [formData, setFormData] = useState({\r\n        name: \"\",\r\n        productionInputs: \"{}\"\r\n    });\r\n\r\n    const fetchPlants = async () => {\r\n        setIsLoading(true);\r\n        const result = await AdminService.getPlants();\r\n        if (result.success && result.data) {\r\n            setPlants(result.data);\r\n        }\r\n        setIsLoading(false);\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchPlants();\r\n    }, []);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setIsSubmitting(true);\r\n\r\n        try {\r\n            const inputs = JSON.parse(formData.productionInputs);\r\n            const result = await AdminService.createPlant({\r\n                name: formData.name,\r\n                productionInputs: inputs\r\n            });\r\n\r\n            if (result.success) {\r\n                setShowModal(false);\r\n                setFormData({ name: \"\", productionInputs: \"{}\" });\r\n                fetchPlants();\r\n                alert(\"เน€เธเธดเนเธกเธเธทเธเธชเธณเน€เธฃเนเธ\");\r\n            } else {\r\n                alert(\"เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”: \" + result.error);\r\n            }\r\n        } catch (err) {\r\n            alert(\"เธฃเธนเธเนเธเธ JSON เนเธกเนเธ–เธนเธเธ•เนเธญเธ\");\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-6\">\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n                <h1 className=\"text-2xl font-bold text-slate-800\">เธเธฑเธ”เธเธฒเธฃเธเธทเธเธชเธกเธธเธเนเธเธฃ (Plants)</h1>\r\n                <button\r\n                    onClick={() => setShowModal(true)}\r\n                    className=\"bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition-colors\"\r\n                >\r\n                    + เน€เธเธดเนเธกเธเธทเธเนเธซเธกเน\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden\">\r\n                <table className=\"w-full text-left\">\r\n                    <thead className=\"bg-slate-50 border-b border-slate-200\">\r\n                        <tr>\r\n                            <th className=\"p-4 font-semibold text-slate-600\">ID</th>\r\n                            <th className=\"p-4 font-semibold text-slate-600\">เธเธทเนเธญเธเธทเธ</th>\r\n                            <th className=\"p-4 font-semibold text-slate-600\">เธชเธ–เธฒเธเธฐ</th>\r\n                            <th className=\"p-4 font-semibold text-slate-600\">เธเธฑเธ”เธเธฒเธฃ</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-slate-100\">\r\n                        {isLoading ? (\r\n                            <tr><td colSpan={4} className=\"p-8 text-center text-slate-500\">เธเธณเธฅเธฑเธเนเธซเธฅเธ”...</td></tr>\r\n                        ) : plants.length === 0 ? (\r\n                            <tr><td colSpan={4} className=\"p-8 text-center text-slate-500\">เนเธกเนเธเธเธเนเธญเธกเธนเธฅเธเธทเธ</td></tr>\r\n                        ) : (\r\n                            plants.map((plant) => (\r\n                                <tr key={plant.id} className=\"hover:bg-slate-50\">\r\n                                    <td className=\"p-4 font-mono text-xs text-slate-500\">{plant.id.substring(0, 8)}...</td>\r\n                                    <td className=\"p-4 font-medium text-slate-800\">{plant.name}</td>\r\n                                    <td className=\"p-4\">\r\n                                        <span className={`px-2 py-1 rounded-full text-xs font-semibold ${plant.isActive ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'\r\n                                            }`}>\r\n                                            {plant.isActive ? 'เนเธเนเธเธฒเธ' : 'เธฃเธฐเธเธฑเธ'}\r\n                                        </span>\r\n                                    </td>\r\n                                    <td className=\"p-4\">\r\n                                        <button className=\"text-emerald-600 hover:underline text-sm font-medium\">เนเธเนเนเธ</button>\r\n                                    </td>\r\n                                </tr>\r\n                            ))\r\n                        )}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n\r\n            {/* Modal */}\r\n            {showModal && (\r\n                <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50\">\r\n                    <div className=\"bg-white rounded-xl max-w-lg w-full p-6\">\r\n                        <h2 className=\"text-xl font-bold mb-4\">เน€เธเธดเนเธกเธเธทเธเนเธซเธกเน</h2>\r\n                        <form onSubmit={handleSubmit}>\r\n                            <div className=\"mb-4\">\r\n                                <label className=\"block text-sm font-medium mb-1\">เธเธทเนเธญเธเธทเธ</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    className=\"w-full border rounded-lg p-2\"\r\n                                    value={formData.name}\r\n                                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                                    required\r\n                                />\r\n                            </div>\r\n                            <div className=\"mb-6\">\r\n                                <label className=\"block text-sm font-medium mb-1\">Production Inputs (JSON)</label>\r\n                                <textarea\r\n                                    className=\"w-full border rounded-lg p-2 font-mono text-sm h-32\"\r\n                                    value={formData.productionInputs}\r\n                                    onChange={(e) => setFormData({ ...formData, productionInputs: e.target.value })}\r\n                                    placeholder='{\"waterSource\": [\"River\", \"Well\"]}'\r\n                                />\r\n                                <p className=\"text-xs text-slate-500 mt-1\">เธ•เนเธญเธเน€เธเนเธเธฃเธนเธเนเธเธ JSON เธ—เธตเนเธ–เธนเธเธ•เนเธญเธ</p>\r\n                            </div>\r\n                            <div className=\"flex justify-end gap-2\">\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={() => setShowModal(false)}\r\n                                    className=\"px-4 py-2 border rounded-lg hover:bg-slate-50\"\r\n                                >\r\n                                    เธขเธเน€เธฅเธดเธ\r\n                                </button>\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    disabled={isSubmitting}\r\n                                    className=\"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50\"\r\n                                >\r\n                                    {isSubmitting ? 'เธเธณเธฅเธฑเธเธเธฑเธเธ—เธถเธ...' : 'เธเธฑเธเธ—เธถเธ'}\r\n                                </button>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\admin\\reports\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\admin\\users\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Link' is defined but never used.","line":5,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'api' is defined but never used.","line":6,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { apiClient as api } from \"@/lib/api\";\r\n\r\ninterface StaffUser {\r\n    id: string;\r\n    email: string;\r\n    firstName: string;\r\n    lastName: string;\r\n    role: string;\r\n    status: string;\r\n    createdAt: string;\r\n}\r\n\r\nconst STAFF_ROLES = [\r\n    { value: \"REVIEWER_AUDITOR\", label: \"เธเธนเนเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ/เธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ\", icon: \"\", color: \"blue\" },\r\n    { value: \"SCHEDULER\", label: \"เน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธเธฑเธ”เธเธดเธง\", icon: \"\", color: \"purple\" },\r\n    { value: \"ADMIN\", label: \"เธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธ\", icon: \"\", color: \"amber\" },\r\n];\r\n\r\nexport default function AdminUsersPage() {\r\n    const router = useRouter();\r\n    const [currentUser, setCurrentUser] = useState<StaffUser | null>(null);\r\n    const [users, setUsers] = useState<StaffUser[]>([]);\r\n    const [showCreateModal, setShowCreateModal] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState(\"\");\r\n\r\n    // New user form\r\n    const [newEmail, setNewEmail] = useState(\"\");\r\n    const [newFirstName, setNewFirstName] = useState(\"\");\r\n    const [newLastName, setNewLastName] = useState(\"\");\r\n    const [newRole, setNewRole] = useState(\"REVIEWER_AUDITOR\");\r\n    const [newPassword, setNewPassword] = useState(\"\");\r\n\r\n    useEffect(() => {\r\n        const token = localStorage.getItem(\"staff_token\");\r\n        const userData = localStorage.getItem(\"staff_user\");\r\n\r\n        if (!token || !userData) {\r\n            router.push(\"/staff/login\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const parsedUser = JSON.parse(userData);\r\n            const role = parsedUser.role?.toUpperCase() || '';\r\n            if (![\"ADMIN\", \"SUPER_ADMIN\"].includes(role)) {\r\n                router.push(\"/staff/dashboard\");\r\n                return;\r\n            }\r\n            setCurrentUser(parsedUser);\r\n        } catch {\r\n            router.push(\"/staff/login\");\r\n            return;\r\n        }\r\n\r\n        // Fetch real staff list from API\r\n        const fetchStaff = async () => {\r\n            try {\r\n                const res = await fetch('/api/staff', {\r\n                    headers: { 'Authorization': `Bearer ${token}` }\r\n                });\r\n                if (res.ok) {\r\n                    const result = await res.json();\r\n                    if (result.success && result.data) {\r\n                        setUsers(result.data.map((s: { id: string; email: string; firstName: string; lastName: string; role: string; isActive: boolean; createdAt: string }) => ({\r\n                            id: s.id,\r\n                            email: s.email || '',\r\n                            firstName: s.firstName || '',\r\n                            lastName: s.lastName || '',\r\n                            role: s.role?.toUpperCase() || 'REVIEWER_AUDITOR',\r\n                            status: s.isActive ? 'ACTIVE' : 'INACTIVE',\r\n                            createdAt: s.createdAt?.split('T')[0] || ''\r\n                        })));\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                console.error('Error fetching staff:', error);\r\n            }\r\n        };\r\n        fetchStaff();\r\n    }, [router]);\r\n\r\n    const handleCreateUser = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError(\"\");\r\n        setIsLoading(true);\r\n\r\n        try {\r\n            const token = localStorage.getItem(\"staff_token\");\r\n            const res = await fetch('/api/staff', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`,\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify({\r\n                    username: newEmail.split('@')[0], // Use email prefix as username\r\n                    email: newEmail,\r\n                    firstName: newFirstName,\r\n                    lastName: newLastName,\r\n                    role: newRole.toLowerCase(),\r\n                    password: newPassword\r\n                })\r\n            });\r\n\r\n            const result = await res.json();\r\n\r\n            if (!result.success) {\r\n                setError(result.error || 'เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เธชเธฃเนเธฒเธเธเธฑเธเธเธตเนเธ”เน');\r\n                setIsLoading(false);\r\n                return;\r\n            }\r\n\r\n            // Add created user to list\r\n            if (result.data) {\r\n                setUsers([\r\n                    {\r\n                        id: result.data.id,\r\n                        email: result.data.email,\r\n                        firstName: result.data.firstName,\r\n                        lastName: result.data.lastName,\r\n                        role: result.data.role?.toUpperCase() || newRole,\r\n                        status: \"ACTIVE\",\r\n                        createdAt: new Date().toISOString().split(\"T\")[0],\r\n                    },\r\n                    ...users,\r\n                ]);\r\n            }\r\n\r\n            // Reset form\r\n            setNewEmail(\"\");\r\n            setNewFirstName(\"\");\r\n            setNewLastName(\"\");\r\n            setNewRole(\"REVIEWER_AUDITOR\");\r\n            setNewPassword(\"\");\r\n            setShowCreateModal(false);\r\n            alert(\"เธชเธฃเนเธฒเธเธเธฑเธเธเธตเธชเธณเน€เธฃเนเธ!\");\r\n        } catch (error) {\r\n            console.error('Create user error:', error);\r\n            setError('เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเธชเธฃเนเธฒเธเธเธฑเธเธเธต');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const getRoleBadge = (role: string) => {\r\n        const roleInfo = STAFF_ROLES.find(r => r.value === role);\r\n        if (!roleInfo) return <span className=\"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs\">{role}</span>;\r\n\r\n        const colors: Record<string, string> = {\r\n            blue: \"bg-blue-100 text-blue-700\",\r\n            purple: \"bg-purple-100 text-purple-700\",\r\n            amber: \"bg-amber-100 text-amber-700\",\r\n        };\r\n        return (\r\n            <span className={`px-2 py-1 ${colors[roleInfo.color]} rounded-full text-xs`}>\r\n                {roleInfo.icon} {roleInfo.label}\r\n            </span>\r\n        );\r\n    };\r\n\r\n    if (!currentUser) {\r\n        return (\r\n            <div className=\"min-h-screen flex items-center justify-center bg-slate-900\">\r\n                <div className=\"w-10 h-10 border-3 border-slate-200 border-t-emerald-600 rounded-full animate-spin\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"font-sans\">\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n                <div>\r\n                    <h1 className=\"text-2xl font-bold text-slate-800\">เธเธฑเธ”เธเธฒเธฃเธเธฑเธเธเธตเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเน (Staff Management)</h1>\r\n                    <p className=\"text-sm text-slate-500\">เธเธฑเธ”เธเธฒเธฃเธเธนเนเนเธเนเธเธฒเธเนเธฅเธฐเธชเธดเธ—เธเธดเนเธเธฒเธฃเน€เธเนเธฒเธ–เธถเธ</p>\r\n                </div>\r\n                <button\r\n                    onClick={() => setShowCreateModal(true)}\r\n                    className=\"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors text-sm flex items-center gap-2\"\r\n                >\r\n                    + เธชเธฃเนเธฒเธเธเธฑเธเธเธตเนเธซเธกเน\r\n                </button>\r\n            </div>\r\n\r\n            {/* Stats */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8\">\r\n                <div className=\"bg-white rounded-xl p-4 shadow-sm border border-slate-200\">\r\n                    <p className=\"text-2xl font-bold text-slate-800\">{users.length}</p>\r\n                    <p className=\"text-sm text-slate-500\">เน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธ—เธฑเนเธเธซเธกเธ”</p>\r\n                </div>\r\n                <div className=\"bg-white rounded-xl p-4 shadow-sm border border-slate-200\">\r\n                    <p className=\"text-2xl font-bold text-blue-600\">{users.filter(u => u.role === \"REVIEWER_AUDITOR\").length}</p>\r\n                    <p className=\"text-sm text-slate-500\">เธเธนเนเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ/เธเธฃเธฐเน€เธกเธดเธ</p>\r\n                </div>\r\n                <div className=\"bg-white rounded-xl p-4 shadow-sm border border-slate-200\">\r\n                    <p className=\"text-2xl font-bold text-purple-600\">{users.filter(u => u.role === \"SCHEDULER\").length}</p>\r\n                    <p className=\"text-sm text-slate-500\">เน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธเธฑเธ”เธเธดเธง</p>\r\n                </div>\r\n                <div className=\"bg-white rounded-xl p-4 shadow-sm border border-slate-200\">\r\n                    <p className=\"text-2xl font-bold text-amber-600\">{users.filter(u => u.role === \"ADMIN\").length}</p>\r\n                    <p className=\"text-sm text-slate-500\">เธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธ</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Users Table */}\r\n            <div className=\"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden\">\r\n                <table className=\"w-full\">\r\n                    <thead className=\"bg-slate-50 border-b border-slate-200\">\r\n                        <tr>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase\">เธเธทเนเธญ</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase\">เธญเธตเน€เธกเธฅ</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase\">เธ•เธณเนเธซเธเนเธ</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase\">เธชเธ–เธฒเธเธฐ</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase\">เธชเธฃเนเธฒเธเน€เธกเธทเนเธญ</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase\">เธเธฑเธ”เธเธฒเธฃ</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-slate-100\">\r\n                        {users.map((user) => (\r\n                            <tr key={user.id} className=\"hover:bg-slate-50 transition-colors\">\r\n                                <td className=\"px-6 py-4\">\r\n                                    <div className=\"flex items-center gap-3\">\r\n                                        <div className=\"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-slate-500\">\r\n                                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><circle cx=\"12\" cy=\"7\" r=\"4\" /><path d=\"M5.5 21a7.5 7.5 0 0 1 13 0\" /></svg>\r\n                                        </div>\r\n                                        <p className=\"font-medium text-slate-700\">{user.firstName} {user.lastName}</p>\r\n                                    </div>\r\n                                </td>\r\n                                <td className=\"px-6 py-4 text-sm text-slate-600\">{user.email}</td>\r\n                                <td className=\"px-6 py-4\">{getRoleBadge(user.role)}</td>\r\n                                <td className=\"px-6 py-4\">\r\n                                    <span className={`px-2 py-1 rounded-full text-xs font-medium ${user.status === 'ACTIVE' ? 'bg-emerald-50 text-emerald-700 border border-emerald-100' : 'bg-slate-100 text-slate-600'}`}>\r\n                                        {user.status}\r\n                                    </span>\r\n                                </td>\r\n                                <td className=\"px-6 py-4 text-sm text-slate-500\">{user.createdAt}</td>\r\n                                <td className=\"px-6 py-4\">\r\n                                    <button className=\"text-slate-400 hover:text-emerald-600 transition-colors\">\r\n                                        <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\" /><path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\" /></svg>\r\n                                    </button>\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n\r\n            {/* Create User Modal */}\r\n            {showCreateModal && (\r\n                <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50\">\r\n                    <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-md\">\r\n                        <div className=\"px-6 py-4 border-b flex justify-between items-center\">\r\n                            <h3 className=\"text-lg font-semibold\">เธชเธฃเนเธฒเธเธเธฑเธเธเธตเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเนเธซเธกเน</h3>\r\n                            <button onClick={() => setShowCreateModal(false)} className=\"text-slate-400 hover:text-slate-600\">โ•</button>\r\n                        </div>\r\n                        <form onSubmit={handleCreateUser} className=\"p-6 space-y-4\">\r\n                            {error && (\r\n                                <div className=\"p-3 bg-red-50 border border-red-200 rounded-lg text-red-600 text-sm\">{error}</div>\r\n                            )}\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm text-slate-600 mb-1\">เธเธทเนเธญ</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={newFirstName}\r\n                                        onChange={(e) => setNewFirstName(e.target.value)}\r\n                                        className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-sm text-slate-600 mb-1\">เธเธฒเธกเธชเธเธธเธฅ</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={newLastName}\r\n                                        onChange={(e) => setNewLastName(e.target.value)}\r\n                                        className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm text-slate-600 mb-1\">เธญเธตเน€เธกเธฅ</label>\r\n                                <input\r\n                                    type=\"email\"\r\n                                    value={newEmail}\r\n                                    onChange={(e) => setNewEmail(e.target.value)}\r\n                                    placeholder=\"officer@dtam.go.th\"\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm text-slate-600 mb-1\">เธ•เธณเนเธซเธเนเธ</label>\r\n                                <select\r\n                                    value={newRole}\r\n                                    onChange={(e) => setNewRole(e.target.value)}\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500\"\r\n                                >\r\n                                    {STAFF_ROLES.map(role => (\r\n                                        <option key={role.value} value={role.value}>\r\n                                            {role.icon} {role.label}\r\n                                        </option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm text-slate-600 mb-1\">เธฃเธซเธฑเธชเธเนเธฒเธเน€เธฃเธดเนเธกเธ•เนเธ</label>\r\n                                <input\r\n                                    type=\"password\"\r\n                                    value={newPassword}\r\n                                    onChange={(e) => setNewPassword(e.target.value)}\r\n                                    placeholder=\"เธญเธขเนเธฒเธเธเนเธญเธข 8 เธ•เธฑเธงเธญเธฑเธเธฉเธฃ\"\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-500\"\r\n                                    required\r\n                                    minLength={8}\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"flex gap-3 pt-4\">\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={() => setShowCreateModal(false)}\r\n                                    className=\"flex-1 py-2 border border-slate-300 rounded-lg hover:bg-slate-50\"\r\n                                >\r\n                                    เธขเธเน€เธฅเธดเธ\r\n                                </button>\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    disabled={isLoading}\r\n                                    className=\"flex-1 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50\"\r\n                                >\r\n                                    {isLoading ? \"เธเธณเธฅเธฑเธเธชเธฃเนเธฒเธ...\" : \"เธชเธฃเนเธฒเธเธเธฑเธเธเธต\"}\r\n                                </button>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\api\\[...path]\\route.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":50,"column":13,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":50,"endColumn":80,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[1837,1904],"text":"// @ts-expect-error - Required for Node.js fetch with ReadableStream body"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2408,2411],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2408,2411],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { cookies } from 'next/headers';\r\n\r\n// Production Server - Always use this\r\n// Production Server - Always use this (Dev Override)\r\nconst BACKEND_URL = process.env.BACKEND_URL || 'http://localhost:5000';\r\n\r\n/**\r\n * Generic API Proxy for all /api/* endpoints (excluding /api/v2, /api/auth-*, /api/health, /api/proxy)\r\n * Forwards requests to backend with auth_token from httpOnly cookie\r\n */\r\nasync function proxyRequest(request: NextRequest, path: string, method: string) {\r\n    try {\r\n        const cookieStore = await cookies();\r\n        const authToken = cookieStore.get('auth_token')?.value;\r\n\r\n        // Start with empty headers\r\n        const headers: Record<string, string> = {};\r\n\r\n        // 1. Copy Content-Type (Essential for multipart/form-data boundaries)\r\n        const contentType = request.headers.get('content-type');\r\n        if (contentType) {\r\n            headers['Content-Type'] = contentType;\r\n        }\r\n\r\n        // 2. Add Authorization header\r\n        if (authToken) {\r\n            headers['Authorization'] = `Bearer ${authToken}`;\r\n        }\r\n\r\n        // 3. Forward test headers if needed\r\n        const testUserId = request.headers.get('X-User-ID');\r\n        if (testUserId && !authToken) {\r\n            headers['X-User-ID'] = testUserId;\r\n        }\r\n\r\n        // Build the full backend URL\r\n        const backendUrl = `${BACKEND_URL}/api/${path}`;\r\n\r\n        console.log(`[API Proxy] ${method} ${backendUrl}`);\r\n\r\n        // 4. Forward Body as Stream (don't parse JSON)\r\n        // For GET/HEAD, body must be undefined/null\r\n        const body = (method === 'GET' || method === 'HEAD') ? undefined : request.body;\r\n\r\n        const response = await fetch(backendUrl, {\r\n            method,\r\n            headers,\r\n            body,\r\n            // @ts-ignore - Required for Node.js fetch with ReadableStream body\r\n            duplex: 'half'\r\n        });\r\n\r\n        // 5. Return Response\r\n        // Use blob() to handle both JSON and Binary responses correctly\r\n        const responseBody = await response.blob();\r\n\r\n        return new NextResponse(responseBody, {\r\n            status: response.status,\r\n            statusText: response.statusText,\r\n            headers: {\r\n                'Content-Type': response.headers.get('Content-Type') || 'application/json'\r\n            }\r\n        });\r\n\r\n    } catch (error: any) {\r\n        console.error('[API Proxy] Error:', error);\r\n        return NextResponse.json(\r\n            { success: false, error: 'Proxy Error: ' + (error.message || 'Unknown') },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n\r\nexport async function GET(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ path: string[] }> }\r\n) {\r\n    const { path } = await params;\r\n    return proxyRequest(request, path.join('/'), 'GET');\r\n}\r\n\r\nexport async function POST(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ path: string[] }> }\r\n) {\r\n    const { path } = await params;\r\n    return proxyRequest(request, path.join('/'), 'POST');\r\n}\r\n\r\nexport async function PUT(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ path: string[] }> }\r\n) {\r\n    const { path } = await params;\r\n    return proxyRequest(request, path.join('/'), 'PUT');\r\n}\r\n\r\nexport async function DELETE(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ path: string[] }> }\r\n) {\r\n    const { path } = await params;\r\n    return proxyRequest(request, path.join('/'), 'DELETE');\r\n}\r\n\r\nexport async function PATCH(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ path: string[] }> }\r\n) {\r\n    const { path } = await params;\r\n    return proxyRequest(request, path.join('/'), 'PATCH');\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\api\\auth-dtam\\[...path]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\api\\auth-farmer\\[...path]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\api\\health\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\api\\proxy\\[...path]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\[id]\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadApplication' and 'router'. Either include them or remove the dependency array.","line":34,"column":213,"nodeType":"ArrayExpression","endLine":34,"endColumn":217,"suggestions":[{"desc":"Update the dependencies array to be: [id, loadApplication, router]","fix":{"range":[2255,2259],"text":"[id, loadApplication, router]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter, useParams } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { apiClient as api } from \"@/lib/api\";\r\n\r\nconst STATUS_CONFIG: Record<string, { label: string; color: string; step: number }> = {\r\n    DRAFT: { label: \"เธฃเนเธฒเธ\", color: \"#8A8A8A\", step: 1 },\r\n    PAYMENT_1_PENDING: { label: \"เธฃเธญเธเธณเธฃเธฐเน€เธเธดเธเธเธงเธ” 1\", color: \"#F59E0B\", step: 2 },\r\n    SUBMITTED: { label: \"เธฃเธญเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ\", color: \"#3B82F6\", step: 3 },\r\n    REVISION_REQ: { label: \"เธ•เนเธญเธเนเธเนเนเธเน€เธญเธเธชเธฒเธฃ\", color: \"#EF4444\", step: 3 },\r\n    PAYMENT_2_PENDING: { label: \"เธฃเธญเธเธณเธฃเธฐเน€เธเธดเธเธเธงเธ” 2\", color: \"#F59E0B\", step: 4 },\r\n    AUDIT_PENDING: { label: \"เธฃเธญเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธเธชเธ–เธฒเธเธ—เธตเน\", color: \"#8B5CF6\", step: 5 },\r\n    AUDIT_SCHEDULED: { label: \"เธเธฑเธ”เธซเธกเธฒเธขเธ•เธฃเธงเธเนเธฅเนเธง\", color: \"#06B6D4\", step: 5 },\r\n    CERTIFIED: { label: \"เนเธ”เนเธฃเธฑเธเธเธฒเธฃเธฃเธฑเธเธฃเธญเธ\", color: \"#10B981\", step: 6 },\r\n};\r\n\r\nconst STEPS = [{ id: 1, label: \"เธขเธทเนเธเธเธณเธเธญ\" }, { id: 2, label: \"เธเธณเธฃเธฐเธเธงเธ” 1\" }, { id: 3, label: \"เธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ\" }, { id: 4, label: \"เธเธณเธฃเธฐเธเธงเธ” 2\" }, { id: 5, label: \"เธ•เธฃเธงเธเธชเธ–เธฒเธเธ—เธตเน\" }, { id: 6, label: \"เธฃเธฑเธเธฃเธญเธ\" }];\r\n\r\ninterface ApplicationDetail { _id: string; applicationNumber?: string; status: string; createdAt: string; updatedAt: string; applicantType?: string; applicantInfo?: { name?: string; firstName?: string; lastName?: string; phone?: string; email?: string }; siteInfo?: { siteName?: string; address?: string; province?: string; gpsLat?: string; gpsLng?: string; areaSize?: string }; formData?: { documents?: { id: string; uploaded?: boolean; name?: string }[] }; staffNotes?: string; }\r\n\r\nexport default function ApplicationDetailPage() {\r\n    const router = useRouter();\r\n    const params = useParams();\r\n    const id = params?.id as string;\r\n\r\n    const [application, setApplication] = useState<ApplicationDetail | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [mounted, setMounted] = useState(false);\r\n    const [isDark, setIsDark] = useState(false);\r\n\r\n    useEffect(() => { setMounted(true); setIsDark(localStorage.getItem(\"theme\") === \"dark\"); const userData = localStorage.getItem(\"user\"); if (!userData) { router.push(\"/login\"); return; } loadApplication(); }, [id]);\r\n\r\n    const loadApplication = async () => {\r\n        if (!id) return;\r\n        setLoading(true);\r\n        setError(null);\r\n        try {\r\n            const result = await api.get<{ data: ApplicationDetail }>(`/applications/${id}`);\r\n            if (result.success && result.data?.data) setApplication(result.data.data);\r\n            else setError(\"เนเธกเนเธเธเธเธณเธเธญเธเธตเนเนเธเธฃเธฐเธเธ\");\r\n        } catch { setError(\"เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเนเธซเธฅเธ”เธเนเธญเธกเธนเธฅ\"); }\r\n        finally { setLoading(false); }\r\n    };\r\n\r\n    const toggleTheme = () => { setIsDark(!isDark); localStorage.setItem(\"theme\", !isDark ? \"dark\" : \"light\"); };\r\n    const handleLogout = () => { localStorage.removeItem(\"user\"); window.location.href = \"/api/auth/logout\"; };\r\n    const getStatusInfo = (status: string) => STATUS_CONFIG[status] || { label: status, color: \"#8A8A8A\", step: 0 };\r\n    const formatDate = (date: string) => new Date(date).toLocaleDateString('th-TH', { year: 'numeric', month: 'long', day: 'numeric' });\r\n\r\n    if (!mounted) return null;\r\n\r\n    const navItems = [{ href: \"/farmer/dashboard\", label: \"เธซเธเนเธฒเธซเธฅเธฑเธ\" }, { href: \"/farmer/applications\", label: \"เธเธณเธเธญ\", active: true }, { href: \"/farmer/tracking\", label: \"เธ•เธดเธ”เธ•เธฒเธก\" }, { href: \"/farmer/payments\", label: \"เธเธฒเธฃเน€เธเธดเธ\" }, { href: \"/farmer/profile\", label: \"เนเธเธฃเนเธเธฅเน\" }];\r\n    const statusInfo = application ? getStatusInfo(application.status) : null;\r\n    const currentStep = statusInfo?.step || 0;\r\n\r\n    return (\r\n        <div className={`min-h-screen font-sans ${isDark ? 'bg-slate-900 text-surface-100' : 'bg-surface-100 text-slate-900'}`}>\r\n            {/* Sidebar */}\r\n            <aside className={`hidden lg:flex fixed left-0 top-0 bottom-0 w-[72px] flex-col items-center py-5 border-r z-50 ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                <div className=\"w-11 h-11 rounded-2xl bg-gradient-to-br from-primary-600 to-primary-400 flex items-center justify-center text-xl font-semibold text-white mb-8\">G</div>\r\n                <nav className=\"flex-1 flex flex-col gap-1 w-full px-2\">\r\n                    {navItems.map(item => (\r\n                        <Link key={item.href} href={item.href} className={`flex flex-col items-center gap-1 py-2.5 rounded-xl relative ${item.active ? (isDark ? 'bg-primary-500/15 border border-primary-500/30' : 'bg-primary-50 border border-primary-500/30') : 'hover:bg-surface-100'}`}>\r\n                            {item.active && <div className=\"absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-7 bg-primary-600 rounded-r\" />}\r\n                            <span className={`text-[10px] font-medium ${item.active ? 'text-primary-600' : 'text-slate-500'}`}>{item.label}</span>\r\n                        </Link>\r\n                    ))}\r\n                </nav>\r\n                <div className=\"flex flex-col gap-3\">\r\n                    <button onClick={toggleTheme} className={`w-10 h-10 rounded-xl flex items-center justify-center ${isDark ? 'bg-primary-500/15 border border-primary-500/30' : 'bg-primary-50 border border-primary-500/30'}`}>\r\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">{isDark ? <><circle cx=\"12\" cy=\"12\" r=\"5\" /><line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\" /><line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\" /><line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\" /><line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\" /><line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\" /><line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\" /><line x1=\"4.22\" y1=\"19.78\" x2=\"5.64\" y2=\"18.36\" /><line x1=\"18.36\" y1=\"5.64\" x2=\"19.78\" y2=\"4.22\" /></> : <path d=\"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z\" />}</svg>\r\n                    </button>\r\n                    <button onClick={handleLogout} className=\"w-10 h-10 rounded-xl flex items-center justify-center text-slate-500\">\r\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\" /><polyline points=\"16 17 21 12 16 7\" /><line x1=\"21\" y1=\"12\" x2=\"9\" y2=\"12\" /></svg>\r\n                    </button>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* Mobile Nav */}\r\n            <nav className={`lg:hidden fixed bottom-0 inset-x-0 h-[72px] flex justify-around items-center z-50 border-t ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                {navItems.map(item => <Link key={item.href} href={item.href} className=\"flex flex-col items-center gap-1 py-2 px-3\"><span className={`text-[10px] font-medium ${item.active ? 'text-primary-600' : 'text-slate-500'}`}>{item.label}</span></Link>)}\r\n            </nav>\r\n\r\n            {/* Main Content */}\r\n            <main className=\"lg:ml-[72px] p-6 lg:p-10 pb-24 lg:pb-10 max-w-6xl\">\r\n                <Link href=\"/farmer/applications\" className={`inline-flex items-center gap-2 text-sm mb-6 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>โ เธเธฅเธฑเธเนเธเธฃเธฒเธขเธเธฒเธฃเธเธณเธเธญ</Link>\r\n\r\n                {loading ? (\r\n                    <div className={`rounded-2xl p-16 text-center border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                        <div className={`w-10 h-10 border-[3px] rounded-full animate-spin mx-auto ${isDark ? 'border-slate-700 border-t-primary-500' : 'border-surface-200 border-t-primary-600'}`} />\r\n                        <p className={`mt-4 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>เธเธณเธฅเธฑเธเนเธซเธฅเธ”เธเนเธญเธกเธนเธฅเธเธณเธเธญ...</p>\r\n                    </div>\r\n                ) : error ? (\r\n                    <div className=\"rounded-2xl p-6 text-center bg-red-50 border border-red-200\">\r\n                        <p className=\"text-red-500 font-medium\">{error}</p>\r\n                        <Link href=\"/applications\" className=\"inline-block mt-4 px-5 py-2.5 rounded-lg bg-red-500 text-white\">เธเธฅเธฑเธเนเธเธฃเธฒเธขเธเธฒเธฃเธเธณเธเธญ</Link>\r\n                    </div>\r\n                ) : application ? (\r\n                    <>\r\n                        {/* Header */}\r\n                        <div className=\"flex justify-between items-start mb-7 flex-wrap gap-4\">\r\n                            <div>\r\n                                <h1 className=\"text-2xl lg:text-3xl font-medium\">เธเธณเธเธญ {application.applicationNumber || `#${application._id.slice(-6).toUpperCase()}`}</h1>\r\n                                <p className={`text-sm mt-1 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>เธขเธทเนเธเน€เธกเธทเนเธญ {formatDate(application.createdAt)}</p>\r\n                            </div>\r\n                            <div className=\"flex gap-3 items-center\">\r\n                                <span className=\"px-5 py-2 rounded-full text-sm font-semibold\" style={{ backgroundColor: `${statusInfo?.color}20`, color: statusInfo?.color, border: `1px solid ${statusInfo?.color}40` }}>{statusInfo?.label}</span>\r\n                                {application.status === \"REVISION_REQ\" && <Link href={`/farmer/applications/${application._id}/edit`} className=\"flex items-center gap-1.5 px-5 py-2.5 rounded-xl bg-secondary-500 text-white font-medium\">เนเธเนเนเธเธเธณเธเธญ</Link>}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Progress Steps */}\r\n                        <div className={`rounded-2xl p-6 mb-6 border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                            <h3 className={`text-base font-semibold mb-5 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธเธงเธฒเธกเธเธทเธเธซเธเนเธฒ</h3>\r\n                            <div className=\"relative mb-5\">\r\n                                <div className={`h-1 rounded ${isDark ? 'bg-slate-700' : 'bg-surface-200'}`} />\r\n                                <div className=\"absolute top-0 left-0 h-1 rounded bg-gradient-to-r from-primary-600 to-primary-400 transition-all\" style={{ width: `${((currentStep - 1) / (STEPS.length - 1)) * 100}%` }} />\r\n                            </div>\r\n                            <div className=\"grid grid-cols-6 gap-2\">\r\n                                {STEPS.map(step => {\r\n                                    const isDone = step.id < currentStep;\r\n                                    const isCurrent = step.id === currentStep;\r\n                                    return (\r\n                                        <div key={step.id} className=\"text-center\">\r\n                                            <div className={`w-10 h-10 rounded-xl mx-auto mb-2 flex items-center justify-center ${isDone ? 'bg-primary-600' : isCurrent ? (isDark ? 'bg-primary-500/20 border-2 border-primary-500' : 'bg-primary-50 border-2 border-primary-600') : (isDark ? 'bg-slate-700' : 'bg-surface-200')}`}>\r\n                                                {isDone ? <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"white\" strokeWidth=\"3\"><path d=\"M20 6L9 17L4 12\" /></svg> : isCurrent ? <span className=\"text-primary-600 text-xs\">โ€ข</span> : <span className={`text-sm font-medium ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{step.id}</span>}\r\n                                            </div>\r\n                                            <span className={`text-[11px] ${isCurrent ? 'text-primary-600 font-semibold' : isDark ? 'text-slate-500' : 'text-slate-400'}`}>{step.label}</span>\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Staff Notes */}\r\n                        {application.staffNotes && (\r\n                            <div className=\"rounded-2xl p-5 mb-6 bg-secondary-50 border border-secondary-200\">\r\n                                <h4 className=\"text-sm font-semibold text-secondary-600 mb-2\">เธซเธกเธฒเธขเน€เธซเธ•เธธเธเธฒเธเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเน</h4>\r\n                                <p className=\"text-sm leading-relaxed\">{application.staffNotes}</p>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Action for Payment */}\r\n                        {application.status === \"PAYMENT_1_PENDING\" && (\r\n                            <div className=\"rounded-2xl p-6 mb-6 bg-secondary-50 border border-secondary-200\">\r\n                                <div className=\"flex justify-between items-center flex-wrap gap-4\">\r\n                                    <div><h4 className=\"text-base font-semibold text-secondary-600 mb-1\">เธฃเธญเธเธณเธฃเธฐเน€เธเธดเธเธเธงเธ”เธ—เธตเน 1</h4><p className={`text-sm ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธเนเธฒเธ•เธฃเธงเธเธชเธญเธเน€เธญเธเธชเธฒเธฃเน€เธเธทเนเธญเธเธ•เนเธ 5,000 เธเธฒเธ—</p></div>\r\n                                    <Link href={`/payments?app=${application._id}&phase=1`} className=\"px-6 py-3 rounded-xl bg-secondary-500 text-white font-semibold\">เธเธณเธฃเธฐเน€เธเธดเธ</Link>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Content Grid */}\r\n                        <div className=\"grid grid-cols-1 lg:grid-cols-5 gap-6\">\r\n                            {/* Left Column */}\r\n                            <div className=\"lg:col-span-3 flex flex-col gap-6\">\r\n                                {/* Applicant Info */}\r\n                                <div className={`rounded-2xl p-6 border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                                    <h3 className={`text-base font-semibold mb-4 flex items-center gap-2 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธเนเธญเธกเธนเธฅเธเธนเนเธขเธทเนเธเธเธณเธเธญ</h3>\r\n                                    <div className=\"grid grid-cols-2 gap-3 text-sm\">\r\n                                        <div><span className={isDark ? 'text-slate-500' : 'text-slate-400'}>เธเธทเนเธญ:</span> <strong>{application.applicantInfo?.name || `${application.applicantInfo?.firstName || ''} ${application.applicantInfo?.lastName || ''}`}</strong></div>\r\n                                        <div><span className={isDark ? 'text-slate-500' : 'text-slate-400'}>เธเธฃเธฐเน€เธ เธ—:</span> {application.applicantType === 'INDIVIDUAL' ? 'เธเธธเธเธเธฅเธเธฃเธฃเธกเธ”เธฒ' : application.applicantType === 'COMMUNITY' ? 'เธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ' : 'เธเธดเธ•เธดเธเธธเธเธเธฅ'}</div>\r\n                                        <div><span className={isDark ? 'text-slate-500' : 'text-slate-400'}>เนเธ—เธฃ:</span> {application.applicantInfo?.phone || '-'}</div>\r\n                                        <div><span className={isDark ? 'text-slate-500' : 'text-slate-400'}>เธญเธตเน€เธกเธฅ:</span> {application.applicantInfo?.email || '-'}</div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Site Info */}\r\n                                {application.siteInfo && (\r\n                                    <div className={`rounded-2xl p-6 border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                                        <h3 className={`text-base font-semibold mb-4 flex items-center gap-2 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธชเธ–เธฒเธเธ—เธตเนเธเธฅเธนเธ/เน€เธเนเธเน€เธเธตเนเธขเธง</h3>\r\n                                        <div className=\"grid gap-3 text-sm\">\r\n                                            <div><span className={isDark ? 'text-slate-500' : 'text-slate-400'}>เธเธทเนเธญเธชเธ–เธฒเธเธ—เธตเน:</span> <strong>{application.siteInfo.siteName}</strong></div>\r\n                                            <div><span className={isDark ? 'text-slate-500' : 'text-slate-400'}>เธ—เธตเนเธญเธขเธนเน:</span> {application.siteInfo.address}, {application.siteInfo.province}</div>\r\n                                            <div className=\"grid grid-cols-2 gap-3\">\r\n                                                <div><span className={isDark ? 'text-slate-500' : 'text-slate-400'}>เธเธทเนเธเธ—เธตเน:</span> {application.siteInfo.areaSize} เนเธฃเน</div>\r\n                                                <div><span className={isDark ? 'text-slate-500' : 'text-slate-400'}>เธเธดเธเธฑเธ” GPS:</span> {application.siteInfo.gpsLat}, {application.siteInfo.gpsLng}</div>\r\n                                            </div>\r\n                                        </div>\r\n                                        {application.siteInfo.gpsLat && application.siteInfo.gpsLng && (\r\n                                            <div className={`mt-4 rounded-xl overflow-hidden border ${isDark ? 'border-slate-700' : 'border-surface-200'}`}>\r\n                                                <iframe src={`https://www.openstreetmap.org/export/embed.html?bbox=${parseFloat(application.siteInfo.gpsLng) - 0.01}%2C${parseFloat(application.siteInfo.gpsLat) - 0.006}%2C${parseFloat(application.siteInfo.gpsLng) + 0.01}%2C${parseFloat(application.siteInfo.gpsLat) + 0.006}&layer=mapnik&marker=${application.siteInfo.gpsLat}%2C${application.siteInfo.gpsLng}`} className=\"w-full h-44 border-none\" loading=\"lazy\" />\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Right Column */}\r\n                            <div className=\"lg:col-span-2 flex flex-col gap-6\">\r\n                                {/* Documents */}\r\n                                <div className={`rounded-2xl p-6 border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                                    <h3 className={`text-base font-semibold mb-4 flex items-center gap-2 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เน€เธญเธเธชเธฒเธฃเธเธฃเธฐเธเธญเธ</h3>\r\n                                    <div className=\"flex flex-col gap-2\">\r\n                                        {application.formData?.documents?.filter(d => d.uploaded).slice(0, 5).map((doc, i) => (\r\n                                            <div key={i} className={`flex items-center justify-between p-3 rounded-lg ${isDark ? 'bg-slate-700/50' : 'bg-surface-100'}`}>\r\n                                                <div className=\"flex items-center gap-2.5\"><svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#10B981\" strokeWidth=\"1.5\"><path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\" /><polyline points=\"14 2 14 8 20 8\" /></svg><span className=\"text-sm\">{doc.name || `เน€เธญเธเธชเธฒเธฃ ${i + 1}`}</span></div>\r\n                                                <button className={`px-3 py-1.5 rounded-lg text-xs font-medium border flex items-center gap-1 ${isDark ? 'border-primary-500 text-primary-400' : 'border-primary-600 text-primary-600'}`}>\r\n                                                    <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" /><polyline points=\"7 10 12 15 17 10\" /><line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" /></svg>\r\n                                                    เธ”เธฒเธงเธเนเนเธซเธฅเธ”\r\n                                                </button>\r\n                                            </div>\r\n                                        )) || <p className={`text-sm text-center py-5 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>เธขเธฑเธเนเธกเนเธกเธตเน€เธญเธเธชเธฒเธฃ</p>}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Quick Actions */}\r\n                                <div className={`rounded-2xl p-6 border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                                    <h3 className=\"text-base font-semibold mb-4\">เธ”เธณเน€เธเธดเธเธเธฒเธฃ</h3>\r\n                                    <div className=\"flex flex-col gap-2.5\">\r\n                                        <Link href={`/tracking?app=${application._id}`} className={`flex items-center gap-2.5 p-3.5 rounded-xl border ${isDark ? 'border-slate-700' : 'border-surface-200'}`}>\r\n                                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><circle cx=\"12\" cy=\"12\" r=\"10\" /><polygon points=\"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76\" /></svg>\r\n                                            <span>เธ•เธดเธ”เธ•เธฒเธกเธชเธ–เธฒเธเธฐ</span>\r\n                                        </Link>\r\n                                        <Link href={`/payments?app=${application._id}`} className={`flex items-center gap-2.5 p-3.5 rounded-xl border ${isDark ? 'border-slate-700' : 'border-surface-200'}`}>\r\n                                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><rect x=\"1\" y=\"4\" width=\"22\" height=\"16\" rx=\"2\" ry=\"2\" /><line x1=\"1\" y1=\"10\" x2=\"23\" y2=\"10\" /></svg>\r\n                                            <span>เธเธฃเธฐเธงเธฑเธ•เธดเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ</span>\r\n                                        </Link>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </>\r\n                ) : null}\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\amendment\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[657,660],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[657,660],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadCertificate'. Either include it or remove the dependency array.","line":22,"column":110,"nodeType":"ArrayExpression","endLine":22,"endColumn":118,"suggestions":[{"desc":"Update the dependencies array to be: [certId, loadCertificate]","fix":{"range":[1023,1031],"text":"[certId, loadCertificate]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1174,1177],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1174,1177],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":48,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2587,2590],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2587,2590],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":134,"column":166,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10995,11036],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ &quot;เธเธฒเธฃเน€เธเธดเธ\" เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10995,11036],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ &ldquo;เธเธฒเธฃเน€เธเธดเธ\" เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10995,11036],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ &#34;เธเธฒเธฃเน€เธเธดเธ\" เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10995,11036],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ &rdquo;เธเธฒเธฃเน€เธเธดเธ\" เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":134,"column":174,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10995,11036],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ \"เธเธฒเธฃเน€เธเธดเธ&quot; เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10995,11036],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ \"เธเธฒเธฃเน€เธเธดเธ&ldquo; เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10995,11036],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ \"เธเธฒเธฃเน€เธเธดเธ&#34; เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10995,11036],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ \"เธเธฒเธฃเน€เธเธดเธ&rdquo; เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Suspense, useEffect, useState } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport { apiClient as api } from \"@/lib/api\";\r\n\r\ninterface EditableField { key: string; label: string; value: string; originalValue: string; isModified: boolean; }\r\n\r\nfunction AmendmentContent() {\r\n    const router = useRouter();\r\n    const searchParams = useSearchParams();\r\n    const certId = searchParams.get('certId');\r\n\r\n    const [isDark, setIsDark] = useState(false);\r\n    const [step, setStep] = useState<'select' | 'edit' | 'confirm' | 'submitted'>('select');\r\n    const [certificate, setCertificate] = useState<any>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [submitting, setSubmitting] = useState(false);\r\n    const [fields, setFields] = useState<EditableField[]>([]);\r\n    const [changeDescription, setChangeDescription] = useState('');\r\n\r\n    useEffect(() => { setIsDark(localStorage.getItem(\"theme\") === \"dark\"); if (certId) loadCertificate(); }, [certId]);\r\n\r\n    const loadCertificate = async () => {\r\n        if (!certId) return;\r\n        setLoading(true);\r\n        const result = await api.get<any>(`/certificates/${certId}`);\r\n        if (result.success && result.data?.data) {\r\n            const cert = result.data.data;\r\n            setCertificate(cert);\r\n            setFields([\r\n                { key: 'siteName', label: 'เธเธทเนเธญเธชเธ–เธฒเธเธเธฃเธฐเธเธญเธเธเธฒเธฃ', value: cert.siteName || '', originalValue: cert.siteName || '', isModified: false },\r\n                { key: 'address', label: 'เธ—เธตเนเธญเธขเธนเน', value: cert.address || '', originalValue: cert.address || '', isModified: false },\r\n                { key: 'contactPhone', label: 'เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เน', value: cert.contactPhone || '', originalValue: cert.contactPhone || '', isModified: false },\r\n                { key: 'contactEmail', label: 'เธญเธตเน€เธกเธฅ', value: cert.contactEmail || '', originalValue: cert.contactEmail || '', isModified: false },\r\n            ]);\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    const handleFieldChange = (key: string, newValue: string) => setFields(prev => prev.map(f => f.key === key ? { ...f, value: newValue, isModified: newValue !== f.originalValue } : f));\r\n    const modifiedFields = fields.filter(f => f.isModified);\r\n\r\n    const handleSubmit = async () => {\r\n        setSubmitting(true);\r\n        try {\r\n            const changes = modifiedFields.reduce((acc, f) => { acc[f.key] = { from: f.originalValue, to: f.value }; return acc; }, {} as Record<string, { from: string; to: string }>);\r\n            const result = await api.post<any>('/api/applications', { serviceType: 'amendment', originalCertificateId: certId, data: { changes, changeDescription, applicantInfo: certificate?.applicantInfo } });\r\n            if (result.success) setStep('submitted');\r\n        } catch { } finally { setSubmitting(false); }\r\n    };\r\n\r\n    if (loading) return (\r\n        <div className={`min-h-screen flex items-center justify-center ${isDark ? 'bg-slate-900' : 'bg-surface-100'}`}>\r\n            <div className=\"text-center\">\r\n                <div className=\"w-10 h-10 border-[3px] border-surface-200 border-t-blue-600 rounded-full animate-spin mx-auto mb-4\" />\r\n                <p className=\"text-slate-500\">เธเธณเธฅเธฑเธเนเธซเธฅเธ”เธเนเธญเธกเธนเธฅเนเธเธฃเธฑเธเธฃเธญเธ...</p>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const stepLabels = ['เน€เธฅเธทเธญเธเธเนเธญเธกเธนเธฅ', 'เนเธเนเนเธ', 'เธขเธทเธเธขเธฑเธ', 'เน€เธชเธฃเนเธเธชเธดเนเธ'];\r\n    const stepKeys = ['select', 'edit', 'confirm', 'submitted'];\r\n    const stepIndex = stepKeys.indexOf(step);\r\n\r\n    return (\r\n        <div className={`min-h-screen p-6 font-sans ${isDark ? 'bg-slate-900' : 'bg-surface-100'}`}>\r\n            <div className=\"max-w-2xl mx-auto\">\r\n                <button onClick={() => router.back()} className={`inline-flex items-center gap-2 px-4 py-2 rounded-lg border mb-6 ${isDark ? 'border-slate-700 text-slate-400' : 'border-surface-200 text-slate-600'}`}>โ เธขเนเธญเธเธเธฅเธฑเธ</button>\r\n                <h1 className={`text-2xl font-semibold mb-2 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เนเธเนเนเธเธเนเธญเธกเธนเธฅเนเธเนเธเธฃเธฑเธเธฃเธญเธ</h1>\r\n                <p className={`text-sm mb-8 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เนเธเธฃเธฑเธเธฃเธญเธเน€เธฅเธเธ—เธตเน: <strong>{certificate?.certificateNumber || '-'}</strong></p>\r\n\r\n                {/* Progress Steps */}\r\n                <div className=\"flex gap-2 mb-8\">\r\n                    {stepLabels.map((label, idx) => (\r\n                        <div key={label} className=\"flex-1 text-center\">\r\n                            <div className={`w-8 h-8 rounded-full mx-auto mb-2 flex items-center justify-center text-sm font-semibold ${idx < stepIndex ? 'bg-primary-600 text-white' : idx === stepIndex ? 'bg-blue-600 text-white' : isDark ? 'bg-slate-700 text-slate-400' : 'bg-surface-200 text-slate-500'}`}>{idx + 1}</div>\r\n                            <div className={`text-xs ${idx === stepIndex ? 'text-blue-600' : isDark ? 'text-slate-500' : 'text-slate-400'}`}>{label}</div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Step: Edit */}\r\n                {(step === 'select' || step === 'edit') && (\r\n                    <div className={`rounded-2xl p-6 border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                        <h3 className={`text-base font-semibold mb-4 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เนเธเนเนเธเธเนเธญเธกเธนเธฅเธ—เธตเนเธ•เนเธญเธเธเธฒเธฃเน€เธเธฅเธตเนเธขเธเนเธเธฅเธ</h3>\r\n                        <div className=\"space-y-4 mb-6\">\r\n                            {fields.map(field => (\r\n                                <div key={field.key}>\r\n                                    <label className={`block text-sm mb-1.5 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{field.label} {field.isModified && <span className=\"text-secondary-500 ml-2\">โ— เนเธเนเนเธเนเธฅเนเธง</span>}</label>\r\n                                    <input type=\"text\" value={field.value} onChange={(e) => handleFieldChange(field.key, e.target.value)} className={`w-full px-3.5 py-3 rounded-lg text-sm outline-none ${field.isModified ? 'border-2 border-secondary-500' : (isDark ? 'border border-slate-600 bg-slate-700 text-surface-100' : 'border border-surface-200 text-slate-900')}`} />\r\n                                    {field.isModified && <p className={`text-xs mt-1 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>เน€เธ”เธดเธก: {field.originalValue}</p>}\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                        <div className=\"mb-6\">\r\n                            <label className={`block text-sm mb-1.5 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เน€เธซเธ•เธธเธเธฅเนเธเธเธฒเธฃเนเธเนเนเธ <span className=\"text-red-500\">*</span></label>\r\n                            <textarea value={changeDescription} onChange={(e) => setChangeDescription(e.target.value)} placeholder=\"เธญเธเธดเธเธฒเธขเธชเธฒเน€เธซเธ•เธธ...\" className={`w-full px-3.5 py-3 rounded-lg text-sm outline-none resize-y min-h-[100px] ${isDark ? 'border border-slate-600 bg-slate-700 text-surface-100' : 'border border-surface-200 text-slate-900'}`} />\r\n                        </div>\r\n                        <button onClick={() => setStep('confirm')} disabled={modifiedFields.length === 0 || !changeDescription.trim()} className={`w-full py-3.5 rounded-xl text-sm font-semibold ${modifiedFields.length > 0 && changeDescription.trim() ? 'bg-gradient-to-br from-blue-600 to-blue-500 text-white shadow-lg shadow-blue-500/40' : 'bg-surface-200 text-slate-400 cursor-not-allowed'}`}>เธ•เธฃเธงเธเธชเธญเธเธเธฒเธฃเนเธเนเนเธ ({modifiedFields.length} เธฃเธฒเธขเธเธฒเธฃ) โ’</button>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Step: Confirm */}\r\n                {step === 'confirm' && (\r\n                    <div className={`rounded-2xl p-6 border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                        <h3 className={`text-base font-semibold mb-4 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธขเธทเธเธขเธฑเธเธเธฒเธฃเนเธเนเนเธ</h3>\r\n                        <div className=\"bg-secondary-50 border border-secondary-500 rounded-xl p-4 mb-6\"><p className=\"text-sm text-secondary-800\">เธซเธฅเธฑเธเธเธฒเธเธชเนเธเธเธณเธเธญ เธ—เธตเธกเธเธฒเธเธเธฐเธเธฃเธฐเน€เธกเธดเธเนเธฅเธฐเธชเนเธเนเธเน€เธชเธเธญเธฃเธฒเธเธฒเนเธซเนเธ—เนเธฒเธเธเนเธฒเธเธฃเธฐเธเธ</p></div>\r\n                        <h4 className={`text-sm font-semibold mb-3 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธฃเธฒเธขเธเธฒเธฃเธ—เธตเนเนเธเนเนเธ:</h4>\r\n                        <div className=\"space-y-2 mb-6\">\r\n                            {modifiedFields.map(field => (\r\n                                <div key={field.key} className={`p-3 rounded-lg border ${isDark ? 'border-slate-600' : 'border-surface-200'}`}>\r\n                                    <div className={`font-medium mb-1 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>{field.label}</div>\r\n                                    <div className=\"text-sm\"><span className=\"text-red-500 line-through\">{field.originalValue}</span><span className={`mx-2 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>โ’</span><span className=\"text-primary-600 font-medium\">{field.value}</span></div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                        <div className={`p-3 rounded-lg mb-6 ${isDark ? 'bg-blue-500/10' : 'bg-blue-50'}`}>\r\n                            <div className={`text-xs mb-1 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เน€เธซเธ•เธธเธเธฅ:</div>\r\n                            <div className={`text-sm ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>{changeDescription}</div>\r\n                        </div>\r\n                        <div className=\"flex gap-3\">\r\n                            <button onClick={() => setStep('edit')} className={`flex-1 py-3.5 rounded-xl text-sm font-medium border ${isDark ? 'border-slate-600 text-slate-400' : 'border-surface-200 text-slate-600'}`}>โ เนเธเนเนเธเน€เธเธดเนเธกเน€เธ•เธดเธก</button>\r\n                            <button onClick={handleSubmit} disabled={submitting} className={`flex-1 py-3.5 rounded-xl text-sm font-semibold bg-gradient-to-br from-blue-600 to-blue-500 text-white shadow-lg shadow-blue-500/40 ${submitting ? 'opacity-70' : ''}`}>{submitting ? 'เธเธณเธฅเธฑเธเธชเนเธ...' : 'เธชเนเธเธเธณเธเธญเนเธเนเนเธ'}</button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Step: Submitted */}\r\n                {step === 'submitted' && (\r\n                    <div className={`rounded-2xl p-8 border text-center ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                        <div className=\"w-16 h-16 rounded-full bg-primary-600 flex items-center justify-center mx-auto mb-4\"><svg width=\"28\" height=\"28\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"white\" strokeWidth=\"3\"><polyline points=\"20 6 9 17 4 12\" /></svg></div>\r\n                        <h3 className={`text-xl font-semibold mb-2 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธชเนเธเธเธณเธเธญเนเธเนเนเธเน€เธฃเธตเธขเธเธฃเนเธญเธข</h3>\r\n                        <p className={`text-sm mb-6 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธ—เธตเธกเธเธฒเธเธเธฐเธ•เธฃเธงเธเธชเธญเธเนเธฅเธฐเธชเนเธเนเธเน€เธชเธเธญเธฃเธฒเธเธฒเนเธซเนเธ—เนเธฒเธ<br />เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ \"เธเธฒเธฃเน€เธเธดเธ\" เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ</p>\r\n                        <div className=\"flex gap-3 justify-center\">\r\n                            <button onClick={() => router.push('/farmer/applications')} className={`px-6 py-3.5 rounded-xl text-sm font-medium border ${isDark ? 'border-slate-600 text-slate-400' : 'border-surface-200 text-slate-600'}`}>เธเธฅเธฑเธเธซเธเนเธฒเธเธณเธเธญ</button>\r\n                            <button onClick={() => router.push('/payments')} className=\"px-6 py-3.5 rounded-xl text-sm font-semibold bg-gradient-to-br from-blue-600 to-blue-500 text-white shadow-lg shadow-blue-500/40\">เนเธเธซเธเนเธฒเธเธฒเธฃเน€เธเธดเธ</button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction AmendmentLoadingFallback() {\r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center bg-surface-100\">\r\n            <div className=\"text-center\">\r\n                <div className=\"w-10 h-10 border-[3px] border-surface-200 border-t-blue-600 rounded-full animate-spin mx-auto mb-4\" />\r\n                <p className=\"text-slate-500 text-sm\">เธเธณเธฅเธฑเธเนเธซเธฅเธ”...</p>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default function AmendmentApplicationPage() { return <Suspense fallback={<AmendmentLoadingFallback />}><AmendmentContent /></Suspense>; }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\context\\wizard-context.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\hooks\\useWizardState.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\hooks\\useWizardStore.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":333,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":333,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10972,10975],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10972,10975],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'get' is defined but never used.","line":443,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":443,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { create } from 'zustand';\r\nimport { persist } from 'zustand/middleware';\r\n\r\n// Types\r\nexport type PlantId = 'cannabis' | 'kratom' | 'turmeric' | 'ginger' | 'black_galangal' | 'plai';\r\nexport type ServiceType = 'NEW' | 'RENEWAL' | 'MODIFY' | 'REPLACEMENT';\r\nexport type PlantGroup = 'HIGH_CONTROL' | 'GENERAL';\r\nexport type CertificationPurpose = 'RESEARCH' | 'COMMERCIAL' | 'EXPORT';\r\nexport type SiteType = 'OUTDOOR' | 'INDOOR' | 'GREENHOUSE';\r\nexport type CultivationMethod = 'outdoor' | 'greenhouse' | 'indoor' | 'vertical' | 'hydroponic';\r\n\r\nexport interface Plant {\r\n    id: PlantId;\r\n    name: string;\r\n    icon: string;\r\n    group: PlantGroup;\r\n}\r\n\r\nexport const PLANTS: Plant[] = [\r\n    { id: 'cannabis', name: 'เธเธฑเธเธเธฒ', icon: '', group: 'HIGH_CONTROL' },\r\n    { id: 'kratom', name: 'เธเธฃเธฐเธ—เนเธญเธก', icon: '', group: 'HIGH_CONTROL' },\r\n    { id: 'turmeric', name: 'เธเธกเธดเนเธเธเธฑเธ', icon: '', group: 'GENERAL' },\r\n    { id: 'ginger', name: 'เธเธดเธ', icon: '', group: 'GENERAL' },\r\n    { id: 'black_galangal', name: 'เธเธฃเธฐเธเธฒเธขเธ”เธณ', icon: '', group: 'GENERAL' },\r\n    { id: 'plai', name: 'เนเธเธฅ', icon: '', group: 'GENERAL' },\r\n];\r\n\r\n// Expanded ApplicantData with all fields for INDIVIDUAL, JURISTIC, COMMUNITY\r\nexport interface ApplicantData {\r\n    applicantType: 'INDIVIDUAL' | 'JURISTIC' | 'COMMUNITY';\r\n\r\n    // เธเธธเธเธเธฅเธเธฃเธฃเธกเธ”เธฒ (Individual)\r\n    firstName?: string;\r\n    lastName?: string;\r\n    fullName?: string;\r\n    idCard?: string;\r\n    phone?: string;\r\n    email?: string;\r\n    lineId?: string;\r\n    address?: string;\r\n    province?: string;\r\n    district?: string;\r\n    subdistrict?: string;\r\n    postalCode?: string;\r\n\r\n    // เธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ (Community Enterprise)\r\n    communityName?: string;           // เธเธทเนเธญเธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ\r\n    communityAddress?: string;        // เธ—เธตเนเธญเธขเธนเนเธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ\r\n    communityRegDate?: string;        // เธงเธฑเธเธ—เธตเนเธเธ”เธ—เธฐเน€เธเธตเธขเธ\r\n    presidentName?: string;           // เธเธทเนเธญเธเธฃเธฐเธเธฒเธ\r\n    presidentIdCard?: string;         // เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธเธเธฃเธฐเธเธฒเธ\r\n    presidentPhone?: string;          // เนเธ—เธฃเธจเธฑเธเธ—เนเธเธฃเธฐเธเธฒเธ\r\n    memberCount?: number;             // เธเธณเธเธงเธเธชเธกเธฒเธเธดเธ\r\n    registrationSVC01?: string;       // เธฃเธซเธฑเธช เธชเธงเธ.01\r\n    registrationTVC3?: string;        // เธฃเธซเธฑเธช เธ—.เธง.เธ.3\r\n    houseRegistrationCode?: string;   // เน€เธฅเธเธฃเธซเธฑเธชเธเธฃเธฐเธเธณเธเนเธฒเธ\r\n    registeredAddress?: string;       // เธ—เธตเนเธญเธขเธนเนเธ•เธฒเธกเธ—เธฐเน€เธเธตเธขเธเธเนเธฒเธ\r\n\r\n    // เธเธดเธ•เธดเธเธธเธเธเธฅ (Juristic Person)\r\n    companyName?: string;             // เธเธทเนเธญเธชเธ–เธฒเธเธเธฃเธฐเธเธญเธเธเธฒเธฃ/เธเธฃเธดเธฉเธฑเธ—\r\n    companyAddress?: string;          // เธ—เธตเนเธญเธขเธนเนเธชเธ–เธฒเธเธ—เธตเนเธเธฑเธ”เธ•เธฑเนเธ\r\n    companyPhone?: string;            // เนเธ—เธฃเธจเธฑเธเธ—เนเธชเธ–เธฒเธเธ—เธตเนเธเธฑเธ”เธ•เธฑเนเธ\r\n    companyType?: string;             // เธเธฃเธฐเน€เธ เธ—เธเธดเธ•เธดเธเธธเธเธเธฅ\r\n    taxId?: string;                   // เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธต\r\n    registeredCapital?: string;       // เธ—เธธเธเธเธ”เธ—เธฐเน€เธเธตเธขเธ\r\n    directorName?: string;            // เธเธทเนเธญเธเธฃเธฐเธเธฒเธเธเธฃเธฃเธกเธเธฒเธฃ\r\n    directorIdCard?: string;          // เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธเธเธฃเธฃเธกเธเธฒเธฃ\r\n    directorPhone?: string;           // เนเธ—เธฃเธจเธฑเธเธ—เนเธเธฃเธฐเธเธฒเธเธเธฃเธฃเธกเธเธฒเธฃ\r\n    directorEmail?: string;           // เธญเธตเน€เธกเธฅเธเธฃเธฐเธเธฒเธ\r\n    directorPosition?: string;        // เธ•เธณเนเธซเธเนเธ\r\n    registrationNumber?: string;      // เน€เธฅเธเธ—เธฐเน€เธเธตเธขเธเธเธดเธ•เธดเธเธธเธเธเธฅ/เน€เธฅเธเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธต\r\n    powerOfAttorneyUrl?: string;      // เธซเธเธฑเธเธชเธทเธญเธกเธญเธเธญเธณเธเธฒเธ (PDF URL)\r\n    coordinatorName?: string;         // เธเธทเนเธญเธเธนเนเธเธฃเธฐเธชเธฒเธเธเธฒเธ (เธเธฃเธ“เธตเธกเธญเธเธญเธณเธเธฒเธ)\r\n    coordinatorPhone?: string;        // เนเธ—เธฃเธจเธฑเธเธ—เนเธเธนเนเธเธฃเธฐเธชเธฒเธเธเธฒเธ\r\n    coordinatorLineId?: string;       // Line ID เธเธนเนเธเธฃเธฐเธชเธฒเธเธเธฒเธ\r\n    contactName?: string;             // เธเธทเนเธญเธเธนเนเธ•เธดเธ”เธ•เนเธญ\r\n    contactPhone?: string;            // เนเธ—เธฃเธจเธฑเธเธ—เนเธเธนเนเธ•เธดเธ”เธ•เนเธญ\r\n    contactEmail?: string;            // เธญเธตเน€เธกเธฅเธเธนเนเธ•เธดเธ”เธ•เนเธญ\r\n\r\n    // Legacy fields\r\n    responsibleName?: string;\r\n    qualification?: string;\r\n    plantingStatus?: 'NOTIFY' | 'LICENSED';\r\n    licenseNumber?: string;\r\n    licenseType?: 'BHT11' | 'BHT13' | 'BHT16';\r\n\r\n    // [GACP] Personnel Hygiene (เธซเธกเธงเธ” 3: เธเธธเธเธฅเธฒเธเธฃ)\r\n    personnelHygiene?: {\r\n        trainingProvided: boolean; // เธเธฒเธฃเธญเธเธฃเธก\r\n        healthCheck: boolean;      // เธ•เธฃเธงเธเธชเธธเธเธ เธฒเธ\r\n        protectiveGear: boolean;   // เธญเธธเธเธเธฃเธ“เนเธเนเธญเธเธเธฑเธ (PPE)\r\n    };\r\n}\r\n\r\n// [NEW] General Information\r\nexport interface GeneralInfo {\r\n    projectName: string;\r\n    certType: string;\r\n}\r\n\r\n// [NEW] Plot Definition\r\nexport interface Plot {\r\n    id: string; // uuid or temp-id\r\n    name: string; // e.g., \"Greenhouse A\"\r\n    areaSize: string; // e.g., \"2\"\r\n    areaUnit: string; // e.g., \"Rai\"\r\n    solarSystem: 'OUTDOOR' | 'INDOOR' | 'GREENHOUSE';\r\n    latitude?: number;\r\n    longitude?: number;\r\n    // [NEW] Dynamic cultivation config fields\r\n    farmLayoutId?: string; // e.g., \"row_cultivation\", \"raised_bed\"\r\n    growingStyleId?: string; // e.g., \"sog\", \"scrog\", \"vertical\" (indoor only)\r\n    tiers?: number; // For vertical farming (1-5)\r\n    estimatedPlants?: number; // Calculated plant count\r\n    plantDensity?: number; // plants per sqm\r\n\r\n    // [GACP] Soil Analysis (เธซเธกเธงเธ” 4: เธงเธฑเธชเธ”เธธเธเธฅเธนเธ)\r\n    soilType?: string; // เธเธฃเธฐเน€เธ เธ—เธ”เธดเธ\r\n    soilAnalysisStatus?: 'none' | 'pending' | 'passed' | 'failed';\r\n    hasHeavyMetalTest?: boolean;\r\n    hasPesticideTest?: boolean;\r\n\r\n    // [GACP] Seed/Material Source (เธซเธกเธงเธ” 4)\r\n    seedSource?: string; // เนเธซเธฅเนเธเน€เธกเธฅเนเธ”เธเธฑเธเธเธธเน\r\n    seedCertificate?: boolean; // เธกเธตเนเธเธฃเธฑเธเธฃเธญเธเน€เธกเธฅเนเธ”เธเธฑเธเธเธธเน\r\n    seedProviderName?: string;\r\n\r\n    // [GACP] IPM Plan (เธซเธกเธงเธ” 6)\r\n    hasIPMPlan?: boolean;\r\n    ipmMethods?: string[]; // เธงเธดเธเธตเธเธฒเธฃเธเนเธญเธเธเธฑเธเธจเธฑเธ•เธฃเธนเธเธทเธ\r\n}\r\n\r\n// [NEW] Farm Data - เธชเธ–เธฒเธเธเธฃเธฐเธเธญเธเธเธฒเธฃ\r\nexport interface FarmData {\r\n    id?: string;\r\n    farmName: string; // เธเธทเนเธญเธเธฒเธฃเนเธก\r\n    address: string;\r\n    province: string;\r\n    district: string;\r\n    subdistrict: string;\r\n    postalCode: string;\r\n    // GPS เธเธธเธ”เธจเธนเธเธขเนเธเธฅเธฒเธ\r\n    gpsLat?: string;\r\n    gpsLng?: string;\r\n    // เธเธทเนเธเธ—เธตเนเธฃเธงเธก\r\n    totalAreaSize: string;\r\n    totalAreaUnit: 'Rai' | 'Ngan' | 'Sqm';\r\n    // เธเธฃเธฃเธกเธชเธดเธ—เธเธดเน\r\n    landOwnership: 'OWN' | 'RENT' | 'CONSENT';\r\n    // เธญเธฒเธ“เธฒเน€เธเธ•\r\n    northBorder?: string;\r\n    southBorder?: string;\r\n    eastBorder?: string;\r\n    westBorder?: string;\r\n    // เนเธเธฃเธเธชเธฃเนเธฒเธเธเธทเนเธเธเธฒเธ\r\n    waterSource?: string;\r\n    electricitySource?: string;\r\n\r\n    // [GACP] Soil Information\r\n    soilType?: string;          // e.g., \"Clay\", \"Loam\"\r\n    soilPH?: string;            // [NEW]\r\n    soilHistory?: string;       // [NEW] History of land use\r\n\r\n    // เธฃเธฐเธเธเธฃเธฑเธเธฉเธฒเธเธงเธฒเธกเธเธฅเธญเธ”เธ เธฑเธข\r\n    hasFence?: boolean;\r\n    hasCCTV?: boolean;\r\n    hasAccessControl?: boolean;\r\n    hasWarningSign?: boolean;\r\n    // เน€เธญเธเธชเธฒเธฃเธเธฒเธฃเนเธก\r\n    documents?: StepDocument[];\r\n}\r\n\r\n// [NEW] Lot - เธฅเนเธญเธ•เธเธฒเธฃเธเธฅเธดเธ•\r\nexport interface Lot {\r\n    id: string;\r\n    lotCode: string; // e.g., \"LOT-67-001\"\r\n    plotId: string; // เน€เธเธทเนเธญเธกเธเธฑเธเนเธเธฅเธ\r\n    plotName?: string; // for display\r\n    plantCount: number; // เธเธณเธเธงเธเธ•เนเธเธ—เธตเนเธเธฐเธเธฅเธนเธ\r\n    estimatedPlantingDate?: string; // ISO date\r\n    estimatedHarvestDate?: string; // ISO date\r\n    estimatedYieldKg?: number; // [NEW] Added for GACP\r\n    status: 'PLANNED' | 'ACTIVE' | 'HARVESTED' | 'CANCELLED';\r\n    notes?: string;\r\n    // เน€เธญเธเธชเธฒเธฃเธฅเนเธญเธ•\r\n    documents?: StepDocument[];\r\n}\r\n\r\n// Expanded SiteData with all fields from original Step6SiteSecurity\r\nexport interface SiteData {\r\n    siteName: string;\r\n    siteAddress?: string;\r\n    address: string;\r\n    province: string;\r\n    district: string;\r\n    subdistrict: string;\r\n    postalCode: string;\r\n    gpsLat?: string;\r\n    gpsLng?: string;\r\n    latitude?: number;\r\n    longitude?: number;\r\n    areaSize?: string;\r\n    areaUnit?: string;\r\n    northBorder?: string;\r\n    southBorder?: string;\r\n    eastBorder?: string;\r\n    westBorder?: string;\r\n    landOwnership?: 'OWN' | 'RENT' | 'CONSENT';\r\n    soilType?: string;          // Added for GACP\r\n    waterSource?: string;       // Added for GACP\r\n    hasCCTV?: boolean;\r\n    hasFence2m?: boolean;\r\n    hasAccessLog?: boolean;\r\n    hasBiometric?: boolean;\r\n    hasAnimalFence?: boolean;\r\n    hasZoneSign?: boolean;\r\n\r\n    // [NEW] Plot Management\r\n    plots?: Plot[];\r\n}\r\n\r\n// [NEW] Plant Variety Detail\r\nexport interface PlantVariety {\r\n    id: string;\r\n    name: string;\r\n    sourceType: 'SELF' | 'BUY' | 'IMPORT';\r\n    sourceName?: string; // Shop name or location\r\n    quantity?: number;\r\n}\r\n\r\n// Expanded ProductionData with all fields from original Step5Production\r\nexport interface ProductionData {\r\n    plantParts?: string[];\r\n    plantPartsOther?: string;\r\n    propagationType?: 'SEED' | 'CUTTING' | 'TISSUE' | 'OTHER';\r\n    cultivationMethod?: 'OUTDOOR' | 'INDOOR' | 'GREENHOUSE'; // Added for GACP\r\n    irrigationType?: 'DRIP' | 'SPRINKLER' | 'MANUAL' | 'FLOOD'; // Added for GACP\r\n\r\n    // Varieties (Upgraded from single varietyName)\r\n    varieties?: PlantVariety[]; // [NEW]\r\n    varietyName?: string;       // Deprecated but kept for compatibility\r\n\r\n    seedSource?: string;\r\n    varietySource?: string;\r\n    treeCount?: number;\r\n    areaSizeRai?: number;\r\n    quantityWithUnit?: string;\r\n    harvestCycles?: number;\r\n    estimatedYield?: number;\r\n    sourceType?: 'SELF' | 'BUY' | 'IMPORT';\r\n    sourceDetail?: string;\r\n    hasGAPCert?: boolean;\r\n    hasOrganicCert?: boolean;\r\n    cultivationArea?: string;\r\n    annualProduction?: string;\r\n    harvestMethod?: string;\r\n    storageMethod?: string;\r\n    qualityControl?: string;\r\n    spacing?: string;\r\n    plantCount?: string;\r\n}\r\n\r\nexport interface SecurityData {\r\n    hasFence: boolean;\r\n    hasCCTV: boolean;\r\n    hasGuard: boolean;\r\n    hasAccessControl: boolean;\r\n    securityNotes?: string;\r\n}\r\n\r\n// [NEW] Harvest & Post-Harvest\r\nexport interface HarvestData {\r\n    harvestMethod: 'MANUAL' | 'MACHINE' | '';\r\n    dryingMethod: 'SUN' | 'OVEN' | 'DEHYDRATOR' | 'OTHER' | '';\r\n    dryingDetail?: string; // If OTHER\r\n    storageSystem: 'CONTROLLED' | 'AMBIENT' | '';\r\n    packaging: string;\r\n}\r\n\r\n// [NEW] Cultivation Details for dynamic form based on method\r\nexport interface CultivationDetails {\r\n    method: CultivationMethod;\r\n    strainId: string;\r\n    strainName?: string;\r\n    // For outdoor/ground\r\n    plantsPerRai?: number;\r\n    plantSpacing?: string;\r\n    // For greenhouse\r\n    greenhouseCount?: number;\r\n    greenhouseSize?: string;\r\n    // For vertical/rack\r\n    rackLayers?: number;\r\n    racksPerLayer?: number;\r\n    plantsPerRack?: number;\r\n    // For hydroponic\r\n    hydroSystem?: 'NFT' | 'DWC' | 'DRIP';\r\n    potCount?: number;\r\n    // Common\r\n    totalPlants: number;\r\n    plantingDate: string; // ISO date\r\n    estimatedHarvestDate?: string; // ISO date\r\n    harvestCyclesPerYear?: number;\r\n    estimatedYieldPerCycle?: number; // kg\r\n}\r\n\r\n// [NEW] QR Tracking Data per plant\r\nexport interface PlantTrackingData {\r\n    plantId: string;\r\n    qrCode?: string;\r\n    plantingDate: string;\r\n    actualHarvestDate?: string;\r\n    status: 'PLANTED' | 'GROWING' | 'HARVESTED' | 'DESTROYED';\r\n}\r\n\r\n// [NEW] Per-step documents (inline uploads)\r\nexport interface StepDocument {\r\n    stepNumber: number;\r\n    docType: string;\r\n    fileName?: string;\r\n    fileUrl?: string;\r\n    uploadedAt?: string;\r\n    required: boolean;\r\n}\r\n\r\nexport interface DocumentUpload {\r\n    id: string;\r\n    name?: string;\r\n    type?: string;\r\n    url?: string;\r\n    uploaded: boolean;\r\n    metadata?: any; // [NEW] For storing extracted data (e.g., Land Area)\r\n}\r\n\r\nexport interface WizardState {\r\n    currentStep: number;\r\n    plantId: PlantId | null;\r\n    serviceType: ServiceType | null;\r\n    certificationPurpose: CertificationPurpose | null;\r\n    siteTypes: SiteType[];\r\n    licensePdfUrl: string | null;\r\n    consentedPDPA: boolean;\r\n    acknowledgedStandards: boolean;\r\n    applicantData: ApplicantData | null;\r\n    siteData: SiteData | null;\r\n    productionData: ProductionData | null;\r\n    harvestData: HarvestData | null;\r\n    securityData: SecurityData | null;\r\n    documents: DocumentUpload[];\r\n    youtubeUrl?: string;\r\n    locationType: SiteType | null;\r\n    generalInfo: GeneralInfo | null;\r\n    applicationId?: string;\r\n    createdAt?: string;\r\n    updatedAt?: string;\r\n    // [NEW] V4 Fields for 9-step redesign\r\n    cultivationMethod: CultivationMethod | null;\r\n    cultivationDetails: CultivationDetails | null;\r\n    stepDocuments: StepDocument[];\r\n    plantTracking: PlantTrackingData[];\r\n    qrCount: number;\r\n    estimatedQRCost: number;\r\n    // [NEW] Farm-Plot-Lot structure\r\n    farmData: FarmData | null;\r\n    plots: Plot[];\r\n    lots: Lot[];\r\n    // [NEW] Quote Data\r\n    milestone1?: {\r\n        dtamQuote: { number: string; amount: number; accepted: boolean };\r\n        platformQuote: { number: string; amount: number; accepted: boolean };\r\n    };\r\n}\r\n\r\ninterface WizardActions {\r\n    // State update actions\r\n    updateState: (updates: Partial<WizardState>) => void;\r\n    setPlant: (plantId: PlantId) => void;\r\n    setServiceType: (serviceType: ServiceType) => void;\r\n    setCertificationPurpose: (purpose: CertificationPurpose) => void;\r\n    setSiteTypes: (siteTypes: SiteType[]) => void;\r\n    setLicensePdfUrl: (url: string | null) => void;\r\n    setApplicantData: (applicantData: ApplicantData) => void;\r\n    setSiteData: (siteData: SiteData) => void;\r\n    setProductionData: (productionData: ProductionData) => void;\r\n    setHarvestData: (harvestData: HarvestData) => void;\r\n    setSecurityData: (securityData: SecurityData) => void;\r\n    setDocuments: (documents: DocumentUpload[]) => void;\r\n    setLocationType: (locationType: SiteType) => void;\r\n    setYoutubeUrl: (youtubeUrl: string) => void;\r\n    setGeneralInfo: (generalInfo: GeneralInfo) => void;\r\n    setCurrentStep: (step: number) => void;\r\n    consentPDPA: () => void;\r\n    acknowledgeStandards: () => void;\r\n    resetWizard: () => void;\r\n    setApplicationId: (applicationId: string) => void;\r\n    // [NEW] Farm-Plot-Lot actions\r\n    setFarmData: (farmData: FarmData) => void;\r\n    setPlots: (plots: Plot[]) => void;\r\n    setLots: (lots: Lot[]) => void;\r\n    addPlot: (plot: Plot) => void;\r\n    removePlot: (plotId: string) => void;\r\n    addLot: (lot: Lot) => void;\r\n    removeLot: (lotId: string) => void;\r\n}\r\n\r\nconst initialState: WizardState = {\r\n    currentStep: 0,\r\n    plantId: null,\r\n    serviceType: null,\r\n    certificationPurpose: null,\r\n    siteTypes: [],\r\n    licensePdfUrl: null,\r\n    consentedPDPA: false,\r\n    acknowledgedStandards: false,\r\n    applicantData: null,\r\n    siteData: null,\r\n    productionData: null,\r\n    harvestData: null,\r\n    securityData: null,\r\n    documents: [],\r\n    youtubeUrl: '',\r\n    locationType: null,\r\n    generalInfo: null,\r\n    // [NEW] V4 Fields\r\n    cultivationMethod: null,\r\n    cultivationDetails: null,\r\n    stepDocuments: [],\r\n    plantTracking: [],\r\n    qrCount: 0,\r\n    estimatedQRCost: 0,\r\n    // [NEW] Farm-Plot-Lot\r\n    farmData: null,\r\n    plots: [],\r\n    lots: [],\r\n};\r\n\r\nconst STORAGE_KEY = 'gacp_wizard_state_v3'; // Bumped version for Zustand migration\r\n\r\n// Create the Zustand store with persistence\r\nconst useWizardStoreBase = create<WizardState & WizardActions>()(\r\n    persist(\r\n        (set, get) => ({\r\n            // Initial state\r\n            ...initialState,\r\n\r\n            // Actions\r\n            updateState: (updates) => set((state) => ({ ...state, ...updates })),\r\n\r\n            setPlant: (plantId) => set((state) => ({\r\n                plantId,\r\n                currentStep: Math.max(state.currentStep, 0)\r\n            })),\r\n\r\n            setServiceType: (serviceType) => set({ serviceType }),\r\n\r\n            setCertificationPurpose: (purpose) => set({ certificationPurpose: purpose }),\r\n\r\n            setSiteTypes: (siteTypes) => set({ siteTypes }),\r\n\r\n            setLicensePdfUrl: (url) => set({ licensePdfUrl: url }),\r\n\r\n            setApplicantData: (applicantData) => set({ applicantData }),\r\n\r\n            setSiteData: (siteData) => set({ siteData }),\r\n\r\n            setProductionData: (productionData) => set({ productionData }),\r\n\r\n            setHarvestData: (harvestData) => set({ harvestData }),\r\n\r\n            setSecurityData: (securityData) => set({ securityData }),\r\n\r\n            setDocuments: (documents) => set({ documents }),\r\n\r\n            setLocationType: (locationType) => set({ locationType }),\r\n\r\n            setYoutubeUrl: (youtubeUrl) => set({ youtubeUrl }),\r\n\r\n            setGeneralInfo: (generalInfo) => set({ generalInfo }),\r\n\r\n            setCurrentStep: (step) => set({ currentStep: step }),\r\n\r\n            consentPDPA: () => set({ consentedPDPA: true }),\r\n\r\n            acknowledgeStandards: () => set({ acknowledgedStandards: true }),\r\n\r\n            resetWizard: () => set(initialState),\r\n\r\n            setApplicationId: (applicationId) => set({ applicationId }),\r\n\r\n            // [NEW] Farm-Plot-Lot actions\r\n            setFarmData: (farmData) => set({ farmData }),\r\n            setPlots: (plots) => set({ plots }),\r\n            setLots: (lots) => set({ lots }),\r\n            addPlot: (plot) => set((state) => ({ plots: [...state.plots, plot] })),\r\n            removePlot: (plotId) => set((state) => ({\r\n                plots: state.plots.filter(p => p.id !== plotId),\r\n                lots: state.lots.filter(l => l.plotId !== plotId)\r\n            })),\r\n            addLot: (lot) => set((state) => ({ lots: [...state.lots, lot] })),\r\n            removeLot: (lotId) => set((state) => ({ lots: state.lots.filter(l => l.id !== lotId) })),\r\n        }),\r\n        {\r\n            name: STORAGE_KEY,\r\n            // Enable automatic hydration from localStorage\r\n            skipHydration: false,\r\n        }\r\n    )\r\n);\r\n\r\n// Validation helpers - Updated for 9-step flow\r\nexport function canProceedFromStep(state: WizardState, step: number): boolean {\r\n    switch (step) {\r\n        case 0: return !!state.plantId && !!state.certificationPurpose && !!state.cultivationMethod; // Plant & Purpose\r\n        case 1: return !!state.applicantData?.applicantType; // Applicant\r\n        case 2: return !!state.siteData?.siteName && !!state.siteData?.gpsLat; // Site\r\n        case 3: return !!state.cultivationDetails?.totalPlants; // Cultivation\r\n        case 4: return !!state.securityData; // Security\r\n        case 5: return !!state.harvestData?.harvestMethod; // Harvest\r\n        case 6: return state.documents.filter(d => d.uploaded).length >= 1; // Additional Documents\r\n        case 7: return true; // Review\r\n        case 8: return true; // Submit & Payment\r\n        default: return false;\r\n    }\r\n}\r\n\r\nexport function getCompletedSteps(state: WizardState): number[] {\r\n    const completed: number[] = [];\r\n    for (let i = 0; i <= 8; i++) { // 9 steps (0-8)\r\n        if (canProceedFromStep(state, i)) {\r\n            completed.push(i);\r\n        } else {\r\n            break;\r\n        }\r\n    }\r\n    return completed;\r\n}\r\n\r\n// Wrapper hook for compatibility with existing code\r\nexport function useWizardStore() {\r\n    const store = useWizardStoreBase();\r\n\r\n    // Extract state object for compatibility\r\n    const state: WizardState = {\r\n        currentStep: store.currentStep,\r\n        plantId: store.plantId,\r\n        serviceType: store.serviceType,\r\n        certificationPurpose: store.certificationPurpose,\r\n        siteTypes: store.siteTypes,\r\n        licensePdfUrl: store.licensePdfUrl,\r\n        consentedPDPA: store.consentedPDPA,\r\n        acknowledgedStandards: store.acknowledgedStandards,\r\n        applicantData: store.applicantData,\r\n        siteData: store.siteData,\r\n        productionData: store.productionData,\r\n        harvestData: store.harvestData,\r\n        securityData: store.securityData,\r\n        documents: store.documents,\r\n        youtubeUrl: store.youtubeUrl,\r\n        locationType: store.locationType,\r\n        generalInfo: store.generalInfo,\r\n        applicationId: store.applicationId,\r\n        createdAt: store.createdAt,\r\n        updatedAt: store.updatedAt,\r\n        // V4 Fields\r\n        cultivationMethod: store.cultivationMethod,\r\n        cultivationDetails: store.cultivationDetails,\r\n        stepDocuments: store.stepDocuments,\r\n        plantTracking: store.plantTracking,\r\n        qrCount: store.qrCount,\r\n        estimatedQRCost: store.estimatedQRCost,\r\n        // Farm-Plot-Lot\r\n        farmData: store.farmData,\r\n        plots: store.plots,\r\n        lots: store.lots,\r\n    };\r\n\r\n    return {\r\n        state,\r\n        isLoaded: true, // Zustand handles hydration\r\n        updateState: store.updateState,\r\n        setPlant: store.setPlant,\r\n        setServiceType: store.setServiceType,\r\n        setCertificationPurpose: store.setCertificationPurpose,\r\n        setSiteTypes: store.setSiteTypes,\r\n        setLicensePdfUrl: store.setLicensePdfUrl,\r\n        setApplicantData: store.setApplicantData,\r\n        setSiteData: store.setSiteData,\r\n        setProductionData: store.setProductionData,\r\n        setHarvestData: store.setHarvestData,\r\n        setSecurityData: store.setSecurityData,\r\n        setDocuments: store.setDocuments,\r\n        setYoutubeUrl: store.setYoutubeUrl,\r\n        setGeneralInfo: store.setGeneralInfo,\r\n        setCurrentStep: store.setCurrentStep,\r\n        consentPDPA: store.consentPDPA,\r\n        acknowledgeStandards: store.acknowledgeStandards,\r\n        resetWizard: store.resetWizard,\r\n        setApplicationId: store.setApplicationId,\r\n        setLocationType: store.setLocationType,\r\n        // Farm-Plot-Lot actions\r\n        setFarmData: store.setFarmData,\r\n        setPlots: store.setPlots,\r\n        setLots: store.setLots,\r\n        addPlot: store.addPlot,\r\n        removePlot: store.removePlot,\r\n        addLot: store.addLot,\r\n        removeLot: store.removeLot,\r\n        canProceedFromStep: (step: number) => canProceedFromStep(state, step),\r\n        getCompletedSteps: () => getCompletedSteps(state),\r\n    };\r\n}\r\n\r\n// Export the base store for direct access if needed\r\nexport { useWizardStoreBase };\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\step\\[id]\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook React.useEffect has missing dependencies: 'setCurrentStep' and 'stepIndex'. Either include them or remove the dependency array.","line":77,"column":8,"nodeType":"ArrayExpression","endLine":77,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [setCurrentStep, stepIndex]","fix":{"range":[3373,3375],"text":"[setCurrentStep, stepIndex]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React from 'react';\r\nimport { notFound, useParams } from 'next/navigation';\r\nimport { useWizardStore } from '../../hooks/useWizardStore';\r\n\r\n// Step Components - Mapped to 11-step GACP flow (consolidated Land+Farm)\r\n// 14-Step GACP Application Flow (Architected for Licensing, Traceability, Payment)\r\n// Pillar 1: Licensing\r\nimport { StepPlantSelection } from '../../steps/StepPlantSelection';    // 1: Plant & Objective\r\nimport { StepGeneral } from '../../steps/StepGeneral';                  // 2: Farmer Profile\r\nimport { StepFarm } from '../../steps/StepFarm';                        // 3: Land & Location\r\nimport { StepPlots } from '../../steps/StepPlots';                      // 4: Farm Layout\r\n\r\n// Pillar 2: Traceability (The \"Engine\")\r\nimport { StepProduction } from '../../steps/StepProduction';            // 5: Production Method (Propagation)\r\nimport { StepLots } from '../../steps/StepLots';                        // 6: Lots Tracking Setup\r\nimport { StepProductionEstimate } from '../../steps/StepProductionEstimate'; // 7: Yield Logic (Calculation)\r\nimport { StepHarvest } from '../../steps/StepHarvest';                  // 8: Harvest Process\r\n\r\n// Pillar 3: Compliance & Submission\r\nimport { StepDocuments } from '../../steps/StepDocuments';              // 9: Evidence\r\nimport { StepPreCheck } from '../../steps/StepPreCheck';                // 10: Self-Audit\r\nimport { StepPreview } from '../../steps/StepPreview';                  // 11: Review\r\nimport { StepSubmit } from '../../steps/StepSubmit';                    // 12: Legal Submission\r\n\r\n// Pillar 4: Payment (Gateway)\r\nimport { StepQuote } from '../../steps/StepQuote';                      // 13: Fee Acceptance\r\nimport { StepInvoice } from '../../steps/StepInvoice';                  // 14: Payment Processing\r\nimport { StepSuccess } from '../../steps/StepSuccess';                  // Success State\r\n\r\n// 14-Step Flow Configuration\r\nconst STEPS_COMPONENTS = [\r\n    StepPlantSelection,     // 1\r\n    StepGeneral,            // 2\r\n    StepFarm,               // 3\r\n    StepPlots,              // 4\r\n    StepProduction,         // 5 (Restored)\r\n    StepLots,               // 6 (New Integration)\r\n    StepProductionEstimate, // 7\r\n    StepHarvest,            // 8 (Restored)\r\n    StepDocuments,          // 9\r\n    StepPreCheck,           // 10 (Restored)\r\n    StepPreview,            // 11\r\n    StepSubmit,             // 12\r\n    StepQuote,              // 13 (Was 10)\r\n    StepInvoice,            // 14 (Was 11)\r\n    StepSuccess,            // Success (Post-14)\r\n];\r\n\r\n\r\nexport default function StepPage() {\r\n    const params = useParams();\r\n\r\n    // Parse ID from URL\r\n    const idStr = Array.isArray(params?.id) ? params.id[0] : params?.id;\r\n    const stepId = parseInt(idStr || '0', 10);\r\n\r\n    // Validate ID (1-12)\r\n    if (isNaN(stepId) || stepId < 1 || stepId > STEPS_COMPONENTS.length) {\r\n        notFound();\r\n    }\r\n\r\n    // Convert to 0-based index\r\n    const stepIndex = stepId - 1;\r\n    const StepComponent = STEPS_COMPONENTS[stepIndex];\r\n\r\n    const { setCurrentStep } = useWizardStore();\r\n    const hasSynced = React.useRef(false);\r\n\r\n    // Sync Store Step with URL Step - only once on mount\r\n    React.useEffect(() => {\r\n        if (!hasSynced.current) {\r\n            hasSynced.current = true;\r\n            setCurrentStep(stepIndex);\r\n        }\r\n    }, []); // Empty deps - only run on mount\r\n\r\n    return (\r\n        <div className=\"p-8\">\r\n            <StepComponent />\r\n        </div>\r\n    );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\InvoicePDF.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[416,419],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[416,419],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":42,"column":29,"nodeType":"JSXOpeningElement","endLine":42,"endColumn":114}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useWizardStore } from \"../hooks/useWizardStore\";\r\n\r\ninterface InvoicePDFProps {\r\n    invoiceNumber: string;\r\n    quoteNumber: string;\r\n    onClose: () => void;\r\n}\r\n\r\nexport const InvoicePDF = ({ invoiceNumber, quoteNumber, onClose }: InvoicePDFProps) => {\r\n    const { state } = useWizardStore();\r\n    const currentDate = new Date();\r\n\r\n    const applicant = (state.applicantData || {}) as any;\r\n    const name = applicant.firstName ? `${applicant.firstName} ${applicant.lastName || ''}` : \"เธเธฃเธดเธฉเธฑเธ— เธชเนเธกเธ เธเธฃเธนเธง เธเธณเธเธฑเธ”\";\r\n    const address = applicant.address || \"88/23 เธซเธกเธนเน 4 เธ–เธเธเธ•เธดเธงเธฒเธเธเธ—เน เธ•เธณเธเธฅเธ•เธฅเธฒเธ”เธเธงเธฑเธ เธญเธณเน€เธ เธญเน€เธกเธทเธญเธ เธเธฑเธเธซเธงเธฑเธ”เธเธเธ—เธเธธเธฃเธต 11000\";\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/70 z-[1100] flex items-center justify-center p-4 print:p-0 print:bg-white print:fixed print:inset-0 overflow-y-auto\" onClick={onClose}>\r\n            <div className=\"w-full max-w-[210mm] my-8 bg-white shadow-2xl animate-scale-in print:shadow-none print:w-full print:my-0\" onClick={e => e.stopPropagation()}>\r\n\r\n                {/* Print/Close Actions */}\r\n                <div className=\"flex justify-between items-center p-4 bg-slate-100 border-b border-slate-200 print:hidden sticky top-0 z-20\">\r\n                    <h3 className=\"font-bold text-slate-700\">เนเธเธงเธฒเธเธเธดเธฅ / เนเธเนเธเนเธเธซเธเธตเน (Official Template Preview)</h3>\r\n                    <div className=\"flex gap-2\">\r\n                        <button onClick={() => window.print()} className=\"px-4 py-2 bg-primary hover:bg-primary-600 text-white rounded-lg text-sm font-bold transition-all shadow-sm\">\r\n                            เธเธดเธกเธเนเน€เธญเธเธชเธฒเธฃ / Print\r\n                        </button>\r\n                        <button onClick={onClose} className=\"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg text-sm font-bold transition-all\">\r\n                            เธเธดเธ” / Close\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* A4 Content Context */}\r\n                <div className=\"p-[15mm] md:p-[20mm] font-serif text-black bg-white min-h-[297mm] leading-tight\">\r\n\r\n                    {/* Header Row */}\r\n                    <div className=\"flex justify-between items-start mb-6\">\r\n                        <div className=\"flex gap-4 items-center\">\r\n                            <img src=\"/dtam_logo_new.png\" alt=\"DTAM Logo\" className=\"w-20 h-20 object-contain\" />\r\n                            <div className=\"space-y-1\">\r\n                                <h1 className=\"text-[16pt] font-bold text-slate-900\">เธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน</h1>\r\n                                <h2 className=\"text-[14pt] font-bold text-slate-800\">เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</h2>\r\n                                <p className=\"text-[10pt] text-slate-600 leading-tight\">\r\n                                    88/23 เธซเธกเธนเน 4 เธ–เธเธเธ•เธดเธงเธฒเธเธเธ—เน เธ•เธณเธเธฅเธ•เธฅเธฒเธ”เธเธงเธฑเธ เธญเธณเน€เธ เธญเน€เธกเธทเธญเธ เธเธฑเธเธซเธงเธฑเธ”เธเธเธ—เธเธธเธฃเธต 11000<br />\r\n                                    เนเธ—เธฃเธจเธฑเธเธ—เน (02) 5647889 เธซเธฃเธทเธญ 061-4219701 เธญเธตเน€เธกเธฅเน tdc.cannabis.gacp@gmail.com\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"border-2 border-black px-4 py-2 text-center min-w-[180px]\">\r\n                            <h3 className=\"text-lg font-bold\">เนเธเธงเธฒเธเธเธดเธฅ/เนเธเนเธเนเธเธซเธเธตเน</h3>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"text-right text-[10pt] mb-4\">\r\n                        เธเธเธ. 18 เธเธฑเธเธงเธฒเธเธก 2568\r\n                    </div>\r\n\r\n                    {/* Meta Section */}\r\n                    <div className=\"border-2 border-black grid grid-cols-12 mb-2\">\r\n                        <div className=\"col-span-8 p-4 border-r-2 border-black space-y-2\">\r\n                            <p className=\"font-bold\">เน€เธฃเธตเธขเธ เธเธฃเธฐเธเธฒเธเธเธฃเธฃเธกเธเธฒเธฃ {name}</p>\r\n                            <div className=\"grid grid-cols-12 text-[10.5pt] gap-y-1\">\r\n                                <span className=\"col-span-4\">เธซเธเนเธงเธขเธเธฒเธเธเธนเนเธฃเธฑเธเธเธฃเธดเธเธฒเธฃ:</span>\r\n                                <span className=\"col-span-8 font-bold\">{name}</span>\r\n                                <span className=\"col-span-4\">เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธต:</span>\r\n                                <span className=\"col-span-8\">{applicant.taxId || \"0835566002415\"}</span>\r\n                                <span className=\"col-span-4\">เธ—เธตเนเธญเธขเธนเน:</span>\r\n                                <span className=\"col-span-8\">{address}</span>\r\n                                <span className=\"col-span-4\">เธเธนเนเธเธฃเธฐเธชเธฒเธเธเธฒเธ:</span>\r\n                                <span className=\"col-span-8\">เธเธธเธ“{applicant.firstName || \"เธเธธเธเธเธฃเธดเธเธ—เธฃเน\"} {applicant.lastName || \"เธเธฑเธงเธจเธฃเธต\"} เนเธ—เธฃเธจเธฑเธเธ—เน: {applicant.phone || \"-\"}</span>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"col-span-4 p-4 text-[10.5pt]\">\r\n                            <p>เน€เธฅเธเธ—เธตเนเน€เธญเธเธชเธฒเธฃ: {invoiceNumber}</p>\r\n                            <p>เธงเธฑเธเธ—เธตเน: {currentDate.toLocaleDateString('th-TH', { day: 'numeric', month: 'long', year: 'numeric' })}</p>\r\n                            <p className=\"mt-2 text-blue-700 font-bold\">เนเธเน€เธชเธเธญเธฃเธฒเธเธฒเน€เธฅเธเธ—เธตเน: {quoteNumber}</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <p className=\"text-[10.5pt] mb-4 font-bold\">\r\n                        เธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเนเธเธญเธเธณเธชเนเธเนเธเธงเธฒเธเธเธดเธฅ/เนเธเนเธเนเธเธซเธเธตเน เธ”เธฑเธเธฃเธฒเธขเธเธฒเธฃเธ•เนเธญเนเธเธเธตเน\r\n                    </p>\r\n\r\n                    {/* Table */}\r\n                    <table className=\"w-full border-2 border-black text-[10.5pt] mb-6\">\r\n                        <thead>\r\n                            <tr className=\"border-b-2 border-black bg-slate-50\">\r\n                                <th className=\"border-r-2 border-black py-2 w-16 text-center\">เธฅเธณเธ”เธฑเธเธ—เธตเน</th>\r\n                                <th className=\"border-r-2 border-black py-2 text-center\">เธฃเธฒเธขเธเธฒเธฃ</th>\r\n                                <th className=\"border-r-2 border-black py-2 w-16 text-center\">เธเธณเธเธงเธ</th>\r\n                                <th className=\"border-r-2 border-black py-2 w-16 text-center\">เธซเธเนเธงเธข</th>\r\n                                <th className=\"border-r-2 border-black py-2 w-24 text-center\">เธฃเธฒเธเธฒ/เธซเธเนเธงเธข</th>\r\n                                <th className=\"py-2 w-28 text-center\">เธเธณเธเธงเธเน€เธเธดเธ (เธเธฒเธ—)</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr className=\"border-b border-black/20\">\r\n                                <td className=\"border-r-2 border-black py-3 text-center\">1.</td>\r\n                                <td className=\"border-r-2 border-black py-3 px-4 text-left\">เธเนเธฒเธ•เธฃเธงเธเธชเธญเธเนเธฅเธฐเธเธฃเธฐเน€เธกเธดเธเธเธณเธเธญเธฃเธฑเธเธเธฒเธฃเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธเน€เธเธทเนเธญเธเธ•เนเธ</td>\r\n                                <td className=\"border-r-2 border-black py-3 text-center\">1</td>\r\n                                <td className=\"border-r-2 border-black py-3 text-center\">เธ•เนเธญเธเธณเธเธญ</td>\r\n                                <td className=\"border-r-2 border-black py-3 text-right px-2\">5,000.00</td>\r\n                                <td className=\"py-3 text-right px-2\">5,000.00</td>\r\n                            </tr>\r\n                            <tr className=\"border-b border-black\">\r\n                                <td className=\"border-r-2 border-black py-3 text-center\">2.</td>\r\n                                <td className=\"border-r-2 border-black py-3 px-4 text-left\">เธเนเธฒเธฃเธฑเธเธฃเธญเธเธเธฅเธเธฒเธฃเธเธฃเธฐเน€เธกเธดเธเนเธฅเธฐเธเธฑเธ”เธ—เธณเธซเธเธฑเธเธชเธทเธญเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ</td>\r\n                                <td className=\"border-r-2 border-black py-3 text-center\">1</td>\r\n                                <td className=\"border-r-2 border-black py-3 text-center\">เธ•เนเธญเธเธณเธเธญ</td>\r\n                                <td className=\"border-r-2 border-black py-3 text-right px-2\">25,000.00</td>\r\n                                <td className=\"py-3 text-right px-2\">25,000.00</td>\r\n                            </tr>\r\n                        </tbody>\r\n                        <tfoot>\r\n                            <tr className=\"font-bold border-t-2 border-black italic\">\r\n                                <td colSpan={4} className=\"border-r-2 border-black py-3 px-4\">(เธชเธฒเธกเธซเธกเธทเนเธเธเธฒเธ—เธ–เนเธงเธ)</td>\r\n                                <td className=\"border-r-2 border-black py-3 px-2 text-center\">เธเธณเธเธงเธเน€เธเธดเธเธ—เธฑเนเธเธชเธดเนเธ</td>\r\n                                <td className=\"py-3 text-right px-2\">30,000.00</td>\r\n                            </tr>\r\n                        </tfoot>\r\n                    </table>\r\n\r\n                    <div className=\"text-[10pt] mb-6 space-y-1\">\r\n                        <p><span className=\"font-bold\">เธซเธกเธฒเธขเน€เธซเธ•เธธ:</span> 1. เธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ : เธ เธฒเธขเนเธ 3 เธงเธฑเธ เธซเธฅเธฑเธเธเธฒเธเนเธ”เนเธฃเธฑเธเนเธเธงเธฒเธเธเธดเธฅ/เนเธเนเธเนเธเธซเธเธตเน</p>\r\n                        <p className=\"font-bold pl-4\">เนเธญเธเน€เธเธดเธเน€เธเนเธฒเธเธฑเธเธเธต</p>\r\n                        <p className=\"pl-6\">เธเธทเนเธญเธเธฑเธเธเธต เน€เธเธดเธเธเธณเธฃเธธเธเธจเธนเธเธขเนเธเธฑเธ’เธเธฒเธขเธฒเนเธเธเนเธ—เธขเนเธฅเธฐเธชเธกเธธเธเนเธเธฃ</p>\r\n                        <p className=\"pl-6\">เธเธฑเธเธเธตเธเธเธฒเธเธฒเธฃเธเธฃเธธเธเนเธ—เธข เน€เธฅเธเธ—เธตเน 4750134376 เธชเธฒเธเธฒเธกเธซเธฒเธงเธดเธ—เธขเธฒเธฅเธฑเธขเธเธฃเธฃเธกเธจเธฒเธชเธ•เธฃเน เธฃเธฑเธเธชเธดเธ•</p>\r\n                        <p className=\"pl-6\">เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธต 0994000036540</p>\r\n                        <p className=\"pl-12 font-bold underline\">เธเธฃเธ“เธตเธ—เธณเน€เธเนเธเธชเธฑเนเธเธเนเธฒเธขเนเธเธเธฒเธก : เน€เธเธดเธเธเธณเธฃเธธเธเธจเธนเธเธขเนเธเธฑเธ’เธเธฒเธขเธฒเนเธเธเนเธ—เธขเนเธฅเธฐเธชเธกเธธเธเนเธเธฃ</p>\r\n                        <p className=\"pt-2\"><span className=\"font-bold\">2. เธเธทเนเธญ-เธ—เธตเนเธญเธขเธนเนเนเธเธเธฒเธฃเธญเธญเธเนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธ เนเธฅเธฐเธเธฒเธฃเธชเนเธเธซเธฅเธฑเธเธเธฒเธเธเธณเธฃเธฐเน€เธเธดเธ :</span></p>\r\n                        <p className=\"pl-6\">เน€เธกเธทเนเธญเธเธณเธฃเธฐเน€เธเธดเธเนเธฅเนเธงเธเธฃเธธเธ“เธฒเธชเนเธ เธเธทเนเธญ-เธ—เธตเนเธญเธขเธนเนเนเธเธเธฒเธฃเธญเธญเธเนเธเน€เธชเธฃเนเธ เธเธฃเนเธญเธกเนเธเธเน€เธญเธเธชเธฒเธฃเธซเธฅเธฑเธเธเธฒเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ</p>\r\n                        <p className=\"pl-6\">เธกเธฒเธขเธฑเธเธเธญเธเธเธฑเธ’เธเธฒเธขเธฒเนเธเธเนเธ—เธขเนเธฅเธฐเธชเธกเธธเธเนเธเธฃเธ—เธฒเธ Google Form</p>\r\n\r\n                        <div className=\"flex justify-end pr-10\">\r\n                            <div className=\"text-center text-[8pt]\">\r\n                                <div className=\"w-16 h-16 border-2 border-black mx-auto flex items-center justify-center mb-1\">\r\n                                    <div className=\"w-12 h-12 bg-black\"></div>\r\n                                </div>\r\n                                <span className=\"font-bold\">เธเธฃเธธเธ“เธฒเธชเนเธเธเธเธดเธงเธญเธฒเธฃเนเนเธเนเธ”</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Signatures */}\r\n                    <div className=\"grid grid-cols-3 gap-0 border-2 border-black mb-8\">\r\n                        <div className=\"p-4 border-r-2 border-black text-center space-y-4 pb-16\">\r\n                            <p className=\"font-bold\">เธเธนเนเธฃเธฑเธเธเธฃเธดเธเธฒเธฃ</p>\r\n                            <div className=\"mt-12 text-center\">\r\n                                <p className=\"mb-2\">(......................................................)</p>\r\n                                <p>เธ•เธณเนเธซเธเนเธ......................................................</p>\r\n                                <p className=\"mt-1\">เธงเธฑเธเธ—เธตเน............/............/............</p>\r\n                                <p className=\"font-bold text-xs mt-4\">{name}</p>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"p-4 border-r-2 border-black text-center space-y-4 pb-16\">\r\n                            <p className=\"font-bold\">เธเธนเนเนเธซเนเธเธฃเธดเธเธฒเธฃ</p>\r\n                            <div className=\"mt-12 text-center text-[9pt]\">\r\n                                <p className=\"font-bold\">( เธเธฒเธขเธฃเธเธ• เนเธกเธเธเธเธฑเธเธเน )</p>\r\n                                <p>เธ•เธณเนเธซเธเนเธ เธเธฑเธเธงเธดเธเธฒเธเธฒเธฃเธชเธฒเธเธฒเธฃเธ“เธชเธธเธ</p>\r\n                                <p className=\"mt-1\">เธงเธฑเธเธ—เธตเน............/............/............</p>\r\n                                <p className=\"font-bold text-xs mt-4\">เธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน</p>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"p-4 text-center space-y-4 pb-16\">\r\n                            <p className=\"font-bold\">เธเธนเนเธกเธตเธญเธณเธเธฒเธเธฅเธเธเธฒเธก</p>\r\n                            <div className=\"mt-12 text-center text-[9pt]\">\r\n                                <p className=\"font-bold\">( เธเธฒเธขเธเธฃเธตเธเธฒ เธซเธเธนเธ—เธดเธก )</p>\r\n                                <p>เธ•เธณเนเธซเธเนเธ เธเธนเนเธญเธณเธเธงเธขเธเธฒเธฃเธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน</p>\r\n                                <p>เธเธเธดเธเธฑเธ•เธดเธฃเธฒเธเธเธฒเธฃเนเธ—เธ เธญเธเธดเธเธ”เธตเธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</p>\r\n                                <p className=\"mt-1\">เธงเธฑเธเธ—เธตเน............/............/............</p>\r\n                                <p className=\"font-bold text-xs mt-4\">เธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\MockInvoicePDF.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Link' is defined but never used.","line":1,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":12},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\MockInvoicePDF.tsx:8:62\n   6 |\n   7 | export const MockInvoicePDF = ({ onClose }: MockInvoiceProps) => {\n>  8 |     const invoiceNumber = `INV-${new Date().getFullYear()}${(Math.random() * 10000).toFixed(0)}`;\n     |                                                              ^^^^^^^^^^^^^ Cannot call impure function\n   9 |     const currentDate = new Date();\n  10 |     const dueDate = new Date();\n  11 |     dueDate.setDate(dueDate.getDate() + 7);","line":8,"column":62,"nodeType":null,"endLine":8,"endColumn":75},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":36,"column":29,"nodeType":"JSXOpeningElement","endLine":36,"endColumn":114}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import Link from \"next/link\";\r\n\r\ninterface MockInvoiceProps {\r\n    onClose: () => void;\r\n}\r\n\r\nexport const MockInvoicePDF = ({ onClose }: MockInvoiceProps) => {\r\n    const invoiceNumber = `INV-${new Date().getFullYear()}${(Math.random() * 10000).toFixed(0)}`;\r\n    const currentDate = new Date();\r\n    const dueDate = new Date();\r\n    dueDate.setDate(dueDate.getDate() + 7);\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/70 z-[1100] flex items-center justify-center p-4 print:p-0 print:bg-white print:fixed print:inset-0\" onClick={onClose}>\r\n            <div className=\"w-full max-w-[210mm] max-h-[90vh] overflow-y-auto bg-white shadow-2xl animate-scale-in print:shadow-none print:w-full print:max-h-full print:overflow-visible\" onClick={e => e.stopPropagation()}>\r\n\r\n                {/* Print/Close Actions */}\r\n                <div className=\"flex justify-between items-center p-4 bg-slate-100 border-b border-slate-200 print:hidden sticky top-0 z-10\">\r\n                    <h3 className=\"font-bold text-slate-700\">เธ•เธฑเธงเธญเธขเนเธฒเธเน€เธญเธเธชเธฒเธฃ (Preview)</h3>\r\n                    <div className=\"flex gap-2\">\r\n                        <button onClick={() => window.print()} className=\"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg text-sm font-medium transition-colors\">\r\n                            เธเธดเธกเธเน / Print\r\n                        </button>\r\n                        <button onClick={onClose} className=\"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm font-medium transition-colors\">\r\n                            เธเธดเธ” (Close)\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* A4 Content */}\r\n                <div className=\"p-[20mm] font-[Sarabun] text-black bg-white min-h-[297mm]\">\r\n\r\n                    {/* Header */}\r\n                    <div className=\"flex items-start justify-between border-b-2 border-blue-600 pb-6 mb-8\">\r\n                        <div className=\"flex items-start gap-4\">\r\n                            <img src=\"/dtam_logo_new.png\" alt=\"DTAM Logo\" className=\"w-16 h-16 object-contain\" />\r\n                            <div>\r\n                                <h1 className=\"text-xl font-bold text-blue-900\">เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</h1>\r\n                                <p className=\"text-xs text-slate-600 mt-1\">Department of Thai Traditional and Alternative Medicine</p>\r\n                                <p className=\"text-[10px] text-slate-500\">88/23 เธซเธกเธนเน 4 เธ–เธเธเธ•เธดเธงเธฒเธเธเธ—เน เธ•เธณเธเธฅเธ•เธฅเธฒเธ”เธเธงเธฑเธ เธญเธณเน€เธ เธญเน€เธกเธทเธญเธ เธเธฑเธเธซเธงเธฑเธ”เธเธเธ—เธเธธเธฃเธต 11000</p>\r\n                                <p className=\"text-[10px] text-slate-500\">เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธต: 0994000165xx</p>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                            <div className=\"inline-block px-4 py-1 bg-blue-100 text-blue-800 text-sm font-bold border border-blue-200 rounded mb-2\">\r\n                                เนเธเธงเธฒเธเธเธดเธฅ/เนเธเนเธเธซเธเธตเน (INVOICE)\r\n                            </div>\r\n                            <p className=\"text-sm\">เน€เธฅเธเธ—เธตเน: <span className=\"font-mono font-bold\">{invoiceNumber}</span></p>\r\n                            <p className=\"text-sm\">เธงเธฑเธเธ—เธตเน: {currentDate.toLocaleDateString('th-TH')}</p>\r\n                            <p className=\"text-sm text-red-600 font-bold\">เธงเธฑเธเธเธฃเธเธเธณเธซเธเธ”: {dueDate.toLocaleDateString('th-TH')}</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Customer Info */}\r\n                    <div className=\"flex gap-8 mb-8\">\r\n                        <div className=\"flex-1 p-4 border border-slate-200 rounded bg-slate-50\">\r\n                            <p className=\"text-xs text-slate-500 mb-1\">เน€เธฃเธตเธขเธเน€เธเนเธเน€เธเธดเธเธเธฒเธ (Bill To):</p>\r\n                            <p className=\"font-bold text-lg\">เธเธนเนเธขเธทเนเธเธเธณเธเธญเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP</p>\r\n                            <p className=\"text-sm text-slate-700\">เธ—เธตเนเธญเธขเธนเน: เธ•เธฒเธกเธ—เธตเนเธฃเธฐเธเธธเนเธเธเธณเธเธญ</p>\r\n                        </div>\r\n                        <div className=\"flex-1 p-4 border border-slate-200 rounded bg-slate-50\">\r\n                            <div className=\"flex justify-between items-start\">\r\n                                <div>\r\n                                    <p className=\"text-xs text-slate-500 mb-1\">เธชเธ–เธฒเธเธฐเน€เธญเธเธชเธฒเธฃ (Status):</p>\r\n                                    <span className=\"inline-flex items-center gap-1.5 px-3 py-1 bg-amber-100 text-amber-700 rounded-full text-xs font-bold border border-amber-200\">\r\n                                        เธฃเธญเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ (Waiting for Payment)\r\n                                    </span>\r\n                                </div>\r\n                                <div className=\"text-right\">\r\n                                    <p className=\"text-xs text-slate-500 mb-1\">เธเนเธญเธเธ—เธฒเธเธเธณเธฃเธฐเน€เธเธดเธ:</p>\r\n                                    <p className=\"text-sm font-bold\">QR Payment / Transfer</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Table */}\r\n                    <table className=\"w-full text-sm mb-8\">\r\n                        <thead>\r\n                            <tr className=\"bg-blue-800 text-white\">\r\n                                <th className=\"py-3 px-4 text-center w-16 border border-blue-900\">เธฅเธณเธ”เธฑเธ</th>\r\n                                <th className=\"py-3 px-4 text-left border border-blue-900\">เธฃเธฒเธขเธเธฒเธฃ (Description)</th>\r\n                                <th className=\"py-3 px-4 text-right w-32 border border-blue-900\">เธเธณเธเธงเธเน€เธเธดเธ (เธเธฒเธ—)</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y divide-slate-200 border border-slate-200\">\r\n                            <tr>\r\n                                <td className=\"py-4 px-4 text-center align-top border-r border-slate-200\">1</td>\r\n                                <td className=\"py-4 px-4 align-top border-r border-slate-200\">\r\n                                    <p className=\"font-bold\">เธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธกเธเธณเธเธญเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP</p>\r\n                                    <p className=\"text-xs text-slate-500 mt-1\">Application Fee for GACP Certification</p>\r\n                                </td>\r\n                                <td className=\"py-4 px-4 text-right align-top\">100.00</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td className=\"py-4 px-4 text-center align-top border-r border-slate-200\">2</td>\r\n                                <td className=\"py-4 px-4 align-top border-r border-slate-200\">\r\n                                    <p className=\"font-bold\">เธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธกเนเธเธฅเธเธเธฅเธนเธ (Plot Fee)</p>\r\n                                    <p className=\"text-xs text-slate-500 mt-1\">Additional Zones Calculation (1 Unit)</p>\r\n                                </td>\r\n                                <td className=\"py-4 px-4 text-right align-top\">50.00</td>\r\n                            </tr>\r\n                        </tbody>\r\n                        <tfoot className=\"border-t-2 border-slate-300\">\r\n                            <tr>\r\n                                <td colSpan={2} className=\"py-3 px-4 text-right font-bold text-slate-700\">เธฃเธงเธกเน€เธเนเธเน€เธเธดเธ (Total)</td>\r\n                                <td className=\"py-3 px-4 text-right font-bold text-slate-900 border border-slate-200 bg-slate-50\">150.00</td>\r\n                            </tr>\r\n                            <tr className=\"bg-blue-50\">\r\n                                <td colSpan={2} className=\"py-4 px-4 text-right font-bold text-blue-900 text-lg\">เธขเธญเธ”เธเธณเธฃเธฐเธชเธธเธ—เธเธด (Net Amount)</td>\r\n                                <td className=\"py-4 px-4 text-right font-bold text-blue-900 text-lg border border-slate-200\">150.00</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td colSpan={3} className=\"py-2 text-center text-xs italic text-slate-500 bg-slate-50\">\r\n                                    (เธซเธเธถเนเธเธฃเนเธญเธขเธซเนเธฒเธชเธดเธเธเธฒเธ—เธ–เนเธงเธ)\r\n                                </td>\r\n                            </tr>\r\n                        </tfoot>\r\n                    </table>\r\n\r\n                    {/* Payment Info */}\r\n                    <div className=\"bg-slate-50 border border-slate-200 rounded-lg p-6 mb-8 flex gap-6 items-center\">\r\n                        <div className=\"w-24 h-24 bg-white border border-slate-300 flex items-center justify-center shrink-0\">\r\n                            <div className=\"text-center\">\r\n                                <span className=\"text-[10px] text-slate-400\">QR</span>\r\n                            </div>\r\n                        </div>\r\n                        <div>\r\n                            <p className=\"font-bold text-blue-900 mb-1\">เธเธณเธฃเธฐเน€เธเธดเธเธเนเธฒเธ QR Code (Scan to Pay)</p>\r\n                            <p className=\"text-xs text-slate-600 mb-2\">เธชเธฒเธกเธฒเธฃเธ–เธชเนเธเธเนเธ”เนเธ”เนเธงเธขเนเธญเธเธเธฅเธดเน€เธเธเธฑเธเธเธเธฒเธเธฒเธฃเธ—เธธเธเธเธเธฒเธเธฒเธฃ</p>\r\n                            <div className=\"text-xs text-slate-500\">\r\n                                OR Transfer: <strong>Krungthai Bank</strong> | Account: <strong>067-0-xxxxx-5</strong><br />\r\n                                Name: <strong>Dept of Thai Traditional Medicine</strong>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Footer / Notes */}\r\n                    <div className=\"grid grid-cols-2 gap-12 mt-4\">\r\n                        <div></div>\r\n                        <div className=\"text-center\">\r\n                            <div className=\"h-16 flex items-center justify-center mb-2\">\r\n                                {/* Digital Signature Placeholder */}\r\n                                <div className=\"text-blue-500 opacity-50 font-script text-2xl\">Digital Signed</div>\r\n                            </div>\r\n                            <p className=\"text-sm font-bold border-t border-slate-400 pt-2 inline-block min-w-[200px]\">เน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธเธฒเธฃเน€เธเธดเธ</p>\r\n                            <p className=\"text-xs text-slate-500 mt-1\">เธเธนเนเนเธ”เนเธฃเธฑเธเธกเธญเธเธญเธณเธเธฒเธ</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\MockQuotePDF.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\MockQuotePDF.tsx:12:48\n  10 |     const { state } = useWizardStore();\n  11 |     const currentDate = new Date();\n> 12 |     const quoteNumber = `G-${String(Math.floor(Math.random() * 900000000) + 100000000)}`;\n     |                                                ^^^^^^^^^^^^^ Cannot call impure function\n  13 |\n  14 |     const applicant = (state.applicantData || {}) as any;\n  15 |     const name = applicant.firstName ? `${applicant.firstName} ${applicant.lastName || ''}` : \"เธเธฃเธดเธฉเธฑเธ— เธชเนเธกเธ เธเธฃเธนเธง เธเธณเธเธฑเธ”\";","line":12,"column":48,"nodeType":null,"endLine":12,"endColumn":61},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[425,428],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[425,428],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":41,"column":29,"nodeType":"JSXOpeningElement","endLine":41,"endColumn":114}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useWizardStore } from \"../hooks/useWizardStore\";\r\n\r\ninterface MockQuoteProps {\r\n    onClose: () => void;\r\n}\r\n\r\nexport const MockQuotePDF = ({ onClose }: MockQuoteProps) => {\r\n    const { state } = useWizardStore();\r\n    const currentDate = new Date();\r\n    const quoteNumber = `G-${String(Math.floor(Math.random() * 900000000) + 100000000)}`;\r\n\r\n    const applicant = (state.applicantData || {}) as any;\r\n    const name = applicant.firstName ? `${applicant.firstName} ${applicant.lastName || ''}` : \"เธเธฃเธดเธฉเธฑเธ— เธชเนเธกเธ เธเธฃเธนเธง เธเธณเธเธฑเธ”\";\r\n    const address = applicant.address || \"88/23 เธซเธกเธนเน 4 เธ–เธเธเธ•เธดเธงเธฒเธเธเธ—เน เธ•เธณเธเธฅเธ•เธฅเธฒเธ”เธเธงเธฑเธ เธญเธณเน€เธ เธญเน€เธกเธทเธญเธ เธเธฑเธเธซเธงเธฑเธ”เธเธเธ—เธเธธเธฃเธต 11000\";\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/70 z-[1100] flex items-center justify-center p-4 print:p-0 print:bg-white print:fixed print:inset-0 overflow-y-auto\" onClick={onClose}>\r\n            <div className=\"w-full max-w-[210mm] my-8 bg-white shadow-2xl animate-scale-in print:shadow-none print:w-full print:my-0\" onClick={e => e.stopPropagation()}>\r\n\r\n                {/* Print/Close Actions */}\r\n                <div className=\"flex justify-between items-center p-4 bg-slate-100 border-b border-slate-200 print:hidden sticky top-0 z-20\">\r\n                    <h3 className=\"font-bold text-slate-700\">เนเธเน€เธชเธเธญเธฃเธฒเธเธฒ (Official Template Preview)</h3>\r\n                    <div className=\"flex gap-2\">\r\n                        <button onClick={() => window.print()} className=\"px-4 py-2 bg-primary hover:bg-primary-600 text-white rounded-lg text-sm font-bold transition-all shadow-sm\">\r\n                            เธเธดเธกเธเนเน€เธญเธเธชเธฒเธฃ / Print\r\n                        </button>\r\n                        <button onClick={onClose} className=\"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg text-sm font-bold transition-all\">\r\n                            เธเธดเธ” / Close\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* A4 Content Context */}\r\n                <div className=\"p-[15mm] md:p-[20mm] font-serif text-black bg-white min-h-[297mm] leading-tight\">\r\n\r\n                    {/* Header Row */}\r\n                    <div className=\"flex justify-between items-start mb-6\">\r\n                        <div className=\"flex gap-4 items-center\">\r\n                            <img src=\"/dtam_logo_new.png\" alt=\"DTAM Logo\" className=\"w-20 h-20 object-contain\" />\r\n                            <div className=\"space-y-1\">\r\n                                <h1 className=\"text-[16pt] font-bold text-slate-900\">เธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน</h1>\r\n                                <h2 className=\"text-[14pt] font-bold text-slate-800\">เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</h2>\r\n                                <p className=\"text-[10pt] text-slate-600 leading-tight\">\r\n                                    88/23 เธซเธกเธนเน 4 เธ–เธเธเธ•เธดเธงเธฒเธเธเธ—เน เธ•เธณเธเธฅเธ•เธฅเธฒเธ”เธเธงเธฑเธ เธญเธณเน€เธ เธญเน€เธกเธทเธญเธ เธเธฑเธเธซเธงเธฑเธ”เธเธเธ—เธเธธเธฃเธต 11000<br />\r\n                                    เนเธ—เธฃเธจเธฑเธเธ—เน (02) 5647889 เธซเธฃเธทเธญ 061-4219701 เธญเธตเน€เธกเธฅเน tdc.cannabis.gacp@gmail.com\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"border-2 border-black px-6 py-2\">\r\n                            <h3 className=\"text-xl font-bold\">เนเธเน€เธชเธเธญเธฃเธฒเธเธฒ</h3>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"text-right text-[10pt] mb-4\">\r\n                        เธเธเธ. 18 เธเธฑเธเธงเธฒเธเธก 2568\r\n                    </div>\r\n\r\n                    {/* Meta Section */}\r\n                    <div className=\"border-2 border-black grid grid-cols-12 mb-6\">\r\n                        <div className=\"col-span-8 p-4 border-r-2 border-black space-y-2\">\r\n                            <p className=\"font-bold\">เน€เธฃเธตเธขเธ เธเธฃเธฐเธเธฒเธเธเธฃเธฃเธกเธเธฒเธฃ {name}</p>\r\n                            <div className=\"grid grid-cols-12 text-[10.5pt] gap-y-1\">\r\n                                <span className=\"col-span-4\">เธซเธเนเธงเธขเธเธฒเธเธเธนเนเธฃเธฑเธเธเธฃเธดเธเธฒเธฃ:</span>\r\n                                <span className=\"col-span-8 font-bold\">{name}</span>\r\n                                <span className=\"col-span-4\">เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธต:</span>\r\n                                <span className=\"col-span-8\">{applicant.taxId || \"0835566002415\"}</span>\r\n                                <span className=\"col-span-4\">เธ—เธตเนเธญเธขเธนเน:</span>\r\n                                <span className=\"col-span-8\">{address}</span>\r\n                                <span className=\"col-span-4\">เธเธนเนเธเธฃเธฐเธชเธฒเธเธเธฒเธ:</span>\r\n                                <span className=\"col-span-8\">เธเธธเธ“{applicant.firstName || \"เธเธธเธเธเธฃเธดเธเธ—เธฃเน\"} {applicant.lastName || \"เธเธฑเธงเธจเธฃเธต\"} เนเธ—เธฃเธจเธฑเธเธ—เน: {applicant.phone || \"-\"}</span>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"col-span-4 p-4 text-[10.5pt]\">\r\n                            <p>เน€เธฅเธเธ—เธตเนเน€เธญเธเธชเธฒเธฃ: {quoteNumber}</p>\r\n                            <p>เธงเธฑเธเธ—เธตเนเน€เธญเธเธชเธฒเธฃ: {currentDate.toLocaleDateString('th-TH', { day: 'numeric', month: 'long', year: 'numeric' })}</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <p className=\"text-[10.5pt] mb-6\">\r\n                        เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ เนเธ”เธขเธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน\r\n                        เธกเธตเธเธงเธฒเธกเธขเธดเธเธ”เธตเธ—เธตเนเธเธฐเน€เธชเธเธญเธฃเธฒเธเธฒเธเนเธฒเธเธฃเธดเธเธฒเธฃเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธเนเธฅเธฐเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธเธเธฒเธฃเน€เธเธฒเธฐเธเธฅเธนเธเนเธฅเธฐเน€เธเนเธเน€เธเธตเนเธขเธงเธ—เธตเนเธ”เธตเธเธญเธเธเธทเธเธเธฑเธเธเธฒ\r\n                        (Good Agricultural and Collection Practices) เธ”เธฑเธเธฃเธฒเธขเธเธฒเธฃเธ•เนเธญเนเธเธเธตเน\r\n                    </p>\r\n\r\n                    {/* Table */}\r\n                    <table className=\"w-full border-2 border-black text-[10.5pt] mb-6\">\r\n                        <thead>\r\n                            <tr className=\"border-b-2 border-black\">\r\n                                <th className=\"border-r-2 border-black py-2 w-16 text-center\">เธฅเธณเธ”เธฑเธเธ—เธตเน</th>\r\n                                <th className=\"border-r-2 border-black py-2 text-center\">เธฃเธฒเธขเธเธฒเธฃ</th>\r\n                                <th className=\"border-r-2 border-black py-2 w-16 text-center\">เธเธณเธเธงเธ</th>\r\n                                <th className=\"border-r-2 border-black py-2 w-16 text-center\">เธซเธเนเธงเธข</th>\r\n                                <th className=\"border-r-2 border-black py-2 w-24 text-center\">เธฃเธฒเธเธฒ/เธซเธเนเธงเธข</th>\r\n                                <th className=\"py-2 w-28 text-center\">เธเธณเธเธงเธเน€เธเธดเธ (เธเธฒเธ—)</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr className=\"border-b border-black/20\">\r\n                                <td className=\"border-r-2 border-black py-3 text-center\">1.</td>\r\n                                <td className=\"border-r-2 border-black py-3 px-4 text-left\">เธเนเธฒเธ•เธฃเธงเธเธชเธญเธเนเธฅเธฐเธเธฃเธฐเน€เธกเธดเธเธเธณเธเธญเธฃเธฑเธเธเธฒเธฃเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธเน€เธเธทเนเธญเธเธ•เนเธ</td>\r\n                                <td className=\"border-r-2 border-black py-3 text-center\">1</td>\r\n                                <td className=\"border-r-2 border-black py-3 text-center\">เธ•เนเธญเธเธณเธเธญ</td>\r\n                                <td className=\"border-r-2 border-black py-3 text-right px-2\">5,000.00</td>\r\n                                <td className=\"py-3 text-right px-2\">5,000.00</td>\r\n                            </tr>\r\n                            <tr className=\"border-b border-black\">\r\n                                <td className=\"border-r-2 border-black py-3 text-center\">2.</td>\r\n                                <td className=\"border-r-2 border-black py-3 px-4 text-left\">เธเนเธฒเธฃเธฑเธเธฃเธญเธเธเธฅเธเธฒเธฃเธเธฃเธฐเน€เธกเธดเธเนเธฅเธฐเธเธฑเธ”เธ—เธณเธซเธเธฑเธเธชเธทเธญเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ</td>\r\n                                <td className=\"border-r-2 border-black py-3 text-center\">1</td>\r\n                                <td className=\"border-r-2 border-black py-3 text-center\">เธ•เนเธญเธเธณเธเธญ</td>\r\n                                <td className=\"border-r-2 border-black py-3 text-right px-2\">25,000.00</td>\r\n                                <td className=\"py-3 text-right px-2\">25,000.00</td>\r\n                            </tr>\r\n                        </tbody>\r\n                        <tfoot>\r\n                            <tr className=\"font-bold border-t-2 border-black italic\">\r\n                                <td colSpan={4} className=\"border-r-2 border-black py-3 px-4\">(เธชเธฒเธกเธซเธกเธทเนเธเธเธฒเธ—เธ–เนเธงเธ)</td>\r\n                                <td className=\"border-r-2 border-black py-3 px-2 text-center\">เธเธณเธเธงเธเน€เธเธดเธเธ—เธฑเนเธเธชเธดเนเธ</td>\r\n                                <td className=\"py-3 text-right px-2\">30,000.00</td>\r\n                            </tr>\r\n                        </tfoot>\r\n                    </table>\r\n\r\n                    <p className=\"text-[10pt] font-bold mb-8\">เธ—เธฑเนเธเธเธตเนเธ—เนเธฒเธเนเธ”เนเธ•เธฃเธงเธเธชเธญเธเธฃเธฒเธขเธเธฒเธฃเธเธณเธเธงเธเนเธฅเธฐเธฃเธฒเธเธฒเธเนเธฒเธเธ•เนเธเน€เธฃเธตเธขเธเธฃเนเธญเธขเนเธฅเนเธง</p>\r\n\r\n                    {/* Signatures */}\r\n                    <div className=\"grid grid-cols-2 gap-0 border-2 border-black mb-8\">\r\n                        <div className=\"p-4 border-r-2 border-black text-center space-y-4 pb-12\">\r\n                            <p className=\"font-bold\">เธขเธทเธเธขเธฑเธเธเธณเธเธญเธฃเธฑเธเธเธฒเธฃเธ•เธฃเธงเธเธชเธญเธเนเธฅเธฐเธเธฃเธฐเน€เธกเธดเธ</p>\r\n                            <div className=\"mt-12 text-center\">\r\n                                <p className=\"mb-2\">(......................................................)</p>\r\n                                <p>เธ•เธณเนเธซเธเนเธ......................................................</p>\r\n                                <p className=\"mt-2\">เธงเธฑเธเธ—เธตเน............/............/............</p>\r\n                                <p className=\"font-bold text-xs mt-4\">เธเธนเนเธญเธเธธเธกเธฑเธ•เธดเธเธณเธเธญ</p>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"p-4 text-center space-y-4 pb-12\">\r\n                            <p className=\"font-bold\">เนเธเธเธฒเธก เธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน</p>\r\n                            <div className=\"mt-12 text-center text-[10pt]\">\r\n                                <p className=\"font-bold\">( เธเธฒเธขเธเธฃเธตเธเธฒ เธซเธเธนเธ—เธดเธก )</p>\r\n                                <p>เธ•เธณเนเธซเธเนเธ เธเธนเนเธญเธณเธเธงเธขเธเธฒเธฃเธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน</p>\r\n                                <p>เธเธเธดเธเธฑเธ•เธดเธฃเธฒเธเธเธฒเธฃเนเธ—เธ เธญเธเธดเธเธ”เธตเธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</p>\r\n                                <p className=\"mt-2\">เธงเธฑเธเธ—เธตเน............/............/............</p>\r\n                                <p className=\"font-bold text-xs mt-4\">(เธเธนเนเน€เธชเธเธญเธฃเธฒเธเธฒ)</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Bank & Footer */}\r\n                    <div className=\"text-[9pt] space-y-1\">\r\n                        <p><span className=\"font-bold\">เธซเธกเธฒเธขเน€เธซเธ•เธธ:</span> เน€เธเธทเนเธญเธเธเธฒเธเธเธฃเธดเธฉเธฑเธ— {name} เธขเธทเนเธเน€เธญเธเธชเธฒเธฃเน€เธกเธทเนเธญเธงเธฑเธเธ—เธตเน {new Date().toLocaleDateString('th-TH')} เธเธถเธเน€เธชเธเธญเธฃเธฒเธเธฒเธ•เธฒเธกเธเธฃเธฐเธเธฒเธจเธญเธฑเธ•เธฃเธฒเธเนเธฒเธเธฃเธดเธเธฒเธฃ เธเธญเธเธเธฑเธ’เธเธฒเธขเธฒเนเธเธเนเธ—เธขเนเธฅเธฐเธชเธกเธธเธเนเธเธฃ</p>\r\n                        <p><span className=\"font-bold\">เน€เธเธทเนเธญเธเนเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ :</span> เธเธฃเธธเธ“เธฒเธเธณเธฃเธฐเน€เธเธดเธเธ เธฒเธขเนเธ 3 เธงเธฑเธ</p>\r\n                        <ul className=\"list-disc list-inside pl-4\">\r\n                            <li>เธชเนเธเน€เธญเธเธชเธฒเธฃเธเธธเธ”เธเธณเธเธญเธเนเธฒเธ 2 เธเนเธญเธเธ—เธฒเธ เธ—เธฒเธเนเธเธฃเธฉเธ“เธตเธขเนเธซเธฃเธทเธญเธขเธทเนเธเธ”เนเธงเธขเธ•เธเน€เธญเธ</li>\r\n                            <li>เธเธทเนเธญเธเธฑเธเธเธต เน€เธเธดเธเธเธณเธฃเธธเธเธจเธนเธเธขเนเธเธฑเธ’เธเธฒเธขเธฒเนเธเธเนเธ—เธขเนเธฅเธฐเธชเธกเธธเธเนเธเธฃ</li>\r\n                            <li>เธเธฑเธเธเธตเธเธเธฒเธเธฒเธฃเธเธฃเธธเธเนเธ—เธข เน€เธฅเธเธ—เธตเน 4750134376 เธชเธฒเธเธฒเธกเธซเธฒเธงเธดเธ—เธขเธฒเธฅเธฑเธขเธเธฃเธฃเธกเธจเธฒเธชเธ•เธฃเน เธฃเธฑเธเธชเธดเธ•</li>\r\n                            <li>เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธต 0994000036540</li>\r\n                            <li>เน€เธกเธทเนเธญเธเธณเธฃเธฐเน€เธเธดเธเนเธฅเนเธงเธเธฃเธธเธ“เธฒเธชเนเธ เธเธทเนเธญ-เธ—เธตเนเธญเธขเธนเนเนเธเธเธฒเธฃเธญเธญเธเนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธ เธเธฃเนเธญเธกเน€เธญเธเธชเธฒเธฃเธซเธฅเธฑเธเธเธฒเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ เธกเธฒเธขเธฑเธเธเธญเธเธเธฑเธ’เธเธฒเธขเธฒเนเธเธเนเธ—เธขเนเธฅเธฐเธชเธกเธธเธเนเธเธฃเธ—เธฒเธ Google Form</li>\r\n                        </ul>\r\n\r\n                        <div className=\"flex justify-end mt-4\">\r\n                            <div className=\"text-center text-[8pt]\">\r\n                                <div className=\"w-16 h-16 bg-slate-100 border border-slate-200 mx-auto flex items-center justify-center mb-1\">\r\n                                    <div className=\"w-12 h-12 bg-black\"></div>\r\n                                </div>\r\n                                <span>เธเธฃเธธเธ“เธฒเธชเนเธเธเธเธดเธงเธญเธฒเธฃเนเนเธเนเธ”</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\PlatformInvoicePDF.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\PlatformQuotePDF.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepDocuments.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'InfoIcon' is defined but never used.","line":12,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":13},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":173,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":173,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7617,7620],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7617,7620],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":327,"column":107,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":327,"endColumn":110,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18151,18154],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18151,18154],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useWizardStore } from '../hooks/useWizardStore';\r\nimport { useRouter } from 'next/navigation';\r\nimport { WizardNavigation } from '@/components/wizard/WizardNavigation';\r\nimport { FormLabelWithHint } from '@/components/FormHint';\r\nimport {\r\n    CheckIcon,\r\n    UploadIcon,\r\n    WarningIcon,\r\n    InfoIcon,\r\n    DocIcon\r\n} from '@/components/icons/WizardIcons';\r\nimport { useLanguage } from '@/lib/i18n/LanguageContext';\r\nimport { Icons } from '@/components/ui/icons';\r\n\r\n// Mapping slotId to ExpectedType for AI Analysis\r\nconst AI_DOC_TYPES: Record<string, string> = {\r\n    'id_card': 'ID_CARD',\r\n    'house_reg': 'HOUSE_REGISTRATION',\r\n    'land_deed': 'LAND_TITLE_DEED',\r\n    'company_reg': 'COMPANY_REGISTRATION',\r\n    'license_bt11': 'LICENSE_BT11',\r\n};\r\n\r\ninterface DocRequirement {\r\n    slotId: string;\r\n    nameKey: keyof import('@/lib/i18n/types').Dictionary['wizard']['documents']['docNames'];\r\n    required: boolean;\r\n    conditionalRequired?: boolean;\r\n    helperText?: string;\r\n    templateUrl?: string;\r\n}\r\n\r\nexport const StepDocuments = () => {\r\n    const { state, setDocuments, setYoutubeUrl: saveToStoreYoutubeUrl } = useWizardStore();\r\n    const router = useRouter();\r\n    const { dict, language } = useLanguage();\r\n\r\n    // State\r\n    const [requirements, setRequirements] = useState<DocRequirement[]>([]);\r\n    const [loadingReqs, setLoadingReqs] = useState(true);\r\n    const [youtubeUrl, setYoutubeUrl] = useState(state.youtubeUrl || '');\r\n    const [uploading, setUploading] = useState<Record<string, boolean>>({});\r\n    const [aiResults, setAiResults] = useState<Record<string, { valid: boolean; message: string; confidence?: number }>>({});\r\n\r\n    // Sync store state to local state on mount\r\n    useEffect(() => {\r\n        if (state.youtubeUrl) setYoutubeUrl(state.youtubeUrl);\r\n    }, [state.youtubeUrl]);\r\n\r\n    // Fetch Requirements\r\n    useEffect(() => {\r\n        const fetchRequirements = async () => {\r\n            setLoadingReqs(true);\r\n            try {\r\n                // Determine requirements based on state\r\n                const isHighControl = ['cannabis', 'kratom'].includes(state.plantId || '');\r\n                const isExport = state.certificationPurpose === 'EXPORT';\r\n\r\n                const coreReqs: DocRequirement[] = [\r\n                    {\r\n                        slotId: 'APP_FORM',\r\n                        nameKey: 'APP_FORM',\r\n                        required: true,\r\n                        templateUrl: '/templates/application_form_v2.pdf'\r\n                    },\r\n                    { slotId: 'house_reg', nameKey: 'house_reg', required: true },\r\n                    { slotId: 'land_deed', nameKey: 'land_deed', required: true },\r\n                    {\r\n                        slotId: 'land_consent',\r\n                        nameKey: 'land_consent',\r\n                        required: false,\r\n                        conditionalRequired: state.siteData?.landOwnership === 'RENT' || state.siteData?.landOwnership === 'CONSENT',\r\n                        templateUrl: '/templates/land_consent_form.pdf'\r\n                    },\r\n                    { slotId: 'site_map', nameKey: 'site_map', required: true },\r\n                    { slotId: 'building_plan', nameKey: 'building_plan', required: true },\r\n                    { slotId: 'photos_exterior', nameKey: 'photos_exterior', required: true },\r\n                    { slotId: 'photos_interior', nameKey: 'photos_interior', required: true },\r\n                    { slotId: 'production_plan', nameKey: 'production_plan', required: true, templateUrl: '/templates/production_plan_template.xlsx' },\r\n                    { slotId: 'security_measures', nameKey: 'security_measures', required: true },\r\n                    { slotId: 'medical_cert', nameKey: 'medical_cert', required: false },\r\n                ];\r\n\r\n                if (isHighControl) {\r\n                    coreReqs.push({ slotId: 'elearning_cert', nameKey: 'elearning_cert', required: true });\r\n                    coreReqs.push({ slotId: 'strain_cert', nameKey: 'strain_cert', required: true });\r\n                }\r\n\r\n                const exportReqs: DocRequirement[] = [\r\n                    { slotId: 'sop_thai', nameKey: 'sop_thai', required: true, templateUrl: '/templates/sop_guideline.pdf' },\r\n                    { slotId: 'training_records', nameKey: 'training_records', required: true },\r\n                    { slotId: 'staff_test', nameKey: 'staff_test', required: true },\r\n                    { slotId: 'soil_water_test', nameKey: 'soil_water_test', required: true },\r\n                    { slotId: 'flower_test', nameKey: 'flower_test', required: true },\r\n                    { slotId: 'input_report', nameKey: 'input_report', required: true },\r\n                    { slotId: 'cp_ccp_plan', nameKey: 'cp_ccp_plan', required: true },\r\n                    { slotId: 'calibration_cert', nameKey: 'calibration_cert', required: true },\r\n                ];\r\n\r\n                const finalReqs = [...coreReqs];\r\n                if (isExport) {\r\n                    finalReqs.push(...exportReqs);\r\n                }\r\n\r\n                setTimeout(() => {\r\n                    setRequirements(finalReqs);\r\n                    setLoadingReqs(false);\r\n                }, 800);\r\n\r\n            } catch (err) {\r\n                console.error(err);\r\n                setLoadingReqs(false);\r\n            }\r\n        };\r\n        fetchRequirements();\r\n    }, [state.plantId, state.siteData?.landOwnership, state.certificationPurpose]);\r\n\r\n    // Derived State\r\n    const uploadedDocIds = state.documents.filter(doc => doc.uploaded && doc.id).map(doc => doc.id!);\r\n    const missingRequirements = requirements.filter(req => !uploadedDocIds.includes(req.slotId));\r\n    const completedRequirements = requirements.filter(req => uploadedDocIds.includes(req.slotId));\r\n    const mandatoryDocs = requirements.filter(r => r.required || r.conditionalRequired);\r\n\r\n    // Handlers\r\n    const handleFileUpload = async (slotId: string, file: File) => {\r\n        setUploading(prev => ({ ...prev, [slotId]: true }));\r\n        setAiResults(prev => {\r\n            const n = { ...prev }; delete n[slotId]; return n;\r\n        });\r\n\r\n        try {\r\n            // Mock API call\r\n            await new Promise(resolve => setTimeout(resolve, 1500));\r\n\r\n            const isMatch = true;\r\n            const confidence = 98;\r\n\r\n            if (isMatch) {\r\n                setAiResults(prev => ({\r\n                    ...prev,\r\n                    [slotId]: {\r\n                        valid: isMatch,\r\n                        message: language === 'th' ? 'เน€เธญเธเธชเธฒเธฃเธ–เธนเธเธ•เนเธญเธ (AI Verified)' : 'Document Valid (AI Verified)',\r\n                        confidence\r\n                    }\r\n                }));\r\n            }\r\n\r\n            const newDocs = [...state.documents.filter(d => d.id !== slotId)];\r\n            newDocs.push({\r\n                id: slotId,\r\n                name: file.name,\r\n                uploaded: true,\r\n                url: URL.createObjectURL(file),\r\n                metadata: { manualEntry: false }\r\n            });\r\n            setDocuments(newDocs);\r\n\r\n        } catch (error) {\r\n            console.error(error);\r\n            setAiResults(prev => ({\r\n                ...prev,\r\n                [slotId]: { valid: false, message: language === 'th' ? 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเธญเธฑเธเนเธซเธฅเธ”' : 'Upload Error' }\r\n            }));\r\n        } finally {\r\n            setUploading(prev => ({ ...prev, [slotId]: false }));\r\n        }\r\n    };\r\n\r\n    const handleUpdateMetadata = (slotId: string, updates: any) => {\r\n        const newDocs = state.documents.map(d => {\r\n            if (d.id === slotId) {\r\n                return { ...d, metadata: { ...d.metadata, ...updates } };\r\n            }\r\n            return d;\r\n        });\r\n        setDocuments(newDocs);\r\n    };\r\n\r\n    const handleAreaChange = (slotId: string, field: 'rai' | 'ngan' | 'sqWa', value: string) => {\r\n        const numVal = parseFloat(value) || 0;\r\n        const currentDoc = state.documents.find(d => d.id === slotId);\r\n        const currentArea = currentDoc?.metadata?.area || { rai: 0, ngan: 0, sqWa: 0 };\r\n\r\n        handleUpdateMetadata(slotId, {\r\n            area: { ...currentArea, [field]: numVal },\r\n            manualEntry: true\r\n        });\r\n    };\r\n\r\n    // Render Helpers\r\n    const renderDocCard = (req: DocRequirement) => {\r\n        const doc = state.documents.find(d => d.id === req.slotId);\r\n        const isUploading = uploading[req.slotId];\r\n        const aiResult = aiResults[req.slotId];\r\n        const isAiSupported = !!AI_DOC_TYPES[req.slotId];\r\n        const displayName = dict.wizard.documents.docNames[req.nameKey] || req.nameKey;\r\n\r\n        return (\r\n            <div key={req.slotId} className={`\r\n                relative bg-white rounded-2xl transition-all duration-300 overflow-hidden group\r\n                ${doc\r\n                    ? 'border-2 border-primary/20 shadow-sm'\r\n                    : 'border border-gray-200 shadow-sm hover:shadow-lg hover:border-primary/40'\r\n                }\r\n            `}>\r\n                <div className=\"p-6\">\r\n                    <div className=\"flex justify-between items-start mb-4\">\r\n                        <div className=\"flex-1 min-w-0 pr-4\">\r\n                            <h4 className={`font-bold text-sm mb-1 flex flex-wrap items-center gap-2 ${doc ? 'text-primary-900' : 'text-gray-700'}`}>\r\n                                {displayName}\r\n                                {(req.required || req.conditionalRequired) && !doc && (\r\n                                    <span className=\"text-[10px] text-red-600 bg-red-50 px-2 py-0.5 rounded-full border border-red-100 font-bold\">\r\n                                        * {language === 'th' ? 'เธเธณเน€เธเนเธ' : 'Required'}\r\n                                    </span>\r\n                                )}\r\n                            </h4>\r\n                            <p className=\"text-[10px] text-text-tertiary flex items-center gap-1\">\r\n                                {isAiSupported && <span className=\"text-primary-600 font-bold bg-primary-50 px-1.5 py-0.5 rounded-md\">โจ AI Smart Scan</span>}\r\n                                {req.helperText || (language === 'th' ? 'เธฃเธญเธเธฃเธฑเธ PDF, JPG, PNG' : 'Supports PDF, JPG, PNG')}\r\n                            </p>\r\n                        </div>\r\n                        {doc && (\r\n                            <div className=\"w-7 h-7 rounded-full bg-primary text-white flex items-center justify-center shadow-lg animate-scale-in\">\r\n                                <CheckIcon className=\"w-4 h-4\" />\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {req.templateUrl && !doc && (\r\n                        <div className=\"mb-4\">\r\n                            <a href={req.templateUrl} target=\"_blank\" rel=\"noopener noreferrer\" className=\"inline-flex items-center gap-1.5 text-[10px] text-primary font-bold hover:bg-primary hover:text-white bg-primary-50 px-3 py-1.5 rounded-xl border border-primary-100 transition-all\">\r\n                                <Icons.Download className=\"w-3 h-3\" />\r\n                                {dict.wizard.documents.downloadForm}\r\n                            </a>\r\n                        </div>\r\n                    )}\r\n\r\n                    {!doc ? (\r\n                        <label className={`\r\n                            relative h-32 w-full rounded-2xl border-2 border-dashed flex flex-col items-center justify-center cursor-pointer transition-all duration-300 overflow-hidden bg-gray-50/50\r\n                            ${isUploading\r\n                                ? 'border-primary bg-primary-50'\r\n                                : 'border-gray-200 hover:border-primary-300 hover:bg-primary-50/30'\r\n                            }\r\n                        `}>\r\n                            {isUploading ? (\r\n                                <div className=\"flex flex-col items-center animate-pulse\">\r\n                                    <div className=\"w-8 h-8 border-[3px] border-primary border-t-transparent rounded-full animate-spin mb-2\"></div>\r\n                                    <span className=\"text-[10px] font-bold text-primary\">{dict.wizard.documents.upload.analyzing}</span>\r\n                                </div>\r\n                            ) : (\r\n                                <>\r\n                                    <div className=\"w-12 h-12 rounded-2xl bg-white text-gray-400 flex items-center justify-center mb-2 group-hover:scale-110 group-hover:text-primary group-hover:shadow-md transition-all shadow-sm border border-gray-100\">\r\n                                        <UploadIcon className=\"w-6 h-6\" />\r\n                                    </div>\r\n                                    <span className=\"text-[10px] font-bold text-gray-500 group-hover:text-primary transition-colors\">{dict.wizard.documents.upload.click}</span>\r\n                                </>\r\n                            )}\r\n                            <input\r\n                                type=\"file\"\r\n                                className=\"hidden\"\r\n                                accept=\"image/*,application/pdf\"\r\n                                disabled={isUploading}\r\n                                onChange={(e) => {\r\n                                    const file = e.target.files?.[0];\r\n                                    if (file) handleFileUpload(req.slotId, file);\r\n                                }}\r\n                            />\r\n                        </label>\r\n                    ) : (\r\n                        <div className=\"bg-gradient-to-br from-gray-50 to-white rounded-2xl p-4 border border-gray-100 group-hover:border-primary-100 transition-all shadow-inner\">\r\n                            <div className=\"flex items-center justify-between gap-3\">\r\n                                <div className=\"flex items-center gap-3 overflow-hidden\">\r\n                                    <div className=\"w-10 h-10 bg-white rounded-xl border border-gray-100 flex items-center justify-center text-primary shadow-sm\">\r\n                                        <DocIcon className=\"w-5 h-5\" />\r\n                                    </div>\r\n                                    <div className=\"flex-1 min-w-0\">\r\n                                        <div className=\"text-xs font-bold text-gray-900 truncate\">{doc.name}</div>\r\n                                        <div className=\"text-[10px] text-emerald-600 font-bold flex items-center gap-1 mt-0.5\">\r\n                                            <CheckIcon className=\"w-3 h-3\" />\r\n                                            {dict.wizard.documents.upload.ready}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <button\r\n                                    onClick={() => {\r\n                                        setDocuments(state.documents.filter(d => d.id !== req.slotId));\r\n                                        setAiResults(prev => { const n = { ...prev }; delete n[req.slotId]; return n; });\r\n                                    }}\r\n                                    className=\"p-1.5 rounded-xl text-gray-300 hover:text-danger hover:bg-danger-50 transition-all\"\r\n                                >\r\n                                    <Icons.Trash className=\"w-4 h-4\" />\r\n                                </button>\r\n                            </div>\r\n\r\n                            {/* Specialized Fields: Land Deed */}\r\n                            {req.slotId === 'land_deed' && (\r\n                                <div className=\"mt-4 pt-4 border-t border-dashed border-gray-200 animate-slide-up\">\r\n                                    <div className=\"flex justify-between items-center mb-2 px-1\">\r\n                                        <span className=\"text-[10px] font-bold text-gray-500 uppercase tracking-wider\">{language === 'th' ? 'เธเนเธญเธกเธนเธฅเธเธเธฒเธ”เธเธทเนเธเธ—เธตเน (เนเธเธเธ”)' : 'Title Deed Area'}</span>\r\n                                        {!doc.metadata?.manualEntry && (\r\n                                            <button\r\n                                                onClick={() => handleUpdateMetadata(req.slotId, { manualEntry: true })}\r\n                                                className=\"text-[10px] text-primary hover:underline font-black\"\r\n                                            >\r\n                                                {language === 'th' ? 'เนเธเนเนเธ' : 'Edit'}\r\n                                            </button>\r\n                                        )}\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-3 gap-2\">\r\n                                        {['rai', 'ngan', 'sqWa'].map((unit) => (\r\n                                            <div key={unit} className=\"bg-white rounded-xl border border-gray-100 p-2 text-center shadow-sm\">\r\n                                                <label className=\"block text-[8px] text-gray-400 uppercase font-bold mb-0.5\">\r\n                                                    {unit === 'sqWa' ? (language === 'th' ? 'เธ•เธฃ.เธง.' : 'Sq.Wa') :\r\n                                                        (unit === 'rai' ? (language === 'th' ? 'เนเธฃเน' : 'Rai') :\r\n                                                            (language === 'th' ? 'เธเธฒเธ' : 'Ngan'))}\r\n                                                </label>\r\n                                                <input\r\n                                                    type=\"number\"\r\n                                                    className=\"w-full text-center text-xs font-black text-gray-900 bg-transparent outline-none\"\r\n                                                    value={doc.metadata?.area?.[unit as keyof typeof doc.metadata.area] ?? ''}\r\n                                                    placeholder=\"0\"\r\n                                                    onChange={(e) => handleAreaChange(req.slotId, unit as any, e.target.value)}\r\n                                                    readOnly={!doc.metadata?.manualEntry && !!doc.metadata?.area}\r\n                                                />\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* AI Result Feedback */}\r\n                            {aiResult && (\r\n                                <div className={`mt-3 text-[10px] p-2.5 rounded-xl flex items-center justify-between font-bold animate-slide-down ${aiResult.valid ? 'bg-emerald-50 text-emerald-700 border border-emerald-100' : 'bg-red-50 text-red-700 border border-red-100'\r\n                                    }`}>\r\n                                    <span className=\"flex items-center gap-1.5 leading-none\">\r\n                                        {aiResult.valid ? <CheckIcon className=\"w-3.5 h-3.5\" /> : <WarningIcon className=\"w-3.5 h-3.5\" />}\r\n                                        {aiResult.message}\r\n                                    </span>\r\n                                    {aiResult.confidence && aiResult.valid && (\r\n                                        <span className=\"bg-white/60 px-1.5 py-0.5 rounded-lg shadow-sm font-black\">\r\n                                            {Math.round(aiResult.confidence)}%\r\n                                        </span>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center gap-4 mb-4\">\r\n                <div className=\"w-12 h-12 bg-primary gradient-mask rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-primary-50\">\r\n                    9\r\n                </div>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-primary-900\">{dict.wizard.documents.title}</h2>\r\n                    <p className=\"text-text-secondary\">{dict.wizard.documents.subtitle}</p>\r\n                </div>\r\n            </div>\r\n\r\n            {loadingReqs ? (\r\n                <div className=\"flex flex-col items-center justify-center h-80 gap-6 bg-white rounded-[2rem] border border-gray-100 shadow-premium\">\r\n                    <div className=\"relative\">\r\n                        <div className=\"w-16 h-16 border-4 border-primary/10 border-t-primary rounded-full animate-spin\"></div>\r\n                        <div className=\"absolute inset-x-0 -bottom-8 flex justify-center\">\r\n                            <span className=\"w-2 h-2 rounded-full bg-primary animate-bounce [animation-delay:-0.3s]\"></span>\r\n                            <span className=\"w-2 h-2 rounded-full bg-primary animate-bounce [animation-delay:-0.15s] mx-1\"></span>\r\n                            <span className=\"w-2 h-2 rounded-full bg-primary animate-bounce\"></span>\r\n                        </div>\r\n                    </div>\r\n                    <span className=\"text-gray-400 font-bold uppercase tracking-widest text-xs\">{language === 'th' ? 'เธเธณเธฅเธฑเธเน€เธ•เธฃเธตเธขเธกเธฃเธฒเธขเธเธฒเธฃเน€เธญเธเธชเธฒเธฃ...' : 'Preparing document list...'}</span>\r\n                </div>\r\n            ) : (\r\n                <>\r\n                    {/* Dashboard Status Card */}\r\n                    <div className=\"gacp-card bg-gradient-to-br from-primary shadow-soft relative overflow-hidden border-none text-white p-8 animate-slide-up\">\r\n                        <div className=\"absolute top-0 right-0 w-96 h-96 bg-white/10 rounded-full blur-3xl -mr-32 -mt-32 pointer-events-none\"></div>\r\n                        <div className=\"absolute bottom-0 left-0 w-64 h-64 bg-black/10 rounded-full blur-3xl -ml-20 -mb-20 pointer-events-none\"></div>\r\n\r\n                        <div className=\"relative z-10 flex flex-col md:flex-row justify-between items-center gap-8\">\r\n                            <div className=\"flex items-center gap-8 w-full md:w-auto\">\r\n                                <div className=\"text-center md:text-left\">\r\n                                    <p className=\"text-[10px] text-white/60 font-black uppercase tracking-widest mb-1\">{dict.wizard.documents.status.mandatory}</p>\r\n                                    <p className=\"text-4xl font-black\">{mandatoryDocs.length}</p>\r\n                                </div>\r\n                                <div className=\"h-12 w-px bg-white/20\"></div>\r\n                                <div className=\"text-center md:text-left\">\r\n                                    <p className=\"text-[10px] text-white/60 font-black uppercase tracking-widest mb-1\">{dict.wizard.documents.status.uploaded}</p>\r\n                                    <p className=\"text-4xl font-black text-emerald-300\">{completedRequirements.length}</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex flex-col items-center md:items-end gap-3\">\r\n                                {missingRequirements.length === 0 ? (\r\n                                    <div className=\"inline-flex items-center gap-2 px-6 py-3 bg-white/20 backdrop-blur-md text-white rounded-2xl text-sm font-black shadow-lg border border-white/30 animate-pulse-soft\">\r\n                                        <CheckIcon className=\"w-5 h-5 text-emerald-300\" />\r\n                                        {dict.wizard.documents.status.complete}\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"inline-flex items-center gap-2 px-6 py-3 bg-white text-primary rounded-2xl text-sm font-black shadow-lg\">\r\n                                        <Icons.Info className=\"w-5 h-5 text-amber-500\" />\r\n                                        {dict.wizard.documents.status.missingCount.replace('{n}', missingRequirements.length.toString())}\r\n                                    </div>\r\n                                )}\r\n                                <p className=\"text-[10px] text-white/50 font-medium italic\">* เนเธเธฐเธเธณเนเธซเนเธญเธฑเธเนเธซเธฅเธ”เนเธเธฅเน PDF เน€เธเธทเนเธญเธเธงเธฒเธกเธเธฑเธ”เน€เธเธเธชเธนเธเธชเธธเธ”</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Missing Documents Section */}\r\n                    {missingRequirements.length > 0 && (\r\n                        <div className=\"space-y-6 animate-slide-up\" style={{ animationDelay: '100ms' }}>\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <div className=\"w-2 h-8 bg-amber-400 rounded-full\"></div>\r\n                                <h3 className=\"font-black text-xl text-gray-800 tracking-tight\">\r\n                                    {dict.wizard.documents.sections.todo}\r\n                                </h3>\r\n                            </div>\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                                {missingRequirements.map((req) => renderDocCard(req))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Completed Documents Section */}\r\n                    {completedRequirements.length > 0 && (\r\n                        <div className=\"space-y-6 animate-slide-up\" style={{ animationDelay: '200ms' }}>\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <div className=\"w-2 h-8 bg-emerald-500 rounded-full\"></div>\r\n                                <h3 className=\"font-black text-xl text-gray-800 tracking-tight\">\r\n                                    {dict.wizard.documents.sections.done}\r\n                                </h3>\r\n                            </div>\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n                                {completedRequirements.map((req) => {\r\n                                    const doc = state.documents.find(d => d.id === req.slotId);\r\n                                    const displayName = dict.wizard.documents.docNames[req.nameKey as keyof typeof dict.wizard.documents.docNames] || req.nameKey;\r\n                                    if (!doc) return null;\r\n                                    return (\r\n                                        <div key={req.slotId} className=\"bg-white border border-gray-100 rounded-2xl p-4 flex items-center gap-4 shadow-sm hover:shadow-md transition-all group relative overflow-hidden\">\r\n                                            <div className=\"absolute top-0 left-0 w-1 h-full bg-emerald-500\"></div>\r\n                                            <div className=\"w-10 h-10 bg-emerald-50 text-emerald-600 rounded-xl flex items-center justify-center flex-shrink-0 border border-emerald-100\">\r\n                                                <Icons.CheckCircle className=\"w-6 h-6\" />\r\n                                            </div>\r\n                                            <div className=\"flex-1 min-w-0\">\r\n                                                <div className=\"text-[10px] font-black text-emerald-500 uppercase mb-0.5 tracking-wider\">Completed</div>\r\n                                                <div className=\"text-xs font-bold text-gray-900 truncate\" title={displayName}>{displayName}</div>\r\n                                            </div>\r\n                                            <button\r\n                                                onClick={() => {\r\n                                                    setDocuments(state.documents.filter(d => d.id !== req.slotId));\r\n                                                    setAiResults(prev => { const n = { ...prev }; delete n[req.slotId]; return n; });\r\n                                                }}\r\n                                                className=\"text-gray-300 hover:text-danger opacity-0 group-hover:opacity-100 transition-all p-1\"\r\n                                            >\r\n                                                <Icons.Trash className=\"w-4 h-4\" />\r\n                                            </button>\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Optional / Extra Links */}\r\n                    <div className=\"gacp-card p-8 mt-12 animate-slide-up bg-gradient-to-br from-white to-blue-50/30 border-blue-100\" style={{ animationDelay: '300ms' }}>\r\n                        <div className=\"flex items-center gap-3 mb-8\">\r\n                            <div className=\"p-3 bg-blue-100 text-blue-600 rounded-2xl shadow-sm\">\r\n                                <Icons.Video className=\"w-6 h-6\" />\r\n                            </div>\r\n                            <div>\r\n                                <h3 className=\"text-xl font-black text-gray-800 tracking-tight\">{dict.wizard.documents.extra.title}</h3>\r\n                                <p className=\"text-xs text-gray-500\">เธเนเธงเธขเนเธซเนเธเธฑเธเธงเธดเธเธฒเธเธฒเธฃเธ•เธฃเธงเธเธชเธญเธเธชเธ–เธฒเธเธ—เธตเนเนเธ”เนเธฃเธงเธ”เน€เธฃเนเธงเธเธถเนเธเธเนเธฒเธเธงเธดเธ”เธตเนเธญ</p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"mb-10 max-w-2xl\">\r\n                            <FormLabelWithHint label={dict.wizard.documents.extra.videoLabel} hint={dict.wizard.documents.extra.videoHint} />\r\n                            <div className=\"relative group\">\r\n                                <div className=\"absolute inset-y-0 left-4 flex items-center text-gray-400 group-focus-within:text-primary transition-colors\">\r\n                                    <Icons.Link className=\"w-5 h-5\" />\r\n                                </div>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"https://youtube.com/watch?v=...\"\r\n                                    className=\"gacp-input pl-12 bg-white\"\r\n                                    value={youtubeUrl}\r\n                                    onChange={(e) => setYoutubeUrl(e.target.value)}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {optionalDocs.length > 0 && (\r\n                            <div className=\"space-y-6\">\r\n                                <h4 className=\"font-bold text-sm text-gray-600 uppercase tracking-widest px-1\">เน€เธญเธเธชเธฒเธฃเน€เธเธดเนเธกเน€เธ•เธดเธก (Optional)</h4>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                                    {optionalDocs.map((req) => renderDocCard(req))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </>\r\n            )}\r\n\r\n            <WizardNavigation\r\n                onNext={() => {\r\n                    saveToStoreYoutubeUrl(youtubeUrl);\r\n                    router.push('/farmer/applications/new/step/10');\r\n                }}\r\n                onBack={() => router.push('/farmer/applications/new/step/8')}\r\n                isNextDisabled={false}\r\n                nextLabel={dict.wizard.navigation.next}\r\n                backLabel={dict.wizard.navigation.back}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StepDocuments;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepFarm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningIcon' is defined but never used.","line":11,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":32},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PlantIcon' is defined but never used.","line":11,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":43},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'InfoIcon' is defined but never used.","line":11,"column":45,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":53},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":74,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":74,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3454,3457],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3454,3457],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useWizardStore, FarmData, StepDocument } from '../hooks/useWizardStore';\r\nimport { useRouter } from 'next/navigation';\r\nimport dynamic from 'next/dynamic';\r\nimport { useGACPData } from '@/hooks/useGACPData';\r\nimport { WizardNavigation } from '@/components/wizard/WizardNavigation';\r\nimport { FormLabelWithHint } from '@/components/FormHint';\r\nimport { InlineDocumentUpload } from '@/components/InlineDocumentUpload';\r\nimport { CheckIcon, WarningIcon, PlantIcon, InfoIcon, SecureIcon } from '@/components/icons/WizardIcons';\r\nimport { Icons } from '@/components/ui/icons';\r\nimport { useLanguage } from '@/lib/i18n/LanguageContext';\r\n\r\n// Dynamically import map to avoid SSR issues\r\nconst InteractiveMap = dynamic(() => import('@/components/InteractiveMap'), {\r\n    ssr: false,\r\n    loading: () => <div className=\"h-64 bg-slate-50 rounded-[2rem] animate-pulse flex items-center justify-center text-slate-400 font-bold\">เธเธณเธฅเธฑเธเนเธซเธฅเธ”เนเธเธเธ เธฒเธเธเธทเนเธเธ—เธตเน...</div>\r\n});\r\n\r\nconst FARM_DOCUMENTS = [\r\n    { id: 'land_title', name: 'เน€เธญเธเธชเธฒเธฃเธชเธดเธ—เธเธดเนเธ—เธตเนเธ”เธดเธ (เนเธเธเธ”/เธ.เธช.4/เธช.เธ.เธ.)', nameEn: 'Land Title Document', required: true },\r\n    { id: 'rental_contract', name: 'เธชเธฑเธเธเธฒเน€เธเนเธฒ (เธเธฃเธ“เธตเน€เธเนเธฒเธ—เธตเนเธ”เธดเธ)', nameEn: 'Rental Contract', required: false, condition: 'landOwnership === \"RENT\"' },\r\n    { id: 'consent_letter', name: 'เธซเธเธฑเธเธชเธทเธญเธขเธดเธเธขเธญเธกเนเธเนเธ—เธตเนเธ”เธดเธ', nameEn: 'Land Use Consent Letter', required: false, condition: 'landOwnership === \"CONSENT\"' },\r\n    { id: 'farm_map', name: 'เนเธเธเธ—เธตเนเธเธฒเธฃเนเธก/เธเธฑเธเธเธฃเธดเน€เธงเธ“', nameEn: 'Farm Layout Map', required: true },\r\n    { id: 'water_quality_report', name: 'เธเธฅเธงเธดเน€เธเธฃเธฒเธฐเธซเนเธเธธเธ“เธ เธฒเธเธเนเธณ', nameEn: 'Water Quality Analysis Report', required: false },\r\n] as const;\r\n\r\nexport const StepFarm = () => {\r\n    const { state, setFarmData } = useWizardStore();\r\n    const router = useRouter();\r\n    const { dict } = useLanguage();\r\n\r\n    // API-First: Fetch GACP data\r\n    const {\r\n        environmentChecklist,\r\n        waterSources,\r\n        securityRequirements,\r\n        loading: gacpLoading,\r\n    } = useGACPData(4);\r\n\r\n    const [formData, setFormData] = useState<Partial<FarmData> & { environmentChecks?: Record<string, boolean>; securityChecks?: Record<string, boolean> }>(state.farmData || {\r\n        farmName: '',\r\n        address: '',\r\n        province: '',\r\n        totalAreaSize: '',\r\n        totalAreaUnit: 'Rai',\r\n        landOwnership: 'OWN',\r\n        waterSource: '',\r\n        hasFence: false,\r\n        hasCCTV: false,\r\n        documents: [],\r\n    });\r\n\r\n    const [envChecks, setEnvChecks] = useState<Record<string, boolean>>(state.farmData?.environmentChecks || {});\r\n    const [securityChecks, setSecurityChecks] = useState<Record<string, boolean>>(state.farmData?.securityChecks || {});\r\n    const [uploadedDocs, setUploadedDocs] = useState<StepDocument[]>(state.farmData?.documents || []);\r\n\r\n    // Auto-save to store\r\n    useEffect(() => {\r\n        const timeout = setTimeout(() => {\r\n            if (formData.farmName) {\r\n                setFarmData({\r\n                    ...formData,\r\n                    documents: uploadedDocs,\r\n                    environmentChecks: envChecks,\r\n                    securityChecks: securityChecks\r\n                } as FarmData);\r\n            }\r\n        }, 500);\r\n        return () => clearTimeout(timeout);\r\n    }, [formData, uploadedDocs, envChecks, securityChecks, setFarmData]);\r\n\r\n    const handleChange = (field: keyof FarmData, value: any) => {\r\n        setFormData(prev => ({ ...prev, [field]: value }));\r\n    };\r\n\r\n    const handleLocationSelect = (lat: number, lng: number) => {\r\n        setFormData(prev => ({\r\n            ...prev,\r\n            gpsLat: lat.toFixed(6),\r\n            gpsLng: lng.toFixed(6)\r\n        }));\r\n    };\r\n\r\n    const handleDocUpload = (docId: string, url: string | null, fileName?: string) => {\r\n        if (!url) {\r\n            setUploadedDocs(prev => prev.filter(d => d.docType !== docId));\r\n            return;\r\n        }\r\n\r\n        const newDoc: StepDocument = {\r\n            stepNumber: 4,\r\n            docType: docId,\r\n            fileName: fileName || 'Uploaded Document',\r\n            fileUrl: url,\r\n            uploadedAt: new Date().toISOString(),\r\n            required: FARM_DOCUMENTS.find(d => d.id === docId)?.required || false,\r\n        };\r\n\r\n        setUploadedDocs(prev => {\r\n            const filtered = prev.filter(d => d.docType !== docId);\r\n            return [...filtered, newDoc];\r\n        });\r\n    };\r\n\r\n    // Validation\r\n    const requiredEnvChecksPassed = environmentChecklist.filter(e => e.required).every(e => envChecks[e.id]);\r\n    const hasBasicInfo = formData.farmName && formData.address && formData.province && formData.totalAreaSize;\r\n    const isFormValid = hasBasicInfo && requiredEnvChecksPassed;\r\n\r\n    if (gacpLoading) {\r\n        return (\r\n            <div className=\"flex flex-col items-center justify-center min-h-[400px] gap-6 animate-pulse\">\r\n                <div className=\"w-16 h-16 rounded-full border-4 border-primary border-t-transparent animate-spin ring-8 ring-primary/10\"></div>\r\n                <div className=\"text-center\">\r\n                    <p className=\"text-primary-900 font-black text-lg\">เธเธณเธฅเธฑเธเนเธซเธฅเธ”เธกเธฒเธ•เธฃเธเธฒเธ GACP</p>\r\n                    <p className=\"text-slate-400 text-sm\">เธเธฃเธธเธ“เธฒเธฃเธญเธชเธฑเธเธเธฃเธนเนเน€เธเธทเนเธญเธ”เธถเธเธเนเธญเธกเธนเธฅเน€เธเธ“เธ‘เนเธเธฒเธฃเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">\r\n\r\n            {/* Step Header */}\r\n            <div className=\"flex items-center gap-4 mb-4\">\r\n                <div className=\"w-12 h-12 bg-primary gradient-mask rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-primary-50\">\r\n                    3\r\n                </div>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-primary-900\">{dict.wizard.farm.title}</h2>\r\n                    <p className=\"text-text-secondary\">{dict.wizard.farm.subtitle}</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Section 1: Basic Info */}\r\n            <section className=\"gacp-card p-10 animate-slide-up\">\r\n                <div className=\"flex items-center gap-4 mb-10\">\r\n                    <div className=\"w-10 h-10 rounded-2xl bg-primary/10 text-primary flex items-center justify-center font-black\">\r\n                        1\r\n                    </div>\r\n                    <h3 className=\"text-xl font-black text-slate-800\">{dict.wizard.farm.sections.general}</h3>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                    <div className=\"md:col-span-2 space-y-2\">\r\n                        <FormLabelWithHint label={dict.wizard.farm.fields.farmName} required />\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"gacp-input\"\r\n                            placeholder=\"เน€เธเนเธ เนเธฃเนเธชเธกเธธเธเนเธเธฃเธชเธธเธเนเธ\"\r\n                            value={formData.farmName}\r\n                            onChange={(e) => handleChange('farmName', e.target.value)}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"md:col-span-2 space-y-2\">\r\n                        <FormLabelWithHint label={dict.wizard.farm.fields.address} required />\r\n                        <textarea\r\n                            className=\"gacp-input min-h-[120px] resize-none py-4\"\r\n                            placeholder=\"เธเนเธฒเธเน€เธฅเธเธ—เธตเน, เธซเธกเธนเน, เธ–เธเธ...\"\r\n                            value={formData.address}\r\n                            onChange={(e) => handleChange('address', e.target.value)}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <FormLabelWithHint label={dict.wizard.farm.fields.province} required />\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"gacp-input\"\r\n                            value={formData.province}\r\n                            onChange={(e) => handleChange('province', e.target.value)}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <FormLabelWithHint label={dict.wizard.farm.fields.totalArea} required />\r\n                        <div className=\"flex gap-4\">\r\n                            <input\r\n                                type=\"number\"\r\n                                className=\"gacp-input flex-1\"\r\n                                placeholder=\"เธเธณเธเธงเธ\"\r\n                                value={formData.totalAreaSize}\r\n                                onChange={(e) => handleChange('totalAreaSize', e.target.value)}\r\n                            />\r\n                            <select\r\n                                className=\"gacp-input w-40\"\r\n                                value={formData.totalAreaUnit}\r\n                                onChange={(e) => handleChange('totalAreaUnit', e.target.value)}\r\n                            >\r\n                                <option value=\"Rai\">เนเธฃเน</option>\r\n                                <option value=\"Ngan\">เธเธฒเธ</option>\r\n                                <option value=\"Sqm\">เธ•เธฃ.เธก.</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <FormLabelWithHint label={dict.wizard.farm.fields.ownership} />\r\n                        <select\r\n                            className=\"gacp-input\"\r\n                            value={formData.landOwnership}\r\n                            onChange={(e) => handleChange('landOwnership', e.target.value)}\r\n                        >\r\n                            <option value=\"OWN\">{dict.wizard.farm.fields.ownershipOptions.own}</option>\r\n                            <option value=\"RENT\">{dict.wizard.farm.fields.ownershipOptions.rent}</option>\r\n                            <option value=\"CONSENT\">{dict.wizard.farm.fields.ownershipOptions.consent}</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                        <FormLabelWithHint label={dict.wizard.farm.water.source} />\r\n                        <select\r\n                            className=\"gacp-input\"\r\n                            value={formData.waterSource}\r\n                            onChange={(e) => handleChange('waterSource', e.target.value)}\r\n                        >\r\n                            <option value=\"\">-- เน€เธฅเธทเธญเธเนเธซเธฅเนเธเธเนเธณ --</option>\r\n                            {waterSources.map(ws => (\r\n                                <option key={ws.id} value={ws.id}>{ws.nameTH}</option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* GPS Section */}\r\n                <div className=\"mt-12 pt-10 border-t border-slate-100 space-y-8\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <h4 className=\"font-black text-slate-800 flex items-center gap-3\">\r\n                            <Icons.MapPin className=\"w-5 h-5 text-primary\" />\r\n                            เธ•เธณเนเธซเธเนเธเธเธดเธเธฑเธ”เนเธเธฅเธ (GPS)\r\n                        </h4>\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={() => {\r\n                                if (navigator.geolocation) {\r\n                                    navigator.geolocation.getCurrentPosition(\r\n                                        (pos) => handleLocationSelect(pos.coords.latitude, pos.coords.longitude),\r\n                                        () => alert('เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เธฃเธฐเธเธธเธ•เธณเนเธซเธเนเธเนเธ”เน')\r\n                                    );\r\n                                }\r\n                            }}\r\n                            className=\"bg-primary/5 hover:bg-primary/10 text-primary px-4 py-2 rounded-xl text-xs font-black transition-all flex items-center gap-2\"\r\n                        >\r\n                            <Icons.Target className=\"w-4 h-4\" />\r\n                            เนเธเนเธ•เธณเนเธซเธเนเธเธเธฑเธเธเธธเธเธฑเธ\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className=\"h-96 w-full rounded-[2.5rem] overflow-hidden shadow-inner border-[6px] border-slate-50 relative z-0 group\">\r\n                        <InteractiveMap\r\n                            initialLat={formData.gpsLat ? parseFloat(formData.gpsLat) : 13.736717}\r\n                            initialLng={formData.gpsLng ? parseFloat(formData.gpsLng) : 100.523186}\r\n                            onLocationSelect={handleLocationSelect}\r\n                        />\r\n                        <div className=\"absolute bottom-6 left-6 flex gap-3 z-10\">\r\n                            <div className=\"px-4 py-3 bg-white/90 backdrop-blur-md rounded-2xl border border-white shadow-premium flex items-center gap-3\">\r\n                                <span className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest border-r border-slate-200 pr-3\">Lat</span>\r\n                                <span className=\"font-mono text-primary-900 font-black\">{formData.gpsLat || '-'}</span>\r\n                            </div>\r\n                            <div className=\"px-4 py-3 bg-white/90 backdrop-blur-md rounded-2xl border border-white shadow-premium flex items-center gap-3\">\r\n                                <span className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest border-r border-slate-200 pr-3\">Lng</span>\r\n                                <span className=\"font-mono text-primary-900 font-black\">{formData.gpsLng || '-'}</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Section 2: GACP Environment & Security */}\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\r\n\r\n                {/* Environment Checks */}\r\n                <section className=\"gacp-card p-10 animate-slide-up\" style={{ animationDelay: '100ms' }}>\r\n                    <div className=\"flex items-center gap-4 mb-8\">\r\n                        <div className=\"w-10 h-10 rounded-2xl bg-primary/10 text-primary flex items-center justify-center font-black\">\r\n                            2\r\n                        </div>\r\n                        <h3 className=\"text-xl font-black text-slate-800\">{dict.wizard.farm.sections.environment}</h3>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-4\">\r\n                        {environmentChecklist.map(item => {\r\n                            const isChecked = envChecks[item.id] || false;\r\n                            return (\r\n                                <button\r\n                                    key={item.id}\r\n                                    onClick={() => setEnvChecks(prev => ({ ...prev, [item.id]: !prev[item.id] }))}\r\n                                    className={`\r\n                                        w-full p-5 rounded-[2rem] text-left border-2 transition-all duration-300 flex items-center gap-5 group\r\n                                        ${isChecked\r\n                                            ? 'border-primary bg-primary-50/50 shadow-soft'\r\n                                            : 'border-slate-50 bg-white hover:border-primary/20 hover:shadow-premium-hover'\r\n                                        }\r\n                                    `}\r\n                                >\r\n                                    <div className={`w-10 h-10 rounded-xl flex items-center justify-center transition-all ${isChecked ? 'bg-primary text-white shadow-lg' : 'bg-slate-50 text-slate-300'}`}>\r\n                                        <CheckIcon className=\"w-5 h-5\" />\r\n                                    </div>\r\n                                    <div className=\"flex-1\">\r\n                                        <p className={`text-sm font-black leading-snug ${isChecked ? 'text-primary-900' : 'text-slate-600'}`}>{item.nameTH}</p>\r\n                                        {item.required && <span className=\"text-[9pt] font-black text-rose-500 uppercase tracking-tighter mt-1 block\">เธเธณเน€เธเนเธเธ•เธฒเธกเธกเธฒเธ•เธฃเธเธฒเธ GACP</span>}\r\n                                    </div>\r\n                                </button>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </section>\r\n\r\n                {/* Security Checks */}\r\n                <section className=\"gacp-card p-10 animate-slide-up\" style={{ animationDelay: '200ms' }}>\r\n                    <div className=\"flex items-center gap-4 mb-8\">\r\n                        <div className=\"w-10 h-10 rounded-2xl bg-primary/10 text-primary flex items-center justify-center font-black\">\r\n                            3\r\n                        </div>\r\n                        <h3 className=\"text-xl font-black text-slate-800\">{dict.wizard.farm.sections.security}</h3>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-4\">\r\n                        {securityRequirements.map(item => {\r\n                            const isChecked = securityChecks[item.id] || false;\r\n                            return (\r\n                                <button\r\n                                    key={item.id}\r\n                                    onClick={() => setSecurityChecks(prev => ({ ...prev, [item.id]: !prev[item.id] }))}\r\n                                    className={`\r\n                                        w-full p-5 rounded-[2rem] text-left border-2 transition-all duration-300 flex items-center gap-5 group\r\n                                        ${isChecked\r\n                                            ? 'border-primary bg-primary-50/50 shadow-soft'\r\n                                            : 'border-slate-50 bg-white hover:border-primary/20 hover:shadow-premium-hover'\r\n                                        }\r\n                                    `}\r\n                                >\r\n                                    <div className={`w-10 h-10 rounded-xl flex items-center justify-center transition-all ${isChecked ? 'bg-primary text-white shadow-lg' : 'bg-slate-50 text-slate-300'}`}>\r\n                                        <SecureIcon className=\"w-5 h-5\" />\r\n                                    </div>\r\n                                    <p className={`text-sm font-black ${isChecked ? 'text-primary-900' : 'text-slate-600'}`}>{item.nameTH}</p>\r\n                                </button>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </section>\r\n            </div>\r\n\r\n            {/* Section 4: Documents */}\r\n            <section className=\"gacp-card p-10 animate-slide-up\" style={{ animationDelay: '300ms' }}>\r\n                <div className=\"flex items-center gap-4 mb-10\">\r\n                    <div className=\"w-10 h-10 rounded-2xl bg-primary/10 text-primary flex items-center justify-center font-black\">\r\n                        4\r\n                    </div>\r\n                    <h3 className=\"text-xl font-black text-slate-800\">{dict.wizard.farm.sections.documents}</h3>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                    {FARM_DOCUMENTS.map(doc => {\r\n                        // Check conditions\r\n                        if (doc.condition) {\r\n                            if (doc.condition === 'landOwnership === \"RENT\"' && formData.landOwnership !== 'RENT') return null;\r\n                            if (doc.condition === 'landOwnership === \"CONSENT\"' && formData.landOwnership !== 'CONSENT') return null;\r\n                        }\r\n                        const currentDoc = uploadedDocs.find(d => d.docType === doc.id);\r\n\r\n                        return (\r\n                            <InlineDocumentUpload\r\n                                key={doc.id}\r\n                                id={doc.id}\r\n                                label={doc.name}\r\n                                labelEn={doc.nameEn}\r\n                                required={doc.required}\r\n                                value={currentDoc?.fileUrl}\r\n                                onChange={(file, url) => handleDocUpload(doc.id, url, file?.name)}\r\n                            />\r\n                        );\r\n                    })}\r\n                </div>\r\n            </section>\r\n\r\n            <WizardNavigation\r\n                onNext={() => router.push('/farmer/applications/new/step/4')}\r\n                onBack={() => router.push('/farmer/applications/new/step/2')}\r\n                isNextDisabled={!isFormValid}\r\n                showBack={true}\r\n                nextLabel={dict.wizard.navigation.next}\r\n                backLabel={dict.wizard.navigation.back}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StepFarm;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepGeneral.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepGeneral.tsx:49:13\n  47 |     useEffect(() => {\n  48 |         if (user && !state.applicantData?.firstName) {\n> 49 |             setFormData(prev => ({\n     |             ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  50 |                 ...prev,\n  51 |                 firstName: user.firstName ?? prev.firstName,\n  52 |                 lastName: user.lastName ?? prev.lastName,","line":49,"column":13,"nodeType":null,"endLine":49,"endColumn":24},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2986,2989],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2986,2989],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepGeneral.tsx:66:9\n  64 |\n  65 |     useEffect(() => {\n> 66 |         setFormData(prev => ({\n     |         ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  67 |             ...prev,\n  68 |             idCardDoc: idCardDoc || undefined,\n  69 |             houseRegDoc: houseRegDoc || undefined,","line":66,"column":9,"nodeType":null,"endLine":66,"endColumn":20}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useWizardStore, ApplicantData } from '../hooks/useWizardStore';\r\nimport { useAuth } from '@/lib/services/auth-provider';\r\nimport { InlineDocumentUpload } from '@/components/InlineDocumentUpload';\r\nimport { FormLabelWithHint } from '@/components/FormHint';\r\nimport { WizardNavigation } from '@/components/wizard/WizardNavigation';\r\nimport { CheckIcon, PersonIcon, BuildingIcon, GroupIcon } from '@/components/icons/WizardIcons';\r\nimport { useLanguage } from '@/lib/i18n/LanguageContext';\r\nimport { Icons } from '@/components/ui/icons';\r\n\r\nconst APPLICANT_TYPES = [\r\n    { id: 'INDIVIDUAL', label: 'เธเธธเธเธเธฅเธเธฃเธฃเธกเธ”เธฒ', labelEN: 'Individual', icon: PersonIcon },\r\n    { id: 'COMMUNITY', label: 'เธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ', labelEN: 'Community Enterprise', icon: GroupIcon },\r\n    { id: 'JURISTIC', label: 'เธเธดเธ•เธดเธเธธเธเธเธฅ', labelEN: 'Juristic Person', icon: BuildingIcon },\r\n] as const;\r\n\r\nexport const StepGeneral = () => {\r\n    const router = useRouter();\r\n    const { user } = useAuth();\r\n    const { state, setApplicantData } = useWizardStore();\r\n    const { dict } = useLanguage();\r\n\r\n    const [formData, setFormData] = useState<Partial<ApplicantData>>(() => {\r\n        if (state.applicantData?.applicantType) return state.applicantData;\r\n\r\n        return {\r\n            applicantType: 'INDIVIDUAL',\r\n            firstName: user?.firstName ?? '',\r\n            lastName: user?.lastName ?? '',\r\n            idCard: user?.idCard ?? '',\r\n            phone: user?.phone ?? '',\r\n            address: user?.address ?? '',\r\n            email: user?.email ?? '',\r\n        };\r\n    });\r\n\r\n    const [idCardDoc, setIdCardDoc] = useState<string | null>(state.applicantData?.idCardDoc || null);\r\n    const [houseRegDoc, setHouseRegDoc] = useState<string | null>(state.applicantData?.houseRegDoc || null);\r\n    const [communityRegDoc, setCommunityRegDoc] = useState<string | null>(state.applicantData?.communityRegDoc || null);\r\n    const [communityMeetingDoc, setCommunityMeetingDoc] = useState<string | null>(state.applicantData?.communityMeetingDoc || null);\r\n    const [companyRegDoc, setCompanyRegDoc] = useState<string | null>(state.applicantData?.companyRegDoc || null);\r\n    const [directorListDoc, setDirectorListDoc] = useState<string | null>(state.applicantData?.directorListDoc || null);\r\n\r\n    useEffect(() => {\r\n        if (user && !state.applicantData?.firstName) {\r\n            setFormData(prev => ({\r\n                ...prev,\r\n                firstName: user.firstName ?? prev.firstName,\r\n                lastName: user.lastName ?? prev.lastName,\r\n                idCard: user.idCard ?? prev.idCard,\r\n                phone: user.phone ?? prev.phone,\r\n                address: user.address ?? prev.address,\r\n                email: user.email ?? prev.email,\r\n            }));\r\n        }\r\n    }, [user, state.applicantData]);\r\n\r\n    const handleChange = (field: keyof ApplicantData, value: any) => {\r\n        setFormData(prev => ({ ...prev, [field]: value }));\r\n    };\r\n\r\n    useEffect(() => {\r\n        setFormData(prev => ({\r\n            ...prev,\r\n            idCardDoc: idCardDoc || undefined,\r\n            houseRegDoc: houseRegDoc || undefined,\r\n            communityRegDoc: communityRegDoc || undefined,\r\n            communityMeetingDoc: communityMeetingDoc || undefined,\r\n            companyRegDoc: companyRegDoc || undefined,\r\n            directorListDoc: directorListDoc || undefined,\r\n        }));\r\n    }, [idCardDoc, houseRegDoc, communityRegDoc, communityMeetingDoc, companyRegDoc, directorListDoc]);\r\n\r\n    const isReady = formData.applicantType && (\r\n        formData.applicantType === 'INDIVIDUAL'\r\n            ? formData.firstName && formData.lastName && formData.idCard && formData.phone\r\n            : formData.applicantType === 'COMMUNITY'\r\n                ? formData.communityName && formData.registrationSVC01 && formData.presidentName\r\n                : formData.companyName && formData.registrationNumber && formData.companyType\r\n    );\r\n\r\n    const handleNext = () => {\r\n        if (isReady) {\r\n            setApplicantData(formData as ApplicantData);\r\n            router.push('/farmer/applications/new/step/3');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">\r\n            <div className=\"flex items-center gap-4 mb-4\">\r\n                <div className=\"w-12 h-12 bg-primary gradient-mask rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-primary-50\">\r\n                    2\r\n                </div>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-primary-900\">{dict.wizard.general.title}</h2>\r\n                    <p className=\"text-text-secondary\">{dict.wizard.general.subtitle}</p>\r\n                </div>\r\n            </div>\r\n\r\n            {user?.firstName && (\r\n                <div className=\"bg-gradient-to-br from-primary-50 to-white border border-primary-100 rounded-[2rem] p-6 flex flex-col md:flex-row items-center gap-6 shadow-soft animate-slide-up\">\r\n                    <div className=\"w-16 h-16 bg-white rounded-2xl border border-primary-100 flex items-center justify-center text-primary shadow-sm flex-shrink-0\">\r\n                        <Icons.UserCheck className=\"w-8 h-8\" />\r\n                    </div>\r\n                    <div>\r\n                        <p className=\"text-primary-900 font-black text-lg mb-1\">{dict.wizard.general.autoFillTitle || 'เธเนเธญเธกเธนเธฅเธเธฒเธเนเธเธฃเนเธเธฅเนเธเธญเธเธเธธเธ“'}</p>\r\n                        <p className=\"text-sm text-primary-700 leading-relaxed font-medium\">\r\n                            เน€เธฃเธฒเนเธ”เนเธ”เธถเธเธเนเธญเธกเธนเธฅเธเธทเนเธเธเธฒเธเธเธญเธเธเธธเธ“ <span className=\"text-primary-900 font-bold underline underline-offset-4\">{user.firstName} {user.lastName}</span> เธกเธฒเนเธซเนเนเธฅเนเธงเนเธ”เธขเธญเธฑเธ•เนเธเธกเธฑเธ•เธด\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            <section className=\"gacp-card p-10 space-y-8 animate-slide-up\" style={{ animationDelay: '100ms' }}>\r\n                <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-10 h-10 rounded-2xl bg-primary/10 text-primary flex items-center justify-center font-black\">\r\n                        1\r\n                    </div>\r\n                    <h3 className=\"text-xl font-black text-slate-800\">{dict.wizard.general.typeHeader || 'เน€เธฅเธทเธญเธเธเธฃเธฐเน€เธ เธ—เธเธนเนเธขเธทเนเธเธเธณเธเธญ'}</h3>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                    {APPLICANT_TYPES.map((type) => {\r\n                        const isSelected = formData.applicantType === type.id;\r\n                        const isLocked = user?.applicantType && user.applicantType !== type.id;\r\n                        const Icon = type.icon;\r\n\r\n                        return (\r\n                            <button\r\n                                key={type.id}\r\n                                onClick={() => !isLocked && handleChange('applicantType', type.id)}\r\n                                disabled={!!isLocked}\r\n                                className={`\r\n                                    relative p-8 rounded-[2rem] flex flex-col items-center justify-center min-h-[180px] transition-all duration-300 border-2 text-center group\r\n                                    ${isLocked\r\n                                        ? 'bg-slate-50 border-slate-100 grayscale opacity-40 cursor-not-allowed'\r\n                                        : isSelected\r\n                                            ? 'bg-primary-50 border-primary shadow-premium scale-[1.02] z-10'\r\n                                            : 'bg-white border-transparent hover:border-primary/20 hover:shadow-premium-hover hover:-translate-y-1'\r\n                                    }\r\n                                `}\r\n                            >\r\n                                {isSelected && (\r\n                                    <div className=\"absolute top-4 right-4 w-6 h-6 rounded-full bg-primary text-white flex items-center justify-center shadow-lg animate-scale-in\">\r\n                                        <CheckIcon className=\"w-4 h-4\" />\r\n                                    </div>\r\n                                )}\r\n                                <div className={`mb-5 transition-transform duration-300 group-hover:scale-110 ${isSelected ? 'text-primary' : 'text-slate-300'}`}>\r\n                                    <Icon className=\"w-14 h-14 stroke-[1.2]\" />\r\n                                </div>\r\n                                <div className={`font-black text-lg leading-tight mb-1 ${isSelected ? 'text-primary-900' : 'text-slate-600'}`}>\r\n                                    {type.label}\r\n                                </div>\r\n                                <div className=\"text-[10px] text-slate-400 uppercase font-black tracking-widest\">\r\n                                    {type.labelEN}\r\n                                </div>\r\n                            </button>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </section>\r\n\r\n            <section className=\"gacp-card p-10 animate-slide-up\" style={{ animationDelay: '200ms' }}>\r\n                <div className=\"flex items-center gap-4 mb-10\">\r\n                    <div className=\"w-10 h-10 rounded-2xl bg-primary/10 text-primary flex items-center justify-center font-black\">\r\n                        2\r\n                    </div>\r\n                    <h3 className=\"text-xl font-black text-slate-800\">\r\n                        {formData.applicantType === 'INDIVIDUAL' ? dict.wizard.general.individualHeader || 'เธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”เธเนเธญเธกเธนเธฅเธชเนเธงเธเธเธธเธเธเธฅ' :\r\n                            formData.applicantType === 'COMMUNITY' ? 'เธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”เธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ' : 'เธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”เธเธดเธ•เธดเธเธธเธเธเธฅ'}\r\n                    </h3>\r\n                </div>\r\n\r\n                {formData.applicantType === 'INDIVIDUAL' && (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                        <div className=\"space-y-2\">\r\n                            <FormLabelWithHint label={dict.wizard.general.firstName} required hint=\"เนเธกเนเธ•เนเธญเธเธฃเธฐเธเธธเธเธณเธเธณเธซเธเนเธฒ\" />\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"gacp-input\"\r\n                                placeholder=\"เธชเธกเธเธฒเธข\"\r\n                                value={formData.firstName || ''}\r\n                                onChange={(e) => handleChange('firstName', e.target.value)}\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <FormLabelWithHint label={dict.wizard.general.lastName} required />\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"gacp-input\"\r\n                                placeholder=\"เนเธเธ”เธต\"\r\n                                value={formData.lastName || ''}\r\n                                onChange={(e) => handleChange('lastName', e.target.value)}\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <FormLabelWithHint label={dict.wizard.general.personalId} required hint=\"13 เธซเธฅเธฑเธ\" />\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"gacp-input font-mono tracking-widest text-lg\"\r\n                                placeholder=\"0-0000-00000-00-0\"\r\n                                value={formData.idCard || ''}\r\n                                onChange={(e) => handleChange('idCard', e.target.value)}\r\n                                maxLength={17}\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <FormLabelWithHint label={dict.wizard.general.phone} required />\r\n                            <input\r\n                                type=\"tel\"\r\n                                className=\"gacp-input font-mono\"\r\n                                placeholder=\"08x-xxx-xxxx\"\r\n                                value={formData.phone || ''}\r\n                                onChange={(e) => handleChange('phone', e.target.value)}\r\n                            />\r\n                        </div>\r\n                        <div className=\"md:col-span-2 space-y-2\">\r\n                            <FormLabelWithHint label={dict.wizard.general.address} required />\r\n                            <textarea\r\n                                className=\"gacp-input min-h-[120px] resize-none py-4\"\r\n                                placeholder=\"เธเนเธฒเธเน€เธฅเธเธ—เธตเน, เธซเธกเธนเน, เธ–เธเธ, เธ•เธณเธเธฅ, เธญเธณเน€เธ เธญ, เธเธฑเธเธซเธงเธฑเธ”...\"\r\n                                value={formData.address || ''}\r\n                                onChange={(e) => handleChange('address', e.target.value)}\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"md:col-span-2 bg-slate-50/50 rounded-[2rem] p-8 border border-slate-100 mt-4\">\r\n                            <h4 className=\"font-black text-slate-800 mb-6 flex items-center gap-3\">\r\n                                <Icons.FileText className=\"w-5 h-5 text-primary\" />\r\n                                {dict.wizard.general.docHeader || 'เน€เธญเธเธชเธฒเธฃเธขเธทเธเธขเธฑเธเธ•เธฑเธงเธ•เธ'}\r\n                            </h4>\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                <InlineDocumentUpload\r\n                                    id=\"id-card\"\r\n                                    label=\"เธชเธณเน€เธเธฒเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธ\"\r\n                                    labelEn=\"ID Card Copy\"\r\n                                    required={true}\r\n                                    value={idCardDoc || undefined}\r\n                                    onChange={(file, url) => setIdCardDoc(url)}\r\n                                />\r\n                                <InlineDocumentUpload\r\n                                    id=\"house-reg\"\r\n                                    label=\"เธชเธณเน€เธเธฒเธ—เธฐเน€เธเธตเธขเธเธเนเธฒเธ\"\r\n                                    labelEn=\"House Registration\"\r\n                                    required={true}\r\n                                    value={houseRegDoc || undefined}\r\n                                    onChange={(file, url) => setHouseRegDoc(url)}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {formData.applicantType === 'COMMUNITY' && (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                        <div className=\"md:col-span-2 space-y-2\">\r\n                            <FormLabelWithHint label=\"เธเธทเนเธญเธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ\" required />\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"gacp-input\"\r\n                                placeholder=\"เธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธเธเธฅเธธเนเธกเธเธนเนเธเธฅเธนเธเธชเธกเธธเธเนเธเธฃ...\"\r\n                                value={formData.communityName || ''}\r\n                                onChange={(e) => handleChange('communityName', e.target.value)}\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <FormLabelWithHint label=\"เธฃเธซเธฑเธชเธ—เธฐเน€เธเธตเธขเธ เธ—เธง.เธ.3\" required />\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"gacp-input font-mono\"\r\n                                placeholder=\"00-00-00-00-00\"\r\n                                value={formData.registrationSVC01 || ''}\r\n                                onChange={(e) => handleChange('registrationSVC01', e.target.value)}\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <FormLabelWithHint label=\"เธเธทเนเธญ-เธเธฒเธกเธชเธเธธเธฅ เธเธฃเธฐเธเธฒเธ\" required />\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"gacp-input\"\r\n                                value={formData.presidentName || ''}\r\n                                onChange={(e) => handleChange('presidentName', e.target.value)}\r\n                            />\r\n                        </div>\r\n                        <div className=\"md:col-span-2 space-y-2\">\r\n                            <FormLabelWithHint label=\"เธ—เธตเนเธญเธขเธนเนเธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ\" required />\r\n                            <textarea\r\n                                className=\"gacp-input min-h-[120px] resize-none py-4\"\r\n                                placeholder=\"เธ—เธตเนเธ•เธฑเนเธเธงเธดเธชเธฒเธซเธเธดเธ...\"\r\n                                value={formData.communityAddress || ''}\r\n                                onChange={(e) => handleChange('communityAddress', e.target.value)}\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"md:col-span-2 bg-slate-50/50 rounded-[2rem] p-8 border border-slate-100 mt-4\">\r\n                            <h4 className=\"font-black text-slate-800 mb-6 flex items-center gap-3\">\r\n                                <Icons.FileText className=\"w-5 h-5 text-primary\" />\r\n                                เน€เธญเธเธชเธฒเธฃเธเธฃเธฐเธเธญเธเธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ\r\n                            </h4>\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                <InlineDocumentUpload\r\n                                    id=\"community-reg\"\r\n                                    label=\"เธชเธณเน€เธเธฒเธ—เธฐเน€เธเธตเธขเธ เธ—เธง.เธ.3\"\r\n                                    labelEn=\"Certificate\"\r\n                                    required={true}\r\n                                    value={communityRegDoc || undefined}\r\n                                    onChange={(file, url) => setCommunityRegDoc(url)}\r\n                                />\r\n                                <InlineDocumentUpload\r\n                                    id=\"community-meeting\"\r\n                                    label=\"เธฃเธฒเธขเธเธฒเธเธเธฒเธฃเธเธฃเธฐเธเธธเธก\"\r\n                                    labelEn=\"Meeting Minutes\"\r\n                                    required={true}\r\n                                    value={communityMeetingDoc || undefined}\r\n                                    onChange={(file, url) => setCommunityMeetingDoc(url)}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {formData.applicantType === 'JURISTIC' && (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                        <div className=\"md:col-span-2 space-y-2\">\r\n                            <FormLabelWithHint label=\"เธเธทเนเธญเธเธฃเธดเธฉเธฑเธ—/เธซเนเธฒเธเธซเธธเนเธเธชเนเธงเธ\" required />\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"gacp-input\"\r\n                                value={formData.companyName || ''}\r\n                                onChange={(e) => handleChange('companyName', e.target.value)}\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <FormLabelWithHint label=\"เน€เธฅเธเธ—เธฐเน€เธเธตเธขเธเธเธดเธ•เธดเธเธธเธเธเธฅ\" required hint=\"13 เธซเธฅเธฑเธ\" />\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"gacp-input font-mono tracking-widest\"\r\n                                value={formData.registrationNumber || ''}\r\n                                onChange={(e) => handleChange('registrationNumber', e.target.value)}\r\n                                maxLength={13}\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <FormLabelWithHint label=\"เธเธฃเธฐเน€เธ เธ—เธเธดเธ•เธดเธเธธเธเธเธฅ\" required />\r\n                            <select\r\n                                className=\"gacp-input\"\r\n                                value={formData.companyType || ''}\r\n                                onChange={(e) => handleChange('companyType', e.target.value)}\r\n                            >\r\n                                <option value=\"\">-- เน€เธฅเธทเธญเธเธเธฃเธฐเน€เธ เธ— --</option>\r\n                                <option value=\"COMPANY_LIMITED\">เธเธฃเธดเธฉเธฑเธ—เธเธณเธเธฑเธ”</option>\r\n                                <option value=\"PUBLIC_COMPANY_LIMITED\">เธเธฃเธดเธฉเธฑเธ—เธกเธซเธฒเธเธเธเธณเธเธฑเธ”</option>\r\n                                <option value=\"LIMITED_PARTNERSHIP\">เธซเนเธฒเธเธซเธธเนเธเธชเนเธงเธเธเธณเธเธฑเธ”</option>\r\n                            </select>\r\n                        </div>\r\n\r\n                        <div className=\"md:col-span-2 bg-slate-50/50 rounded-[2rem] p-8 border border-slate-100 mt-4\">\r\n                            <h4 className=\"font-black text-slate-800 mb-6 flex items-center gap-3\">\r\n                                <Icons.FileText className=\"w-5 h-5 text-primary\" />\r\n                                เน€เธญเธเธชเธฒเธฃเธเธฃเธฐเธเธญเธเธเธดเธ•เธดเธเธธเธเธเธฅ\r\n                            </h4>\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                <InlineDocumentUpload\r\n                                    id=\"company-reg\"\r\n                                    label=\"เธซเธเธฑเธเธชเธทเธญเธฃเธฑเธเธฃเธญเธเธเธฃเธดเธฉเธฑเธ—\"\r\n                                    labelEn=\"Company Registration\"\r\n                                    required={true}\r\n                                    value={companyRegDoc || undefined}\r\n                                    onChange={(file, url) => setCompanyRegDoc(url)}\r\n                                />\r\n                                <InlineDocumentUpload\r\n                                    id=\"director-list\"\r\n                                    label=\"เธฃเธฒเธขเธเธทเนเธญเธเธนเนเธ–เธทเธญเธซเธธเนเธ (เธเธญเธ.5)\"\r\n                                    labelEn=\"Shareholder List\"\r\n                                    required={true}\r\n                                    value={directorListDoc || undefined}\r\n                                    onChange={(file, url) => setDirectorListDoc(url)}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </section>\r\n\r\n            <section className=\"gacp-card p-10 animate-slide-up\" style={{ animationDelay: '300ms' }}>\r\n                <div className=\"flex items-center gap-4 mb-10\">\r\n                    <div className=\"w-10 h-10 rounded-2xl bg-primary/10 text-primary flex items-center justify-center font-black\">\r\n                        3\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                        <h3 className=\"text-xl font-black text-slate-800\">{dict.wizard.steps.personnel}</h3>\r\n                        <p className=\"text-text-secondary text-sm font-medium\">เธเธฒเธฃเธเธฑเธ”เธเธฒเธฃเธ”เนเธฒเธเธเธธเธเธฅเธฒเธเธฃเธ•เธฒเธกเธกเธฒเธ•เธฃเธเธฒเธ GACP</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 gap-5\">\r\n                    {[\r\n                        { id: 'trainingProvided', label: 'เธกเธตเธเธฒเธฃเธญเธเธฃเธกเธเธเธฑเธเธเธฒเธ (Training)', desc: 'เธเธเธฑเธเธเธฒเธเนเธ”เนเธฃเธฑเธเธเธงเธฒเธกเธฃเธนเนเน€เธฃเธทเนเธญเธ GACP เนเธฅเธฐเธชเธธเธเธฅเธฑเธเธฉเธ“เธฐเธชเนเธงเธเธเธธเธเธเธฅ', icon: Icons.Users },\r\n                        { id: 'healthCheck', label: 'เธกเธตเธเธฒเธฃเธ•เธฃเธงเธเธชเธธเธเธ เธฒเธเธเธฃเธฐเธเธณเธเธต (Health Check)', desc: 'เธเธเธฑเธเธเธฒเธเนเธ”เนเธฃเธฑเธเธเธฒเธฃเธ•เธฃเธงเธเธชเธธเธเธ เธฒเธเนเธฅเธฐเนเธกเนเธกเธตเนเธฃเธเธ•เธดเธ”เธ•เนเธญเธฃเนเธฒเธขเนเธฃเธ', icon: Icons.ShieldCheck },\r\n                        { id: 'protectiveGear', label: 'เธกเธตเธเธธเธ”เธเนเธญเธเธเธฑเธ/เธญเธธเธเธเธฃเธ“เนเธเนเธญเธเธเธฑเธ (PPE)', desc: 'เธชเธงเธกเนเธชเนเธเธธเธ”เธเธเธดเธเธฑเธ•เธดเธเธฒเธเธ—เธตเนเน€เธซเธกเธฒเธฐเธชเธก เธซเธกเธงเธ เธ–เธธเธเธกเธทเธญ เธฃเธญเธเน€เธ—เนเธฒเธเธนเธ—', icon: Icons.Tshirt }\r\n                    ].map((item) => {\r\n                        const isChecked = formData.personnelHygiene?.[item.id as keyof typeof formData.personnelHygiene] || false;\r\n                        const ItemIcon = item.icon;\r\n\r\n                        return (\r\n                            <button\r\n                                key={item.id}\r\n                                onClick={() => {\r\n                                    const current = formData.personnelHygiene || { trainingProvided: false, healthCheck: false, protectiveGear: false };\r\n                                    setFormData(prev => ({\r\n                                        ...prev,\r\n                                        personnelHygiene: { ...current, [item.id]: !isChecked }\r\n                                    }));\r\n                                }}\r\n                                className={`\r\n                                    relative p-6 rounded-[2rem] text-left border-2 transition-all duration-300 flex items-center gap-6 group\r\n                                    ${isChecked\r\n                                        ? 'border-primary bg-primary-50/50 shadow-soft'\r\n                                        : 'border-slate-100 bg-white hover:border-primary/20 hover:shadow-premium-hover hover:-translate-y-0.5'\r\n                                    }\r\n                                `}\r\n                            >\r\n                                <div className={`w-14 h-14 rounded-2xl flex items-center justify-center transition-all duration-300 ${isChecked ? 'bg-primary text-white shadow-lg shadow-primary/20' : 'bg-slate-50 text-slate-400 group-hover:bg-primary/10 group-hover:text-primary'}`}>\r\n                                    <ItemIcon className=\"w-8 h-8\" />\r\n                                </div>\r\n                                <div className=\"flex-1\">\r\n                                    <span className={`block font-black text-lg mb-1 transition-colors ${isChecked ? 'text-primary-900' : 'text-slate-700'}`}>{item.label}</span>\r\n                                    <span className=\"text-sm text-slate-400 font-medium\">{item.desc}</span>\r\n                                </div>\r\n                                <div className={`w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all duration-300 ${isChecked ? 'bg-primary border-primary text-white scale-110' : 'border-slate-200'}`}>\r\n                                    {isChecked && <CheckIcon className=\"w-5 h-5\" />}\r\n                                </div>\r\n                            </button>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </section>\r\n\r\n            <WizardNavigation\r\n                onNext={handleNext}\r\n                onBack={() => router.push('/farmer/applications/new/step/1')}\r\n                isNextDisabled={!isReady}\r\n                showBack={true}\r\n                nextLabel={dict.wizard.navigation.next}\r\n                backLabel={dict.wizard.navigation.back}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StepGeneral;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepHarvest.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'dict' is assigned a value but never used.","line":16,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1138,1141],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1138,1141],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1295,1298],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1295,1298],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":111,"column":38,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ &quot;Machine\" เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ \"Manual\""},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ &ldquo;Machine\" เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ \"Manual\""},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ &#34;Machine\" เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ \"Manual\""},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ &rdquo;Machine\" เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ \"Manual\""},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":111,"column":46,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ \"Machine&quot; เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ \"Manual\""},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ \"Machine&ldquo; เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ \"Manual\""},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ \"Machine&#34; เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ \"Manual\""},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ \"Machine&rdquo; เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ \"Manual\""},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":111,"column":135,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ \"Machine\" เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ &quot;Manual\""},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ \"Machine\" เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ &ldquo;Manual\""},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ \"Machine\" เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ &#34;Manual\""},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ \"Machine\" เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ &rdquo;Manual\""},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":111,"column":142,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ \"Machine\" เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ \"Manual&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ \"Machine\" เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ \"Manual&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ \"Machine\" เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ \"Manual&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[5789,5900],"text":"เน€เธฅเธทเธญเธ \"Machine\" เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ \"Manual&rdquo;"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useWizardStore } from '../hooks/useWizardStore';\r\nimport { useRouter } from 'next/navigation';\r\nimport { PlantQRCalculator } from '@/components/PlantQRCalculator';\r\nimport { WizardNavigation } from '@/components/wizard/WizardNavigation';\r\nimport { FormLabelWithHint } from '@/components/FormHint';\r\nimport { InfoIcon, WarningIcon, CheckIcon } from '@/components/icons/WizardIcons';\r\nimport { Icons } from '@/components/ui/icons';\r\nimport { useLanguage } from '@/lib/i18n/LanguageContext';\r\n\r\nexport const StepHarvest = () => {\r\n    const { state, setHarvestData, updateState } = useWizardStore();\r\n    const router = useRouter();\r\n    const { dict } = useLanguage();\r\n\r\n    const [formData, setFormData] = useState(state.harvestData || {\r\n        harvestMethod: '',\r\n        dryingMethod: '',\r\n        dryingDetail: '',\r\n        storageSystem: '',\r\n        packaging: '',\r\n    });\r\n\r\n    const [touched, setTouched] = useState<Record<string, boolean>>({});\r\n\r\n    useEffect(() => {\r\n        const timeout = setTimeout(() => {\r\n            setHarvestData(formData as any);\r\n        }, 500);\r\n        return () => clearTimeout(timeout);\r\n    }, [formData, setHarvestData]);\r\n\r\n    const handleChange = (field: string, value: any) => {\r\n        setFormData(prev => ({ ...prev, [field]: value }));\r\n        setTouched(prev => ({ ...prev, [field]: true }));\r\n    };\r\n\r\n    const validate = () => {\r\n        const errors: Record<string, string> = {};\r\n        if (!formData.harvestMethod) errors.harvestMethod = 'เธเธฃเธธเธ“เธฒเน€เธฅเธทเธญเธเธงเธดเธเธตเธเธฒเธฃเน€เธเนเธเน€เธเธตเนเธขเธง';\r\n        if (!formData.dryingMethod) errors.dryingMethod = 'เธเธฃเธธเธ“เธฒเน€เธฅเธทเธญเธเธงเธดเธเธตเธเธฒเธฃเธฅเธ”เธเธงเธฒเธกเธเธทเนเธ';\r\n        if (formData.dryingMethod === 'OTHER' && !formData.dryingDetail?.trim()) {\r\n            errors.dryingDetail = 'เธเธฃเธธเธ“เธฒเธฃเธฐเธเธธเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”เธงเธดเธเธตเธเธฒเธฃเธ•เธฒเธเนเธซเนเธ';\r\n        }\r\n        if (!formData.storageSystem) errors.storageSystem = 'เธเธฃเธธเธ“เธฒเน€เธฅเธทเธญเธเธชเธ–เธฒเธเธ—เธตเนเน€เธเนเธเธฃเธฑเธเธฉเธฒ';\r\n        if (!formData.packaging?.trim()) errors.packaging = 'เธเธฃเธธเธ“เธฒเธฃเธฐเธเธธเธเนเธญเธกเธนเธฅเธเธฃเธฃเธเธธเธ เธฑเธ“เธ‘เน';\r\n        return errors;\r\n    };\r\n\r\n    const errors = validate();\r\n    const isValid = Object.keys(errors).length === 0;\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center gap-4 mb-4\">\r\n                <div className=\"w-12 h-12 bg-primary gradient-mask rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-primary-50\">\r\n                    8\r\n                </div>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-primary-900\">เธเธฒเธฃเน€เธเนเธเน€เธเธตเนเธขเธงเนเธฅเธฐเธเธฑเธ”เธเธฒเธฃ (Harvest & Post-Harvest)</h2>\r\n                    <p className=\"text-text-secondary\">เธฃเธฐเธเธธเธงเธดเธเธตเธเธฒเธฃเน€เธเนเธเน€เธเธตเนเธขเธง เธเธฒเธฃเธฅเธ”เธเธงเธฒเธกเธเธทเนเธ เนเธฅเธฐเธเธฒเธฃเน€เธเนเธเธฃเธฑเธเธฉเธฒเธ•เธฒเธกเธกเธฒเธ•เธฃเธเธฒเธ GACP</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Info Banner */}\r\n            <div className=\"p-6 bg-blue-50/80 backdrop-blur-sm border border-blue-200 rounded-2xl flex gap-4 text-blue-900 shadow-sm animate-slide-up\">\r\n                <div className=\"p-2 bg-white rounded-xl shadow-sm h-fit\">\r\n                    <InfoIcon className=\"w-6 h-6 text-blue-600\" />\r\n                </div>\r\n                <div className=\"space-y-1\">\r\n                    <p className=\"font-bold text-blue-900 text-sm\">เธเนเธญเธเธณเธซเธเธ”เธเธฒเธฃเธเธฑเธ”เธเธฒเธฃเธซเธฅเธฑเธเน€เธเนเธเน€เธเธตเนเธขเธง</p>\r\n                    <p className=\"text-xs leading-relaxed text-blue-800/80\">\r\n                        เธเธฒเธฃเธเธฑเธ”เธเธฒเธฃเธเธฅเธเธฅเธดเธ•เธซเธฅเธฑเธเน€เธเนเธเน€เธเธตเนเธขเธงเธกเธตเธเธงเธฒเธกเธชเธณเธเธฑเธเธญเธขเนเธฒเธเธขเธดเนเธเธ•เนเธญเธเธธเธ“เธ เธฒเธเธเธญเธเธชเธฒเธฃเธชเธณเธเธฑเธเนเธเธชเธกเธธเธเนเธเธฃ\r\n                        เธเธฃเธธเธ“เธฒเธฃเธฐเธเธธเธเนเธญเธกเธนเธฅเนเธซเนเธ•เธฃเธเธเธฑเธเธเธงเธฒเธกเน€เธเนเธเธเธฃเธดเธเน€เธเธทเนเธญเธเธฒเธฃเธเธฃเธฐเน€เธกเธดเธเธเธงเธฒเธกเน€เธชเธตเนเธขเธเธ—เธตเนเธ–เธนเธเธ•เนเธญเธ\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 animate-slide-up\" style={{ animationDelay: '100ms' }}>\r\n                {/* 1. Harvest & Drying */}\r\n                <div className=\"space-y-6\">\r\n                    <div className=\"gacp-card p-6 space-y-5 border-emerald-100 bg-gradient-to-br from-emerald-50/30 to-white\">\r\n                        <div className=\"flex items-center gap-2 mb-2\">\r\n                            <span className=\"text-2xl\">๐พ</span>\r\n                            <h3 className=\"font-bold text-gray-900\">เธงเธดเธเธตเธเธฒเธฃเน€เธเนเธเน€เธเธตเนเธขเธง (Harvesting)</h3>\r\n                        </div>\r\n\r\n                        <div>\r\n                            <FormLabelWithHint label=\"เธงเธดเธเธตเธเธฒเธฃเน€เธเนเธเน€เธเธตเนเธขเธง\" required />\r\n                            <select\r\n                                className={`gacp-input bg-white ${touched.harvestMethod && errors.harvestMethod ? 'border-danger ring-danger/10' : ''}`}\r\n                                value={formData.harvestMethod}\r\n                                onChange={(e) => handleChange('harvestMethod', e.target.value)}\r\n                            >\r\n                                <option value=\"\">-- เธเธฃเธธเธ“เธฒเน€เธฅเธทเธญเธ --</option>\r\n                                <option value=\"MANUAL\">เน€เธเนเธเธ”เนเธงเธขเธกเธทเธญ (Manual)</option>\r\n                                <option value=\"MACHINE\">เนเธเนเน€เธเธฃเธทเนเธญเธเธเธฑเธเธฃ (Machine)</option>\r\n                            </select>\r\n                            {touched.harvestMethod && errors.harvestMethod && (\r\n                                <p className=\"text-xs text-danger mt-1.5 flex items-center gap-1 font-medium italic\">\r\n                                    <WarningIcon className=\"w-3 h-3\" /> {errors.harvestMethod}\r\n                                </p>\r\n                            )}\r\n                        </div>\r\n\r\n                        <div className=\"p-4 bg-emerald-50/50 rounded-xl border border-emerald-100 flex gap-3 text-xs text-emerald-700\">\r\n                            <div className=\"mt-0.5\">๐’ก</div>\r\n                            <p>เน€เธฅเธทเธญเธ \"Machine\" เธซเธฒเธเนเธเนเธฃเธ–เน€เธเธตเนเธขเธงเธเนเธฒเธงเธซเธฃเธทเธญเธญเธธเธเธเธฃเธ“เนเธ—เธธเนเธเนเธฃเธเธเธเธฒเธ”เนเธซเธเน เธซเธฒเธเนเธเนเนเธฃเธเธเธฒเธเธเธเนเธฅเธฐเธญเธธเธเธเธฃเธ“เนเธเธเธฒเธ”เน€เธฅเนเธ เนเธซเนเน€เธฅเธทเธญเธ \"Manual\"</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"gacp-card p-6 space-y-5 border-orange-100 bg-gradient-to-br from-orange-50/30 to-white\">\r\n                        <div className=\"flex items-center gap-2 mb-2\">\r\n                            <span className=\"text-2xl\">โ€๏ธ</span>\r\n                            <h3 className=\"font-bold text-gray-900\">เธเธฒเธฃเธฅเธ”เธเธงเธฒเธกเธเธทเนเธ (Drying)</h3>\r\n                        </div>\r\n\r\n                        <div>\r\n                            <FormLabelWithHint label=\"เธงเธดเธเธตเธเธฒเธฃเธฅเธ”เธเธงเธฒเธกเธเธทเนเธ\" required />\r\n                            <select\r\n                                className={`gacp-input bg-white ${touched.dryingMethod && errors.dryingMethod ? 'border-danger ring-danger/10' : ''}`}\r\n                                value={formData.dryingMethod}\r\n                                onChange={(e) => handleChange('dryingMethod', e.target.value)}\r\n                            >\r\n                                <option value=\"\">-- เธเธฃเธธเธ“เธฒเน€เธฅเธทเธญเธ --</option>\r\n                                <option value=\"SUN\">เธ•เธฒเธเนเธ”เธ”เธเธฃเธฃเธกเธเธฒเธ•เธด (Sun Dry)</option>\r\n                                <option value=\"OVEN\">เธ•เธนเนเธญเธเธเธงเธฒเธกเธฃเนเธญเธ (Hot Air Oven)</option>\r\n                                <option value=\"DEHYDRATOR\">เน€เธเธฃเธทเนเธญเธเธฅเธ”เธเธงเธฒเธกเธเธทเนเธ (Dehydrator)</option>\r\n                                <option value=\"OTHER\">เธญเธทเนเธเน (Other)</option>\r\n                            </select>\r\n                            {touched.dryingMethod && errors.dryingMethod && (\r\n                                <p className=\"text-xs text-danger mt-1.5 flex items-center gap-1 font-medium italic\">\r\n                                    <WarningIcon className=\"w-3 h-3\" /> {errors.dryingMethod}\r\n                                </p>\r\n                            )}\r\n                        </div>\r\n\r\n                        {formData.dryingMethod === 'OTHER' && (\r\n                            <div className=\"animate-slide-down\">\r\n                                <FormLabelWithHint label=\"เนเธเธฃเธ”เธฃเธฐเธเธธเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”\" required />\r\n                                <input\r\n                                    type=\"text\"\r\n                                    className={`gacp-input bg-white ${touched.dryingDetail && errors.dryingDetail ? 'border-danger ring-danger/10' : ''}`}\r\n                                    placeholder=\"เน€เธเนเธ เธ•เธฒเธเนเธเธซเนเธญเธเธเธงเธเธเธธเธกเธเธงเธฒเธกเธเธทเนเธ...\"\r\n                                    value={formData.dryingDetail}\r\n                                    onChange={(e) => handleChange('dryingDetail', e.target.value)}\r\n                                />\r\n                                {touched.dryingDetail && errors.dryingDetail && (\r\n                                    <p className=\"text-xs text-danger mt-1.5 flex items-center gap-1 font-medium italic\">\r\n                                        <WarningIcon className=\"w-3 h-3\" /> {errors.dryingDetail}\r\n                                    </p>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n\r\n                        <div className=\"p-4 bg-orange-50/50 rounded-xl border border-orange-100 flex gap-3 text-xs text-orange-700\">\r\n                            <div className=\"mt-0.5\">๐“</div>\r\n                            <p><strong>Requirement:</strong> เธเธงเธฒเธกเธเธทเนเธเธ—เธตเนเน€เธซเธกเธฒเธฐเธชเธกเธเธญเธเธเธฅเธเธฅเธดเธ•เนเธซเนเธเธเธงเธฃเธ•เนเธณเธเธงเนเธฒ 10-12% เน€เธเธทเนเธญเธเนเธญเธเธเธฑเธเธเธฒเธฃเน€เธเธดเธ”เน€เธเธทเนเธญเธฃเธฒเนเธฅเธฐเธชเธฒเธฃ Aflatoxin</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* 2. Storage & Packaging */}\r\n                <div className=\"space-y-6\">\r\n                    <div className=\"gacp-card p-6 space-y-6 border-blue-100 bg-gradient-to-br from-blue-50/30 to-white h-full relative overflow-hidden\">\r\n                        <div className=\"absolute top-0 right-0 w-32 h-32 bg-blue-100/20 rounded-full blur-2xl -mr-16 -mt-16 pointer-events-none\"></div>\r\n\r\n                        <div className=\"flex items-center gap-2 mb-2 relative z-10\">\r\n                            <span className=\"text-2xl\">๐“ฆ</span>\r\n                            <h3 className=\"font-bold text-gray-900\">เธเธฒเธฃเน€เธเนเธเธฃเธฑเธเธฉเธฒ (Storage)</h3>\r\n                        </div>\r\n\r\n                        <div className=\"relative z-10\">\r\n                            <FormLabelWithHint label=\"เธชเธ–เธฒเธเธ—เธตเนเน€เธเนเธเธฃเธฑเธเธฉเธฒ\" required />\r\n                            <select\r\n                                className={`gacp-input bg-white ${touched.storageSystem && errors.storageSystem ? 'border-danger ring-danger/10' : ''}`}\r\n                                value={formData.storageSystem}\r\n                                onChange={(e) => handleChange('storageSystem', e.target.value)}\r\n                            >\r\n                                <option value=\"\">-- เธเธฃเธธเธ“เธฒเน€เธฅเธทเธญเธ --</option>\r\n                                <option value=\"CONTROLLED\">เธซเนเธญเธเธเธงเธเธเธธเธกเธญเธธเธ“เธซเธ เธนเธกเธด (Controlled Temp)</option>\r\n                                <option value=\"AMBIENT\">เธซเนเธญเธเธญเธธเธ“เธซเธ เธนเธกเธดเธเธเธ•เธด (Ambient Temp)</option>\r\n                            </select>\r\n                            {touched.storageSystem && errors.storageSystem && (\r\n                                <p className=\"text-xs text-danger mt-1.5 flex items-center gap-1 font-medium italic\">\r\n                                    <WarningIcon className=\"w-3 h-3\" /> {errors.storageSystem}\r\n                                </p>\r\n                            )}\r\n                            <p className=\"text-[10px] text-slate-400 mt-2 italic px-1\">\r\n                                * เธชเธ–เธฒเธเธ—เธตเนเน€เธเนเธเธ•เนเธญเธเนเธขเธเธเธฒเธเธชเธฒเธฃเน€เธเธกเธต เธเธธเนเธข เนเธฅเธฐเธ—เธณเธเธงเธฒเธกเธชเธฐเธญเธฒเธ”เธเนเธฒเธข\r\n                            </p>\r\n                        </div>\r\n\r\n                        <div className=\"relative z-10\">\r\n                            <FormLabelWithHint label=\"เธเธฃเธฃเธเธธเธ เธฑเธ“เธ‘เน (Packaging)\" required />\r\n                            <textarea\r\n                                className={`gacp-input bg-white h-32 resize-none ${touched.packaging && errors.packaging ? 'border-danger ring-danger/10' : ''}`}\r\n                                placeholder=\"เธฃเธฐเธเธธเธเธเธดเธ”เธ–เธธเธ/เธ เธฒเธเธเธฐเธ—เธตเนเนเธเนเธเธฃเธฃเธเธธ เน€เธเนเธ เธ–เธธเธเธชเธนเธเธเธฒเธเธฒเธจ Food Grade, เธเธฃเธฐเธชเธญเธเธเนเธฒเธเนเธซเธกเน...\"\r\n                                value={formData.packaging}\r\n                                onChange={(e) => handleChange('packaging', e.target.value)}\r\n                            />\r\n                            {touched.packaging && errors.packaging && (\r\n                                <p className=\"text-xs text-danger mt-1.5 flex items-center gap-1 font-medium italic\">\r\n                                    <WarningIcon className=\"w-3 h-3\" /> {errors.packaging}\r\n                                </p>\r\n                            )}\r\n                            <div className=\"flex items-start gap-2 mt-3 p-3 bg-blue-50/50 rounded-xl border border-blue-100 text-xs text-blue-700\">\r\n                                <span className=\"text-blue-500\">๐’ก</span>\r\n                                <p>เธเธงเธฃเนเธเนเธงเธฑเธชเธ”เธธเธ—เธตเนเธชเธฐเธญเธฒเธ” เนเธซเนเธ เนเธฅเธฐเน€เธเนเธ Food Grade เน€เธเธทเนเธญเธเนเธญเธเธเธฑเธเธเธฒเธฃเธเธเน€เธเธทเนเธญเธเธเนเธณ</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Warning Alert for GACP */}\r\n            <div className=\"gacp-card border-amber-200 bg-amber-50/50 p-6 flex items-start gap-4 animate-slide-up\" style={{ animationDelay: '200ms' }}>\r\n                <div className=\"p-2 bg-white rounded-xl shadow-sm text-2xl\">โ ๏ธ</div>\r\n                <div>\r\n                    <h4 className=\"font-bold text-amber-900 mb-2\">เธเนเธญเธชเธณเธเธฑเธเธ•เธฒเธกเธกเธฒเธ•เธฃเธเธฒเธ GACP</h4>\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                        <div className=\"flex items-center gap-2 text-xs text-amber-800\">\r\n                            <div className=\"w-1.5 h-1.5 rounded-full bg-amber-400\"></div>\r\n                            <span>เนเธกเนเธงเธฒเธเธเธฅเธเธฅเธดเธ•เธชเธฑเธกเธเธฑเธชเธเธทเนเธเธ”เธดเธเนเธ”เธขเธ•เธฃเธ</span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2 text-xs text-amber-800\">\r\n                            <div className=\"w-1.5 h-1.5 rounded-full bg-amber-400\"></div>\r\n                            <span>เธ เธฒเธเธเธฐเธเธฃเธฃเธเธธเธ•เนเธญเธเธชเธฐเธญเธฒเธ”เนเธฅเธฐเนเธซเนเธเธชเธเธดเธ—</span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2 text-xs text-amber-800\">\r\n                            <div className=\"w-1.5 h-1.5 rounded-full bg-amber-400\"></div>\r\n                            <span>เธเธงเธฒเธกเธเธทเนเธเธเธงเธฃเธ•เนเธณเธเธงเนเธฒ 10-12%</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* 3. QR Tracking Preview */}\r\n            <div className=\"gacp-card border-teal-200 bg-gradient-to-br from-teal-50/50 to-white p-8 space-y-6 animate-slide-up relative overflow-hidden\" style={{ animationDelay: '300ms' }}>\r\n                <div className=\"absolute top-0 right-0 w-64 h-64 bg-emerald-100/20 rounded-full blur-3xl -mr-20 -mt-20 pointer-events-none\"></div>\r\n\r\n                <div className=\"flex items-center gap-3 relative z-10\">\r\n                    <div className=\"p-3 bg-teal-100 text-teal-600 rounded-2xl shadow-sm\">\r\n                        <Icons.QrCode className=\"w-6 h-6\" />\r\n                    </div>\r\n                    <div>\r\n                        <h3 className=\"text-lg font-bold text-gray-900 tracking-tight\">QR Traceability (เธ•เธฃเธงเธเธชเธญเธเธขเนเธญเธเธเธฅเธฑเธ)</h3>\r\n                        <p className=\"text-xs text-gray-500\">เธงเธฒเธเนเธเธเธเธฒเธฃเธ•เธดเธ”เธ•เธฒเธกเธเธฅเธเธฅเธดเธ•เธ•เธฑเนเธเนเธ•เนเน€เธฃเธดเนเธกเธเธฅเธนเธเธเธเธ–เธถเธเธงเธฑเธเน€เธเนเธเน€เธเธตเนเธขเธง</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 relative z-10\">\r\n                    <div>\r\n                        <FormLabelWithHint label=\"เธงเธฑเธเธ—เธตเนเธเธฒเธ”เธงเนเธฒเธเธฐเน€เธฃเธดเนเธกเธเธฅเธนเธ\" />\r\n                        <input\r\n                            type=\"date\"\r\n                            className=\"gacp-input bg-white font-bold text-primary-900\"\r\n                            value={state.cultivationDetails?.plantingDate || ''}\r\n                            onChange={(e) => {\r\n                                const plantingDate = e.target.value;\r\n                                const harvestDate = plantingDate ?\r\n                                    new Date(new Date(plantingDate).getTime() + 120 * 24 * 60 * 60 * 1000).toISOString().split('T')[0] : '';\r\n                                updateState({\r\n                                    cultivationDetails: {\r\n                                        ...(state.cultivationDetails || { method: 'outdoor', strainId: '', totalPlants: 0, plantingDate: '' }),\r\n                                        plantingDate,\r\n                                        estimatedHarvestDate: harvestDate\r\n                                    }\r\n                                });\r\n                            }}\r\n                        />\r\n                    </div>\r\n                    <div>\r\n                        <FormLabelWithHint label=\"เธงเธฑเธเธ—เธตเนเธเธฒเธ”เธงเนเธฒเธเธฐเน€เธเนเธเน€เธเธตเนเธขเธง (เน€เธเธฅเธตเนเธข 120 เธงเธฑเธ)\" />\r\n                        <div className=\"relative\">\r\n                            <input\r\n                                type=\"date\"\r\n                                className=\"gacp-input bg-gray-50 text-gray-400 font-bold border-gray-100\"\r\n                                value={state.cultivationDetails?.estimatedHarvestDate || ''}\r\n                                readOnly\r\n                            />\r\n                            <div className=\"absolute right-4 top-1/2 -translate-y-1/2\">\r\n                                <span className=\"text-[10px] font-bold text-primary-500 bg-primary-50 px-2 py-1 rounded-md\">Auto-calc</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"bg-white/70 backdrop-blur-sm rounded-3xl p-6 border border-teal-100 shadow-inner relative z-10\">\r\n                    <PlantQRCalculator\r\n                        plantCount={state.cultivationDetails?.totalPlants || state.lots?.reduce((s, l) => s + l.plantCount, 0) || 100}\r\n                        plantingDate={state.cultivationDetails?.plantingDate || new Date().toISOString().split('T')[0]}\r\n                        showPreview={true}\r\n                        onChange={(count, cost) => updateState({ qrCount: count, estimatedQRCost: cost })}\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"flex items-start gap-4 p-5 bg-teal-50/80 rounded-2xl border border-teal-100 relative z-10\">\r\n                    <div className=\"p-2 bg-white rounded-xl shadow-sm h-fit\">\r\n                        <CheckIcon className=\"w-5 h-5 text-teal-600\" />\r\n                    </div>\r\n                    <p className=\"text-xs text-teal-800 leading-relaxed\">\r\n                        <strong>เธซเธกเธฒเธขเน€เธซเธ•เธธ:</strong> เธฃเธฐเธเธเธเธฐเธญเธญเธ QR Code เธเธฃเธฐเธเธณเธ•เนเธเนเธซเนเธซเธฅเธฑเธเธเธฒเธเธ—เธตเนเธเธณเธเธญเนเธ”เนเธฃเธฑเธเธเธฒเธฃเธญเธเธธเธกเธฑเธ•เธดเธเธทเนเธเธเธฒเธเนเธฅเนเธง เนเธ”เธขเธฃเธซเธฑเธชเธเธฐเธ–เธนเธเธเธณเนเธเนเธเนเนเธเธเธฑเนเธเธ•เธญเธเธเธฒเธฃเธ•เธดเธ”เธ•เธฒเธกเธ”เธนเนเธฅเธฃเธฑเธเธฉเธฒเนเธฅเธฐเธเธฒเธฃเน€เธเนเธเน€เธเธตเนเธขเธงเธ•เนเธญเนเธ\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <WizardNavigation\r\n                onNext={() => {\r\n                    const allTouched = Object.keys(formData).reduce((acc, key) => ({ ...acc, [key]: true }), {});\r\n                    setTouched(allTouched);\r\n                    if (isValid) router.push('/farmer/applications/new/step/9');\r\n                }}\r\n                onBack={() => router.push('/farmer/applications/new/step/7')}\r\n                isNextDisabled={!isValid}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StepHarvest;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepInvoice.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'language' is assigned a value but never used.","line":18,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":27},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepInvoice.tsx:25:62\n  23 |     const [phase, setPhase] = useState<1 | 2>(1);\n  24 |\n> 25 |     const invoiceNumber = `INV-${new Date().getFullYear()}${(Math.random() * 10000).toFixed(0)}`;\n     |                                                              ^^^^^^^^^^^^^ Cannot call impure function\n  26 |     const currentDate = new Date();\n  27 |     const dueDate = new Date();\n  28 |     dueDate.setDate(dueDate.getDate() + 7);","line":25,"column":62,"nodeType":null,"endLine":25,"endColumn":75}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useWizardStore } from '../hooks/useWizardStore';\r\nimport Image from 'next/image';\r\nimport { ApplicationService, Application } from '@/lib/services/application-service';\r\nimport { apiClient } from '@/lib/api/api-client';\r\nimport { useRouter } from 'next/navigation';\r\nimport { WizardNavigation } from '@/components/wizard/WizardNavigation';\r\nimport { SecureIcon, InfoIcon, CheckIcon } from '@/components/icons/WizardIcons';\r\nimport { Icons } from '@/components/ui/icons';\r\nimport { useLanguage } from '@/lib/i18n/LanguageContext';\r\nimport { InvoicePDF } from './InvoicePDF';\r\n\r\nexport const StepInvoice = () => {\r\n    const { setCurrentStep, state } = useWizardStore();\r\n    const router = useRouter();\r\n    const { dict, language } = useLanguage();\r\n    const [showQrModal, setShowQrModal] = useState(false);\r\n    const [showInvoicePdf, setShowInvoicePdf] = useState(false);\r\n    const [isProcessing, setIsProcessing] = useState(false);\r\n    const [appData, setAppData] = useState<Application | null>(null);\r\n    const [phase, setPhase] = useState<1 | 2>(1);\r\n\r\n    const invoiceNumber = `INV-${new Date().getFullYear()}${(Math.random() * 10000).toFixed(0)}`;\r\n    const currentDate = new Date();\r\n    const dueDate = new Date();\r\n    dueDate.setDate(dueDate.getDate() + 7);\r\n\r\n    const [invoiceItems, setInvoiceItems] = useState<{ label: string; amount: number }[]>([]);\r\n\r\n    useEffect(() => {\r\n        const fetchApp = async () => {\r\n            const res = await ApplicationService.getMyApplications();\r\n            if (res.success && res.data) {\r\n                const apps: Application[] = Array.isArray(res.data)\r\n                    ? res.data\r\n                    : (res.data as unknown as { data: Application[] })?.data || [];\r\n                const activeApp = apps[0];\r\n                if (activeApp) {\r\n                    setAppData(activeApp);\r\n                    let currentPhase: 1 | 2 = 1;\r\n                    if (activeApp.status === 'PAYMENT_2_PENDING') {\r\n                        currentPhase = 2;\r\n                    }\r\n                    setPhase(currentPhase);\r\n\r\n                    const feeData = activeApp.fees || {};\r\n                    const phaseData = currentPhase === 1 ? feeData.phase1 : feeData.phase2;\r\n\r\n                    if (phaseData && phaseData.items) {\r\n                        setInvoiceItems(phaseData.items.map((i) => ({\r\n                            label: i.description,\r\n                            amount: i.amount\r\n                        })));\r\n                    } else {\r\n                        // Use values from state.milestone1 if available (from StepQuote)\r\n                        if (currentPhase === 1 && state.milestone1) {\r\n                            const items = [];\r\n                            if (state.milestone1.dtamQuote) items.push({ label: dict.wizard.quote.dtam.title, amount: state.milestone1.dtamQuote.amount });\r\n                            if (state.milestone1.platformQuote) items.push({ label: dict.wizard.quote.platform.title, amount: state.milestone1.platformQuote.amount });\r\n                            setInvoiceItems(items);\r\n                        } else {\r\n                            // Fallback\r\n                            if (currentPhase === 1) {\r\n                                setInvoiceItems([\r\n                                    { label: dict.wizard.invoice.items.standardFee, amount: 5000 },\r\n                                    { label: 'Platform Service Fee', amount: 500 }\r\n                                ]);\r\n                            } else {\r\n                                setInvoiceItems([\r\n                                    { label: dict.wizard.invoice.items.auditFee, amount: 25000 }\r\n                                ]);\r\n                            }\r\n                        }\r\n                    }\r\n                    setCurrentStep(13); // Step 14 = index 13\r\n                }\r\n            }\r\n        };\r\n        fetchApp();\r\n    }, [setCurrentStep, dict, state.milestone1]);\r\n\r\n    const handlePayClick = () => {\r\n        setIsProcessing(true);\r\n        setTimeout(() => {\r\n            setIsProcessing(false);\r\n            setShowQrModal(true);\r\n        }, 800);\r\n    };\r\n\r\n    const handlePaymentSuccess = async () => {\r\n        setIsProcessing(true);\r\n        try {\r\n            if (appData && appData._id) {\r\n                const total = invoiceItems.reduce((acc, item) => acc + item.amount, 0);\r\n                await apiClient.post(`/applications/${appData._id}/payment`, {\r\n                    phase: phase,\r\n                    amount: total,\r\n                    method: 'QR_CASH'\r\n                });\r\n            }\r\n\r\n            setTimeout(() => {\r\n                if (phase === 2) {\r\n                    router.push('/farmer/dashboard');\r\n                } else {\r\n                    router.push('/farmer/applications/new/step/15');\r\n                }\r\n            }, 1000);\r\n        } catch (error) {\r\n            console.error(\"Payment Error\", error);\r\n            alert(\"Payment failed\");\r\n            setIsProcessing(false);\r\n        }\r\n    };\r\n\r\n    const totalAmount = invoiceItems.reduce((acc, item) => acc + item.amount, 0);\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in pb-20 max-w-5xl mx-auto\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center gap-4 mb-4\">\r\n                <div className=\"w-12 h-12 bg-primary gradient-mask rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-primary-50\">\r\n                    14\r\n                </div>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-primary-900\">\r\n                        {phase === 1 ? dict.wizard.invoice.phase1Title : dict.wizard.invoice.phase2Title}\r\n                    </h2>\r\n                    <p className=\"text-text-secondary\">เนเธเนเธเนเธเธเธณเธฃเธฐเน€เธเธดเธเธชเธณเธซเธฃเธฑเธเธเธฒเธฃเธเธดเธเธฒเธฃเธ“เธฒเธกเธฒเธ•เธฃเธเธฒเธ GACP</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Main Content Area */}\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-8 items-start\">\r\n\r\n                {/* Left Column: The Invoice Paper */}\r\n                <div className=\"lg:col-span-8 group\">\r\n                    <div className=\"relative\">\r\n                        {/* Shadow Decor */}\r\n                        <div className=\"absolute inset-0 bg-primary-900/5 rounded-[2rem] blur-3xl -z-10 translate-y-4 scale-95 opacity-0 group-hover:opacity-100 transition-opacity\"></div>\r\n\r\n                        <div className=\"bg-white rounded-[2rem] shadow-premium overflow-hidden border border-gray-100 relative z-10 animate-slide-up\">\r\n                            {/* Paper Texture/Pattern */}\r\n                            <div className=\"absolute inset-0 opacity-[0.03] pointer-events-none bg-[url('https://www.transparenttextures.com/patterns/natural-paper.png')]\"></div>\r\n\r\n                            {/* Color Bar */}\r\n                            <div className=\"h-3 bg-gradient-to-r from-primary-400 via-primary to-primary-800\"></div>\r\n\r\n                            <div className=\"p-8 md:p-12\">\r\n                                {/* Letterhead */}\r\n                                <div className=\"flex flex-col md:flex-row justify-between items-start border-b border-gray-100 pb-10 mb-10 gap-8\">\r\n                                    <div className=\"flex items-start gap-5\">\r\n                                        <div className=\"w-20 h-20 bg-white rounded-2xl shadow-premium-hover border border-gray-50 flex items-center justify-center p-2 relative overflow-hidden\">\r\n                                            <Image src=\"/dtam_logo_new.png\" alt=\"DTAM\" fill className=\"object-contain p-2\" />\r\n                                        </div>\r\n                                        <div>\r\n                                            <h1 className=\"text-xl font-black text-primary-900 leading-tight\">เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</h1>\r\n                                            <p className=\"text-[10px] text-gray-400 font-bold uppercase tracking-wider mt-1\">Ministry of Public Health, Thailand</p>\r\n                                            <p className=\"text-[10px] text-gray-500 mt-2 leading-relaxed max-w-xs\">{dict.wizard.invoice.paper.orgAddress}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"text-right w-full md:w-auto space-y-4\">\r\n                                        <div className=\"inline-block px-5 py-2 bg-primary-900 text-white text-sm font-black rounded-2xl shadow-lg uppercase tracking-widest\">\r\n                                            {dict.wizard.invoice.paper.invoiceTitle}\r\n                                        </div>\r\n                                        <div className=\"space-y-1.5 bg-gray-50 p-5 rounded-2xl border border-gray-200/50 min-w-[220px]\">\r\n                                            <p className=\"flex justify-between items-center text-[10px] font-black uppercase text-gray-400\">\r\n                                                <span>{dict.wizard.invoice.paper.no}</span>\r\n                                                <span className=\"text-gray-900\">{invoiceNumber}</span>\r\n                                            </p>\r\n                                            <p className=\"flex justify-between items-center text-[10px] font-black uppercase text-gray-400\">\r\n                                                <span>{dict.wizard.invoice.paper.date}</span>\r\n                                                <span className=\"text-gray-900\">{currentDate.toLocaleDateString('th-TH')}</span>\r\n                                            </p>\r\n                                            <p className=\"flex justify-between items-center text-[10px] font-black uppercase text-gray-400\">\r\n                                                <span>{dict.wizard.invoice.paper.dueDate}</span>\r\n                                                <span className=\"text-danger font-black\">{dueDate.toLocaleDateString('th-TH')}</span>\r\n                                            </p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Billing Info */}\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10 mb-12\">\r\n                                    <div className=\"space-y-3\">\r\n                                        <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{dict.wizard.invoice.paper.customer}</p>\r\n                                        <div className=\"p-4 rounded-2xl bg-gray-50 border border-gray-100\">\r\n                                            <p className=\"font-black text-gray-900 text-lg\">\r\n                                                {appData?.applicantData?.firstName || 'เธเธนเนเธขเธทเนเธเธเธณเธเธญ GACP'} {appData?.applicantData?.lastName || ''}\r\n                                            </p>\r\n                                            <p className=\"text-xs text-gray-500 mt-1 leading-relaxed\">\r\n                                                {appData?.applicantData?.address || '-'}\r\n                                            </p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"space-y-3\">\r\n                                        <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">เธชเธ–เธฒเธเธ—เธตเนเธเธฅเธนเธ / เนเธเธฅเธ</p>\r\n                                        <div className=\"p-4 rounded-2xl bg-gray-50 border border-gray-100\">\r\n                                            <p className=\"font-bold text-gray-800 text-sm\">{state.farmData?.farmName || '-'}</p>\r\n                                            <p className=\"text-[10px] text-gray-400 font-bold uppercase tracking-wider mt-1\">{state.plantId?.toUpperCase() || '-'} Certification</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Items Table */}\r\n                                <div className=\"border border-gray-100 rounded-[2rem] overflow-hidden shadow-inner mb-10\">\r\n                                    <table className=\"w-full text-sm\">\r\n                                        <thead>\r\n                                            <tr className=\"bg-primary text-white\">\r\n                                                <th className=\"py-5 px-6 text-left text-[10px] font-black uppercase tracking-widest\">{dict.wizard.invoice.table.description}</th>\r\n                                                <th className=\"py-5 px-6 text-right text-[10px] font-black uppercase tracking-widest w-40\">{dict.wizard.invoice.table.amount}</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody className=\"divide-y divide-gray-50\">\r\n                                            {invoiceItems.map((item, idx) => (\r\n                                                <tr key={idx} className=\"group/row hover:bg-primary-50/30 transition-colors\">\r\n                                                    <td className=\"py-6 px-6\">\r\n                                                        <p className=\"font-black text-gray-800\">{item.label}</p>\r\n                                                        <p className=\"text-[10px] text-gray-400 font-bold uppercase tracking-tight mt-1\">GACP Standard Compliance Audit</p>\r\n                                                    </td>\r\n                                                    <td className=\"py-6 px-6 text-right font-black text-gray-900 text-lg\">เธฟ{item.amount.toLocaleString()}.00</td>\r\n                                                </tr>\r\n                                            ))}\r\n                                            {/* Empty rows to maintain height */}\r\n                                            {invoiceItems.length < 3 && [...Array(3 - invoiceItems.length)].map((_, i) => (\r\n                                                <tr key={i}><td className=\"py-8 px-6\"></td><td className=\"py-8 px-6\"></td></tr>\r\n                                            ))}\r\n                                        </tbody>\r\n                                        <tfoot className=\"bg-primary-900 text-white\">\r\n                                            <tr>\r\n                                                <td className=\"py-8 px-8 text-right font-black uppercase tracking-widest text-white/60\">\r\n                                                    {dict.wizard.invoice.table.total}\r\n                                                </td>\r\n                                                <td className=\"py-8 px-8 text-right font-black text-4xl tracking-tighter shadow-xl\">\r\n                                                    เธฟ{totalAmount.toLocaleString()}.00\r\n                                                </td>\r\n                                            </tr>\r\n                                        </tfoot>\r\n                                    </table>\r\n                                </div>\r\n\r\n                                {/* Note */}\r\n                                <div className=\"flex flex-col md:flex-row justify-between items-center gap-6 text-[10px] text-gray-400 font-bold uppercase tracking-widest\">\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <div className=\"w-8 h-px bg-gray-200\"></div>\r\n                                        <span>Digital Signature Authenticated</span>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <span>Generated at {new Date().toLocaleTimeString()}</span>\r\n                                        <div className=\"w-8 h-px bg-gray-200\"></div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Right Column: Payment Actions */}\r\n                <div className=\"lg:col-span-4 space-y-6\">\r\n                    <div className=\"gacp-card p-8 bg-white border-primary shadow-premium animate-slide-up\" style={{ animationDelay: '100ms' }}>\r\n                        <h3 className=\"text-xl font-black text-primary-900 mb-6 flex items-center gap-3\">\r\n                            <div className=\"p-2 bg-primary/10 rounded-xl\">\r\n                                <SecureIcon className=\"w-6 h-6 text-primary\" />\r\n                            </div>\r\n                            เธเธณเธฃเธฐเน€เธเธดเธเธ—เธฑเธเธ—เธต\r\n                        </h3>\r\n\r\n                        <div className=\"space-y-4 mb-8\">\r\n                            <div className=\"p-5 rounded-2xl bg-gray-50 border border-gray-200/50 space-y-1\">\r\n                                <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest leading-none\">Net Amount Due</p>\r\n                                <p className=\"text-4xl font-black text-gray-900\">เธฟ{totalAmount.toLocaleString()}</p>\r\n                            </div>\r\n\r\n                            <div className=\"p-4 rounded-xl bg-blue-50/50 border border-blue-100 flex gap-3 text-blue-900\">\r\n                                <InfoIcon className=\"w-5 h-5 shrink-0 text-blue-500 mt-0.5\" />\r\n                                <p className=\"text-[10px] font-bold leading-relaxed opacity-80\">\r\n                                    เธฃเธญเธเธฃเธฑเธเธเธฒเธฃเธเธณเธฃเธฐเธเนเธฒเธ Thai QR Payment, Mobile Banking เนเธฅเธฐเธเธฑเธ•เธฃเน€เธเธฃเธ”เธดเธ•เธ—เธธเธเธเธเธฒเธเธฒเธฃ\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <button\r\n                            onClick={handlePayClick}\r\n                            disabled={isProcessing}\r\n                            className={`\r\n                                w-full py-4 rounded-2xl font-black text-white shadow-lg transition-all flex items-center justify-center gap-3\r\n                                ${isProcessing\r\n                                    ? 'bg-gray-400 cursor-not-allowed'\r\n                                    : 'bg-primary hover:bg-primary-600 hover:shadow-primary/30 hover:-translate-y-1 active:scale-95'\r\n                                }\r\n                            `}\r\n                        >\r\n                            {isProcessing ? (\r\n                                <div className=\"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin\"></div>\r\n                            ) : (\r\n                                <Icons.CreditCard className=\"w-6 h-6\" />\r\n                            )}\r\n                            {isProcessing ? 'เธเธณเธฅเธฑเธเธ•เธฃเธงเธเธชเธญเธ...' : 'เธเธณเธฃเธฐเธเนเธฒเธ Mobile Banking'}\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className=\"gacp-card p-6 bg-gradient-to-br from-gray-900 to-black border-none text-white animate-slide-up\" style={{ animationDelay: '200ms' }}>\r\n                        <div className=\"flex gap-4 items-start\">\r\n                            <div className=\"p-3 bg-white/10 rounded-2xl backdrop-blur-md\">\r\n                                <Icons.FileText className=\"w-6 h-6 text-primary-300\" />\r\n                            </div>\r\n                            <div className=\"space-y-1\">\r\n                                <h4 className=\"font-bold text-sm\">เธ”เธฒเธงเธเนเนเธซเธฅเธ”เนเธเนเธเนเธเธซเธเธตเน</h4>\r\n                                <p className=\"text-[10px] text-white/50 leading-relaxed\">เธ—เนเธฒเธเธชเธฒเธกเธฒเธฃเธ–เธ”เธฒเธงเธเนเนเธซเธฅเธ”เนเธเธฅเน PDF เน€เธเนเธเนเธงเนเน€เธเนเธเธซเธฅเธฑเธเธเธฒเธเธเธฒเธฃเธ—เธณเธฃเธฒเธขเธเธฒเธฃ</p>\r\n                                <button\r\n                                    onClick={() => setShowInvoicePdf(true)}\r\n                                    className=\"text-[10px] font-black uppercase text-primary-300 hover:underline pt-2\"\r\n                                >\r\n                                    View Official PDF\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <WizardNavigation\r\n                onNext={handlePayClick}\r\n                onBack={() => phase === 2 ? router.push('/farmer/dashboard') : router.push('/farmer/applications/new/step/13')}\r\n                isNextDisabled={isProcessing}\r\n                nextLabel={dict.wizard.invoice.modal.simulate}\r\n            />\r\n\r\n            {/* Simulated Payment Modal */}\r\n            {showQrModal && (\r\n                <div className=\"fixed inset-0 z-[1200] flex items-center justify-center bg-gray-900/80 backdrop-blur-sm p-4 animate-fade-in\">\r\n                    <div className=\"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl overflow-hidden animate-scale-in relative border border-white/20\">\r\n                        <div className=\"bg-[#E60000] p-8 text-white text-center relative overflow-hidden\">\r\n                            <div className=\"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-2xl -mr-16 -mt-16 pointer-events-none\"></div>\r\n                            <h3 className=\"text-3xl font-black relative z-10 tracking-tight\">Ksher Pay</h3>\r\n                            <p className=\"text-white/60 text-[10px] font-black uppercase tracking-widest mt-1 relative z-10\">Gateway Transaction</p>\r\n                        </div>\r\n\r\n                        <div className=\"p-10 text-center space-y-8\">\r\n                            <div>\r\n                                <p className=\"text-gray-400 font-black uppercase tracking-widest text-[10px] mb-2\">{dict.wizard.invoice.modal.scanQr}</p>\r\n                                <p className=\"text-5xl font-black text-gray-900 tracking-tighter\">เธฟ{totalAmount.toLocaleString()}</p>\r\n                            </div>\r\n\r\n                            <div className=\"w-64 h-64 bg-white mx-auto rounded-3xl border-4 border-gray-100 p-4 shadow-inner relative group cursor-pointer hover:border-primary transition-all\">\r\n                                <div className=\"absolute inset-0 bg-gradient-to-b from-primary/5 to-transparent animate-pulse rounded-2xl overflow-hidden pointer-events-none\"></div>\r\n                                <div className=\"w-full h-full bg-gray-900 rounded-2xl flex items-center justify-center relative overflow-hidden shadow-premium\">\r\n                                    <div className=\"grid grid-cols-2 grid-rows-2 w-full h-full p-4 bg-white relative\">\r\n                                        <div className=\"border-[8px] border-black m-2 rounded-xl\"></div>\r\n                                        <div className=\"border-[8px] border-black m-2 rounded-xl\"></div>\r\n                                        <div className=\"border-[8px] border-black m-2 rounded-xl\"></div>\r\n                                        <div className=\"flex items-center justify-center\">\r\n                                            <div className=\"w-12 h-12 bg-primary rounded-xl flex items-center justify-center text-white\">\r\n                                                <Icons.CheckCircle className=\"w-8 h-8\" />\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-4 pt-4\">\r\n                                <button\r\n                                    onClick={handlePaymentSuccess}\r\n                                    className=\"w-full py-4 bg-emerald-500 text-white font-black rounded-2xl shadow-xl shadow-emerald-200 hover:bg-emerald-600 hover:-translate-y-1 transition-all flex items-center justify-center gap-3\"\r\n                                >\r\n                                    <CheckIcon className=\"w-6 h-6\" />\r\n                                    {dict.wizard.invoice.modal.simulate}\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => setShowQrModal(false)}\r\n                                    className=\"text-gray-400 font-bold hover:text-gray-600 transition-colors text-sm\"\r\n                                >\r\n                                    {dict.wizard.invoice.modal.cancel}\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {showInvoicePdf && (\r\n                <InvoicePDF\r\n                    invoiceNumber={invoiceNumber}\r\n                    quoteNumber={state.milestone1?.dtamQuote?.number || \"G-011268017\"}\r\n                    onClose={() => setShowInvoicePdf(false)}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StepInvoice;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepLots.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckIcon' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useWizardStore, Lot } from '../hooks/useWizardStore';\r\nimport { useRouter } from 'next/navigation';\r\nimport { WizardNavigation } from '@/components/wizard/WizardNavigation';\r\nimport { CheckIcon, InfoIcon } from '@/components/icons/WizardIcons';\r\nimport { useLanguage } from '@/lib/i18n/LanguageContext';\r\n\r\nexport const StepLots = () => {\r\n    const { state, setLots } = useWizardStore();\r\n    const router = useRouter();\r\n    const { dict } = useLanguage();\r\n\r\n    // Local lots state (sync with store)\r\n    const [lots, setLotsLocal] = useState<Lot[]>(state.lots || []);\r\n\r\n    // Modal state\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n    const [currentLot, setCurrentLot] = useState<Partial<Lot>>({\r\n        lotCode: '',\r\n        plotId: '',\r\n        plantCount: 0,\r\n        estimatedPlantingDate: '',\r\n        status: 'PLANNED',\r\n        notes: '',\r\n    });\r\n\r\n    // Sync with store when lots change\r\n    useEffect(() => {\r\n        setLots(lots);\r\n    }, [lots, setLots]);\r\n\r\n    // Generate lot code\r\n    const generateLotCode = () => {\r\n        const year = new Date().getFullYear() % 100; // เน€เธญเธฒ 2 เธซเธฅเธฑเธเธ—เนเธฒเธข เน€เธเนเธ 67\r\n        const count = lots.length + 1;\r\n        return `LOT-${year}-${String(count).padStart(3, '0')}`;\r\n    };\r\n\r\n    // Get available plots from state (check both locations for compatibility)\r\n    const availablePlots = (state.siteData?.plots && state.siteData.plots.length > 0)\r\n        ? state.siteData.plots\r\n        : (state.plots || []);\r\n\r\n    // Handle add lot\r\n    const handleAddLot = () => {\r\n        if (!currentLot.plotId || !currentLot.plantCount) return;\r\n\r\n        const selectedPlot = availablePlots.find(p => p.id === currentLot.plotId);\r\n\r\n        const newLot: Lot = {\r\n            id: crypto.randomUUID(),\r\n            lotCode: currentLot.lotCode || generateLotCode(),\r\n            plotId: currentLot.plotId,\r\n            plotName: selectedPlot?.name || '',\r\n            plantCount: currentLot.plantCount || 0,\r\n            estimatedPlantingDate: currentLot.estimatedPlantingDate,\r\n            status: 'PLANNED',\r\n            notes: currentLot.notes,\r\n        };\r\n\r\n        setLotsLocal([...lots, newLot]);\r\n        setIsModalOpen(false);\r\n        setCurrentLot({\r\n            lotCode: '',\r\n            plotId: '',\r\n            plantCount: 0,\r\n            estimatedPlantingDate: '',\r\n            status: 'PLANNED',\r\n            notes: '',\r\n        });\r\n    };\r\n\r\n    // Handle remove lot\r\n    const handleRemoveLot = (id: string) => {\r\n        setLotsLocal(lots.filter(l => l.id !== id));\r\n    };\r\n\r\n    // Calculate total plants across all lots\r\n    const totalPlants = lots.reduce((sum, lot) => sum + (lot.plantCount || 0), 0);\r\n\r\n    // Get status badge color\r\n    const getStatusBadge = (status: Lot['status']) => {\r\n        switch (status) {\r\n            case 'PLANNED': return 'gacp-badge-warning';\r\n            case 'ACTIVE': return 'gacp-badge-success';\r\n            case 'HARVESTED': return 'gacp-badge-neutral';\r\n            case 'CANCELLED': return 'gacp-badge-danger';\r\n            default: return 'gacp-badge-neutral';\r\n        }\r\n    };\r\n\r\n    // Get status label\r\n    const getStatusLabel = (status: Lot['status']) => {\r\n        switch (status) {\r\n            case 'PLANNED': return 'เธงเธฒเธเนเธเธ';\r\n            case 'ACTIVE': return 'เธเธณเธฅเธฑเธเธเธฅเธนเธ';\r\n            case 'HARVESTED': return 'เน€เธเนเธเน€เธเธตเนเธขเธงเนเธฅเนเธง';\r\n            case 'CANCELLED': return 'เธขเธเน€เธฅเธดเธ';\r\n            default: return status;\r\n        }\r\n    };\r\n\r\n    // Validation\r\n    const canProceed = lots.length > 0;\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center gap-4 mb-4\">\r\n                <div className=\"w-12 h-12 bg-primary gradient-mask rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-primary-50\">\r\n                    6\r\n                </div>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-primary-900\">{dict.wizard.steps.lots || 'เธเธฑเธ”เธเธฒเธฃเธฅเนเธญเธ•เธเธฒเธฃเธเธฅเธดเธ• (Lots Management)'}</h2>\r\n                    <p className=\"text-text-secondary\">เธงเธฒเธเนเธเธเนเธฅเธฐเธเธฑเธ”เธเธฒเธฃเธฅเนเธญเธ•เธเธฒเธฃเธเธฅเธนเธเน€เธเธทเนเธญเธเธฒเธฃเธ•เธดเธ”เธ•เธฒเธกเธขเนเธญเธเธเธฅเธฑเธ (Traceability)</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Summary Card */}\r\n            <div className=\"gacp-card bg-gradient-to-br from-teal-50 to-white border-teal-100 relative overflow-hidden\">\r\n                <div className=\"absolute top-0 right-0 w-64 h-64 bg-teal-100/30 rounded-full blur-3xl -mr-20 -mt-20 pointer-events-none\"></div>\r\n                <div className=\"flex justify-between items-center relative z-10\">\r\n                    <div>\r\n                        <p className=\"text-xs font-bold text-teal-600 uppercase tracking-wider mb-1\">เธเธณเธเธงเธเธฅเนเธญเธ•เธ—เธฑเนเธเธซเธกเธ”</p>\r\n                        <p className=\"text-3xl font-bold text-teal-700\">{lots.length} <span className=\"text-lg text-teal-600/70 font-medium\">เธฅเนเธญเธ•</span></p>\r\n                    </div>\r\n                    <div className=\"h-12 w-px bg-teal-100 hidden md:block\"></div>\r\n                    <div>\r\n                        <p className=\"text-xs font-bold text-teal-600 uppercase tracking-wider mb-1\">เธเธณเธเธงเธเธ•เนเธเธเธทเธเธฃเธงเธก</p>\r\n                        <p className=\"text-3xl font-bold text-emerald-700\">{totalPlants.toLocaleString()} <span className=\"text-lg text-emerald-600/70 font-medium\">เธ•เนเธ</span></p>\r\n                    </div>\r\n                    <div className=\"h-12 w-px bg-teal-100 hidden md:block\"></div>\r\n                    <div>\r\n                        <p className=\"text-xs font-bold text-teal-600 uppercase tracking-wider mb-1\">เนเธเธฅเธเธเธฅเธนเธเธ—เธตเนเธกเธต</p>\r\n                        <p className=\"text-3xl font-bold text-primary-900\">{availablePlots.length} <span className=\"text-lg text-primary-600/70 font-medium\">เนเธเธฅเธ</span></p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Lots List */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                {/* Add New Button */}\r\n                <button\r\n                    onClick={() => {\r\n                        setCurrentLot({\r\n                            lotCode: generateLotCode(),\r\n                            plotId: '',\r\n                            plantCount: 0,\r\n                            estimatedPlantingDate: '',\r\n                            status: 'PLANNED',\r\n                            notes: '',\r\n                        });\r\n                        setIsModalOpen(true);\r\n                    }}\r\n                    disabled={availablePlots.length === 0}\r\n                    className={`h-48 rounded-2xl border-2 border-dashed flex flex-col items-center justify-center transition-all group relative overflow-hidden\r\n                        ${availablePlots.length === 0\r\n                            ? 'border-gray-200 bg-gray-50 text-gray-400 cursor-not-allowed'\r\n                            : 'border-primary-300 bg-primary-50/30 text-primary-700 hover:border-primary-500 hover:bg-primary-50 hover:shadow-lg'\r\n                        }`}\r\n                >\r\n                    <div className=\"w-14 h-14 rounded-full bg-white shadow-sm flex items-center justify-center mb-3 group-hover:scale-110 transition-transform text-2xl text-primary-600\">\r\n                        +\r\n                    </div>\r\n                    <span className=\"font-bold text-lg\">เน€เธเธดเนเธกเธฅเนเธญเธ•เนเธซเธกเน</span>\r\n                    {availablePlots.length === 0 ? (\r\n                        <span className=\"text-xs text-gray-400 mt-2 bg-white px-2 py-1 rounded-md\">เธเธฃเธธเธ“เธฒเน€เธเธดเนเธกเนเธเธฅเธเธเธฅเธนเธเธเนเธญเธ</span>\r\n                    ) : (\r\n                        <span className=\"text-xs text-primary-600/70 mt-1 opacity-0 group-hover:opacity-100 transition-opacity\">เธเธฅเธดเธเน€เธเธทเนเธญเธชเธฃเนเธฒเธเธฅเนเธญเธ•</span>\r\n                    )}\r\n                </button>\r\n\r\n                {/* Existing Lots */}\r\n                {lots.map((lot) => (\r\n                    <div key={lot.id} className=\"gacp-card group hover:border-primary-300 hover:shadow-premium-hover transition-all duration-300 animate-slide-up relative\">\r\n                        <div className=\"flex justify-between items-start mb-4\">\r\n                            <div>\r\n                                <div className=\"flex items-center gap-2 mb-1\">\r\n                                    <span className=\"px-2 py-0.5 rounded-md bg-gray-100 text-gray-600 text-[10px] font-mono font-medium\">\r\n                                        {lot.lotCode}\r\n                                    </span>\r\n                                </div>\r\n                                <h3 className=\"font-bold text-lg text-gray-900 line-clamp-1\" title={lot.plotName}>\r\n                                    {lot.plotName || 'เนเธกเนเธฃเธฐเธเธธเนเธเธฅเธ'}\r\n                                </h3>\r\n                            </div>\r\n                            <span className={`gacp-badge ${getStatusBadge(lot.status)}`}>\r\n                                {getStatusLabel(lot.status)}\r\n                            </span>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-3 pt-2 border-t border-gray-100\">\r\n                            <div className=\"flex justify-between items-center\">\r\n                                <span className=\"text-sm text-text-secondary\">เธเธณเธเธงเธเธ•เนเธ</span>\r\n                                <span className=\"font-bold text-xl text-primary-700\">{lot.plantCount.toLocaleString()}</span>\r\n                            </div>\r\n                            {lot.estimatedPlantingDate && (\r\n                                <div className=\"flex justify-between items-center text-sm\">\r\n                                    <span className=\"text-text-secondary\">เธงเธฑเธเธ—เธตเนเธเธฅเธนเธ</span>\r\n                                    <span className=\"font-medium text-gray-900\">{new Date(lot.estimatedPlantingDate).toLocaleDateString('th-TH')}</span>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        <button\r\n                            onClick={() => handleRemoveLot(lot.id)}\r\n                            className=\"absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-all p-2 text-danger hover:bg-danger-bg rounded-full hover:shadow-sm\"\r\n                            title=\"เธฅเธเธฅเนเธญเธ•\"\r\n                        >\r\n                            <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" /><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\r\n                            </svg>\r\n                        </button>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Info Banner */}\r\n            <div className=\"p-6 bg-blue-50/80 backdrop-blur-sm border border-blue-200 rounded-2xl flex gap-4 text-blue-900 text-sm shadow-sm animate-slide-up\" style={{ animationDelay: '200ms' }}>\r\n                <div className=\"p-2 bg-white rounded-xl shadow-sm h-fit\">\r\n                    <InfoIcon className=\"w-6 h-6 text-blue-600\" />\r\n                </div>\r\n                <div className=\"space-y-1\">\r\n                    <p className=\"font-bold text-blue-900\">เน€เธเธฃเนเธ”เธเธงเธฒเธกเธฃเธนเน: เธฅเนเธญเธ•เธเธฒเธฃเธเธฅเธดเธ• (Lot)</p>\r\n                    <p className=\"leading-relaxed text-blue-800/80\">\r\n                        เธฅเนเธญเธ•เธเธฒเธฃเธเธฅเธดเธ•เธเธทเธญเธซเธเนเธงเธขเธชเธณเธเธฑเธเนเธเธเธฒเธฃเธ•เธฃเธงเธเธชเธญเธเธขเนเธญเธเธเธฅเธฑเธ (Traceability) เธ•เธฒเธกเธกเธฒเธ•เธฃเธเธฒเธ GACP เธฃเธฐเธเธเธเธฐเธชเธฃเนเธฒเธ QR Code เธเธฃเธฐเธเธณเธ•เนเธเน€เธกเธทเนเธญเนเธ”เนเธฃเธฑเธเธเธฒเธฃเธญเธเธธเธกเธฑเธ•เธด เน€เธเธทเนเธญเนเธเนเนเธเธเธฒเธฃเธ•เธดเธ”เธ•เธฒเธ—เธชเธ–เธฒเธเธฐเธเธเธ–เธถเธเธเธฒเธฃเน€เธเนเธเน€เธเธตเนเธขเธง\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Modal */}\r\n            {isModalOpen && (\r\n                <div className=\"fixed inset-0 bg-black/40 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-fade-in\">\r\n                    <div className=\"bg-white/95 backdrop-blur-xl rounded-[2rem] max-w-md w-full p-8 shadow-2xl border border-white/50 animate-scale-in\">\r\n                        <div className=\"flex justify-between items-center mb-6\">\r\n                            <h3 className=\"text-2xl font-bold text-primary-900\">เน€เธเธดเนเธกเธฅเนเธญเธ•เธเธฒเธฃเธเธฅเธดเธ•เนเธซเธกเน</h3>\r\n                            <button onClick={() => setIsModalOpen(false)} className=\"w-10 h-10 flex items-center justify-center rounded-xl bg-gray-50 text-gray-400 hover:text-gray-600 transition-colors\">\r\n                                <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-5\">\r\n                            {/* Lot Code */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-bold text-gray-700 mb-1.5\">เธฃเธซเธฑเธชเธฅเนเธญเธ• (Auto-generated)</label>\r\n                                <div className=\"w-full border border-gray-100 rounded-2xl px-4 py-4 bg-gray-50/50 text-gray-500 font-mono text-xl font-bold tracking-widest text-center shadow-inner\">\r\n                                    {currentLot.lotCode}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Plot Selection */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-bold text-gray-700 mb-1.5\">เน€เธฅเธทเธญเธเนเธเธฅเธเธเธฅเธนเธ <span className=\"text-danger\">*</span></label>\r\n                                <select\r\n                                    className=\"gacp-input bg-white\"\r\n                                    value={currentLot.plotId || ''}\r\n                                    onChange={e => setCurrentLot({ ...currentLot, plotId: e.target.value })}\r\n                                >\r\n                                    <option value=\"\">-- เธเธฃเธธเธ“เธฒเน€เธฅเธทเธญเธเนเธเธฅเธ --</option>\r\n                                    {availablePlots.map(plot => (\r\n                                        <option key={plot.id} value={plot.id}>\r\n                                            {plot.name} ({plot.areaSize} {plot.areaUnit})\r\n                                        </option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n\r\n                            {/* Plant Count */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-bold text-gray-700 mb-1.5\">เธเธณเธเธงเธเธ•เนเธ <span className=\"text-danger\">*</span></label>\r\n                                <div className=\"relative\">\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        className=\"gacp-input bg-white pr-12 text-lg font-bold\"\r\n                                        placeholder=\"0\"\r\n                                        value={currentLot.plantCount || ''}\r\n                                        onChange={e => setCurrentLot({ ...currentLot, plantCount: parseInt(e.target.value) || 0 })}\r\n                                    />\r\n                                    <span className=\"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 font-bold\">เธ•เนเธ</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Estimated Planting Date */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-bold text-gray-700 mb-1.5\">เธงเธฑเธเธ—เธตเนเธเธฒเธ”เธงเนเธฒเธเธฐเธเธฅเธนเธ</label>\r\n                                <input\r\n                                    type=\"date\"\r\n                                    className=\"gacp-input bg-white\"\r\n                                    value={currentLot.estimatedPlantingDate || ''}\r\n                                    onChange={e => setCurrentLot({ ...currentLot, estimatedPlantingDate: e.target.value })}\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Notes */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-bold text-gray-700 mb-1.5\">เธซเธกเธฒเธขเน€เธซเธ•เธธ</label>\r\n                                <textarea\r\n                                    className=\"gacp-input bg-white h-24 resize-none text-sm\"\r\n                                    placeholder=\"เธเนเธญเธกเธนเธฅเน€เธเธดเนเธกเน€เธ•เธดเธก เน€เธเนเธ เธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”เธชเธฒเธขเธเธฑเธเธเธธเนเธขเนเธญเธข เธซเธฃเธทเธญเน€เธ—เธเธเธดเธเธเธดเน€เธจเธฉ...\"\r\n                                    value={currentLot.notes || ''}\r\n                                    onChange={e => setCurrentLot({ ...currentLot, notes: e.target.value })}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Modal Actions */}\r\n                        <div className=\"flex gap-4 mt-8 pt-4\">\r\n                            <button\r\n                                onClick={() => setIsModalOpen(false)}\r\n                                className=\"flex-1 px-4 py-3.5 border border-gray-200 text-gray-600 rounded-2xl font-bold hover:bg-gray-50 transition-colors\"\r\n                            >\r\n                                {dict?.wizard?.navigation?.back || 'เธขเธเน€เธฅเธดเธ'}\r\n                            </button>\r\n                            <button\r\n                                onClick={handleAddLot}\r\n                                disabled={!currentLot.plotId || !currentLot.plantCount}\r\n                                className={`flex-1 px-4 py-3.5 rounded-2xl font-bold shadow-lg transition-all ${currentLot.plotId && currentLot.plantCount\r\n                                    ? 'bg-primary text-white hover:bg-primary-700 hover:shadow-primary/30 hover:-translate-y-1'\r\n                                    : 'bg-gray-200 text-gray-400 cursor-not-allowed shadow-none'\r\n                                    }`}\r\n                            >\r\n                                เธขเธทเธเธขเธฑเธเธชเธฃเนเธฒเธเธฅเนเธญเธ•\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            <WizardNavigation\r\n                onNext={() => router.push('/farmer/applications/new/step/7')}\r\n                onBack={() => router.push('/farmer/applications/new/step/5')}\r\n                isNextDisabled={!canProceed}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StepLots;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPlantSelection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPlots.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreCheck.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setCurrentStep' is assigned a value but never used.","line":11,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'dict' is assigned a value but never used.","line":13,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":17},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":137,"column":70,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6928,6950],"text":"&quot;เธ•เธฃเธงเธเธชเธญเธเธเนเธญเธกเธนเธฅเธ—เธฑเนเธเธซเธกเธ”\""},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6928,6950],"text":"&ldquo;เธ•เธฃเธงเธเธชเธญเธเธเนเธญเธกเธนเธฅเธ—เธฑเนเธเธซเธกเธ”\""},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6928,6950],"text":"&#34;เธ•เธฃเธงเธเธชเธญเธเธเนเธญเธกเธนเธฅเธ—เธฑเนเธเธซเธกเธ”\""},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6928,6950],"text":"&rdquo;เธ•เธฃเธงเธเธชเธญเธเธเนเธญเธกเธนเธฅเธ—เธฑเนเธเธซเธกเธ”\""},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":137,"column":91,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[6928,6950],"text":"\"เธ•เธฃเธงเธเธชเธญเธเธเนเธญเธกเธนเธฅเธ—เธฑเนเธเธซเธกเธ”&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[6928,6950],"text":"\"เธ•เธฃเธงเธเธชเธญเธเธเนเธญเธกเธนเธฅเธ—เธฑเนเธเธซเธกเธ”&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[6928,6950],"text":"\"เธ•เธฃเธงเธเธชเธญเธเธเนเธญเธกเธนเธฅเธ—เธฑเนเธเธซเธกเธ”&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[6928,6950],"text":"\"เธ•เธฃเธงเธเธชเธญเธเธเนเธญเธกเธนเธฅเธ—เธฑเนเธเธซเธกเธ”&rdquo;"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useWizardStore } from '../hooks/useWizardStore';\r\nimport { useRouter } from 'next/navigation';\r\nimport { WizardNavigation } from '@/components/wizard/WizardNavigation';\r\nimport { CheckIcon, InfoIcon, WarningIcon } from '@/components/icons/WizardIcons';\r\nimport { useLanguage } from '@/lib/i18n/LanguageContext';\r\n\r\nexport const StepPreCheck = () => {\r\n    const { setCurrentStep } = useWizardStore();\r\n    const router = useRouter();\r\n    const { dict } = useLanguage();\r\n\r\n    const [checks, setChecks] = useState({\r\n        confirmTruth: false,\r\n        acceptAudit: false,\r\n        acknowledgePenalty: false,\r\n        consentData: false\r\n    });\r\n\r\n    const allChecked = Object.values(checks).every(Boolean);\r\n\r\n    const toggle = (key: keyof typeof checks) => {\r\n        setChecks(prev => ({ ...prev, [key]: !prev[key] }));\r\n    };\r\n\r\n    const checkItems = [\r\n        {\r\n            key: 'confirmTruth' as const,\r\n            title: 'เธขเธทเธเธขเธฑเธเธเธงเธฒเธกเธ–เธนเธเธ•เนเธญเธเธเธญเธเธเนเธญเธกเธนเธฅ',\r\n            desc: 'เธเนเธฒเธเน€เธเนเธฒเธขเธทเธเธขเธฑเธเธงเนเธฒเน€เธญเธเธชเธฒเธฃเนเธฅเธฐเธเนเธญเธกเธนเธฅเธ—เธฑเนเธเธซเธกเธ”เธ—เธตเนเนเธเธเธกเธฒเน€เธเนเธเธเธงเธฒเธกเธเธฃเธดเธเธ—เธธเธเธเธฃเธฐเธเธฒเธฃ',\r\n            icon: '๐“'\r\n        },\r\n        {\r\n            key: 'acceptAudit' as const,\r\n            title: 'เธขเธดเธเธขเธญเธกเนเธซเนเน€เธเนเธฒเธ•เธฃเธงเธเธชเธ–เธฒเธเธเธฃเธฐเธเธญเธเธเธฒเธฃ',\r\n            desc: 'เธเนเธฒเธเน€เธเนเธฒเธขเธดเธเธขเธญเธกเนเธซเนเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเน€เธเนเธฒเธ•เธฃเธงเธเธชเธญเธเธเธทเนเธเธ—เธตเนเนเธเธฅเธเธเธฅเธนเธเนเธฅเธฐเนเธฃเธเน€เธฃเธทเธญเธเธ•เธฒเธกเธเธฑเธ”เธซเธกเธฒเธข',\r\n            icon: '๐ก๏ธ'\r\n        },\r\n        {\r\n            key: 'acknowledgePenalty' as const,\r\n            title: 'เธฃเธฑเธเธ—เธฃเธฒเธเธเธ—เธฅเธเนเธ—เธฉ',\r\n            desc: 'เธซเธฒเธเธ•เธฃเธงเธเธชเธญเธเธเธเธงเนเธฒเธกเธตเธเธฒเธฃเธเธฅเธญเธกเนเธเธฅเธเน€เธญเธเธชเธฒเธฃ เธซเธฃเธทเธญเนเธซเนเธเนเธญเธกเธนเธฅเน€เธ—เนเธ เธเธณเธเธญเธเธฐเธ–เธนเธเธขเธเน€เธฅเธดเธเนเธฅเธฐเธญเธฒเธเธ–เธนเธเธ”เธณเน€เธเธดเธเธเธ”เธตเธ•เธฒเธกเธเธเธซเธกเธฒเธข',\r\n            icon: 'โ ๏ธ'\r\n        },\r\n        {\r\n            key: 'consentData' as const,\r\n            title: 'เธขเธดเธเธขเธญเธกเน€เธเธดเธ”เน€เธเธขเธเนเธญเธกเธนเธฅ (PDPA)',\r\n            desc: 'เธเนเธฒเธเน€เธเนเธฒเธขเธดเธเธขเธญเธกเนเธซเนเธซเธเนเธงเธขเธเธฒเธเธฃเธฑเธเธเธฑเธ”เน€เธเนเธเนเธฅเธฐเน€เธเธดเธ”เน€เธเธขเธเนเธญเธกเธนเธฅเน€เธเธทเนเธญเธเธฃเธฐเนเธขเธเธเนเนเธเธเธฒเธฃเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP',\r\n            icon: '๐”’'\r\n        }\r\n    ];\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in max-w-3xl mx-auto pb-12\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center gap-4 mb-4\">\r\n                <div className=\"w-12 h-12 bg-primary gradient-mask rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-primary-50\">\r\n                    10\r\n                </div>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-primary-900\">เธ•เธฃเธงเธเธชเธญเธเธเธงเธฒเธกเน€เธฃเธตเธขเธเธฃเนเธญเธข (Self-Audit)</h2>\r\n                    <p className=\"text-text-secondary\">เธเธฑเนเธเธ•เธญเธเธชเธธเธ”เธ—เนเธฒเธขเธเนเธญเธเธชเนเธเธเธณเธเธญ เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธฅเธฐเธเธ”เธขเธทเธเธขเธฑเธเธเนเธญเธเธณเธซเธเธ”</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Warning Banner */}\r\n            <div className=\"p-6 bg-amber-50/80 backdrop-blur-sm border border-amber-200 rounded-3xl flex gap-4 text-amber-900 shadow-sm animate-slide-up\">\r\n                <div className=\"p-2 bg-white rounded-2xl shadow-sm h-fit\">\r\n                    <WarningIcon className=\"w-6 h-6 text-amber-600\" />\r\n                </div>\r\n                <div className=\"space-y-1\">\r\n                    <p className=\"font-bold text-amber-900 text-sm\">เนเธเธฃเธ”เธ•เธฃเธงเธเธชเธญเธเธเนเธญเธกเธนเธฅเธญเธขเนเธฒเธเธฅเธฐเน€เธญเธตเธขเธ”</p>\r\n                    <p className=\"text-xs leading-relaxed text-amber-800/80\">\r\n                        เธเธฒเธฃเนเธซเนเธเนเธญเธกเธนเธฅเธ—เธตเนเน€เธเนเธเน€เธ—เนเธเธญเธฒเธเธชเนเธเธเธฅเธ•เนเธญเธเธฒเธฃเธเธดเธเธฒเธฃเธ“เธฒเนเธเธฃเธฑเธเธฃเธญเธเนเธเธญเธเธฒเธเธ•เนเธฅเธฐเธกเธตเธเธ—เธฅเธเนเธ—เธฉเธ•เธฒเธกเธเธเธซเธกเธฒเธข\r\n                        เธ—เนเธฒเธเธชเธฒเธกเธฒเธฃเธ–เธขเนเธญเธเธเธฅเธฑเธเนเธเนเธเนเนเธเธเนเธญเธกเธนเธฅเนเธเธเธฑเนเธเธ•เธญเธเธเนเธญเธเธซเธเนเธฒเนเธ”เนเนเธเธซเธเนเธฒเธฃเธงเธกเธชเธฃเธธเธ (Step 11)\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Checklist Container */}\r\n            <div className=\"gacp-card p-4 space-y-3 animate-slide-up\" style={{ animationDelay: '100ms' }}>\r\n                {checkItems.map((item, index) => (\r\n                    <div\r\n                        key={item.key}\r\n                        onClick={() => toggle(item.key)}\r\n                        className={`\r\n                            group flex items-start gap-5 p-5 rounded-2xl cursor-pointer transition-all duration-300 border\r\n                            ${checks[item.key]\r\n                                ? 'bg-primary/5 border-primary/20 shadow-sm'\r\n                                : 'bg-white border-gray-100 hover:border-primary/30 hover:bg-gray-50/50 hover:shadow-md'\r\n                            }\r\n                        `}\r\n                        style={{ animationDelay: `${150 + index * 50}ms` }}\r\n                    >\r\n                        {/* Custom Checkbox Design */}\r\n                        <div className=\"relative mt-1\">\r\n                            <div className={`\r\n                                w-7 h-7 rounded-xl border-2 flex items-center justify-center transition-all duration-500\r\n                                ${checks[item.key]\r\n                                    ? 'bg-primary border-primary rotate-0 scale-100'\r\n                                    : 'bg-white border-gray-300 rotate-45 scale-90 group-hover:rotate-0 group-hover:scale-100 group-hover:border-primary'\r\n                                }\r\n                            `}>\r\n                                {checks[item.key] && (\r\n                                    <CheckIcon className=\"w-4 h-4 text-white animate-scale-in\" />\r\n                                )}\r\n                            </div>\r\n                            {/* Decorative ring when checked */}\r\n                            {checks[item.key] && (\r\n                                <div className=\"absolute inset-0 rounded-xl ring-4 ring-primary/20 animate-pulse\"></div>\r\n                            )}\r\n                        </div>\r\n\r\n                        <div className=\"flex-1 min-w-0\">\r\n                            <div className=\"flex items-center gap-2 mb-1\">\r\n                                <span className=\"text-lg grayscale group-hover:grayscale-0 transition-all duration-500\">{item.icon}</span>\r\n                                <h4 className={`font-bold text-base transition-colors ${checks[item.key] ? 'text-primary-900' : 'text-gray-700'}`}>\r\n                                    {item.title}\r\n                                </h4>\r\n                            </div>\r\n                            <p className={`text-xs leading-relaxed transition-colors ${checks[item.key] ? 'text-primary-700/70' : 'text-gray-500'}`}>\r\n                                {item.desc}\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Bottom Info */}\r\n            <div className=\"p-6 bg-blue-50/50 rounded-3xl border border-blue-100 flex items-center gap-4 animate-slide-up\" style={{ animationDelay: '400ms' }}>\r\n                <div className=\"p-2 bg-white rounded-xl shadow-sm\">\r\n                    <InfoIcon className=\"w-5 h-5 text-blue-500\" />\r\n                </div>\r\n                <p className=\"text-xs text-blue-800/80 font-medium\">\r\n                    เธซเธฅเธฑเธเธเธฒเธเธขเธทเธเธขเธฑเธเธเธฃเธเธ—เธธเธเธเนเธญ เธ—เนเธฒเธเธเธฐเน€เธเนเธฒเธชเธนเนเธซเธเนเธฒ <strong>\"เธ•เธฃเธงเธเธชเธญเธเธเนเธญเธกเธนเธฅเธ—เธฑเนเธเธซเธกเธ”\"</strong> เน€เธเธทเนเธญเธฃเธตเธงเธดเธงเธเธงเธฒเธกเธ–เธนเธเธ•เนเธญเธเธเนเธญเธเธเธ”เธชเนเธเธเธณเธเธญเธญเธขเนเธฒเธเน€เธเนเธเธ—เธฒเธเธเธฒเธฃ\r\n                </p>\r\n            </div>\r\n\r\n            <WizardNavigation\r\n                onNext={() => router.push('/farmer/applications/new/step/11')}\r\n                onBack={() => router.push('/farmer/applications/new/step/9')}\r\n                isNextDisabled={!allChecked}\r\n                nextLabel=\"เธฃเธฑเธเธ—เธฃเธฒเธเนเธฅเธฐเธ”เธณเน€เธเธดเธเธเธฒเธฃเธ•เนเธญ\"\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StepPreCheck;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DocIcon' is defined but never used.","line":8,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningIcon' is defined but never used.","line":8,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":51},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'dict' is assigned a value but never used.","line":14,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'language' is assigned a value but never used.","line":14,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":27},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1477,1480],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1477,1480],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":78,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3768,3771],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3768,3771],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:142:18\n  140 |\n  141 |                 {/* 1. Applicant */}\n> 142 |                 <SectionHeader\n      |                  ^^^^^^^^^^^^^ This component is created during render\n  143 |                     title=\"เธเนเธญเธกเธนเธฅเธเธนเนเธขเธทเนเธเธเธณเธเธญ\"\n  144 |                     icon={<Icons.User className=\"w-6 h-6\" />}\n  145 |                     isOpen={expandedSections.applicant}\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:39:27\n  37 |     const totalDocs = documents.filter(d => d.uploaded).length;\n  38 |\n> 39 |     const SectionHeader = ({ title, icon, isOpen, onToggle, editStep }: any) => (\n     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 40 |         <div className={`flex flex-col border-b last:border-0 transition-all duration-500 ${isOpen ? 'bg-white' : 'bg-gray-50/30'}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 41 |             <div className=\"flex items-center justify-between p-6\">\n     โ€ฆ\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 75 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 76 |     );\n     | ^^^^^^ The component is created during render here\n  77 |\n  78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n  79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>","line":142,"column":18,"nodeType":null,"endLine":142,"endColumn":31},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:151:26\n  149 |                 {expandedSections.applicant && (\n  150 |                     <div className=\"p-8 grid grid-cols-1 md:grid-cols-2 gap-8 animate-slide-down bg-white\">\n> 151 |                         <InfoItem label=\"เธเธทเนเธญ-เธเธฒเธกเธชเธเธธเธฅ\" value={`${applicant?.firstName || ''} ${applicant?.lastName || ''}`} />\n      |                          ^^^^^^^^ This component is created during render\n  152 |                         <InfoItem label=\"เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธ / เธเธดเธ•เธดเธเธธเธเธเธฅ\" value={applicant?.idCard} />\n  153 |                         <InfoItem label=\"เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เน\" value={applicant?.phone} />\n  154 |                         <InfoItem label=\"เธญเธตเน€เธกเธฅ\" value={applicant?.email} />\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:78:22\n  76 |     );\n  77 |\n> 78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     );\n     | ^^^^^^ The component is created during render here\n  84 |\n  85 |     return (\n  86 |         <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">","line":151,"column":26,"nodeType":null,"endLine":151,"endColumn":34},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:152:26\n  150 |                     <div className=\"p-8 grid grid-cols-1 md:grid-cols-2 gap-8 animate-slide-down bg-white\">\n  151 |                         <InfoItem label=\"เธเธทเนเธญ-เธเธฒเธกเธชเธเธธเธฅ\" value={`${applicant?.firstName || ''} ${applicant?.lastName || ''}`} />\n> 152 |                         <InfoItem label=\"เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธ / เธเธดเธ•เธดเธเธธเธเธเธฅ\" value={applicant?.idCard} />\n      |                          ^^^^^^^^ This component is created during render\n  153 |                         <InfoItem label=\"เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เน\" value={applicant?.phone} />\n  154 |                         <InfoItem label=\"เธญเธตเน€เธกเธฅ\" value={applicant?.email} />\n  155 |                         <InfoItem label=\"เธ—เธตเนเธญเธขเธนเน\" fullWidth value={`${applicant?.addressNo || ''} ${applicant?.subdistrict || ''} ${applicant?.district || ''} ${applicant?.province || ''} ${applicant?.zipCode || ''}`} />\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:78:22\n  76 |     );\n  77 |\n> 78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     );\n     | ^^^^^^ The component is created during render here\n  84 |\n  85 |     return (\n  86 |         <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">","line":152,"column":26,"nodeType":null,"endLine":152,"endColumn":34},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:153:26\n  151 |                         <InfoItem label=\"เธเธทเนเธญ-เธเธฒเธกเธชเธเธธเธฅ\" value={`${applicant?.firstName || ''} ${applicant?.lastName || ''}`} />\n  152 |                         <InfoItem label=\"เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธ / เธเธดเธ•เธดเธเธธเธเธเธฅ\" value={applicant?.idCard} />\n> 153 |                         <InfoItem label=\"เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เน\" value={applicant?.phone} />\n      |                          ^^^^^^^^ This component is created during render\n  154 |                         <InfoItem label=\"เธญเธตเน€เธกเธฅ\" value={applicant?.email} />\n  155 |                         <InfoItem label=\"เธ—เธตเนเธญเธขเธนเน\" fullWidth value={`${applicant?.addressNo || ''} ${applicant?.subdistrict || ''} ${applicant?.district || ''} ${applicant?.province || ''} ${applicant?.zipCode || ''}`} />\n  156 |                     </div>\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:78:22\n  76 |     );\n  77 |\n> 78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     );\n     | ^^^^^^ The component is created during render here\n  84 |\n  85 |     return (\n  86 |         <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">","line":153,"column":26,"nodeType":null,"endLine":153,"endColumn":34},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:154:26\n  152 |                         <InfoItem label=\"เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธ / เธเธดเธ•เธดเธเธธเธเธเธฅ\" value={applicant?.idCard} />\n  153 |                         <InfoItem label=\"เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เน\" value={applicant?.phone} />\n> 154 |                         <InfoItem label=\"เธญเธตเน€เธกเธฅ\" value={applicant?.email} />\n      |                          ^^^^^^^^ This component is created during render\n  155 |                         <InfoItem label=\"เธ—เธตเนเธญเธขเธนเน\" fullWidth value={`${applicant?.addressNo || ''} ${applicant?.subdistrict || ''} ${applicant?.district || ''} ${applicant?.province || ''} ${applicant?.zipCode || ''}`} />\n  156 |                     </div>\n  157 |                 )}\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:78:22\n  76 |     );\n  77 |\n> 78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     );\n     | ^^^^^^ The component is created during render here\n  84 |\n  85 |     return (\n  86 |         <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">","line":154,"column":26,"nodeType":null,"endLine":154,"endColumn":34},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:155:26\n  153 |                         <InfoItem label=\"เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เน\" value={applicant?.phone} />\n  154 |                         <InfoItem label=\"เธญเธตเน€เธกเธฅ\" value={applicant?.email} />\n> 155 |                         <InfoItem label=\"เธ—เธตเนเธญเธขเธนเน\" fullWidth value={`${applicant?.addressNo || ''} ${applicant?.subdistrict || ''} ${applicant?.district || ''} ${applicant?.province || ''} ${applicant?.zipCode || ''}`} />\n      |                          ^^^^^^^^ This component is created during render\n  156 |                     </div>\n  157 |                 )}\n  158 |\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:78:22\n  76 |     );\n  77 |\n> 78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     );\n     | ^^^^^^ The component is created during render here\n  84 |\n  85 |     return (\n  86 |         <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">","line":155,"column":26,"nodeType":null,"endLine":155,"endColumn":34},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:160:18\n  158 |\n  159 |                 {/* 2. Farm */}\n> 160 |                 <SectionHeader\n      |                  ^^^^^^^^^^^^^ This component is created during render\n  161 |                     title=\"เธเนเธญเธกเธนเธฅเธชเธ–เธฒเธเธ—เธตเนเนเธฅเธฐเธฃเธฐเธเธ\"\n  162 |                     icon={<Icons.Home className=\"w-6 h-6\" />}\n  163 |                     isOpen={expandedSections.farm}\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:39:27\n  37 |     const totalDocs = documents.filter(d => d.uploaded).length;\n  38 |\n> 39 |     const SectionHeader = ({ title, icon, isOpen, onToggle, editStep }: any) => (\n     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 40 |         <div className={`flex flex-col border-b last:border-0 transition-all duration-500 ${isOpen ? 'bg-white' : 'bg-gray-50/30'}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 41 |             <div className=\"flex items-center justify-between p-6\">\n     โ€ฆ\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 75 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 76 |     );\n     | ^^^^^^ The component is created during render here\n  77 |\n  78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n  79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>","line":160,"column":18,"nodeType":null,"endLine":160,"endColumn":31},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:169:26\n  167 |                 {expandedSections.farm && (\n  168 |                     <div className=\"p-8 grid grid-cols-1 md:grid-cols-2 gap-8 animate-slide-down bg-white\">\n> 169 |                         <InfoItem label=\"เธเธทเนเธญเธชเธ–เธฒเธเธ—เธตเนเธเธฅเธดเธ•\" value={farm?.farmName} />\n      |                          ^^^^^^^^ This component is created during render\n  170 |                         <InfoItem label=\"เธเธฑเธเธซเธงเธฑเธ”\" value={farm?.province} />\n  171 |                         <InfoItem label=\"เธเธเธฒเธ”เธเธทเนเธเธ—เธตเนเธฃเธงเธก\" value={`${farm?.totalAreaSize || '0'} เนเธฃเน`} />\n  172 |                         <InfoItem label=\"เธเธฃเธฃเธกเธชเธดเธ—เธเธดเน\" value={farm?.landOwnership} />\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:78:22\n  76 |     );\n  77 |\n> 78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     );\n     | ^^^^^^ The component is created during render here\n  84 |\n  85 |     return (\n  86 |         <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">","line":169,"column":26,"nodeType":null,"endLine":169,"endColumn":34},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:170:26\n  168 |                     <div className=\"p-8 grid grid-cols-1 md:grid-cols-2 gap-8 animate-slide-down bg-white\">\n  169 |                         <InfoItem label=\"เธเธทเนเธญเธชเธ–เธฒเธเธ—เธตเนเธเธฅเธดเธ•\" value={farm?.farmName} />\n> 170 |                         <InfoItem label=\"เธเธฑเธเธซเธงเธฑเธ”\" value={farm?.province} />\n      |                          ^^^^^^^^ This component is created during render\n  171 |                         <InfoItem label=\"เธเธเธฒเธ”เธเธทเนเธเธ—เธตเนเธฃเธงเธก\" value={`${farm?.totalAreaSize || '0'} เนเธฃเน`} />\n  172 |                         <InfoItem label=\"เธเธฃเธฃเธกเธชเธดเธ—เธเธดเน\" value={farm?.landOwnership} />\n  173 |                         <InfoItem label=\"เนเธซเธฅเนเธเธเนเธณ\" value={farm?.waterSource} />\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:78:22\n  76 |     );\n  77 |\n> 78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     );\n     | ^^^^^^ The component is created during render here\n  84 |\n  85 |     return (\n  86 |         <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">","line":170,"column":26,"nodeType":null,"endLine":170,"endColumn":34},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:171:26\n  169 |                         <InfoItem label=\"เธเธทเนเธญเธชเธ–เธฒเธเธ—เธตเนเธเธฅเธดเธ•\" value={farm?.farmName} />\n  170 |                         <InfoItem label=\"เธเธฑเธเธซเธงเธฑเธ”\" value={farm?.province} />\n> 171 |                         <InfoItem label=\"เธเธเธฒเธ”เธเธทเนเธเธ—เธตเนเธฃเธงเธก\" value={`${farm?.totalAreaSize || '0'} เนเธฃเน`} />\n      |                          ^^^^^^^^ This component is created during render\n  172 |                         <InfoItem label=\"เธเธฃเธฃเธกเธชเธดเธ—เธเธดเน\" value={farm?.landOwnership} />\n  173 |                         <InfoItem label=\"เนเธซเธฅเนเธเธเนเธณ\" value={farm?.waterSource} />\n  174 |                         <InfoItem label=\"เธเธดเธเธฑเธ” GPS\" value={`${farm?.gpsLat || '-'}, ${farm?.gpsLng || '-'}`} />\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:78:22\n  76 |     );\n  77 |\n> 78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     );\n     | ^^^^^^ The component is created during render here\n  84 |\n  85 |     return (\n  86 |         <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">","line":171,"column":26,"nodeType":null,"endLine":171,"endColumn":34},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:172:26\n  170 |                         <InfoItem label=\"เธเธฑเธเธซเธงเธฑเธ”\" value={farm?.province} />\n  171 |                         <InfoItem label=\"เธเธเธฒเธ”เธเธทเนเธเธ—เธตเนเธฃเธงเธก\" value={`${farm?.totalAreaSize || '0'} เนเธฃเน`} />\n> 172 |                         <InfoItem label=\"เธเธฃเธฃเธกเธชเธดเธ—เธเธดเน\" value={farm?.landOwnership} />\n      |                          ^^^^^^^^ This component is created during render\n  173 |                         <InfoItem label=\"เนเธซเธฅเนเธเธเนเธณ\" value={farm?.waterSource} />\n  174 |                         <InfoItem label=\"เธเธดเธเธฑเธ” GPS\" value={`${farm?.gpsLat || '-'}, ${farm?.gpsLng || '-'}`} />\n  175 |                     </div>\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:78:22\n  76 |     );\n  77 |\n> 78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     );\n     | ^^^^^^ The component is created during render here\n  84 |\n  85 |     return (\n  86 |         <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">","line":172,"column":26,"nodeType":null,"endLine":172,"endColumn":34},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:173:26\n  171 |                         <InfoItem label=\"เธเธเธฒเธ”เธเธทเนเธเธ—เธตเนเธฃเธงเธก\" value={`${farm?.totalAreaSize || '0'} เนเธฃเน`} />\n  172 |                         <InfoItem label=\"เธเธฃเธฃเธกเธชเธดเธ—เธเธดเน\" value={farm?.landOwnership} />\n> 173 |                         <InfoItem label=\"เนเธซเธฅเนเธเธเนเธณ\" value={farm?.waterSource} />\n      |                          ^^^^^^^^ This component is created during render\n  174 |                         <InfoItem label=\"เธเธดเธเธฑเธ” GPS\" value={`${farm?.gpsLat || '-'}, ${farm?.gpsLng || '-'}`} />\n  175 |                     </div>\n  176 |                 )}\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:78:22\n  76 |     );\n  77 |\n> 78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     );\n     | ^^^^^^ The component is created during render here\n  84 |\n  85 |     return (\n  86 |         <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">","line":173,"column":26,"nodeType":null,"endLine":173,"endColumn":34},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:174:26\n  172 |                         <InfoItem label=\"เธเธฃเธฃเธกเธชเธดเธ—เธเธดเน\" value={farm?.landOwnership} />\n  173 |                         <InfoItem label=\"เนเธซเธฅเนเธเธเนเธณ\" value={farm?.waterSource} />\n> 174 |                         <InfoItem label=\"เธเธดเธเธฑเธ” GPS\" value={`${farm?.gpsLat || '-'}, ${farm?.gpsLng || '-'}`} />\n      |                          ^^^^^^^^ This component is created during render\n  175 |                     </div>\n  176 |                 )}\n  177 |\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:78:22\n  76 |     );\n  77 |\n> 78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     );\n     | ^^^^^^ The component is created during render here\n  84 |\n  85 |     return (\n  86 |         <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">","line":174,"column":26,"nodeType":null,"endLine":174,"endColumn":34},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:179:18\n  177 |\n  178 |                 {/* 3. Production & Plots */}\n> 179 |                 <SectionHeader\n      |                  ^^^^^^^^^^^^^ This component is created during render\n  180 |                     title=\"เนเธเธเธเธฒเธฃเธเธฅเธดเธ•เนเธฅเธฐเนเธเธฅเธเธเธฅเธนเธ\"\n  181 |                     icon={<Icons.Leaf className=\"w-6 h-6\" />}\n  182 |                     isOpen={expandedSections.production}\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:39:27\n  37 |     const totalDocs = documents.filter(d => d.uploaded).length;\n  38 |\n> 39 |     const SectionHeader = ({ title, icon, isOpen, onToggle, editStep }: any) => (\n     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 40 |         <div className={`flex flex-col border-b last:border-0 transition-all duration-500 ${isOpen ? 'bg-white' : 'bg-gray-50/30'}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 41 |             <div className=\"flex items-center justify-between p-6\">\n     โ€ฆ\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 75 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 76 |     );\n     | ^^^^^^ The component is created during render here\n  77 |\n  78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n  79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>","line":179,"column":18,"nodeType":null,"endLine":179,"endColumn":31},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:189:30\n  187 |                     <div className=\"p-8 space-y-8 animate-slide-down bg-white\">\n  188 |                         <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n> 189 |                             <InfoItem label=\"เธฃเธฐเธเธเธเธฒเธฃเน€เธเธฒเธฐเธเธฅเธนเธ\" value={state.cultivationMethod} />\n      |                              ^^^^^^^^ This component is created during render\n  190 |                             <InfoItem label=\"เธงเธฑเธ•เธ–เธธเธเธฃเธฐเธชเธเธเน\" value={state.certificationPurpose} />\n  191 |                         </div>\n  192 |\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:78:22\n  76 |     );\n  77 |\n> 78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     );\n     | ^^^^^^ The component is created during render here\n  84 |\n  85 |     return (\n  86 |         <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">","line":189,"column":30,"nodeType":null,"endLine":189,"endColumn":38},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:190:30\n  188 |                         <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n  189 |                             <InfoItem label=\"เธฃเธฐเธเธเธเธฒเธฃเน€เธเธฒเธฐเธเธฅเธนเธ\" value={state.cultivationMethod} />\n> 190 |                             <InfoItem label=\"เธงเธฑเธ•เธ–เธธเธเธฃเธฐเธชเธเธเน\" value={state.certificationPurpose} />\n      |                              ^^^^^^^^ This component is created during render\n  191 |                         </div>\n  192 |\n  193 |                         <div>\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:78:22\n  76 |     );\n  77 |\n> 78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     );\n     | ^^^^^^ The component is created during render here\n  84 |\n  85 |     return (\n  86 |         <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">","line":190,"column":30,"nodeType":null,"endLine":190,"endColumn":38},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:218:18\n  216 |\n  217 |                 {/* 4. Documents */}\n> 218 |                 <SectionHeader\n      |                  ^^^^^^^^^^^^^ This component is created during render\n  219 |                     title=\"เน€เธญเธเธชเธฒเธฃเธเธฃเธฐเธเธญเธเธเธณเธเธญ\"\n  220 |                     icon={<Icons.FileText className=\"w-6 h-6\" />}\n  221 |                     isOpen={expandedSections.documents}\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepPreview.tsx:39:27\n  37 |     const totalDocs = documents.filter(d => d.uploaded).length;\n  38 |\n> 39 |     const SectionHeader = ({ title, icon, isOpen, onToggle, editStep }: any) => (\n     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 40 |         <div className={`flex flex-col border-b last:border-0 transition-all duration-500 ${isOpen ? 'bg-white' : 'bg-gray-50/30'}`}>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 41 |             <div className=\"flex items-center justify-between p-6\">\n     โ€ฆ\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 75 |         </div>\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 76 |     );\n     | ^^^^^^ The component is created during render here\n  77 |\n  78 |     const InfoItem = ({ label, value, fullWidth }: any) => (\n  79 |         <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>","line":218,"column":18,"nodeType":null,"endLine":218,"endColumn":31}],"suppressedMessages":[],"errorCount":19,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useWizardStore } from '../hooks/useWizardStore';\r\nimport { useRouter } from 'next/navigation';\r\nimport { WizardNavigation } from '@/components/wizard/WizardNavigation';\r\nimport { Icons } from '@/components/ui/icons';\r\nimport { CheckIcon, InfoIcon, DocIcon, WarningIcon } from '@/components/icons/WizardIcons';\r\nimport { useLanguage } from '@/lib/i18n/LanguageContext';\r\n\r\nexport const StepPreview = () => {\r\n    const { state } = useWizardStore();\r\n    const router = useRouter();\r\n    const { dict, language } = useLanguage();\r\n\r\n    const [expandedSections, setExpandedSections] = useState<Record<string, boolean>>({\r\n        applicant: true,\r\n        farm: true,\r\n        production: true,\r\n        documents: true,\r\n    });\r\n\r\n    const toggleSection = (key: string) => {\r\n        setExpandedSections(prev => ({ ...prev, [key]: !prev[key] }));\r\n    };\r\n\r\n    // Data extraction\r\n    const applicant = state.applicantData;\r\n    const farm = state.farmData;\r\n    const plots = state.siteData?.plots || [];\r\n    const lots = state.lots || [];\r\n    const documents = state.documents || [];\r\n\r\n    // Summary calculations\r\n    const totalPlants = lots.reduce((sum, lot) => sum + (Number(lot.plantCount) || 0), 0);\r\n    const totalArea = parseFloat(farm?.totalAreaSize || '0');\r\n    const totalDocs = documents.filter(d => d.uploaded).length;\r\n\r\n    const SectionHeader = ({ title, icon, isOpen, onToggle, editStep }: any) => (\r\n        <div className={`flex flex-col border-b last:border-0 transition-all duration-500 ${isOpen ? 'bg-white' : 'bg-gray-50/30'}`}>\r\n            <div className=\"flex items-center justify-between p-6\">\r\n                <button\r\n                    onClick={onToggle}\r\n                    className=\"flex items-center gap-4 group text-left\"\r\n                >\r\n                    <div className={`\r\n                        w-12 h-12 rounded-2xl flex items-center justify-center text-xl transition-all duration-300 shadow-sm\r\n                        ${isOpen ? 'bg-primary text-white shadow-md scale-100' : 'bg-white border border-gray-100 text-gray-400 scale-95'}\r\n                    `}>\r\n                        {icon}\r\n                    </div>\r\n                    <div>\r\n                        <h3 className=\"font-black text-gray-900 tracking-tight\">{title}</h3>\r\n                        <p className=\"text-[10px] text-gray-400 font-bold uppercase tracking-widest\">\r\n                            {isOpen ? 'Click to collapse' : 'Click to expand'}\r\n                        </p>\r\n                    </div>\r\n                </button>\r\n                <div className=\"flex items-center gap-3\">\r\n                    <button\r\n                        onClick={() => router.push(`/farmer/applications/new/step/${editStep}`)}\r\n                        className=\"p-2.5 rounded-xl bg-gray-100 text-gray-400 hover:bg-primary/10 hover:text-primary transition-all flex items-center gap-2 group/btn\"\r\n                    >\r\n                        <Icons.Edit className=\"w-4 h-4\" />\r\n                        <span className=\"text-[10px] font-bold uppercase tracking-wider hidden md:inline\">Edit</span>\r\n                    </button>\r\n                    <button\r\n                        onClick={onToggle}\r\n                        className={`w-10 h-10 rounded-xl border flex items-center justify-center transition-all ${isOpen ? 'bg-primary-50 border-primary-100 text-primary rotate-180' : 'bg-white border-gray-200 text-gray-400 rotate-0'}`}\r\n                    >\r\n                        <Icons.ChevronDown className=\"w-5 h-5\" />\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const InfoItem = ({ label, value, fullWidth }: any) => (\r\n        <div className={`space-y-1.5 ${fullWidth ? 'col-span-1 md:col-span-2' : ''}`}>\r\n            <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">{label}</p>\r\n            <p className=\"text-sm font-bold text-gray-900 bg-gray-50/50 px-3 py-2 rounded-xl border border-gray-100/50\">{value || '-'}</p>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">\r\n            {/* Header */}\r\n            <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-4\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-12 h-12 bg-primary gradient-mask rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-primary-50\">\r\n                        11\r\n                    </div>\r\n                    <div>\r\n                        <h2 className=\"text-2xl font-bold text-primary-900\">เธ•เธฃเธงเธเธชเธญเธเธเนเธญเธกเธนเธฅเธชเธฃเธธเธ (Application Review)</h2>\r\n                        <p className=\"text-text-secondary\">เธ•เธฃเธงเธเธชเธญเธเธเธงเธฒเธกเธ–เธนเธเธ•เนเธญเธเธ—เธฑเนเธเธซเธกเธ”เธญเธตเธเธเธฃเธฑเนเธเธเนเธญเธเธขเธทเธเธขเธฑเธเธชเนเธเธเธณเธเธญ</p>\r\n                    </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                    <button\r\n                        onClick={() => window.print()}\r\n                        className=\"px-5 py-2.5 rounded-2xl border border-gray-200 text-gray-600 font-bold text-sm bg-white hover:bg-gray-50 transition-all shadow-sm flex items-center gap-2\"\r\n                    >\r\n                        <Icons.Printer className=\"w-4 h-4\" />\r\n                        เธเธดเธกเธเน PDF\r\n                    </button>\r\n                    <div className=\"h-10 w-px bg-gray-200 hidden md:block\"></div>\r\n                    <div className=\"bg-emerald-50 px-4 py-2 rounded-2xl border border-emerald-100 text-emerald-700 flex items-center gap-2 shadow-sm\">\r\n                        <div className=\"w-2 h-2 rounded-full bg-emerald-500 animate-pulse\"></div>\r\n                        <span className=\"text-xs font-black uppercase tracking-wider\">Ready to Submit</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Summary KPI Cards */}\r\n            <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 animate-slide-up\">\r\n                <div className=\"gacp-card bg-white p-6 border-gray-100 flex flex-col items-center justify-center group overflow-hidden relative\">\r\n                    <div className=\"absolute top-0 right-0 w-16 h-16 bg-primary/5 rounded-full -mr-8 -mt-8\"></div>\r\n                    <p className=\"text-3xl font-black text-primary group-hover:scale-110 transition-transform\">{plots.length}</p>\r\n                    <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest mt-1\">เนเธเธฅเธเธเธฅเธนเธ</p>\r\n                </div>\r\n                <div className=\"gacp-card bg-white p-6 border-gray-100 flex flex-col items-center justify-center group overflow-hidden relative\">\r\n                    <div className=\"absolute top-0 right-0 w-16 h-16 bg-primary/5 rounded-full -mr-8 -mt-8\"></div>\r\n                    <p className=\"text-3xl font-black text-primary group-hover:scale-110 transition-transform\">{totalPlants.toLocaleString()}</p>\r\n                    <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest mt-1\">เธเธณเธเธงเธเธ•เนเธเธฃเธงเธก</p>\r\n                </div>\r\n                <div className=\"gacp-card bg-white p-6 border-gray-100 flex flex-col items-center justify-center group overflow-hidden relative\">\r\n                    <div className=\"absolute top-0 right-0 w-16 h-16 bg-primary/5 rounded-full -mr-8 -mt-8\"></div>\r\n                    <p className=\"text-3xl font-black text-primary group-hover:scale-110 transition-transform\">{totalArea}</p>\r\n                    <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest mt-1\">เธเธทเนเธเธ—เธตเนเธเธฅเธนเธ (เนเธฃเน)</p>\r\n                </div>\r\n                <div className=\"gacp-card bg-white p-6 border-gray-100 flex flex-col items-center justify-center group overflow-hidden relative\">\r\n                    <div className=\"absolute top-0 right-0 w-16 h-16 bg-primary/5 rounded-full -mr-8 -mt-8\"></div>\r\n                    <p className=\"text-3xl font-black text-primary group-hover:scale-110 transition-transform\">{totalDocs}</p>\r\n                    <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest mt-1\">เน€เธญเธเธชเธฒเธฃเนเธเธ</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Main Content Sections */}\r\n            <div className=\"gacp-card border-gray-200 shadow-premium overflow-hidden animate-slide-up\" style={{ animationDelay: '100ms' }}>\r\n\r\n                {/* 1. Applicant */}\r\n                <SectionHeader\r\n                    title=\"เธเนเธญเธกเธนเธฅเธเธนเนเธขเธทเนเธเธเธณเธเธญ\"\r\n                    icon={<Icons.User className=\"w-6 h-6\" />}\r\n                    isOpen={expandedSections.applicant}\r\n                    onToggle={() => toggleSection('applicant')}\r\n                    editStep={2}\r\n                />\r\n                {expandedSections.applicant && (\r\n                    <div className=\"p-8 grid grid-cols-1 md:grid-cols-2 gap-8 animate-slide-down bg-white\">\r\n                        <InfoItem label=\"เธเธทเนเธญ-เธเธฒเธกเธชเธเธธเธฅ\" value={`${applicant?.firstName || ''} ${applicant?.lastName || ''}`} />\r\n                        <InfoItem label=\"เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธ / เธเธดเธ•เธดเธเธธเธเธเธฅ\" value={applicant?.idCard} />\r\n                        <InfoItem label=\"เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เน\" value={applicant?.phone} />\r\n                        <InfoItem label=\"เธญเธตเน€เธกเธฅ\" value={applicant?.email} />\r\n                        <InfoItem label=\"เธ—เธตเนเธญเธขเธนเน\" fullWidth value={`${applicant?.addressNo || ''} ${applicant?.subdistrict || ''} ${applicant?.district || ''} ${applicant?.province || ''} ${applicant?.zipCode || ''}`} />\r\n                    </div>\r\n                )}\r\n\r\n                {/* 2. Farm */}\r\n                <SectionHeader\r\n                    title=\"เธเนเธญเธกเธนเธฅเธชเธ–เธฒเธเธ—เธตเนเนเธฅเธฐเธฃเธฐเธเธ\"\r\n                    icon={<Icons.Home className=\"w-6 h-6\" />}\r\n                    isOpen={expandedSections.farm}\r\n                    onToggle={() => toggleSection('farm')}\r\n                    editStep={3}\r\n                />\r\n                {expandedSections.farm && (\r\n                    <div className=\"p-8 grid grid-cols-1 md:grid-cols-2 gap-8 animate-slide-down bg-white\">\r\n                        <InfoItem label=\"เธเธทเนเธญเธชเธ–เธฒเธเธ—เธตเนเธเธฅเธดเธ•\" value={farm?.farmName} />\r\n                        <InfoItem label=\"เธเธฑเธเธซเธงเธฑเธ”\" value={farm?.province} />\r\n                        <InfoItem label=\"เธเธเธฒเธ”เธเธทเนเธเธ—เธตเนเธฃเธงเธก\" value={`${farm?.totalAreaSize || '0'} เนเธฃเน`} />\r\n                        <InfoItem label=\"เธเธฃเธฃเธกเธชเธดเธ—เธเธดเน\" value={farm?.landOwnership} />\r\n                        <InfoItem label=\"เนเธซเธฅเนเธเธเนเธณ\" value={farm?.waterSource} />\r\n                        <InfoItem label=\"เธเธดเธเธฑเธ” GPS\" value={`${farm?.gpsLat || '-'}, ${farm?.gpsLng || '-'}`} />\r\n                    </div>\r\n                )}\r\n\r\n                {/* 3. Production & Plots */}\r\n                <SectionHeader\r\n                    title=\"เนเธเธเธเธฒเธฃเธเธฅเธดเธ•เนเธฅเธฐเนเธเธฅเธเธเธฅเธนเธ\"\r\n                    icon={<Icons.Leaf className=\"w-6 h-6\" />}\r\n                    isOpen={expandedSections.production}\r\n                    onToggle={() => toggleSection('production')}\r\n                    editStep={6}\r\n                />\r\n                {expandedSections.production && (\r\n                    <div className=\"p-8 space-y-8 animate-slide-down bg-white\">\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                            <InfoItem label=\"เธฃเธฐเธเธเธเธฒเธฃเน€เธเธฒเธฐเธเธฅเธนเธ\" value={state.cultivationMethod} />\r\n                            <InfoItem label=\"เธงเธฑเธ•เธ–เธธเธเธฃเธฐเธชเธเธเน\" value={state.certificationPurpose} />\r\n                        </div>\r\n\r\n                        <div>\r\n                            <p className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-4\">เธฃเธฒเธขเธเธฒเธฃเธฅเนเธญเธ•เธเธฒเธฃเธเธฅเธดเธ• ({lots.length})</p>\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                {lots.map((lot, idx) => (\r\n                                    <div key={idx} className=\"p-4 rounded-2xl border border-gray-100 bg-gray-50 flex justify-between items-center group hover:border-primary/30 transition-all\">\r\n                                        <div className=\"flex items-center gap-3\">\r\n                                            <div className=\"w-8 h-8 rounded-lg bg-white border border-gray-100 flex items-center justify-center text-primary font-bold shadow-sm\">\r\n                                                {idx + 1}\r\n                                            </div>\r\n                                            <div>\r\n                                                <p className=\"text-xs font-bold text-gray-900\">{lot.name}</p>\r\n                                                <p className=\"text-[10px] text-gray-400\">{lot.variety} โ€ข {lot.plantCount} เธ•เนเธ</p>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"text-right\">\r\n                                            <p className=\"text-[10px] font-bold text-primary bg-primary-50 px-2 py-0.5 rounded-md\">ID: {lot.id}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* 4. Documents */}\r\n                <SectionHeader\r\n                    title=\"เน€เธญเธเธชเธฒเธฃเธเธฃเธฐเธเธญเธเธเธณเธเธญ\"\r\n                    icon={<Icons.FileText className=\"w-6 h-6\" />}\r\n                    isOpen={expandedSections.documents}\r\n                    onToggle={() => toggleSection('documents')}\r\n                    editStep={9}\r\n                />\r\n                {expandedSections.documents && (\r\n                    <div className=\"p-8 space-y-6 animate-slide-down bg-white\">\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                            {documents.filter(d => d.uploaded).map((doc, idx) => (\r\n                                <div key={idx} className=\"p-3 bg-white border border-gray-100 rounded-2xl flex items-center gap-3 shadow-sm group hover:shadow-md transition-all\">\r\n                                    <div className=\"w-9 h-9 bg-emerald-50 text-emerald-600 rounded-xl flex items-center justify-center border border-emerald-100\">\r\n                                        <CheckIcon className=\"w-5 h-5\" />\r\n                                    </div>\r\n                                    <div className=\"flex-1 min-w-0 pr-2\">\r\n                                        <p className=\"text-xs font-bold text-gray-900 truncate\" title={doc.name}>{doc.name}</p>\r\n                                        <p className=\"text-[9px] text-emerald-500 font-bold uppercase tracking-tighter\">Verified</p>\r\n                                    </div>\r\n                                    <button className=\"opacity-0 group-hover:opacity-100 transition-opacity p-2 text-primary hover:bg-primary-50 rounded-lg\">\r\n                                        <Icons.Eye className=\"w-4 h-4\" />\r\n                                    </button>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                        {documents.filter(d => d.uploaded).length === 0 && (\r\n                            <div className=\"p-12 text-center rounded-3xl bg-gray-50 border border-dashed border-gray-200\">\r\n                                <p className=\"text-gray-400 font-bold\">เนเธกเนเธเธเธเนเธญเธกเธนเธฅเน€เธญเธเธชเธฒเธฃเนเธเธ</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Note Banner */}\r\n            <div className=\"p-6 bg-blue-50/80 backdrop-blur-sm border border-blue-200 rounded-3xl flex gap-4 text-blue-900 shadow-sm animate-slide-up\" style={{ animationDelay: '200ms' }}>\r\n                <div className=\"p-3 bg-white rounded-2xl shadow-sm h-fit\">\r\n                    <InfoIcon className=\"w-6 h-6 text-blue-600\" />\r\n                </div>\r\n                <div className=\"space-y-1\">\r\n                    <p className=\"font-black text-blue-900 text-sm\">เธเธฑเนเธเธ•เธญเธเธ•เนเธญเนเธ</p>\r\n                    <p className=\"text-xs leading-relaxed text-blue-800/80\">\r\n                        เธซเธฅเธฑเธเธเธฒเธเธเธ”เธขเธทเธเธขเธฑเธ เธฃเธฐเธเธเธเธฐเธเธณเธ—เนเธฒเธเนเธเธชเธนเนเธซเธเนเธฒเธเธฒเธฃเธฅเธเธเธฒเธกเธ”เธดเธเธดเธ—เธฑเธฅ (E-Signature) เน€เธเธทเนเธญเธชเนเธเธเธณเธเธญเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธเธเธฒเธฃเธ•เธฃเธงเธเธชเธญเธ\r\n                        เธเธฃเธธเธ“เธฒเน€เธ•เธฃเธตเธขเธกเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธเธซเธฃเธทเธญเธฃเธซเธฑเธช OTP เนเธซเนเธเธฃเนเธญเธก\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <WizardNavigation\r\n                onNext={() => router.push('/farmer/applications/new/step/12')}\r\n                onBack={() => router.push('/farmer/applications/new/step/10')}\r\n                nextLabel=\"เนเธเธ—เธตเนเธซเธเนเธฒเธชเนเธเธเธณเธเธญ\"\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StepPreview;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepProduction.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PlantIcon' is defined but never used.","line":9,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[877,880],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[877,880],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1099,1102],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1099,1102],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1227,1230],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1227,1230],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1387,1390],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1387,1390],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":164,"column":60,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8624,8667],"text":"เธเธ”เธเธธเนเธก &quot;เน€เธเธดเนเธกเธชเธฒเธขเธเธฑเธเธเธธเน\" เน€เธเธทเนเธญเธฃเธฐเธเธธเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8624,8667],"text":"เธเธ”เธเธธเนเธก &ldquo;เน€เธเธดเนเธกเธชเธฒเธขเธเธฑเธเธเธธเน\" เน€เธเธทเนเธญเธฃเธฐเธเธธเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8624,8667],"text":"เธเธ”เธเธธเนเธก &#34;เน€เธเธดเนเธกเธชเธฒเธขเธเธฑเธเธเธธเน\" เน€เธเธทเนเธญเธฃเธฐเธเธธเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8624,8667],"text":"เธเธ”เธเธธเนเธก &rdquo;เน€เธเธดเนเธกเธชเธฒเธขเธเธฑเธเธเธธเน\" เน€เธเธทเนเธญเธฃเธฐเธเธธเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":164,"column":75,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[8624,8667],"text":"เธเธ”เธเธธเนเธก \"เน€เธเธดเนเธกเธชเธฒเธขเธเธฑเธเธเธธเน&quot; เน€เธเธทเนเธญเธฃเธฐเธเธธเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[8624,8667],"text":"เธเธ”เธเธธเนเธก \"เน€เธเธดเนเธกเธชเธฒเธขเธเธฑเธเธเธธเน&ldquo; เน€เธเธทเนเธญเธฃเธฐเธเธธเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[8624,8667],"text":"เธเธ”เธเธธเนเธก \"เน€เธเธดเนเธกเธชเธฒเธขเธเธฑเธเธเธธเน&#34; เน€เธเธทเนเธญเธฃเธฐเธเธธเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[8624,8667],"text":"เธเธ”เธเธธเนเธก \"เน€เธเธดเนเธกเธชเธฒเธขเธเธฑเธเธเธธเน&rdquo; เน€เธเธทเนเธญเธฃเธฐเธเธธเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":208,"column":104,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":208,"endColumn":107,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11964,11967],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11964,11967],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":330,"column":60,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19347,19383],"text":"เธเธ”เธเธธเนเธก &quot;เน€เธเธดเนเธกเธฃเธฒเธขเธเธฒเธฃ\" เน€เธเธทเนเธญเธฃเธฐเธเธธเธเนเธญเธกเธนเธฅ"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19347,19383],"text":"เธเธ”เธเธธเนเธก &ldquo;เน€เธเธดเนเธกเธฃเธฒเธขเธเธฒเธฃ\" เน€เธเธทเนเธญเธฃเธฐเธเธธเธเนเธญเธกเธนเธฅ"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19347,19383],"text":"เธเธ”เธเธธเนเธก &#34;เน€เธเธดเนเธกเธฃเธฒเธขเธเธฒเธฃ\" เน€เธเธทเนเธญเธฃเธฐเธเธธเธเนเธญเธกเธนเธฅ"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19347,19383],"text":"เธเธ”เธเธธเนเธก &rdquo;เน€เธเธดเนเธกเธฃเธฒเธขเธเธฒเธฃ\" เน€เธเธทเนเธญเธฃเธฐเธเธธเธเนเธญเธกเธนเธฅ"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":330,"column":72,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19347,19383],"text":"เธเธ”เธเธธเนเธก \"เน€เธเธดเนเธกเธฃเธฒเธขเธเธฒเธฃ&quot; เน€เธเธทเนเธญเธฃเธฐเธเธธเธเนเธญเธกเธนเธฅ"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19347,19383],"text":"เธเธ”เธเธธเนเธก \"เน€เธเธดเนเธกเธฃเธฒเธขเธเธฒเธฃ&ldquo; เน€เธเธทเนเธญเธฃเธฐเธเธธเธเนเธญเธกเธนเธฅ"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19347,19383],"text":"เธเธ”เธเธธเนเธก \"เน€เธเธดเนเธกเธฃเธฒเธขเธเธฒเธฃ&#34; เน€เธเธทเนเธญเธฃเธฐเธเธธเธเนเธญเธกเธนเธฅ"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19347,19383],"text":"เธเธ”เธเธธเนเธก \"เน€เธเธดเนเธกเธฃเธฒเธขเธเธฒเธฃ&rdquo; เน€เธเธทเนเธญเธฃเธฐเธเธธเธเนเธญเธกเธนเธฅ"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":334,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":334,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19551,19554],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19551,19554],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":340,"column":97,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":340,"endColumn":100,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20061,20064],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20061,20064],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useWizardStore } from '../hooks/useWizardStore';\r\nimport { useMasterData } from '@/hooks/useMasterData';\r\nimport { useRouter } from 'next/navigation';\r\nimport { WizardNavigation } from '@/components/wizard/WizardNavigation';\r\nimport { FormLabelWithHint } from '@/components/FormHint';\r\nimport { PlantIcon, CheckIcon } from '@/components/icons/WizardIcons';\r\nimport { useLanguage } from '@/lib/i18n/LanguageContext';\r\n\r\nexport const StepProduction = () => {\r\n    const { state, setProductionData } = useWizardStore();\r\n    const router = useRouter();\r\n    const { dict } = useLanguage();\r\n    const { data: masterData } = useMasterData();\r\n\r\n    const [formData, setFormData] = useState(state.productionData || {\r\n        plantParts: [] as string[],\r\n        propagationType: '',\r\n        varieties: [] as any[],\r\n        seedSource: '',\r\n        varietyName: '',\r\n        estimatedYield: '',\r\n        sourceType: '',\r\n        cultivationArea: '',\r\n        spacing: '',\r\n        plantCount: '',\r\n        productionInputs: [] as any[],\r\n    });\r\n\r\n    useEffect(() => {\r\n        const timeout = setTimeout(() => {\r\n            setProductionData(formData as any);\r\n        }, 500);\r\n        return () => clearTimeout(timeout);\r\n    }, [formData, setProductionData]);\r\n\r\n    const handleChange = (field: string, value: any) => {\r\n        setFormData(prev => ({ ...prev, [field]: value }));\r\n    };\r\n\r\n    const togglePlantPart = (partId: string) => {\r\n        setFormData(prev => {\r\n            const current = prev.plantParts || [];\r\n            if (current.includes(partId)) {\r\n                return { ...prev, plantParts: current.filter(id => id !== partId) };\r\n            } else {\r\n                return { ...prev, plantParts: [...current, partId] };\r\n            }\r\n        });\r\n    };\r\n\r\n    const isNextDisabled = !formData.plantParts?.length || !formData.propagationType || (!formData.varieties?.length);\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center gap-4 mb-4\">\r\n                <div className=\"w-12 h-12 bg-primary gradient-mask rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-primary-50\">\r\n                    5\r\n                </div>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-primary-900\">{dict.wizard.steps.production}</h2>\r\n                    <p className=\"text-text-secondary\">เธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”เธชเนเธงเธเธ—เธตเนเธเธณเธกเธฒเนเธเน เนเธซเธฅเนเธเธ—เธตเนเธกเธฒ เนเธฅเธฐเธเธฃเธดเธกเธฒเธ“เธเธฒเธฃเธเธฅเธดเธ•</p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                {/* 1. Parts Used */}\r\n                <div className=\"gacp-card\">\r\n                    <h3 className=\"font-bold text-gray-800 mb-4 flex items-center gap-2\">\r\n                        <span className=\"text-xl\">๐ฟ</span> เธชเนเธงเธเธเธญเธเธเธทเธเธ—เธตเนเนเธเน (Plant Parts Used)\r\n                    </h3>\r\n                    <div className=\"grid grid-cols-2 gap-3\">\r\n                        {masterData?.plantParts.map((part) => (\r\n                            <label\r\n                                key={part.id}\r\n                                className={`\r\n                                    flex items-center gap-3 p-3 rounded-xl border cursor-pointer transition-all\r\n                                    ${formData.plantParts?.includes(part.id)\r\n                                        ? 'border-primary bg-primary-50 text-primary-900 shadow-sm'\r\n                                        : 'border-gray-100 bg-white hover:border-primary-200 hover:bg-gray-50'\r\n                                    }\r\n                                `}\r\n                            >\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    className=\"hidden\"\r\n                                    checked={formData.plantParts?.includes(part.id)}\r\n                                    onChange={() => togglePlantPart(part.id)}\r\n                                />\r\n                                <div className={`w-5 h-5 rounded border flex items-center justify-center transition-colors ${formData.plantParts?.includes(part.id) ? 'bg-primary border-primary text-white' : 'border-gray-300 bg-white'\r\n                                    }`}>\r\n                                    {formData.plantParts?.includes(part.id) && <CheckIcon className=\"w-3 h-3\" />}\r\n                                </div>\r\n                                <span className=\"font-medium text-sm\">{part.label}</span>\r\n                            </label>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* 2. Propagation Method */}\r\n                <div className=\"gacp-card\">\r\n                    <h3 className=\"font-bold text-gray-800 mb-4 flex items-center gap-2\">\r\n                        <span className=\"text-xl\">๐ฑ</span> เธงเธดเธเธตเธเธฒเธฃเธเธขเธฒเธขเธเธฑเธเธเธธเน (Propagation)\r\n                    </h3>\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        {[\r\n                            { id: 'SEED', label: 'เน€เธเธฒเธฐเน€เธกเธฅเนเธ” (Seed)', icon: '๐ฑ' },\r\n                            { id: 'CUTTING', label: 'เธเธฑเธเธเธณ (Cutting)', icon: '๐ฟ' },\r\n                            { id: 'TISSUE', label: 'เน€เธเธฒเธฐเน€เธฅเธตเนเธขเธเน€เธเธทเนเธญเน€เธขเธทเนเธญ (Tissue)', icon: '๐งช' },\r\n                            { id: 'OTHER', label: 'เธญเธทเนเธ เน (Other)', icon: 'โ“' }\r\n                        ].map((method) => (\r\n                            <button\r\n                                key={method.id}\r\n                                onClick={() => handleChange('propagationType', method.id)}\r\n                                className={`\r\n                                    p-4 rounded-xl border text-left transition-all flex flex-col gap-2 relative overflow-hidden\r\n                                    ${formData.propagationType === method.id\r\n                                        ? 'border-primary bg-primary-50 ring-1 ring-primary-500 shadow-sm'\r\n                                        : 'border-gray-100 bg-white hover:border-primary-300 hover:shadow-md'\r\n                                    }\r\n                                `}\r\n                            >\r\n                                <span className=\"text-2xl\">{method.icon}</span>\r\n                                <span className={`font-bold text-sm ${formData.propagationType === method.id ? 'text-primary-900' : 'text-gray-700'}`}>\r\n                                    {method.label}\r\n                                </span>\r\n                                {formData.propagationType === method.id && (\r\n                                    <div className=\"absolute top-2 right-2 text-primary animate-scale-in\">\r\n                                        <CheckIcon className=\"w-4 h-4\" />\r\n                                    </div>\r\n                                )}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* 3. Plant Varieties */}\r\n            <div className=\"gacp-card\">\r\n                <div className=\"flex justify-between items-center mb-6\">\r\n                    <h3 className=\"font-bold text-gray-800 flex items-center gap-2\">\r\n                        <span className=\"text-xl\">๐“</span> เธเนเธญเธกเธนเธฅเธชเธฒเธขเธเธฑเธเธเธธเน (Varieties)\r\n                    </h3>\r\n                    <button\r\n                        onClick={() => {\r\n                            const newVariety = { id: Date.now().toString(), name: '', sourceType: 'SELF' as const, quantity: 0 };\r\n                            setFormData(prev => ({\r\n                                ...prev,\r\n                                varieties: [...(prev.varieties || []), newVariety]\r\n                            }));\r\n                        }}\r\n                        className=\"px-4 py-2 bg-primary text-white rounded-xl hover:bg-primary-700 transition-all flex items-center gap-2 font-bold shadow-md active:scale-95\"\r\n                    >\r\n                        <span>+</span> เน€เธเธดเนเธกเธชเธฒเธขเธเธฑเธเธเธธเน\r\n                    </button>\r\n                </div>\r\n\r\n                {(!formData.varieties || formData.varieties.length === 0) ? (\r\n                    <div className=\"text-center py-12 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200 text-gray-400\">\r\n                        <p className=\"font-medium\">เธขเธฑเธเนเธกเนเนเธ”เนเน€เธเธดเนเธกเธเนเธญเธกเธนเธฅเธชเธฒเธขเธเธฑเธเธเธธเน</p>\r\n                        <p className=\"text-xs mt-1\">เธเธ”เธเธธเนเธก \"เน€เธเธดเนเธกเธชเธฒเธขเธเธฑเธเธเธธเน\" เน€เธเธทเนเธญเธฃเธฐเธเธธเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                        {formData.varieties.map((item, index) => (\r\n                            <div key={item.id} className=\"p-5 rounded-2xl border border-gray-100 bg-white hover:border-primary-200 transition-all relative group shadow-sm hover:shadow-md animate-slide-up\">\r\n                                <button\r\n                                    onClick={() => {\r\n                                        setFormData(prev => ({\r\n                                            ...prev,\r\n                                            varieties: prev.varieties?.filter(v => v.id !== item.id)\r\n                                        }));\r\n                                    }}\r\n                                    className=\"absolute top-3 right-3 p-1.5 text-gray-400 hover:text-danger hover:bg-danger-bg rounded-lg transition-all opacity-0 group-hover:opacity-100\"\r\n                                    title=\"เธฅเธเธฃเธฒเธขเธเธฒเธฃ\"\r\n                                >\r\n                                    <svg width=\"18\" height=\"18\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\"><path d=\"M6 18L18 6M6 6l12 12\" /></svg>\r\n                                </button>\r\n\r\n                                <div className=\"space-y-4\">\r\n                                    <div className=\"flex items-center gap-3\">\r\n                                        <span className=\"bg-primary-50 text-primary text-xs font-bold px-2 py-1 rounded\">#{index + 1}</span>\r\n                                        <div className=\"flex-1\">\r\n                                            <FormLabelWithHint label=\"เธเธทเนเธญเธชเธฒเธขเธเธฑเธเธเธธเน\" required />\r\n                                            <input\r\n                                                className=\"gacp-input mt-1\"\r\n                                                placeholder=\"เน€เธเนเธ เธซเธฒเธเธเธฃเธฐเธฃเธญเธ\"\r\n                                                value={item.name}\r\n                                                onChange={(e) => {\r\n                                                    const newVarieties = [...(formData.varieties || [])];\r\n                                                    newVarieties[index].name = e.target.value;\r\n                                                    setFormData(prev => ({ ...prev, varieties: newVarieties }));\r\n                                                }}\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"grid grid-cols-2 gap-4\">\r\n                                        <div>\r\n                                            <FormLabelWithHint label=\"เนเธซเธฅเนเธเธ—เธตเนเธกเธฒ\" />\r\n                                            <select\r\n                                                className=\"gacp-input mt-1\"\r\n                                                value={item.sourceType}\r\n                                                onChange={(e) => {\r\n                                                    const newVarieties = [...(formData.varieties || [])];\r\n                                                    newVarieties[index].sourceType = e.target.value as any;\r\n                                                    setFormData(prev => ({ ...prev, varieties: newVarieties }));\r\n                                                }}\r\n                                            >\r\n                                                <option value=\"SELF\">เน€เธเนเธเน€เธญเธ</option>\r\n                                                <option value=\"BUY\">เธเธทเนเธญเธกเธฒ</option>\r\n                                                <option value=\"IMPORT\">เธเธณเน€เธเนเธฒ</option>\r\n                                            </select>\r\n                                        </div>\r\n                                        {item.sourceType !== 'SELF' && (\r\n                                            <div className=\"animate-fade-in\">\r\n                                                <FormLabelWithHint label=\"เธเธทเนเธญเธฃเนเธฒเธ/เนเธซเธฅเนเธเธ—เธตเนเธกเธฒ\" />\r\n                                                <input\r\n                                                    className=\"gacp-input mt-1\"\r\n                                                    placeholder=\"เธเธทเนเธญเธฃเนเธฒเธเธเนเธฒ...\"\r\n                                                    value={item.sourceName || ''}\r\n                                                    onChange={(e) => {\r\n                                                        const newVarieties = [...(formData.varieties || [])];\r\n                                                        newVarieties[index].sourceName = e.target.value;\r\n                                                        setFormData(prev => ({ ...prev, varieties: newVarieties }));\r\n                                                    }}\r\n                                                />\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* 4. Cultivation Summary Card */}\r\n            <div className=\"gacp-card bg-gradient-to-br from-indigo-50 to-white border-indigo-100 relative overflow-hidden\">\r\n                <div className=\"absolute top-0 right-0 w-[300px] h-[300px] bg-gradient-to-bl from-indigo-100/40 to-transparent rounded-full blur-3xl -mr-20 -mt-20 pointer-events-none\"></div>\r\n\r\n                <h3 className=\"font-bold text-indigo-900 mb-6 flex items-center gap-3 text-lg relative z-10\">\r\n                    <span className=\"w-8 h-8 rounded-lg bg-white shadow-sm flex items-center justify-center\">๐“</span>\r\n                    เธเธฃเธฐเธกเธฒเธ“เธเธฒเธฃเธเธฒเธฃเน€เธเธฒเธฐเธเธฅเธนเธ (Cultivation Estimate)\r\n                </h3>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 relative z-10\">\r\n                    <div>\r\n                        <FormLabelWithHint label=\"เธฃเธฐเธขเธฐเธเธฅเธนเธ (Spacing)\" />\r\n                        <select\r\n                            className=\"gacp-input mt-1 bg-white\"\r\n                            value={formData.spacing || ''}\r\n                            onChange={(e) => handleChange('spacing', e.target.value)}\r\n                        >\r\n                            <option value=\"\">-- เน€เธฅเธทเธญเธเธฃเธฐเธขเธฐเธเธฅเธนเธ --</option>\r\n                            <option value=\"1x1\">1 x 1 เน€เธกเธ•เธฃ (Standard)</option>\r\n                            <option value=\"1.5x1.5\">1.5 x 1.5 เน€เธกเธ•เธฃ</option>\r\n                            <option value=\"2x2\">2 x 2 เน€เธกเธ•เธฃ</option>\r\n                            <option value=\"4x4\">4 x 4 เน€เธกเธ•เธฃ</option>\r\n                        </select>\r\n                    </div>\r\n                    <div>\r\n                        <FormLabelWithHint label=\"เธเธณเธเธงเธเธ•เนเธเธฃเธงเธก (Total Plant Count)\" />\r\n                        <div className=\"relative\">\r\n                            <input\r\n                                type=\"number\"\r\n                                className=\"gacp-input mt-1 bg-white pr-10\"\r\n                                placeholder=\"0\"\r\n                                value={formData.plantCount || ''}\r\n                                onChange={(e) => handleChange('plantCount', e.target.value)}\r\n                            />\r\n                            <span className=\"absolute right-3 top-[1.1rem] text-text-tertiary text-xs font-bold\">เธ•เนเธ</span>\r\n                        </div>\r\n                    </div>\r\n                    <div>\r\n                        <FormLabelWithHint label=\"เธเธฅเธเธฅเธดเธ•เธเธฒเธ”เธเธฒเธฃเธ“เนเธฃเธงเธก (เธเธ./เธเธต)\" />\r\n                        <div className=\"relative\">\r\n                            <input\r\n                                type=\"number\"\r\n                                className={`gacp-input mt-1 bg-white pr-10 ${Number(formData.estimatedYield) > 500 ? 'border-amber-300 focus:ring-amber-100' : ''}`}\r\n                                placeholder=\"0\"\r\n                                value={formData.estimatedYield}\r\n                                onChange={(e) => handleChange('estimatedYield', e.target.value)}\r\n                            />\r\n                            <span className=\"absolute right-3 top-[1.1rem] text-text-tertiary text-xs font-bold\">เธเธ.</span>\r\n                        </div>\r\n                        {Number(formData.estimatedYield) > 500 && (\r\n                            <p className=\"text-[10px] text-amber-600 mt-1 font-bold flex items-center gap-1\">\r\n                                โ ๏ธ เน€เธเธดเธเธเนเธฒเน€เธเธฅเธตเนเธขเธกเธฒเธ•เธฃเธเธฒเธ\r\n                            </p>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* 5. Production Inputs */}\r\n            <div className=\"gacp-card\">\r\n                <div className=\"flex justify-between items-center mb-6\">\r\n                    <div>\r\n                        <h3 className=\"font-bold text-gray-800 flex items-center gap-2\">\r\n                            <span className=\"text-xl\">๐งด</span> เธเธฑเธเธเธฑเธขเธเธฒเธฃเธเธฅเธดเธ• (Production Inputs)\r\n                        </h3>\r\n                        <p className=\"text-xs text-text-secondary mt-1\">เธเธธเนเธข, เธงเธฑเธชเธ”เธธเธเธฃเธฑเธเธเธฃเธธเธเธ”เธดเธ, เนเธฅเธฐเธชเธฒเธฃเธเนเธญเธเธเธฑเธเธเธณเธเธฑเธ”เธจเธฑเธ•เธฃเธนเธเธทเธ</p>\r\n                    </div>\r\n                    <button\r\n                        onClick={() => {\r\n                            const newInput = {\r\n                                id: Date.now().toString(),\r\n                                type: 'FERTILIZER',\r\n                                name: '',\r\n                                sourceType: 'PURCHASED',\r\n                                isOrganic: false\r\n                            };\r\n                            setFormData(prev => ({\r\n                                ...prev,\r\n                                productionInputs: [...(prev.productionInputs || []), newInput]\r\n                            }));\r\n                        }}\r\n                        className=\"px-4 py-2 bg-primary text-white rounded-xl hover:bg-primary-700 transition-all flex items-center gap-2 font-bold shadow-md active:scale-95\"\r\n                    >\r\n                        <span>+</span> เน€เธเธดเนเธกเธฃเธฒเธขเธเธฒเธฃ\r\n                    </button>\r\n                </div>\r\n\r\n                {(!formData.productionInputs || formData.productionInputs.length === 0) ? (\r\n                    <div className=\"text-center py-10 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200 text-gray-400\">\r\n                        <p className=\"font-medium\">เธขเธฑเธเนเธกเนเธกเธตเธเนเธญเธกเธนเธฅเธเธฑเธเธเธฑเธขเธเธฒเธฃเธเธฅเธดเธ•</p>\r\n                        <p className=\"text-xs mt-1\">เธเธ”เธเธธเนเธก \"เน€เธเธดเนเธกเธฃเธฒเธขเธเธฒเธฃ\" เน€เธเธทเนเธญเธฃเธฐเธเธธเธเนเธญเธกเธนเธฅ</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"space-y-4\">\r\n                        {formData.productionInputs.map((item: any, index: number) => (\r\n                            <div key={item.id} className=\"p-4 rounded-xl border border-gray-100 bg-gray-50/50 hover:bg-white transition-all relative group animate-slide-up\">\r\n                                <button\r\n                                    onClick={() => {\r\n                                        setFormData(prev => ({\r\n                                            ...prev,\r\n                                            productionInputs: prev.productionInputs?.filter((i: any) => i.id !== item.id)\r\n                                        }));\r\n                                    }}\r\n                                    className=\"absolute top-2 right-2 p-1 text-gray-400 hover:text-danger hover:bg-danger-bg rounded-lg opacity-0 group-hover:opacity-100 transition-all\"\r\n                                >\r\n                                    <svg width=\"16\" height=\"16\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\"><path d=\"M6 18L18 6M6 6l12 12\" /></svg>\r\n                                </button>\r\n\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-12 gap-4 items-end\">\r\n                                    <div className=\"md:col-span-3\">\r\n                                        <FormLabelWithHint label=\"เธเธฃเธฐเน€เธ เธ—\" />\r\n                                        <select\r\n                                            className=\"gacp-input mt-1 bg-white\"\r\n                                            value={item.type}\r\n                                            onChange={(e) => {\r\n                                                const inputs = [...(formData.productionInputs || [])];\r\n                                                inputs[index].type = e.target.value;\r\n                                                setFormData(prev => ({ ...prev, productionInputs: inputs }));\r\n                                            }}\r\n                                        >\r\n                                            <option value=\"FERTILIZER\">เธเธธเนเธข (Fertilizer)</option>\r\n                                            <option value=\"SOIL_AMENDMENT\">เธงเธฑเธชเธ”เธธเธเธฃเธฑเธเธเธฃเธธเธเธ”เธดเธ</option>\r\n                                            <option value=\"PLANT_PROTECTION\">เธจเธฑเธ•เธฃเธนเธเธทเธ/เธงเธฑเธเธเธทเธ</option>\r\n                                            <option value=\"OTHER\">เธญเธทเนเธเน</option>\r\n                                        </select>\r\n                                    </div>\r\n                                    <div className=\"md:col-span-4\">\r\n                                        <FormLabelWithHint label=\"เธเธทเนเธญเน€เธฃเธตเธขเธ / เธขเธตเนเธซเนเธญ\" />\r\n                                        <input\r\n                                            className=\"gacp-input mt-1 bg-white\"\r\n                                            placeholder=\"เน€เธเนเธ เธเธธเนเธขเธเธญเธ, NPK 15-15-15\"\r\n                                            value={item.name}\r\n                                            onChange={(e) => {\r\n                                                const inputs = [...(formData.productionInputs || [])];\r\n                                                inputs[index].name = e.target.value;\r\n                                                setFormData(prev => ({ ...prev, productionInputs: inputs }));\r\n                                            }}\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"md:col-span-3\">\r\n                                        <FormLabelWithHint label=\"เนเธซเธฅเนเธเธ—เธตเนเธกเธฒ\" />\r\n                                        <select\r\n                                            className=\"gacp-input mt-1 bg-white\"\r\n                                            value={item.sourceType}\r\n                                            onChange={(e) => {\r\n                                                const inputs = [...(formData.productionInputs || [])];\r\n                                                inputs[index].sourceType = e.target.value;\r\n                                                setFormData(prev => ({ ...prev, productionInputs: inputs }));\r\n                                            }}\r\n                                        >\r\n                                            <option value=\"PURCHASED\">เธเธทเนเธญเธเธฒเธเธฃเนเธฒเธเธเนเธฒ</option>\r\n                                            <option value=\"SELF_MADE\">เธเธฅเธดเธ•เน€เธญเธ</option>\r\n                                        </select>\r\n                                    </div>\r\n                                    <div className=\"md:col-span-2 flex items-center h-[2.75rem]\">\r\n                                        <label className=\"flex items-center cursor-pointer gap-2 select-none group/check\">\r\n                                            <div className={`w-5 h-5 rounded border flex items-center justify-center transition-all ${item.isOrganic ? 'bg-primary border-primary shadow-sm' : 'border-gray-300 bg-white shadow-inner group-hover/check:border-primary-300'}`}>\r\n                                                {item.isOrganic && <CheckIcon className=\"w-3 h-3 text-white\" />}\r\n                                            </div>\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                className=\"hidden\"\r\n                                                checked={item.isOrganic || false}\r\n                                                onChange={(e) => {\r\n                                                    const inputs = [...(formData.productionInputs || [])];\r\n                                                    inputs[index].isOrganic = e.target.checked;\r\n                                                    setFormData(prev => ({ ...prev, productionInputs: inputs }));\r\n                                                }}\r\n                                            />\r\n                                            <span className=\"text-sm font-bold text-gray-600\">เธญเธดเธเธ—เธฃเธตเธขเน</span>\r\n                                        </label>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <WizardNavigation\r\n                onNext={() => router.push('/farmer/applications/new/step/6')}\r\n                onBack={() => router.push('/farmer/applications/new/step/4')}\r\n                isNextDisabled={isNextDisabled}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StepProduction;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepProductionEstimate.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setLots' is assigned a value but never used.","line":22,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":27},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepProductionEstimate.tsx:55:13\n  53 |     useEffect(() => {\n  54 |         if (totalPlantsFromLots > 0) {\n> 55 |             setEstimatedPlants(totalPlantsFromLots);\n     |             ^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  56 |         }\n  57 |     }, [totalPlantsFromLots]);\n  58 |","line":55,"column":13,"nodeType":null,"endLine":55,"endColumn":31},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepProductionEstimate.tsx:62:13\n  60 |     useEffect(() => {\n  61 |         if (estimatedPlants > recommendedMax * 1.5) {\n> 62 |             setValidationWarning(`เธเธณเธเธงเธเธ•เนเธเธชเธนเธเธเธงเนเธฒเธเนเธฒเนเธเธฐเธเธณเธกเธฒเธ (เธชเธนเธเธชเธธเธ” ~${recommendedMax.toLocaleString()} เธ•เนเธ เธชเธณเธซเธฃเธฑเธเธเธทเนเธเธ—เธตเน ${totalAreaRai} เนเธฃเน)`);\n     |             ^^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  63 |         } else if (estimatedPlants < recommendedMin * 0.5 && estimatedPlants > 0) {\n  64 |             setValidationWarning(`เธเธณเธเธงเธเธ•เนเธเธ•เนเธณเธเธงเนเธฒเธเนเธฒเนเธเธฐเธเธณเธกเธฒเธ (เธ•เนเธณเธชเธธเธ” ~${recommendedMin.toLocaleString()} เธ•เนเธ)`);\n  65 |         } else {","line":62,"column":13,"nodeType":null,"endLine":62,"endColumn":33}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useWizardStore } from '../hooks/useWizardStore';\r\nimport { useRouter } from 'next/navigation';\r\nimport { WizardNavigation } from '@/components/wizard/WizardNavigation';\r\nimport { FormLabelWithHint } from '@/components/FormHint';\r\nimport { Icons } from '@/components/ui/icons';\r\nimport { useLanguage } from '@/lib/i18n/LanguageContext';\r\nimport { InfoIcon, PlantIcon, WarningIcon } from '@/components/icons/WizardIcons';\r\n\r\n// Density constants per cultivation system (plants per sq.m.)\r\nconst DENSITY_CONFIG = {\r\n    INDOOR: { min: 4, default: 8, max: 40, label: 'เธเธฒเธฃเนเธกเธเธดเธ” (Indoor)' },\r\n    OUTDOOR: { min: 0.5, default: 1.5, max: 4, label: 'เธเธฒเธฃเนเธกเน€เธเธดเธ” (Outdoor)' },\r\n    GREENHOUSE: { min: 6, default: 10, max: 20, label: 'เนเธฃเธเน€เธฃเธทเธญเธ (Greenhouse)' },\r\n};\r\n\r\nconst LOSS_RATE = 0.15; // 15% estimated loss\r\n\r\nexport const StepProductionEstimate = () => {\r\n    const { state, setLots } = useWizardStore();\r\n    const router = useRouter();\r\n    const { dict } = useLanguage();\r\n\r\n    // Get cultivation system from state\r\n    const cultivationSystem = (state.cultivationMethod?.toUpperCase() || 'OUTDOOR') as keyof typeof DENSITY_CONFIG;\r\n    const systemConfig = DENSITY_CONFIG[cultivationSystem] || DENSITY_CONFIG.OUTDOOR;\r\n\r\n    // Get total area from farmData or siteData\r\n    const totalAreaRai = parseFloat(state.farmData?.totalAreaSize || state.siteData?.areaSize || '0');\r\n    const totalAreaSqm = totalAreaRai * 1600;\r\n\r\n    // Calculate recommended range\r\n    const recommendedMin = Math.floor(totalAreaSqm * systemConfig.min * (1 - LOSS_RATE));\r\n    const recommendedMax = Math.floor(totalAreaSqm * systemConfig.max * (1 - LOSS_RATE));\r\n    const recommendedDefault = Math.floor(totalAreaSqm * systemConfig.default * (1 - LOSS_RATE));\r\n\r\n    // Summary of plants from existing lots (Step 6)\r\n    const totalPlantsFromLots = state.lots?.reduce((sum, lot) => sum + (lot.plantCount || 0), 0) || 0;\r\n\r\n    // Local state - prioritize total from lots if available\r\n    const [estimatedPlants, setEstimatedPlants] = useState<number>(\r\n        totalPlantsFromLots > 0 ? totalPlantsFromLots : (state.lots?.[0]?.plantCount || recommendedDefault)\r\n    );\r\n    const [plantingDate, setPlantingDate] = useState<string>(\r\n        state.lots?.[0]?.estimatedPlantingDate || ''\r\n    );\r\n    const [notes, setNotes] = useState<string>(state.lots?.[0]?.notes || '');\r\n    const [validationWarning, setValidationWarning] = useState<string>('');\r\n\r\n    // Update estimated plants if lots change and were not manual\r\n    useEffect(() => {\r\n        if (totalPlantsFromLots > 0) {\r\n            setEstimatedPlants(totalPlantsFromLots);\r\n        }\r\n    }, [totalPlantsFromLots]);\r\n\r\n    // Validate plant count\r\n    useEffect(() => {\r\n        if (estimatedPlants > recommendedMax * 1.5) {\r\n            setValidationWarning(`เธเธณเธเธงเธเธ•เนเธเธชเธนเธเธเธงเนเธฒเธเนเธฒเนเธเธฐเธเธณเธกเธฒเธ (เธชเธนเธเธชเธธเธ” ~${recommendedMax.toLocaleString()} เธ•เนเธ เธชเธณเธซเธฃเธฑเธเธเธทเนเธเธ—เธตเน ${totalAreaRai} เนเธฃเน)`);\r\n        } else if (estimatedPlants < recommendedMin * 0.5 && estimatedPlants > 0) {\r\n            setValidationWarning(`เธเธณเธเธงเธเธ•เนเธเธ•เนเธณเธเธงเนเธฒเธเนเธฒเนเธเธฐเธเธณเธกเธฒเธ (เธ•เนเธณเธชเธธเธ” ~${recommendedMin.toLocaleString()} เธ•เนเธ)`);\r\n        } else {\r\n            setValidationWarning('');\r\n        }\r\n    }, [estimatedPlants, recommendedMin, recommendedMax, totalAreaRai]);\r\n\r\n    // Validation\r\n    const canProceed = estimatedPlants > 0;\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in max-w-5xl mx-auto pb-12\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center gap-4 mb-4\">\r\n                <div className=\"w-12 h-12 bg-primary gradient-mask rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-primary-50\">\r\n                    7\r\n                </div>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-primary-900\">{dict.wizard.preview?.headers?.production || 'เธเธฃเธฐเธกเธฒเธ“เธเธฒเธฃเธเธฅเธเธฅเธดเธ• (Production Estimate)'}</h2>\r\n                    <p className=\"text-text-secondary\">เธเนเธญเธกเธนเธฅเธชเธณเธซเธฃเธฑเธเธเธฃเธฐเน€เธกเธดเธเธจเธฑเธเธขเธ เธฒเธเธเธฒเธฃเธเธฅเธดเธ•เนเธฅเธฐเธ•เธฃเธงเธเธชเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Info Banner */}\r\n            <div className=\"p-6 bg-blue-50/80 backdrop-blur-sm border border-blue-200 rounded-2xl flex gap-4 text-blue-900 text-sm shadow-sm animate-slide-up\">\r\n                <div className=\"p-2 bg-white rounded-xl shadow-sm h-fit\">\r\n                    <InfoIcon className=\"w-6 h-6 text-blue-600\" />\r\n                </div>\r\n                <div className=\"space-y-1\">\r\n                    <p className=\"font-bold text-blue-900\">เธเธณเนเธเธฐเธเธณเธกเธฒเธ•เธฃเธเธฒเธ GACP</p>\r\n                    <p className=\"leading-relaxed text-blue-800/80\">\r\n                        เธเธฃเธธเธ“เธฒเธฃเธฐเธเธธเธเธณเธเธงเธเธ•เนเธเธเธทเธเธ—เธตเนเธเธฒเธ”เธงเนเธฒเธเธฐเธเธฅเธนเธ เน€เธเธทเนเธญเนเธเนเธเธฃเธฐเน€เธกเธดเธเธเธงเธฒเธกเน€เธซเธกเธฒเธฐเธชเธกเธเธญเธเธเธทเนเธเธ—เธตเน (Density Check)\r\n                        {totalPlantsFromLots > 0 && \" เธฃเธฐเธเธเธชเธฃเธธเธเธขเธญเธ”เธฃเธงเธกเธเธฒเธเนเธเธฅเธเธ—เธตเนเธเธธเธ“เนเธเนเธเนเธงเนเนเธเธเธฑเนเธเธ•เธญเธเธเนเธญเธเธซเธเนเธฒเนเธ”เธขเธญเธฑเธ•เนเธเธกเธฑเธ•เธด\"}\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Summary Grid */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 animate-slide-up\" style={{ animationDelay: '100ms' }}>\r\n                <div className=\"gacp-card bg-gradient-to-br from-primary-50/50 to-white text-center p-6 border-primary-100 hover:shadow-md transition-shadow\">\r\n                    <p className=\"text-xs font-bold text-primary-600 uppercase tracking-wider mb-2\">เธเธทเนเธเธ—เธตเนเธเธฅเธนเธเธ—เธฑเนเธเธซเธกเธ”</p>\r\n                    <p className=\"text-4xl font-black text-primary-900\">{totalAreaRai} <span className=\"text-lg text-primary-600 font-medium\">เนเธฃเน</span></p>\r\n                </div>\r\n                <div className=\"gacp-card bg-gradient-to-br from-indigo-50/50 to-white text-center p-6 border-indigo-100 hover:shadow-md transition-shadow\">\r\n                    <p className=\"text-xs font-bold text-indigo-600 uppercase tracking-wider mb-2\">เธฃเธฐเธเธเธเธฒเธฃเธเธฅเธนเธ</p>\r\n                    <div className=\"flex items-center justify-center gap-2\">\r\n                        <span className=\"text-2xl\">{cultivationSystem === 'INDOOR' ? '๐ญ' : cultivationSystem === 'GREENHOUSE' ? '๐ ' : '๐ฟ'}</span>\r\n                        <p className=\"text-2xl font-black text-indigo-900\">{systemConfig.label}</p>\r\n                    </div>\r\n                </div>\r\n                <div className=\"gacp-card bg-gradient-to-br from-teal-50/50 to-white text-center p-6 border-teal-100 hover:shadow-md transition-shadow\">\r\n                    <p className=\"text-xs font-bold text-teal-600 uppercase tracking-wider mb-2\">เธเธณเธเธงเธเธฅเนเธญเธ•/เนเธเธฅเธ</p>\r\n                    <p className=\"text-4xl font-black text-teal-900\">{state.lots?.length || 0} <span className=\"text-lg text-teal-600 font-medium\">เธฃเธฒเธขเธเธฒเธฃ</span></p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Main Estimate Form */}\r\n            <div className=\"gacp-card p-8 space-y-8 animate-slide-up relative overflow-hidden\" style={{ animationDelay: '200ms' }}>\r\n                <div className=\"absolute top-0 right-0 w-64 h-64 bg-primary-100/20 rounded-full blur-3xl -mr-20 -mt-20 pointer-events-none\"></div>\r\n\r\n                {/* Estimated Plants Input */}\r\n                <div className=\"relative z-10\">\r\n                    <div className=\"flex flex-col md:flex-row md:items-center justify-between mb-4 gap-2\">\r\n                        <FormLabelWithHint\r\n                            label={dict.wizard.preview?.labels?.totalPlants || \"เธเธณเธเธงเธเธ•เนเธเธเธทเธเธเธฃเธฐเธกเธฒเธ“เธเธฒเธฃ\"}\r\n                            hint=\"เธเธณเธเธงเธเธ•เนเธเธ—เธฑเนเธเธซเธกเธ”เธ—เธตเนเธเธฒเธ”เธงเนเธฒเธเธฐเธเธฅเธนเธเนเธเธฃเธญเธเธเธตเน\"\r\n                            required\r\n                        />\r\n                        <div className=\"flex items-center gap-2 px-3 py-1.5 bg-gray-50 rounded-xl border border-gray-100\">\r\n                            <div className=\"w-2 h-2 rounded-full bg-primary animate-pulse\"></div>\r\n                            <span className=\"text-xs font-medium text-gray-500\">\r\n                                เธเนเธงเธเนเธเธฐเธเธณ: {recommendedMin.toLocaleString()} - {recommendedMax.toLocaleString()} เธ•เนเธ\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"relative transition-all duration-300\">\r\n                        <input\r\n                            type=\"number\"\r\n                            readOnly={totalPlantsFromLots > 0}\r\n                            className={`w-full border rounded-2xl px-6 py-5 text-4xl font-black outline-none transition-all shadow-sm\r\n                                ${totalPlantsFromLots > 0 ? 'bg-gray-50 text-gray-400 border-gray-100' :\r\n                                    validationWarning ? 'border-amber-300 bg-amber-50 focus:ring-4 focus:ring-amber-100 text-amber-900' :\r\n                                        'border-gray-200 focus:border-primary focus:ring-4 focus:ring-primary-100 text-primary-900'}`}\r\n                            placeholder={`เนเธเธฐเธเธณ: ${recommendedDefault.toLocaleString()} เธ•เนเธ`}\r\n                            value={estimatedPlants || ''}\r\n                            onChange={e => setEstimatedPlants(parseInt(e.target.value) || 0)}\r\n                        />\r\n                        <div className={`absolute right-6 top-1/2 -translate-y-1/2 font-black text-2xl pointer-events-none py-2 px-4 rounded-xl ${totalPlantsFromLots > 0 ? 'bg-gray-100 text-gray-300' : 'bg-primary-50 text-primary-500'}`}>\r\n                            เธ•เนเธ\r\n                        </div>\r\n                    </div>\r\n\r\n                    {totalPlantsFromLots > 0 && (\r\n                        <p className=\"mt-3 text-sm text-primary-600 flex items-center gap-2 font-medium\">\r\n                            <Icons.CheckCircle className=\"w-4 h-4\" />\r\n                            เธ”เธถเธเธเนเธญเธกเธนเธฅเธเธฒเธเธฃเธฒเธขเธเธฒเธฃเธฅเนเธญเธ•เธ—เธตเนเธเธธเธ“เธชเธฃเนเธฒเธเนเธงเนเธญเธฑเธ•เนเธเธกเธฑเธ•เธด\r\n                        </p>\r\n                    )}\r\n\r\n                    {validationWarning && (\r\n                        <div className=\"mt-4 p-4 bg-amber-50 border border-amber-200 rounded-2xl flex gap-3 text-amber-800 animate-slide-down\">\r\n                            <WarningIcon className=\"w-6 h-6 shrink-0\" />\r\n                            <div className=\"text-sm\">\r\n                                <p className=\"font-bold mb-0.5\">เธเนเธญเธเธงเธฃเธฃเธฐเธงเธฑเธ</p>\r\n                                <p className=\"opacity-80\">{validationWarning}</p>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Density Analysis */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 pt-4\">\r\n                    <div className=\"p-6 rounded-2xl bg-gradient-to-br from-gray-50 to-white border border-gray-100 shadow-inner group transition-all hover:border-primary-200\">\r\n                        <div className=\"flex justify-between items-start mb-4\">\r\n                            <div className=\"p-2 bg-white rounded-xl shadow-sm\">\r\n                                <PlantIcon className=\"w-6 h-6 text-primary-600\" />\r\n                            </div>\r\n                            <span className=\"text-[10px] font-bold text-gray-400 uppercase tracking-widest bg-gray-100 px-2 py-1 rounded-md\">Analysis</span>\r\n                        </div>\r\n                        <p className=\"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2\">เธเธงเธฒเธกเธซเธเธฒเนเธเนเธ (Plant Density)</p>\r\n                        <div className=\"flex items-baseline gap-2\">\r\n                            <p className=\"text-3xl font-black text-gray-900\">\r\n                                {(estimatedPlants / (totalAreaSqm || 1)).toFixed(2)}\r\n                            </p>\r\n                            <span className=\"text-sm text-gray-400 font-bold\">เธ•เนเธ / เธ•เธฃ.เธก.</span>\r\n                        </div>\r\n                        <div className=\"mt-4 h-1.5 w-full bg-gray-100 rounded-full overflow-hidden\">\r\n                            <div\r\n                                className={`h-full transition-all duration-1000 ${estimatedPlants > recommendedMax ? 'bg-amber-400' : 'bg-primary'}`}\r\n                                style={{ width: `${Math.min(100, (estimatedPlants / (recommendedMax || 1)) * 100)}%` }}\r\n                            ></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-6\">\r\n                        <div>\r\n                            <FormLabelWithHint label={dict.wizard.preview?.labels?.startPlanting || \"เธงเธฑเธเธ—เธตเนเน€เธฃเธดเนเธกเธเธฅเธนเธ / เธเธฒเธ”เธงเนเธฒเธเธฐเธเธฅเธนเธ\"} />\r\n                            <input\r\n                                type=\"date\"\r\n                                className=\"gacp-input font-bold text-primary-900\"\r\n                                value={plantingDate}\r\n                                onChange={e => setPlantingDate(e.target.value)}\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <FormLabelWithHint label=\"เธซเธกเธฒเธขเน€เธซเธ•เธธเธเธฒเธฃเธเธฅเธดเธ•\" hint=\"เน€เธเนเธ เนเธเธเธเธฒเธฃเน€เธเนเธเน€เธเธตเนเธขเธง เธซเธฃเธทเธญเธเนเธญเธกเธนเธฅเน€เธเธดเนเธกเน€เธ•เธดเธก...\" />\r\n                            <textarea\r\n                                className=\"gacp-input min-h-[100px] resize-none text-sm\"\r\n                                placeholder=\"เธฃเธฐเธเธธเธเนเธญเธกเธนเธฅเน€เธเธดเนเธกเน€เธ•เธดเธก...\"\r\n                                value={notes}\r\n                                onChange={e => setNotes(e.target.value)}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <WizardNavigation\r\n                onNext={() => router.push('/farmer/applications/new/step/8')}\r\n                onBack={() => router.push('/farmer/applications/new/step/6')}\r\n                isNextDisabled={!canProceed}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StepProductionEstimate;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepQuote.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DocIcon' is defined but never used.","line":10,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'InfoIcon' is defined but never used.","line":10,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'language' is assigned a value but never used.","line":24,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":27},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepQuote.tsx:32:96\n  30 |\n  31 |     const quoteDate = new Date().toISOString();\n> 32 |     const [dtamQuoteNumber] = useState(`DTAM-QT-${new Date().getFullYear()}${String(Math.floor(Math.random() * 10000)).padStart(4, '0')}`);\n     |                                                                                                ^^^^^^^^^^^^^ Cannot call impure function\n  33 |     const [platformQuoteNumber] = useState(`PLT-QT-${new Date().getFullYear()}${String(Math.floor(Math.random() * 10000)).padStart(4, '0')}`);\n  34 |\n  35 |     const dtamFee = GACP_FEES.milestone1;","line":32,"column":96,"nodeType":null,"endLine":32,"endColumn":109},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepQuote.tsx:33:99\n  31 |     const quoteDate = new Date().toISOString();\n  32 |     const [dtamQuoteNumber] = useState(`DTAM-QT-${new Date().getFullYear()}${String(Math.floor(Math.random() * 10000)).padStart(4, '0')}`);\n> 33 |     const [platformQuoteNumber] = useState(`PLT-QT-${new Date().getFullYear()}${String(Math.floor(Math.random() * 10000)).padStart(4, '0')}`);\n     |                                                                                                   ^^^^^^^^^^^^^ Cannot call impure function\n  34 |\n  35 |     const dtamFee = GACP_FEES.milestone1;\n  36 |     const platformFee = Math.round(dtamFee * PLATFORM_FEE_PERCENT);","line":33,"column":99,"nodeType":null,"endLine":33,"endColumn":112}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useWizardStore } from '../hooks/useWizardStore';\r\nimport { useRouter } from 'next/navigation';\r\nimport { MockQuotePDF } from './MockQuotePDF';\r\nimport { PlatformQuotePDF } from './PlatformQuotePDF';\r\nimport Image from 'next/image';\r\nimport { WizardNavigation } from '@/components/wizard/WizardNavigation';\r\nimport { CheckIcon, DocIcon, InfoIcon } from '@/components/icons/WizardIcons';\r\nimport { Icons } from '@/components/ui/icons';\r\nimport { useLanguage } from '@/lib/i18n/LanguageContext';\r\n\r\nconst GACP_FEES = {\r\n    milestone1: 5000,\r\n    milestone2: 25000,\r\n};\r\n\r\nconst PLATFORM_FEE_PERCENT = 0.10;\r\n\r\nexport const StepQuote = () => {\r\n    const { state, updateState } = useWizardStore();\r\n    const router = useRouter();\r\n    const { dict, language } = useLanguage();\r\n\r\n    const [dtamQuoteAccepted, setDtamQuoteAccepted] = useState(false);\r\n    const [platformQuoteAccepted, setPlatformQuoteAccepted] = useState(false);\r\n    const [showDtamQuote, setShowDtamQuote] = useState(false);\r\n    const [showPlatformQuote, setShowPlatformQuote] = useState(false);\r\n\r\n    const quoteDate = new Date().toISOString();\r\n    const [dtamQuoteNumber] = useState(`DTAM-QT-${new Date().getFullYear()}${String(Math.floor(Math.random() * 10000)).padStart(4, '0')}`);\r\n    const [platformQuoteNumber] = useState(`PLT-QT-${new Date().getFullYear()}${String(Math.floor(Math.random() * 10000)).padStart(4, '0')}`);\r\n\r\n    const dtamFee = GACP_FEES.milestone1;\r\n    const platformFee = Math.round(dtamFee * PLATFORM_FEE_PERCENT);\r\n    const totalMilestone1 = dtamFee + platformFee;\r\n\r\n    const allAccepted = dtamQuoteAccepted && platformQuoteAccepted;\r\n\r\n    const handleProceedToInvoice = () => {\r\n        if (allAccepted) {\r\n            updateState({\r\n                milestone1: {\r\n                    dtamQuote: { number: dtamQuoteNumber, amount: dtamFee, accepted: true },\r\n                    platformQuote: { number: platformQuoteNumber, amount: platformFee, accepted: true }\r\n                }\r\n            });\r\n            router.push('/farmer/applications/new/step/14');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in pb-12 max-w-5xl mx-auto\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center gap-4 mb-4\">\r\n                <div className=\"w-12 h-12 bg-primary gradient-mask rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-primary-50\">\r\n                    13\r\n                </div>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-primary-900\">{dict.wizard.quote.title}</h2>\r\n                    <p className=\"text-text-secondary\">{dict.wizard.quote.subtitle}</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Instruction Banner */}\r\n            <div className=\"bg-gradient-to-br from-indigo-50 to-white border border-indigo-100 rounded-[2.5rem] p-10 shadow-soft relative overflow-hidden group animate-slide-up\">\r\n                <div className=\"absolute top-0 right-0 w-96 h-96 bg-primary/5 rounded-full blur-3xl -mr-32 -mt-32 pointer-events-none group-hover:bg-primary/10 transition-all duration-1000\"></div>\r\n\r\n                <div className=\"relative z-10 flex flex-col md:flex-row items-center md:items-start gap-8\">\r\n                    <div className=\"w-20 h-20 rounded-[2rem] bg-white text-primary flex items-center justify-center shadow-premium-hover shrink-0 scale-110 md:scale-100\">\r\n                        <Icons.Calculator className=\"w-10 h-10\" />\r\n                    </div>\r\n                    <div className=\"text-center md:text-left\">\r\n                        <h3 className=\"font-black text-primary-900 text-2xl mb-3 tracking-tight\">{dict.wizard.quote.milestone1Title}</h3>\r\n                        <p className=\"text-gray-500 text-sm leading-relaxed max-w-2xl\">\r\n                            {dict.wizard.quote.milestone1Desc}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Quote Cards */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 animate-slide-up\" style={{ animationDelay: '100ms' }}>\r\n\r\n                {/* DTAM Quote */}\r\n                <div className={`\r\n                    relative gacp-card p-8 transition-all duration-500 border-2 overflow-hidden group\r\n                    ${dtamQuoteAccepted\r\n                        ? 'border-emerald-500 bg-emerald-50/10 shadow-emerald-100'\r\n                        : 'border-white bg-white hover:border-primary/20 hover:shadow-premium'\r\n                    }\r\n                `}>\r\n                    {dtamQuoteAccepted && (\r\n                        <div className=\"absolute -right-6 -top-6 w-24 h-24 bg-emerald-500/10 rounded-full blur-2xl animate-pulse\"></div>\r\n                    )}\r\n\r\n                    <div className=\"flex items-center justify-between mb-8\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <div className=\"w-14 h-14 bg-white rounded-2xl border border-gray-100 flex items-center justify-center p-2 shadow-sm overflow-hidden relative\">\r\n                                <Image src=\"/dtam_logo_new.png\" alt=\"DTAM\" fill className=\"object-contain p-2\" />\r\n                            </div>\r\n                            <div>\r\n                                <h4 className=\"font-black text-gray-900 text-lg leading-none\">{dict.wizard.quote.dtam.title}</h4>\r\n                                <p className=\"text-[10px] font-bold text-gray-400 uppercase tracking-widest mt-1\">Certification Body</p>\r\n                            </div>\r\n                        </div>\r\n                        {dtamQuoteAccepted && (\r\n                            <div className=\"w-8 h-8 rounded-xl bg-emerald-500 text-white flex items-center justify-center shadow-lg animate-scale-in\">\r\n                                <CheckIcon className=\"w-5 h-5\" />\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"bg-gray-50/50 rounded-2xl p-6 border border-gray-100/50 mb-8 space-y-4\">\r\n                        <div className=\"flex justify-between items-center text-xs\">\r\n                            <span className=\"text-gray-400 font-bold uppercase tracking-widest\">Fee Description</span>\r\n                            <span className=\"text-gray-400 font-bold uppercase tracking-widest\">Amount</span>\r\n                        </div>\r\n                        <div className=\"flex justify-between items-center\">\r\n                            <p className=\"text-sm font-bold text-gray-700\">{dict.wizard.quote.dtam.feeLabel}</p>\r\n                            <p className=\"text-xl font-black text-gray-900\">เธฟ{dtamFee.toLocaleString()}</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex flex-col gap-3\">\r\n                        <div className=\"flex justify-between items-baseline mb-2 px-1\">\r\n                            <span className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">Quote Total</span>\r\n                            <span className={`text-4xl font-black transition-colors ${dtamQuoteAccepted ? 'text-emerald-600' : 'text-gray-900'}`}>\r\n                                เธฟ{dtamFee.toLocaleString()}\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"grid grid-cols-2 gap-3\">\r\n                            <button\r\n                                onClick={() => setShowDtamQuote(true)}\r\n                                className=\"px-4 py-3 rounded-2xl bg-white border border-gray-200 text-gray-500 font-bold text-xs hover:bg-gray-50 transition-all flex items-center justify-center gap-2\"\r\n                            >\r\n                                <Icons.Eye className=\"w-4 h-4\" />\r\n                                {dict.wizard.quote.buttons.viewDetails}\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setDtamQuoteAccepted(!dtamQuoteAccepted)}\r\n                                className={`\r\n                                    px-4 py-3 rounded-2xl font-black text-xs transition-all flex items-center justify-center gap-2 shadow-sm\r\n                                    ${dtamQuoteAccepted\r\n                                        ? 'bg-emerald-500 text-white hover:bg-emerald-600'\r\n                                        : 'bg-primary text-white hover:shadow-premium'\r\n                                    }\r\n                                `}\r\n                            >\r\n                                {dtamQuoteAccepted ? <CheckIcon className=\"w-4 h-4\" /> : <Icons.CheckCircle className=\"w-4 h-4\" />}\r\n                                {dtamQuoteAccepted ? dict.wizard.quote.buttons.accepted : dict.wizard.quote.buttons.accept}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Platform Quote */}\r\n                <div className={`\r\n                    relative gacp-card p-8 transition-all duration-500 border-2 overflow-hidden group\r\n                    ${platformQuoteAccepted\r\n                        ? 'border-blue-500 bg-blue-50/10 shadow-blue-100'\r\n                        : 'border-white bg-white hover:border-primary/20 hover:shadow-premium'\r\n                    }\r\n                `}>\r\n                    {platformQuoteAccepted && (\r\n                        <div className=\"absolute -right-6 -top-6 w-24 h-24 bg-blue-500/10 rounded-full blur-2xl animate-pulse\"></div>\r\n                    )}\r\n\r\n                    <div className=\"flex items-center justify-between mb-8\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <div className=\"w-14 h-14 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center text-white font-black text-xl shadow-lg shadow-blue-200\">\r\n                                GP\r\n                            </div>\r\n                            <div>\r\n                                <h4 className=\"font-black text-gray-900 text-lg leading-none\">{dict.wizard.quote.platform.title}</h4>\r\n                                <p className=\"text-[10px] font-bold text-gray-400 uppercase tracking-widest mt-1\">Software Platform</p>\r\n                            </div>\r\n                        </div>\r\n                        {platformQuoteAccepted && (\r\n                            <div className=\"w-8 h-8 rounded-xl bg-blue-500 text-white flex items-center justify-center shadow-lg animate-scale-in\">\r\n                                <CheckIcon className=\"w-5 h-5\" />\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"bg-gray-50/50 rounded-2xl p-6 border border-gray-100/50 mb-8 space-y-4\">\r\n                        <div className=\"flex justify-between items-center text-xs\">\r\n                            <span className=\"text-gray-400 font-bold uppercase tracking-widest\">Fee Description</span>\r\n                            <span className=\"text-gray-400 font-bold uppercase tracking-widest\">Amount</span>\r\n                        </div>\r\n                        <div className=\"flex justify-between items-center\">\r\n                            <p className=\"text-sm font-bold text-gray-700\">{dict.wizard.quote.platform.feeLabel}</p>\r\n                            <p className=\"text-xl font-black text-gray-900\">เธฟ{platformFee.toLocaleString()}</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex flex-col gap-3\">\r\n                        <div className=\"flex justify-between items-baseline mb-2 px-1\">\r\n                            <span className=\"text-[10px] font-black text-gray-400 uppercase tracking-widest\">Quote Total</span>\r\n                            <span className={`text-4xl font-black transition-colors ${platformQuoteAccepted ? 'text-blue-600' : 'text-gray-900'}`}>\r\n                                เธฟ{platformFee.toLocaleString()}\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"grid grid-cols-2 gap-3\">\r\n                            <button\r\n                                onClick={() => setShowPlatformQuote(true)}\r\n                                className=\"px-4 py-3 rounded-2xl bg-white border border-gray-200 text-gray-500 font-bold text-xs hover:bg-gray-50 transition-all flex items-center justify-center gap-2\"\r\n                            >\r\n                                <Icons.Eye className=\"w-4 h-4\" />\r\n                                {dict.wizard.quote.buttons.viewDetails}\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setPlatformQuoteAccepted(!platformQuoteAccepted)}\r\n                                className={`\r\n                                    px-4 py-3 rounded-2xl font-black text-xs transition-all flex items-center justify-center gap-2 shadow-sm\r\n                                    ${platformQuoteAccepted\r\n                                        ? 'bg-blue-500 text-white hover:bg-blue-600'\r\n                                        : 'bg-primary text-white hover:shadow-premium'\r\n                                    }\r\n                                `}\r\n                            >\r\n                                {platformQuoteAccepted ? <CheckIcon className=\"w-4 h-4\" /> : <Icons.CheckCircle className=\"w-4 h-4\" />}\r\n                                {platformQuoteAccepted ? dict.wizard.quote.buttons.accepted : dict.wizard.quote.buttons.accept}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Net Total Summary */}\r\n            <div className={`\r\n                transition-all duration-700 transform px-2\r\n                ${allAccepted ? 'translate-y-0 opacity-100' : 'translate-y-12 opacity-40 grayscale'}\r\n            `}>\r\n                <div className=\"bg-gray-900 rounded-[3rem] p-10 text-white shadow-2xl relative overflow-hidden group border border-white/5\">\r\n                    <div className=\"absolute top-0 right-0 w-96 h-96 bg-primary/20 rounded-full blur-[100px] -mr-40 -mt-40 pointer-events-none\"></div>\r\n\r\n                    <div className=\"relative z-10 flex flex-col md:flex-row justify-between items-center gap-10\">\r\n                        <div className=\"space-y-6 text-center md:text-left\">\r\n                            <div>\r\n                                <h4 className=\"text-2xl font-black tracking-tight mb-2\">{dict.wizard.quote.summary.netTotal}</h4>\r\n                                <p className=\"text-white/40 text-xs font-medium uppercase tracking-widest\">Milestone 1: Application & Document Audit</p>\r\n                            </div>\r\n                            <div className=\"flex flex-wrap justify-center md:justify-start items-center gap-4\">\r\n                                <div className={`flex items-center gap-3 px-4 py-2 rounded-2xl border transition-all ${dtamQuoteAccepted ? 'bg-emerald-500/10 border-emerald-500/30 text-emerald-400' : 'bg-white/5 border-white/10 text-white/30'}`}>\r\n                                    <Icons.CheckCircle className=\"w-4 h-4\" />\r\n                                    <span className=\"text-xs font-black uppercase tracking-widest\">DTAM Accepted</span>\r\n                                </div>\r\n                                <div className={`flex items-center gap-3 px-4 py-2 rounded-2xl border transition-all ${platformQuoteAccepted ? 'bg-blue-500/10 border-blue-500/30 text-blue-400' : 'bg-white/5 border-white/10 text-white/30'}`}>\r\n                                    <Icons.CheckCircle className=\"w-4 h-4\" />\r\n                                    <span className=\"text-xs font-black uppercase tracking-widest\">Platform Accepted</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex flex-col items-center md:items-end gap-2 bg-white/5 p-8 rounded-[2rem] border border-white/10 min-w-[280px]\">\r\n                            <p className=\"text-[10px] font-black text-white/40 uppercase tracking-[0.2em]\">{dict.wizard.quote.summary.totalLabel}</p>\r\n                            <p className=\"text-6xl font-black tracking-tighter shadow-primary drop-shadow-2xl\">เธฟ{totalMilestone1.toLocaleString()}</p>\r\n                            <p className=\"text-[10px] text-white/30 font-medium\">* เธฃเธงเธกเธ เธฒเธฉเธตเธกเธนเธฅเธเนเธฒเน€เธเธดเนเธกเนเธฅเนเธง</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <WizardNavigation\r\n                onNext={handleProceedToInvoice}\r\n                onBack={() => router.push('/farmer/applications/new/step/12')}\r\n                isNextDisabled={!allAccepted}\r\n                nextLabel=\"เนเธเธ—เธตเนเธเธฑเนเธเธ•เธญเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ\"\r\n            />\r\n\r\n            {showDtamQuote && <MockQuotePDF onClose={() => setShowDtamQuote(false)} />}\r\n            {showPlatformQuote && (\r\n                <PlatformQuotePDF\r\n                    quoteNumber={platformQuoteNumber}\r\n                    date={quoteDate}\r\n                    customer={{\r\n                        name: state.applicantData?.firstName\r\n                            ? `${state.applicantData.firstName} ${state.applicantData.lastName || ''}`\r\n                            : 'เธเธนเนเธขเธทเนเธเธเธณเธเธญ GACP',\r\n                        address: state.applicantData?.address,\r\n                        phone: state.applicantData?.phone,\r\n                    }}\r\n                    items={[{ description: 'เธเนเธฒเธเธฃเธดเธเธฒเธฃเธ”เธณเน€เธเธดเธเธเธฒเธฃ GACP (เธเธงเธ”เธ—เธตเน 1)', descriptionEN: 'Platform Service Fee - Milestone 1', amount: platformFee }]}\r\n                    total={platformFee}\r\n                    status=\"PENDING\"\r\n                    validDays={30}\r\n                    onClose={() => setShowPlatformQuote(false)}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StepQuote;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepSubmit.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningIcon' is defined but never used.","line":8,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":42},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":209,"column":50,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[11808,11817],"text":"&quot;Preview\""},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[11808,11817],"text":"&ldquo;Preview\""},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[11808,11817],"text":"&#34;Preview\""},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[11808,11817],"text":"&rdquo;Preview\""},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":209,"column":58,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[11808,11817],"text":"\"Preview&quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[11808,11817],"text":"\"Preview&ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[11808,11817],"text":"\"Preview&#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[11808,11817],"text":"\"Preview&rdquo;"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useWizardStore } from '../hooks/useWizardStore';\r\nimport { useRouter } from 'next/navigation';\r\nimport { apiClient } from '@/lib/api/api-client';\r\nimport { WizardNavigation } from '@/components/wizard/WizardNavigation';\r\nimport { CheckIcon, InfoIcon, WarningIcon } from '@/components/icons/WizardIcons';\r\nimport { Icons } from '@/components/ui/icons';\r\n\r\nexport const StepSubmit = () => {\r\n    const { state, setApplicationId } = useWizardStore();\r\n    const router = useRouter();\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [confirmChecks, setConfirmChecks] = useState({\r\n        dataCorrect: false,\r\n        termsAccepted: false,\r\n        paymentUnderstood: false,\r\n    });\r\n\r\n    const allChecked = confirmChecks.dataCorrect && confirmChecks.termsAccepted && confirmChecks.paymentUnderstood;\r\n\r\n    const handleSubmit = async () => {\r\n        if (!allChecked) return;\r\n\r\n        setIsSubmitting(true);\r\n        try {\r\n            const applicationData = {\r\n                applicantData: state.applicantData,\r\n                farmData: state.farmData,\r\n                siteData: state.siteData,\r\n                lots: state.lots,\r\n                documents: state.documents,\r\n                plantId: state.plantId,\r\n                certificationPurpose: state.certificationPurpose,\r\n                locationType: state.locationType,\r\n                fees: state.milestone1,\r\n            };\r\n\r\n            const response = await apiClient.post<{ _id: string; applicationNo: string }>('/applications/submit', applicationData);\r\n\r\n            if (response.success && response.data) {\r\n                setApplicationId(response.data.applicationNo || response.data._id);\r\n                router.push('/farmer/applications/new/step/13');\r\n            } else {\r\n                throw new Error('Submission failed');\r\n            }\r\n        } catch (error) {\r\n            console.error('Submit error:', error);\r\n            // In a real app, show a toast. For now, alert is okay but let's make it better if possible.\r\n            alert('เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเธชเนเธเธเธณเธเธญ เธเธฃเธธเธ“เธฒเธฅเธญเธเนเธซเธกเนเธญเธตเธเธเธฃเธฑเนเธ');\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    const toggleCheck = (key: keyof typeof confirmChecks) => {\r\n        setConfirmChecks(prev => ({ ...prev, [key]: !prev[key] }));\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8 animate-fade-in pb-12 max-w-5xl mx-auto\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center gap-4 mb-4\">\r\n                <div className=\"w-12 h-12 bg-primary gradient-mask rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-primary-50\">\r\n                    12\r\n                </div>\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-primary-900\">เธขเธทเธเธขเธฑเธเธเธฒเธฃเธชเนเธเธเธณเธเธญเธฃเธฑเธเธฃเธญเธ GACP</h2>\r\n                    <p className=\"text-text-secondary\">เธเธฃเธธเธ“เธฒเธขเธญเธกเธฃเธฑเธเธเนเธญเธเธณเธซเธเธ”เนเธฅเธฐเน€เธเธทเนเธญเธเนเธเธ—เธฒเธเธเธเธซเธกเธฒเธขเธเนเธญเธเธชเนเธเธเนเธญเธกเธนเธฅเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Final Confirmation Hero */}\r\n            <div className=\"gacp-card bg-gradient-to-br from-primary shadow-soft relative overflow-hidden border-none text-white p-10 animate-slide-up\">\r\n                <div className=\"absolute top-0 right-0 w-96 h-96 bg-white/10 rounded-full blur-3xl -mr-32 -mt-32 pointer-events-none\"></div>\r\n                <div className=\"absolute bottom-0 left-0 w-64 h-64 bg-black/10 rounded-full blur-3xl -ml-20 -mb-20 pointer-events-none\"></div>\r\n\r\n                <div className=\"relative z-10 space-y-8\">\r\n                    <div className=\"flex items-start gap-6\">\r\n                        <div className=\"w-16 h-16 rounded-2xl bg-white/20 backdrop-blur-md flex items-center justify-center border border-white/30 shadow-xl\">\r\n                            <Icons.ShieldCheck className=\"w-10 h-10 text-white\" />\r\n                        </div>\r\n                        <div className=\"space-y-2 max-w-2xl\">\r\n                            <h3 className=\"text-2xl font-black tracking-tight\">เธชเธฃเธธเธเธเนเธญเธกเธนเธฅเธเธณเธเธญ</h3>\r\n                            <p className=\"text-white/70 text-sm leading-relaxed\">\r\n                                เธ—เนเธฒเธเธเธณเธฅเธฑเธเธเธฐเธชเนเธเธเธณเธเธญเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP เธชเธณเธซเธฃเธฑเธ <strong>{state.plantId?.toUpperCase() || '-'}</strong>\r\n                                เน€เธเธทเนเธญเธงเธฑเธ•เธ–เธธเธเธฃเธฐเธชเธเธเน <strong>{state.certificationPurpose || '-'}</strong> เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเธเธงเธฒเธกเธ–เธนเธเธ•เนเธญเธเธเธญเธเธเนเธญเธกเธนเธฅเธเธนเนเธขเธทเนเธเธเธณเธเธญเนเธฅเธฐเน€เธเธทเนเธญเธเนเธเธ”เนเธฒเธเธฅเนเธฒเธ\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 pt-4\">\r\n                        <div className=\"space-y-1\">\r\n                            <p className=\"text-[10px] text-white/50 font-black uppercase tracking-widest leading-none\">เธเธนเนเธขเธทเนเธเธเธณเธเธญ / เธญเธเธเนเธเธฃ</p>\r\n                            <p className=\"text-2xl font-black font-noto\">\r\n                                {state.applicantData?.applicantType === 'INDIVIDUAL'\r\n                                    ? `${state.applicantData?.firstName} ${state.applicantData?.lastName}`\r\n                                    : state.applicantData?.applicantType === 'COMMUNITY'\r\n                                        ? state.applicantData?.communityName\r\n                                        : state.applicantData?.companyName || '-'\r\n                                }\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"space-y-1\">\r\n                            <p className=\"text-[10px] text-white/50 font-black uppercase tracking-widest leading-none\">เธชเธ–เธฒเธเธ—เธตเนเธเธฅเธดเธ• (เธเธฒเธฃเนเธก)</p>\r\n                            <p className=\"text-2xl font-black font-noto\">{state.farmData?.farmName || '-'}</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Legal Checks */}\r\n            <div className=\"space-y-4 animate-slide-up\" style={{ animationDelay: '100ms' }}>\r\n                <div\r\n                    onClick={() => toggleCheck('dataCorrect')}\r\n                    className={`\r\n                        group flex items-start gap-5 p-6 rounded-3xl cursor-pointer transition-all duration-300 border-2\r\n                        ${confirmChecks.dataCorrect\r\n                            ? 'bg-primary/5 border-primary/20 shadow-sm'\r\n                            : 'bg-white border-gray-100 hover:border-primary/30 hover:bg-gray-50/50'\r\n                        }\r\n                    `}\r\n                >\r\n                    <div className={`\r\n                        w-8 h-8 rounded-xl border-2 flex items-center justify-center transition-all duration-500 flex-shrink-0 mt-0.5\r\n                        ${confirmChecks.dataCorrect\r\n                            ? 'bg-primary border-primary'\r\n                            : 'bg-white border-gray-300 group-hover:border-primary'\r\n                        }\r\n                    `}>\r\n                        {confirmChecks.dataCorrect && <CheckIcon className=\"w-5 h-5 text-white animate-scale-in\" />}\r\n                    </div>\r\n                    <div>\r\n                        <h4 className=\"font-black text-gray-800 text-lg mb-1 leading-tight\">เธเนเธฒเธเน€เธเนเธฒเธขเธทเธเธขเธฑเธเธเธงเธฒเธกเธ–เธนเธเธ•เนเธญเธเธเธญเธเธเนเธญเธกเธนเธฅ</h4>\r\n                        <p className=\"text-sm text-gray-500 leading-relaxed\">\r\n                            เธเนเธญเธกเธนเธฅเนเธฅเธฐเน€เธญเธเธชเธฒเธฃเธเธฃเธฐเธเธญเธเธเธณเธเธญเธ—เธฑเนเธเธซเธกเธ”เธ—เธตเนเธฃเธฐเธเธธเนเธเธเธณเธเธญเธเธตเนเน€เธเนเธเธเธงเธฒเธกเธเธฃเธดเธเนเธฅเธฐเน€เธเนเธเธเธฑเธเธเธธเธเธฑเธเธ—เธธเธเธเธฃเธฐเธเธฒเธฃ\r\n                            เธซเธฒเธเธกเธตเธเธฒเธฃเธ•เธฃเธงเธเธเธเธงเนเธฒเธเนเธญเธกเธนเธฅเน€เธเนเธเน€เธ—เนเธ เธเนเธฒเธเน€เธเนเธฒเธขเธดเธเธขเธญเธกเนเธซเนเธขเธเน€เธฅเธดเธเธเธณเธเธญเธ—เธฑเธเธ—เธต\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div\r\n                    onClick={() => toggleCheck('termsAccepted')}\r\n                    className={`\r\n                        group flex items-start gap-5 p-6 rounded-3xl cursor-pointer transition-all duration-300 border-2\r\n                        ${confirmChecks.termsAccepted\r\n                            ? 'bg-primary/5 border-primary/20 shadow-sm'\r\n                            : 'bg-white border-gray-100 hover:border-primary/30 hover:bg-gray-50/50'\r\n                        }\r\n                    `}\r\n                >\r\n                    <div className={`\r\n                        w-8 h-8 rounded-xl border-2 flex items-center justify-center transition-all duration-500 flex-shrink-0 mt-0.5\r\n                        ${confirmChecks.termsAccepted\r\n                            ? 'bg-primary border-primary'\r\n                            : 'bg-white border-gray-300 group-hover:border-primary'\r\n                        }\r\n                    `}>\r\n                        {confirmChecks.termsAccepted && <CheckIcon className=\"w-5 h-5 text-white animate-scale-in\" />}\r\n                    </div>\r\n                    <div>\r\n                        <h4 className=\"font-black text-gray-800 text-lg mb-1 leading-tight\">เธเนเธฒเธเน€เธเนเธฒเนเธ”เนเธญเนเธฒเธเนเธฅเธฐเธขเธญเธกเธฃเธฑเธเธเนเธญเธเธณเธซเธเธ” (GACP Standards)</h4>\r\n                        <p className=\"text-sm text-gray-500 leading-relaxed\">\r\n                            เธเนเธฒเธเน€เธเนเธฒเน€เธเนเธฒเนเธเธกเธฒเธ•เธฃเธเธฒเธเธเธฒเธฃเธเธเธดเธเธฑเธ•เธดเธ—เธฒเธเธเธฒเธฃเน€เธเธฉเธ•เธฃเธ—เธตเนเธ”เธตเธชเธณเธซเธฃเธฑเธเธเธทเธเธชเธกเธธเธเนเธเธฃ (GACP)\r\n                            เนเธฅเธฐเธ•เธเธฅเธเธ—เธตเนเธเธฐเธเธเธดเธเธฑเธ•เธดเธ•เธฒเธกเธกเธฒเธ•เธฃเธเธฒเธเธญเธขเนเธฒเธเน€เธเธฃเนเธเธเธฃเธฑเธ”เธ•เธฅเธญเธ”เธฃเธฐเธขเธฐเน€เธงเธฅเธฒเธเธฒเธฃเธฃเธฑเธเธฃเธญเธ\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div\r\n                    onClick={() => toggleCheck('paymentUnderstood')}\r\n                    className={`\r\n                        group flex items-start gap-5 p-6 rounded-3xl cursor-pointer transition-all duration-300 border-2\r\n                        ${confirmChecks.paymentUnderstood\r\n                            ? 'bg-primary/5 border-primary/20 shadow-sm'\r\n                            : 'bg-white border-gray-100 hover:border-primary/30 hover:bg-gray-50/50'\r\n                        }\r\n                    `}\r\n                >\r\n                    <div className={`\r\n                        w-8 h-8 rounded-xl border-2 flex items-center justify-center transition-all duration-500 flex-shrink-0 mt-0.5\r\n                        ${confirmChecks.paymentUnderstood\r\n                            ? 'bg-primary border-primary'\r\n                            : 'bg-white border-gray-300 group-hover:border-primary'\r\n                        }\r\n                    `}>\r\n                        {confirmChecks.paymentUnderstood && <CheckIcon className=\"w-5 h-5 text-white animate-scale-in\" />}\r\n                    </div>\r\n                    <div>\r\n                        <h4 className=\"font-black text-gray-800 text-lg mb-1 leading-tight\">เธฃเธฑเธเธ—เธฃเธฒเธเน€เธฃเธทเนเธญเธเธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธก</h4>\r\n                        <p className=\"text-sm text-gray-500 leading-relaxed\">\r\n                            เธเนเธฒเธเน€เธเนเธฒเน€เธเนเธฒเนเธเธงเนเธฒเธเธฐเธ•เนเธญเธเธเธณเธฃเธฐเธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธกเธเธฒเธฃเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธเธซเธฅเธฑเธเธเธฒเธเนเธ”เนเธฃเธฑเธเนเธเนเธเนเธเธซเธเธตเน (Invoice)\r\n                            เนเธฅเธฐเธเธฒเธฃเนเธกเนเธเธณเธฃเธฐเธญเธฒเธเธชเนเธเธเธฅเนเธซเนเธเธฒเธฃเธเธดเธเธฒเธฃเธ“เธฒเธเธณเธเธญเธซเธขเธธเธ”เธเธฐเธเธฑเธ\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Submission Warning */}\r\n            <div className=\"p-6 bg-blue-50/50 border border-blue-100 rounded-[2rem] flex gap-4 animate-slide-up\" style={{ animationDelay: '200ms' }}>\r\n                <div className=\"p-3 bg-white rounded-2xl shadow-sm h-fit\">\r\n                    <InfoIcon className=\"w-6 h-6 text-blue-600\" />\r\n                </div>\r\n                <div className=\"space-y-1\">\r\n                    <p className=\"font-black text-blue-900 text-sm italic\">เธเธณเนเธเธฐเธเธณเธชเธณเธซเธฃเธฑเธเธเธฒเธฃเธชเนเธเธเธณเธเธญ</p>\r\n                    <p className=\"text-xs leading-relaxed text-blue-800/80\">\r\n                        เน€เธกเธทเนเธญเธ—เนเธฒเธเธเธ”เธขเธทเธเธขเธฑเธ เธเนเธญเธกเธนเธฅเธเธฐเธ–เธนเธเธเธฑเธเธ—เธถเธเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ เนเธฅเธฐเธ—เนเธฒเธเธเธฐเนเธกเนเธชเธฒเธกเธฒเธฃเธ–เธเธฅเธฑเธเธกเธฒเนเธเนเนเธเธเนเธญเธกเธนเธฅเนเธ”เนเธ”เนเธงเธขเธ•เธเน€เธญเธเธเธเธเธงเนเธฒเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธเธฐเธ—เธณเธเธฒเธฃเธ•เธฃเธงเธเธชเธญเธ\r\n                        เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเธซเธเนเธฒ <strong>\"Preview\"</strong> เธญเธตเธเธเธฃเธฑเนเธเธซเธฒเธเนเธกเนเธกเธฑเนเธเนเธ\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <WizardNavigation\r\n                onNext={handleSubmit}\r\n                onBack={() => router.push('/farmer/applications/new/step/11')}\r\n                isNextDisabled={!allChecked || isSubmitting}\r\n                nextLabel={isSubmitting ? 'เธเธณเธฅเธฑเธเธชเนเธเธเธณเธเธญเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ...' : 'เธขเธทเธเธขเธฑเธเนเธฅเธฐเธชเนเธเธเธณเธเธญ'}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StepSubmit;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\steps\\StepSuccess.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\success\\page.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\success\\page.tsx:44:122\n  42 |                 <div className=\"fixed inset-0 pointer-events-none overflow-hidden z-50\">\n  43 |                     {[...Array(40)].map((_, i) => (\n> 44 |                         <div key={i} className=\"absolute animate-[confetti_2s_ease-out_forwards]\" style={{ width: `${8 + Math.random() * 8}px`, height: `${8 + Math.random() * 8}px`, background: ['#10B981', '#F59E0B', '#3B82F6', '#EC4899', '#8B5CF6', '#EF4444'][i % 6], borderRadius: i % 3 === 0 ? '50%' : '2px', left: `${Math.random() * 100}%`, top: '-20px', animationDelay: `${Math.random() * 0.8}s` }} />\n     |                                                                                                                          ^^^^^^^^^^^^^ Cannot call impure function\n  45 |                     ))}\n  46 |                 </div>\n  47 |             )}","line":44,"column":122,"nodeType":null,"endLine":44,"endColumn":135},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\success\\page.tsx:44:160\n  42 |                 <div className=\"fixed inset-0 pointer-events-none overflow-hidden z-50\">\n  43 |                     {[...Array(40)].map((_, i) => (\n> 44 |                         <div key={i} className=\"absolute animate-[confetti_2s_ease-out_forwards]\" style={{ width: `${8 + Math.random() * 8}px`, height: `${8 + Math.random() * 8}px`, background: ['#10B981', '#F59E0B', '#3B82F6', '#EC4899', '#8B5CF6', '#EF4444'][i % 6], borderRadius: i % 3 === 0 ? '50%' : '2px', left: `${Math.random() * 100}%`, top: '-20px', animationDelay: `${Math.random() * 0.8}s` }} />\n     |                                                                                                                                                                ^^^^^^^^^^^^^ Cannot call impure function\n  45 |                     ))}\n  46 |                 </div>\n  47 |             )}","line":44,"column":160,"nodeType":null,"endLine":44,"endColumn":173},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\success\\page.tsx:44:322\n  42 |                 <div className=\"fixed inset-0 pointer-events-none overflow-hidden z-50\">\n  43 |                     {[...Array(40)].map((_, i) => (\n> 44 |                         <div key={i} className=\"absolute animate-[confetti_2s_ease-out_forwards]\" style={{ width: `${8 + Math.random() * 8}px`, height: `${8 + Math.random() * 8}px`, background: ['#10B981', '#F59E0B', '#3B82F6', '#EC4899', '#8B5CF6', '#EF4444'][i % 6], borderRadius: i % 3 === 0 ? '50%' : '2px', left: `${Math.random() * 100}%`, top: '-20px', animationDelay: `${Math.random() * 0.8}s` }} />\n     |                                                                                                                                                                                                                                                                                                                                  ^^^^^^^^^^^^^ Cannot call impure function\n  45 |                     ))}\n  46 |                 </div>\n  47 |             )}","line":44,"column":322,"nodeType":null,"endLine":44,"endColumn":335},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\new\\success\\page.tsx:44:379\n  42 |                 <div className=\"fixed inset-0 pointer-events-none overflow-hidden z-50\">\n  43 |                     {[...Array(40)].map((_, i) => (\n> 44 |                         <div key={i} className=\"absolute animate-[confetti_2s_ease-out_forwards]\" style={{ width: `${8 + Math.random() * 8}px`, height: `${8 + Math.random() * 8}px`, background: ['#10B981', '#F59E0B', '#3B82F6', '#EC4899', '#8B5CF6', '#EF4444'][i % 6], borderRadius: i % 3 === 0 ? '50%' : '2px', left: `${Math.random() * 100}%`, top: '-20px', animationDelay: `${Math.random() * 0.8}s` }} />\n     |                                                                                                                                                                                                                                                                                                                                                                                           ^^^^^^^^^^^^^ Cannot call impure function\n  45 |                     ))}\n  46 |                 </div>\n  47 |             )}","line":44,"column":379,"nodeType":null,"endLine":44,"endColumn":392},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":103,"column":29,"nodeType":"JSXOpeningElement","endLine":103,"endColumn":173}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport Link from 'next/link';\r\nimport { PLANTS } from '../hooks/useWizardStore';\r\n\r\nconst SITE_TYPE_LABELS: Record<string, string> = { OUTDOOR: 'เธเธฅเธฒเธเนเธเนเธ', INDOOR: 'เนเธฃเธเน€เธฃเธทเธญเธเธฃเธฐเธเธเธเธดเธ”', GREENHOUSE: 'เนเธฃเธเน€เธฃเธทเธญเธเธ—เธฑเนเธงเนเธ' };\r\nconst FEE_PER_SITE_TYPE = 5000;\r\n\r\ninterface PaymentData { applicantName: string; siteTypesCount: number; installment1Fee: number; invoiceId: string; paymentDate: string; plantId: string; siteTypes: string[]; }\r\n\r\nexport default function SuccessPage() {\r\n    const [isDark, setIsDark] = useState(false);\r\n    const [appId, setAppId] = useState('');\r\n    const [showConfetti, setShowConfetti] = useState(true);\r\n    const [showReceipt, setShowReceipt] = useState(false);\r\n    const [paymentData, setPaymentData] = useState<PaymentData | null>(null);\r\n    const [countdown, setCountdown] = useState(60);\r\n\r\n    useEffect(() => {\r\n        setIsDark(localStorage.getItem(\"theme\") === \"dark\");\r\n        setAppId(localStorage.getItem('last_application_id') || `GACP-${Date.now().toString(36).toUpperCase()}`);\r\n        const savedData = localStorage.getItem('last_payment_data');\r\n        if (savedData) setPaymentData(JSON.parse(savedData));\r\n        setTimeout(() => setShowConfetti(false), 3000);\r\n    }, []);\r\n\r\n    useEffect(() => { if (countdown > 0) { const t = setTimeout(() => setCountdown(countdown - 1), 1000); return () => clearTimeout(t); } }, [countdown]);\r\n\r\n    const plant = paymentData?.plantId ? PLANTS.find(p => p.id === paymentData.plantId) : null;\r\n    const totalFee = paymentData?.installment1Fee || FEE_PER_SITE_TYPE;\r\n    const applicantName = paymentData?.applicantName || '-';\r\n    const siteTypes = paymentData?.siteTypes || ['OUTDOOR'];\r\n    const paymentDate = paymentData?.paymentDate ? new Date(paymentData.paymentDate) : new Date();\r\n\r\n    const handlePrint = () => window.print();\r\n\r\n    return (\r\n        <div className={`min-h-screen p-6 font-sans ${isDark ? 'bg-slate-900' : 'bg-gradient-to-b from-primary-50 to-surface-100'}`}>\r\n            {/* Confetti */}\r\n            {showConfetti && (\r\n                <div className=\"fixed inset-0 pointer-events-none overflow-hidden z-50\">\r\n                    {[...Array(40)].map((_, i) => (\r\n                        <div key={i} className=\"absolute animate-[confetti_2s_ease-out_forwards]\" style={{ width: `${8 + Math.random() * 8}px`, height: `${8 + Math.random() * 8}px`, background: ['#10B981', '#F59E0B', '#3B82F6', '#EC4899', '#8B5CF6', '#EF4444'][i % 6], borderRadius: i % 3 === 0 ? '50%' : '2px', left: `${Math.random() * 100}%`, top: '-20px', animationDelay: `${Math.random() * 0.8}s` }} />\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            {/* Success Header */}\r\n            <div className=\"text-center mb-6\">\r\n                <div className=\"w-[90px] h-[90px] bg-gradient-to-br from-primary-700 via-primary-600 to-primary-400 rounded-full flex items-center justify-center mx-auto mb-4 shadow-xl shadow-primary-500/40 animate-[scaleIn_0.5s_ease-out]\">\r\n                    <svg width=\"45\" height=\"45\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"white\" strokeWidth=\"3\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M20 6L9 17L4 12\" /></svg>\r\n                </div>\r\n                <h1 className={`text-2xl font-bold mb-2 ${isDark ? 'text-surface-100' : 'text-primary-800'}`}>เธขเธทเนเธเธเธณเธเธญเธชเธณเน€เธฃเนเธ!</h1>\r\n                <p className={`text-sm mb-1 ${isDark ? 'text-slate-400' : 'text-primary-600'}`}>เธเธณเธฃเธฐเน€เธเธดเธเน€เธฃเธตเธขเธเธฃเนเธญเธขเนเธฅเนเธง</p>\r\n                <div className={`inline-flex items-center gap-2 px-4 py-2 rounded-full border-2 border-primary-600 shadow-sm ${isDark ? 'bg-slate-700' : 'bg-white'}`}>\r\n                    <span className={`text-sm ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธซเธกเธฒเธขเน€เธฅเธเธเธณเธเธญ:</span>\r\n                    <strong className=\"text-sm text-primary-600 tracking-wide\">{appId}</strong>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Application Summary */}\r\n            <div className={`rounded-2xl p-5 mb-4 max-w-md mx-auto shadow-lg border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                <h3 className={`text-sm font-semibold mb-4 flex items-center gap-2 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธชเธฃเธธเธเธเนเธญเธกเธนเธฅเธเธณเธเธญ</h3>\r\n                <div className=\"grid grid-cols-2 gap-3\">\r\n                    {[{ label: 'เธเธนเนเธขเธทเนเธเธเธณเธเธญ', value: applicantName }, { label: 'เธเธฃเธฐเน€เธ เธ—เธเธทเธ', value: `${plant?.icon} ${plant?.name || 'เธเธฑเธเธเธฒ'}` }, { label: 'เธฅเธฑเธเธฉเธ“เธฐเธเธทเนเธเธ—เธตเน', value: siteTypes.map(t => SITE_TYPE_LABELS[t] || t).join(', ') }, { label: 'เธงเธฑเธเธ—เธตเนเธเธณเธฃเธฐเน€เธเธดเธ', value: paymentDate.toLocaleDateString('th-TH', { year: 'numeric', month: 'short', day: 'numeric' }) }].map((item, i) => (\r\n                        <div key={i} className={`p-3 rounded-lg ${isDark ? 'bg-slate-700' : 'bg-surface-100'}`}>\r\n                            <div className={`text-[11px] mb-1 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{item.label}</div>\r\n                            <div className={`text-sm font-medium ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>{item.value}</div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n                <div className=\"flex justify-center gap-2 items-center p-3 bg-primary-50 border border-primary-600 rounded-lg mt-4\">\r\n                    <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#10B981\" strokeWidth=\"2\"><path d=\"M20 6L9 17L4 12\" /></svg>\r\n                    <span className=\"text-sm font-semibold text-primary-800\">เธเธณเธฃเธฐเน€เธเธดเธเธเธงเธ”เธ—เธตเน 1 เน€เธฃเธตเธขเธเธฃเนเธญเธขเนเธฅเนเธง</span>\r\n                    <span className=\"text-base font-bold text-primary-600\">เธฟ{totalFee.toLocaleString()}</span>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Email Notification */}\r\n            <div className={`rounded-xl px-4 py-3 mb-4 max-w-md mx-auto flex items-start gap-3 border ${isDark ? 'bg-blue-500/10 border-blue-500/30' : 'bg-blue-50 border-blue-200'}`}>\r\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z\" /><polyline points=\"22,6 12,13 2,6\" /></svg>\r\n                <div>\r\n                    <p className={`text-sm font-medium mb-0.5 ${isDark ? 'text-blue-300' : 'text-blue-700'}`}>เธญเธตเน€เธกเธฅเธขเธทเธเธขเธฑเธเธ–เธนเธเธชเนเธเนเธเนเธฅเนเธง</p>\r\n                    <p className={`text-xs ${isDark ? 'text-slate-400' : 'text-slate-600'}`}>เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเธญเธตเน€เธกเธฅเธเธญเธเธ—เนเธฒเธเธชเธณเธซเธฃเธฑเธเนเธเน€เธชเธฃเนเธเนเธฅเธฐเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”เธเธณเธเธญ</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Receipt Toggle */}\r\n            <div className=\"text-center mb-4\">\r\n                <button onClick={() => setShowReceipt(!showReceipt)} className={`px-6 py-3 rounded-lg border-2 border-primary-600 text-sm font-semibold inline-flex items-center gap-2 shadow-lg shadow-primary-500/20 transition-all ${showReceipt ? 'bg-primary-600 text-white' : 'bg-white text-primary-600'}`}>\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\" /><polyline points=\"14 2 14 8 20 8\" /></svg>\r\n                    {showReceipt ? 'เธเนเธญเธเนเธเน€เธชเธฃเนเธ' : 'เธ”เธนเนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธ'}\r\n                </button>\r\n            </div>\r\n\r\n            {/* Official Receipt */}\r\n            {showReceipt && (\r\n                <div id=\"official-receipt\" className=\"bg-white text-slate-900 p-7 max-w-lg mx-auto mb-6 border-2 border-primary-600 rounded-xl shadow-xl font-sans print:border-0 print:shadow-none\">\r\n                    {/* Header */}\r\n                    <div className=\"text-center border-b-[3px] border-primary-600 pb-5 mb-5\">\r\n                        <div className=\"flex justify-center items-center gap-3 mb-3\">\r\n                            <img src=\"/images/logo-dtam.png\" alt=\"DTAM\" className=\"w-12 h-12 object-contain\" onError={(e) => { e.currentTarget.style.display = 'none'; }} />\r\n                            <div><div className=\"text-base font-bold text-primary-800\">เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</div><div className=\"text-[11px] text-slate-500\">Department of Thai Traditional and Alternative Medicine</div></div>\r\n                        </div>\r\n                        <h2 className=\"text-xl font-bold text-primary-600 my-2\">เนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธ</h2>\r\n                        <div className=\"text-xs text-slate-500\">เน€เธฅเธเธ—เธตเนเนเธเน€เธชเธฃเนเธ: <strong className=\"text-slate-900\">{appId}-REC</strong></div>\r\n                    </div>\r\n\r\n                    {/* Applicant Info */}\r\n                    <table className=\"w-full text-sm mb-5\">\r\n                        <tbody>\r\n                            {[{ label: 'เธงเธฑเธเธ—เธตเนเธเธณเธฃเธฐเน€เธเธดเธ', value: paymentDate.toLocaleDateString('th-TH', { year: 'numeric', month: 'long', day: 'numeric' }) }, { label: 'เธเธนเนเธเธณเธฃเธฐเน€เธเธดเธ', value: applicantName }, { label: 'เน€เธฅเธเธ—เธตเนเธเธณเธเธญ', value: appId, highlight: true }, { label: 'เธเธฃเธฐเน€เธ เธ—เธเธทเธ', value: `${plant?.icon} ${plant?.name || 'เธเธฑเธเธเธฒ'}` }].map((row, i) => (\r\n                                <tr key={i} className=\"border-b border-surface-200\"><td className=\"py-2.5 text-slate-500 w-[35%]\">{row.label}</td><td className={`py-2.5 font-medium ${row.highlight ? 'text-primary-600 font-semibold' : ''}`}>{row.value}</td></tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n\r\n                    {/* Fee Breakdown */}\r\n                    <div className=\"bg-surface-100 rounded-lg p-4 mb-5\">\r\n                        <div className=\"text-xs font-semibold text-slate-700 mb-3\">เธฃเธฒเธขเธเธฒเธฃเธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธก (เธเธงเธ”เธ—เธตเน 1)</div>\r\n                        <table className=\"w-full text-sm\">\r\n                            <thead><tr className=\"border-b-2 border-surface-200\"><th className=\"text-left py-2.5 text-slate-500\">เธฃเธฒเธขเธเธฒเธฃ</th><th className=\"text-center py-2.5 text-slate-500 w-[60px]\">เธเธณเธเธงเธ</th><th className=\"text-right py-2.5 text-slate-500 w-[100px]\">เธฃเธฒเธเธฒ</th></tr></thead>\r\n                            <tbody>\r\n                                {siteTypes.map((type, i) => (<tr key={i} className=\"border-b border-surface-200\"><td className=\"py-3\">เธเนเธฒเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ ({SITE_TYPE_LABELS[type] || type})</td><td className=\"text-center py-3\">1</td><td className=\"text-right py-3\">เธฟ{FEE_PER_SITE_TYPE.toLocaleString()}</td></tr>))}\r\n                            </tbody>\r\n                            <tfoot><tr><td colSpan={2} className=\"py-3.5 font-bold text-sm\">เธฃเธงเธกเธ—เธฑเนเธเธชเธดเนเธ</td><td className=\"text-right py-3.5 font-bold text-lg text-primary-600\">เธฟ{totalFee.toLocaleString()}</td></tr></tfoot>\r\n                        </table>\r\n                    </div>\r\n\r\n                    {/* Success Badge */}\r\n                    <div className=\"flex justify-center gap-2 items-center p-3.5 bg-primary-50 border-2 border-primary-600 rounded-lg mb-5\">\r\n                        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#10B981\" strokeWidth=\"2\"><path d=\"M20 6L9 17L4 12\" /></svg>\r\n                        <span className=\"text-base font-bold text-primary-800\">เธเธณเธฃเธฐเน€เธเธดเธเน€เธฃเธตเธขเธเธฃเนเธญเธขเนเธฅเนเธง</span>\r\n                    </div>\r\n\r\n                    {/* Signature */}\r\n                    <div className=\"grid grid-cols-2 gap-6 pt-5 border-t-2 border-dashed border-surface-200\">\r\n                        {[{ title: 'เธฅเธเธเธทเนเธญ เธเธนเนเธฃเธฑเธเน€เธเธดเธ' }, { title: 'เธงเธฑเธเธ—เธตเน' }].map((sig, i) => (<div key={i} className=\"text-center\"><div className=\"h-12 border-b border-slate-600 mb-1.5\"></div><div className=\"text-[11px] text-slate-500\">{sig.title}</div></div>))}\r\n                    </div>\r\n\r\n                    {/* Print Button */}\r\n                    <div className=\"text-center mt-5\">\r\n                        <button onClick={handlePrint} className=\"px-7 py-3 rounded-lg border-2 border-primary-600 bg-white text-primary-600 text-sm font-semibold inline-flex items-center gap-2\">\r\n                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><polyline points=\"6 9 6 2 18 2 18 9\" /><path d=\"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2\" /><rect x=\"6\" y=\"14\" width=\"12\" height=\"8\" /></svg>\r\n                            เธเธดเธกเธเนเนเธเน€เธชเธฃเนเธ / เธ”เธฒเธงเธเนเนเธซเธฅเธ” PDF\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Next Steps */}\r\n            <div className={`rounded-2xl p-5 mb-4 max-w-md mx-auto shadow-lg border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                <h3 className={`text-sm font-semibold mb-4 flex items-center gap-2 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธเธฑเนเธเธ•เธญเธเธ–เธฑเธ”เนเธ</h3>\r\n                {[{ text: 'เธขเธทเนเธเธเธณเธเธญเนเธฅเธฐเธเธณเธฃเธฐเน€เธเธดเธเธเธงเธ”เธ—เธตเน 1 เธชเธณเน€เธฃเนเธ', done: true, active: true }, { text: 'เธฃเธญเธ•เธฃเธงเธเธชเธญเธเน€เธญเธเธชเธฒเธฃ (เนเธเนเน€เธงเธฅเธฒ 3-5 เธงเธฑเธเธ—เธณเธเธฒเธฃ)', done: false, active: true }, { text: 'เธเธฑเธ”เธซเธกเธฒเธขเนเธฅเธฐเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธเธชเธ–เธฒเธเธ—เธตเน', done: false, active: false }, { text: 'เธเธณเธฃเธฐเน€เธเธดเธเธเธงเธ”เธ—เธตเน 2 (เธซเธฅเธฑเธเธเนเธฒเธเธเธฒเธฃเธเธฃเธฐเน€เธกเธดเธ)', done: false, active: false }, { text: 'เธฃเธฑเธเนเธเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP', done: false, active: false }].map((step, i) => (\r\n                    <div key={i} className={`flex items-center gap-3.5 py-2.5 ml-3 pl-4 border-l-[3px] ${step.done ? 'border-primary-600' : step.active ? 'border-secondary-500' : isDark ? 'border-slate-600' : 'border-surface-200'} ${!step.done && !step.active ? 'opacity-60' : ''}`}>\r\n                        <span className={`w-5 h-5 rounded-full flex items-center justify-center ${step.done ? 'bg-primary-600 text-white' : step.active ? 'bg-secondary-100 text-secondary-600' : isDark ? 'bg-slate-700 text-slate-500' : 'bg-surface-200 text-slate-400'}`}>\r\n                            {step.done && <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"3\"><path d=\"M20 6L9 17L4 12\" /></svg>}\r\n                            {!step.done && <span className=\"text-[10px]\">{i + 1}</span>}\r\n                        </span>\r\n                        <span className={`text-sm ${step.done ? 'text-primary-600' : step.active ? 'text-secondary-600 font-semibold' : isDark ? 'text-slate-400' : 'text-slate-500'}`}>{step.text}</span>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Action Buttons */}\r\n            <div className=\"flex flex-col gap-3 max-w-md mx-auto\">\r\n                <Link href=\"/tracking\" className=\"py-4 px-6 rounded-xl bg-gradient-to-r from-primary-700 to-primary-600 text-white text-base font-semibold text-center flex items-center justify-center gap-2.5 shadow-xl shadow-primary-500/40\">\r\n                    <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z\" /><circle cx=\"12\" cy=\"10\" r=\"3\" /></svg>\r\n                    เธ•เธดเธ”เธ•เธฒเธกเธชเธ–เธฒเธเธฐเธเธณเธเธญ\r\n                </Link>\r\n                <Link href=\"/farmer/dashboard\" className={`py-4 px-6 rounded-xl text-center text-sm font-medium flex items-center justify-center gap-2.5 border-2 ${isDark ? 'bg-slate-700 border-slate-600 text-surface-100' : 'bg-white border-surface-200 text-slate-700'}`}>\r\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\" /><polyline points=\"9 22 9 12 15 12 15 22\" /></svg>\r\n                    เธเธฅเธฑเธเธซเธเนเธฒเธซเธฅเธฑเธ {countdown > 0 && <span className=\"text-xs text-slate-400\">(เธญเธฑเธ•เนเธเธกเธฑเธ•เธดเนเธ {countdown} เธงเธดเธเธฒเธ—เธต)</span>}\r\n                </Link>\r\n            </div>\r\n\r\n            {/* Feedback */}\r\n            <div className=\"text-center mt-6\">\r\n                <a href=\"#feedback\" className={`text-sm underline flex items-center justify-center gap-1.5 ${isDark ? 'text-blue-400' : 'text-blue-600'}`}>\r\n                    <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z\" /></svg>\r\n                    เนเธชเธ”เธเธเธงเธฒเธกเธเธดเธ”เน€เธซเนเธเน€เธเธตเนเธขเธงเธเธฑเธเธเธฃเธดเธเธฒเธฃ\r\n                </a>\r\n            </div>\r\n\r\n            {/* Styles */}\r\n            <style jsx global>{`\r\n                @keyframes scaleIn { from { opacity: 0; transform: scale(0.5); } to { opacity: 1; transform: scale(1); } }\r\n                @keyframes confetti { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }\r\n                @media print { body * { visibility: hidden; } #official-receipt, #official-receipt * { visibility: visible; } #official-receipt { position: absolute; left: 0; top: 0; width: 100%; border: none !important; box-shadow: none !important; } }\r\n            `}</style>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\page.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadApplications` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\page.tsx:44:9\n  42 |         }\n  43 |\n> 44 |         loadApplications();\n     |         ^^^^^^^^^^^^^^^^ `loadApplications` accessed before it is declared\n  45 |     }, [router]);\n  46 |\n  47 |     const loadApplications = async () => {\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\page.tsx:47:5\n  45 |     }, [router]);\n  46 |\n> 47 |     const loadApplications = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 48 |         setLoading(true);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 49 |         const result = await api.get<Application[]>(\"/applications/my\");\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 50 |         if (result.success && result.data) {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 51 |             const apps = Array.isArray(result.data) ? result.data : (result.data as any).data || [];\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 52 |             setApplications(apps);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 53 |         }\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 54 |         setLoading(false);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 55 |     };\n     | ^^^^^^^ `loadApplications` is declared here\n  56 |\n  57 |     if (!mounted) return (\n  58 |         <div className={`min-h-screen flex items-center justify-center ${isDark ? 'bg-slate-900' : 'bg-stone-50'}`}>","line":44,"column":9,"nodeType":null,"endLine":44,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2363,2366],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2363,2366],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { apiClient as api } from \"@/lib/api/api-client\";\r\nimport { AuthService } from \"@/lib/services/auth-service\";\r\nimport {\r\n    IconDocument, IconPlus, IconChevronRight,\r\n    IconDraft, IconCreditCard as IconPayment, IconSearch, IconWarning,\r\n    IconBuilding, IconCalendar, IconCertificate, IconChart, IconClock, IconLeaf\r\n} from \"@/components/ui/icons\";\r\n\r\ninterface Application { _id: string; applicationNumber?: string; status: string; createdAt: string; plantType?: string; }\r\n\r\nconst STATUS_CONFIG: Record<string, { label: string; Icon: React.FC<{ size?: number; className?: string }>; bgClass: string }> = {\r\n    DRAFT: { label: \"เธฃเนเธฒเธ\", Icon: IconDraft, bgClass: \"bg-slate-500\" },\r\n    PAYMENT_1_PENDING: { label: \"เธฃเธญเธเธณเธฃเธฐเธเธงเธ” 1\", Icon: IconPayment, bgClass: \"bg-amber-500\" },\r\n    SUBMITTED: { label: \"เธฃเธญเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ\", Icon: IconSearch, bgClass: \"bg-blue-500\" },\r\n    REVISION_REQ: { label: \"เธ•เนเธญเธเนเธเนเนเธ\", Icon: IconWarning, bgClass: \"bg-red-500\" },\r\n    PAYMENT_2_PENDING: { label: \"เธฃเธญเธเธณเธฃเธฐเธเธงเธ” 2\", Icon: IconPayment, bgClass: \"bg-amber-500\" },\r\n    AUDIT_PENDING: { label: \"เธฃเธญเธ•เธฃเธงเธเธชเธ–เธฒเธเธ—เธตเน\", Icon: IconBuilding, bgClass: \"bg-violet-500\" },\r\n    AUDIT_SCHEDULED: { label: \"เธเธฑเธ”เธ•เธฃเธงเธเนเธฅเนเธง\", Icon: IconCalendar, bgClass: \"bg-cyan-500\" },\r\n    CERTIFIED: { label: \"เนเธ”เนเธฃเธฑเธเธเธฒเธฃเธฃเธฑเธเธฃเธญเธ\", Icon: IconCertificate, bgClass: \"bg-emerald-500\" },\r\n};\r\n\r\nexport default function ApplicationsPage() {\r\n    const router = useRouter();\r\n    const [applications, setApplications] = useState<Application[]>([]);\r\n    const [mounted, setMounted] = useState(false);\r\n    const [isDark, setIsDark] = useState(false);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        setIsDark(localStorage.getItem(\"theme\") === \"dark\");\r\n\r\n        const user = AuthService.getUser();\r\n        if (!user) {\r\n            router.push(\"/login\");\r\n            return;\r\n        }\r\n\r\n        loadApplications();\r\n    }, [router]);\r\n\r\n    const loadApplications = async () => {\r\n        setLoading(true);\r\n        const result = await api.get<Application[]>(\"/applications/my\");\r\n        if (result.success && result.data) {\r\n            const apps = Array.isArray(result.data) ? result.data : (result.data as any).data || [];\r\n            setApplications(apps);\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    if (!mounted) return (\r\n        <div className={`min-h-screen flex items-center justify-center ${isDark ? 'bg-slate-900' : 'bg-stone-50'}`}>\r\n            <div className=\"w-8 h-8 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin\" />\r\n        </div>\r\n    );\r\n\r\n    const stats = [\r\n        { label: \"เธ—เธฑเนเธเธซเธกเธ”\", value: applications.length, Icon: IconChart, color: \"bg-slate-600\" },\r\n        { label: \"เธเธณเธฅเธฑเธเธ”เธณเน€เธเธดเธเธเธฒเธฃ\", value: applications.filter(a => !['DRAFT', 'CERTIFIED'].includes(a.status)).length, Icon: IconClock, color: \"bg-amber-500\" },\r\n        { label: \"เนเธ”เนเธฃเธฑเธเธฃเธญเธ\", value: applications.filter(a => a.status === 'CERTIFIED').length, Icon: IconCertificate, color: \"bg-emerald-500\" },\r\n        { label: \"เธฃเนเธฒเธ\", value: applications.filter(a => a.status === 'DRAFT').length, Icon: IconDraft, color: \"bg-blue-500\" },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"p-6 lg:p-8 pb-28 lg:pb-8 max-w-5xl mx-auto\">\r\n            {/* Header */}\r\n            <header className=\"flex justify-between items-start flex-wrap gap-4 mb-8\">\r\n                <div>\r\n                    <h1 className=\"text-2xl lg:text-3xl font-semibold tracking-tight\">เธเธณเธเธญเธเธญเธเธเธฑเธ</h1>\r\n                    <p className={`text-sm mt-1 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>\r\n                        เธเธฑเธ”เธเธฒเธฃเธเธณเธเธญเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP\r\n                    </p>\r\n                </div>\r\n                <Link href=\"/farmer/applications/new\" className=\"flex items-center gap-2 px-5 py-3 rounded-xl bg-emerald-600 text-white font-medium text-sm hover:bg-emerald-700 transition-colors shadow-sm\">\r\n                    <IconPlus size={18} />\r\n                    เธขเธทเนเธเธเธณเธเธญเนเธซเธกเน\r\n                </Link>\r\n            </header>\r\n\r\n            {/* Stats Grid */}\r\n            <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-8\">\r\n                {stats.map((stat, i) => (\r\n                    <div key={i} className={`p-4 rounded-xl border transition-all hover:shadow-md ${isDark ? 'bg-slate-800/50 border-slate-700/50' : 'bg-white border-slate-200'}`}>\r\n                        <div className=\"flex items-center justify-between mb-3\">\r\n                            <span className={`text-xs font-medium ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{stat.label}</span>\r\n                            <div className={`w-8 h-8 rounded-lg ${stat.color} flex items-center justify-center`}>\r\n                                <stat.Icon size={16} className=\"text-white\" />\r\n                            </div>\r\n                        </div>\r\n                        <p className=\"text-2xl font-semibold\">{stat.value}</p>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Applications List */}\r\n            {loading ? (\r\n                <div className={`rounded-xl p-16 text-center border ${isDark ? 'bg-slate-800/50 border-slate-700/50' : 'bg-white border-slate-200'}`}>\r\n                    <div className=\"w-8 h-8 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin mx-auto mb-4\" />\r\n                    <p className={`text-sm ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธเธณเธฅเธฑเธเนเธซเธฅเธ”เธเนเธญเธกเธนเธฅ...</p>\r\n                </div>\r\n            ) : applications.length > 0 ? (\r\n                <div className=\"space-y-3\">\r\n                    {applications.map((app) => {\r\n                        const statusInfo = STATUS_CONFIG[app.status] || { label: app.status, Icon: IconDocument, bgClass: 'bg-slate-500' };\r\n                        const StatusIcon = statusInfo.Icon;\r\n                        return (\r\n                            <div key={app._id} className={`group flex justify-between items-center p-4 rounded-xl border transition-all hover:shadow-md ${isDark ? 'bg-slate-800/50 border-slate-700/50 hover:border-emerald-500/30' : 'bg-white border-slate-200 hover:border-emerald-300'}`}>\r\n                                <div className=\"flex items-center gap-4\">\r\n                                    <div className={`w-11 h-11 rounded-xl ${statusInfo.bgClass} flex items-center justify-center shadow-sm`}>\r\n                                        <StatusIcon size={20} className=\"text-white\" />\r\n                                    </div>\r\n                                    <div>\r\n                                        <p className=\"font-semibold\">{app.applicationNumber || `#${app._id.slice(-6).toUpperCase()}`}</p>\r\n                                        <div className=\"flex items-center gap-3 mt-0.5\">\r\n                                            <span className={`text-xs ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>\r\n                                                {new Date(app.createdAt).toLocaleDateString('th-TH', { year: 'numeric', month: 'short', day: 'numeric' })}\r\n                                            </span>\r\n                                            {app.plantType && (\r\n                                                <span className={`text-xs px-2 py-0.5 rounded-md flex items-center gap-1 ${isDark ? 'bg-slate-700 text-slate-300' : 'bg-slate-100 text-slate-600'}`}>\r\n                                                    <IconLeaf size={12} />\r\n                                                    {app.plantType}\r\n                                                </span>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <span className={`hidden sm:inline-block px-3 py-1.5 rounded-lg text-xs font-medium ${statusInfo.bgClass} text-white`}>\r\n                                        {statusInfo.label}\r\n                                    </span>\r\n                                    <Link href={`/farmer/applications/${app._id}`} className={`flex items-center gap-1 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${isDark ? 'bg-slate-700 text-slate-200 hover:bg-emerald-600 hover:text-white' : 'bg-slate-100 text-slate-700 hover:bg-emerald-600 hover:text-white'}`}>\r\n                                        เธ”เธนเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”\r\n                                        <IconChevronRight size={16} />\r\n                                    </Link>\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            ) : (\r\n                <div className={`rounded-xl p-16 text-center border ${isDark ? 'bg-slate-800/50 border-slate-700/50' : 'bg-white border-slate-200'}`}>\r\n                    <div className=\"w-16 h-16 mx-auto mb-6 rounded-2xl bg-emerald-100 flex items-center justify-center\">\r\n                        <IconDocument size={32} className=\"text-emerald-600\" />\r\n                    </div>\r\n                    <h3 className=\"text-lg font-semibold mb-2\">เธขเธฑเธเนเธกเนเธกเธตเธเธณเธเธญ</h3>\r\n                    <p className={`text-sm mb-6 max-w-sm mx-auto ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>\r\n                        เน€เธฃเธดเนเธกเธ•เนเธเธขเธทเนเธเธเธณเธเธญเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP เน€เธเธทเนเธญเธฃเธฑเธเธเธฒเธฃเธฃเธฑเธเธฃเธญเธเธเธฒเธเธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเธฏ\r\n                    </p>\r\n                    <Link href=\"/applications/new\" className=\"inline-flex items-center gap-2 px-6 py-3 rounded-xl bg-emerald-600 text-white font-medium hover:bg-emerald-700 transition-colors\">\r\n                        <IconPlus size={18} />\r\n                        เธขเธทเนเธเธเธณเธเธญเนเธฃเธเธเธญเธเธเธธเธ“\r\n                    </Link>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\renewal\\InvoiceStep.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\renewal\\InvoiceStep.tsx:14:34\n  12 |\n  13 | export function InvoiceStep({ certificate, renewalId, isDark, onBack, onProceed }: InvoiceStepProps) {\n> 14 |     const invoiceNumber = `INV-${Date.now().toString(36).toUpperCase().slice(-6)}`;\n     |                                  ^^^^^^^^^^ Cannot call impure function\n  15 |     const currentDate = new Date();\n  16 |     const dueDate = new Date(currentDate);\n  17 |     dueDate.setDate(dueDate.getDate() + 7);","line":14,"column":34,"nodeType":null,"endLine":14,"endColumn":44}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Certificate, RENEWAL_FEE } from './types';\r\n\r\ninterface InvoiceStepProps {\r\n    certificate: Certificate | null;\r\n    renewalId: string | null;\r\n    isDark: boolean;\r\n    onBack: () => void;\r\n    onProceed: () => void;\r\n}\r\n\r\nexport function InvoiceStep({ certificate, renewalId, isDark, onBack, onProceed }: InvoiceStepProps) {\r\n    const invoiceNumber = `INV-${Date.now().toString(36).toUpperCase().slice(-6)}`;\r\n    const currentDate = new Date();\r\n    const dueDate = new Date(currentDate);\r\n    dueDate.setDate(dueDate.getDate() + 7);\r\n\r\n    return (\r\n        <div className={`min-h-screen p-6 font-sans ${isDark ? 'bg-slate-900' : 'bg-surface-100'}`}>\r\n            <div className=\"max-w-3xl mx-auto\">\r\n                <button onClick={onBack} className={`inline-flex items-center gap-2 px-4 py-2 rounded-lg border mb-6 ${isDark ? 'border-slate-700 text-slate-400' : 'border-surface-200 text-slate-600'}`}>โ เธขเนเธญเธเธเธฅเธฑเธ</button>\r\n                <h1 className={`text-xl font-semibold mb-5 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เนเธเธงเธฒเธเธเธดเธฅ / Invoice</h1>\r\n\r\n                {/* Official Invoice */}\r\n                <div className=\"bg-white text-slate-900 p-10 border border-surface-200 rounded shadow-lg mb-6 font-[Sarabun]\">\r\n                    {/* Header */}\r\n                    <div className=\"flex items-start gap-4 mb-6 pb-4 border-b-2 border-blue-600\">\r\n                        <div className=\"flex-1\">\r\n                            <div className=\"text-base font-bold text-slate-800 mb-0.5\">เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</div>\r\n                            <div className=\"text-[11px] text-slate-700 mb-0.5\">Department of Thai Traditional and Alternative Medicine</div>\r\n                            <div className=\"text-[10px] text-slate-500\">เธเธฃเธฐเธ—เธฃเธงเธเธชเธฒเธเธฒเธฃเธ“เธชเธธเธ | Ministry of Public Health</div>\r\n                        </div>\r\n                        <div className=\"text-right min-w-[160px]\">\r\n                            <div className=\"bg-gradient-to-r from-blue-600 to-blue-500 text-white px-3.5 py-1.5 text-sm font-semibold rounded mb-2\">เนเธเธงเธฒเธเธเธดเธฅ</div>\r\n                            <div className=\"text-[11px] text-slate-700\">เน€เธฅเธเธ—เธตเน: <strong>{invoiceNumber}</strong></div>\r\n                            <div className=\"text-[10px] text-slate-500\">เธงเธฑเธเธ—เธตเน: {currentDate.toLocaleDateString('th-TH')}</div>\r\n                            <div className=\"text-[10px] text-slate-500\">เธญเนเธฒเธเธญเธดเธ: {renewalId || '-'}</div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Recipient */}\r\n                    <div className=\"mb-5 p-3 bg-surface-100 rounded-md border border-surface-200\">\r\n                        <div className=\"text-[11px] text-slate-500 mb-1\">เน€เธฃเธตเธขเธเน€เธเนเธเน€เธเธดเธเธเธฒเธ / Bill To:</div>\r\n                        <div className=\"text-sm font-semibold\">{certificate?.siteName || 'เธเธนเนเธเธฃเธฐเธเธญเธเธเธฒเธฃ'}</div>\r\n                        <div className=\"text-[11px] text-slate-500\">เนเธเธฃเธฑเธเธฃเธญเธ: {certificate?.certificateNumber || '-'}</div>\r\n                    </div>\r\n\r\n                    {/* Fee Table */}\r\n                    <table className=\"w-full text-xs mb-5 border-collapse\">\r\n                        <thead><tr className=\"bg-blue-900 text-white\"><th className=\"p-2.5 text-center border border-blue-900 w-[50px]\">เธฅเธณเธ”เธฑเธ</th><th className=\"p-2.5 text-left border border-blue-900\">เธฃเธฒเธขเธเธฒเธฃ</th><th className=\"p-2.5 text-right border border-blue-900 w-[100px]\">เธเธณเธเธงเธเน€เธเธดเธ (เธเธฒเธ—)</th></tr></thead>\r\n                        <tbody>\r\n                            <tr><td className=\"p-3 border border-surface-200 text-center\">1</td><td className=\"p-3 border border-surface-200\">เธเนเธฒเธเธฃเธดเธเธฒเธฃเธ•เนเธญเธญเธฒเธขเธธเนเธเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP<br /><span className=\"text-[10px] text-slate-500\">(เธฃเธงเธกเธเนเธฒเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธเนเธฅเธฐเธญเธญเธเนเธเธฃเธฑเธเธฃเธญเธ)</span></td><td className=\"p-3 border border-surface-200 text-right\">{RENEWAL_FEE.toLocaleString()}</td></tr>\r\n                        </tbody>\r\n                        <tfoot>\r\n                            <tr className=\"bg-blue-50\"><td colSpan={2} className=\"p-3 border border-surface-200 text-right font-semibold\">เธขเธญเธ”เธฃเธงเธกเธ—เธตเนเธ•เนเธญเธเธเธณเธฃเธฐ</td><td className=\"p-3 border border-surface-200 text-right font-bold text-blue-700 text-base\">{RENEWAL_FEE.toLocaleString()}</td></tr>\r\n                            <tr><td colSpan={3} className=\"p-2 border border-surface-200 text-center italic text-[11px] text-slate-600\">(เธชเธฒเธกเธซเธกเธทเนเธเธเธฒเธ—เธ–เนเธงเธ)</td></tr>\r\n                        </tfoot>\r\n                    </table>\r\n\r\n                    {/* Due Date & Status */}\r\n                    <div className=\"flex gap-4 mb-5\">\r\n                        <div className=\"flex-1 p-3 bg-secondary-50 border border-secondary-500 rounded-md\">\r\n                            <div className=\"text-[10px] text-secondary-800 mb-1\">เธเธณเธซเธเธ”เธเธณเธฃเธฐ / Due Date</div>\r\n                            <div className=\"text-sm font-semibold text-secondary-700\">{dueDate.toLocaleDateString('th-TH')}</div>\r\n                        </div>\r\n                        <div className=\"flex-1 p-3 bg-red-50 border border-red-500 rounded-md\">\r\n                            <div className=\"text-[10px] text-red-800 mb-1\">เธชเธ–เธฒเธเธฐ / Status</div>\r\n                            <div className=\"text-sm font-semibold text-red-600\">เธฃเธญเธเธณเธฃเธฐเน€เธเธดเธ</div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Payment Methods */}\r\n                    <div className=\"p-3.5 bg-sky-50 border border-sky-300 rounded-md\">\r\n                        <div className=\"text-xs font-semibold text-sky-900 mb-1.5\">เธเนเธญเธเธ—เธฒเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ:</div>\r\n                        <div className=\"text-[11px] text-sky-700\">\r\n                            <div className=\"mb-1\">โ€ข เธชเนเธเธ QR Code PromptPay</div>\r\n                            <div>โ€ข เนเธญเธเน€เธเธดเธเน€เธเนเธฒเธเธฑเธเธเธต: <strong>เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเธฏ</strong> เธ.เธเธฃเธธเธเนเธ—เธข 067-0-00001-5</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Actions */}\r\n                <div className=\"flex gap-3\">\r\n                    <button onClick={() => window.print()} className=\"flex-1 py-3.5 rounded-xl border-2 border-blue-600 text-blue-600 text-sm font-semibold flex items-center justify-center gap-2\">\r\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><polyline points=\"6 9 6 2 18 2 18 9\" /><path d=\"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2\" /><rect x=\"6\" y=\"14\" width=\"12\" height=\"8\" /></svg>\r\n                        เธเธดเธกเธเนเนเธเธงเธฒเธเธเธดเธฅ\r\n                    </button>\r\n                    <button onClick={onProceed} className=\"flex-1 py-3.5 rounded-xl bg-gradient-to-br from-blue-600 to-blue-500 text-white text-sm font-semibold shadow-lg shadow-blue-500/40\">เธ”เธณเน€เธเธดเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ โ’</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\renewal\\PaymentStep.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":29,"column":25,"nodeType":"JSXOpeningElement","endLine":34,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { RENEWAL_FEE } from './types';\r\n\r\ninterface PaymentStepProps {\r\n    renewalId: string | null;\r\n    isDark: boolean;\r\n    onBack: () => void;\r\n    onConfirm: () => void;\r\n}\r\n\r\nexport function PaymentStep({ renewalId, isDark, onBack, onConfirm }: PaymentStepProps) {\r\n    return (\r\n        <div className={`min-h-screen p-6 font-sans ${isDark ? 'bg-slate-900' : 'bg-surface-100'}`}>\r\n            <div className=\"max-w-md mx-auto\">\r\n                <button onClick={onBack} className={`inline-flex items-center gap-2 px-4 py-2 rounded-lg border mb-6 ${isDark ? 'border-slate-700 text-slate-400' : 'border-surface-200 text-slate-600'}`}>โ เธขเนเธญเธเธเธฅเธฑเธ</button>\r\n\r\n                <h1 className={`text-2xl font-semibold mb-2 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธเธณเธฃเธฐเน€เธเธดเธเธเนเธฒเธ•เนเธญเธชเธฑเธเธเธฒ</h1>\r\n                <p className={`mb-6 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธชเนเธเธ QR Code เน€เธเธทเนเธญเธเธณเธฃเธฐเน€เธเธดเธ</p>\r\n\r\n                {/* QR Payment Card */}\r\n                <div className={`rounded-2xl p-7 text-center border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                    <div className=\"mb-5\">\r\n                        <span className=\"inline-block px-5 py-2 bg-[#00427A] rounded-lg text-white text-sm font-semibold\">เธเธฃเนเธญเธกเน€เธเธขเน | PromptPay</span>\r\n                    </div>\r\n\r\n                    {/* QR Code */}\r\n                    <div className=\"w-[220px] h-[220px] mx-auto mb-5 bg-white border-2 border-[#00427A] rounded-xl p-2.5 flex items-center justify-center\">\r\n                        <img\r\n                            src={`https://promptpay.io/0994566289/${RENEWAL_FEE}.png`}\r\n                            alt=\"PromptPay QR\"\r\n                            className=\"w-[200px] h-[200px]\"\r\n                            onError={(e) => { e.currentTarget.onerror = null; e.currentTarget.src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=PROMPTPAY:${RENEWAL_FEE}`; }}\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Amount */}\r\n                    <div className=\"p-4 bg-primary-50 rounded-xl mb-5\">\r\n                        <p className=\"text-sm text-slate-500 mb-1\">เธเธณเธเธงเธเน€เธเธดเธเธ—เธตเนเธ•เนเธญเธเธเธณเธฃเธฐ</p>\r\n                        <p className=\"text-3xl font-bold text-primary-600\">เธฟ{RENEWAL_FEE.toLocaleString()}</p>\r\n                    </div>\r\n\r\n                    {/* Receiver Info */}\r\n                    <div className={`p-3 rounded-lg text-sm mb-6 ${isDark ? 'bg-slate-700 text-slate-300' : 'bg-surface-100 text-slate-700'}`}>\r\n                        <p className=\"mb-1\"><strong>เธเธนเนเธฃเธฑเธเน€เธเธดเธ:</strong> เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</p>\r\n                        <p><strong>เธซเธกเธฒเธขเน€เธฅเธเน€เธเธช:</strong> {renewalId}</p>\r\n                    </div>\r\n\r\n                    <button onClick={onConfirm} className=\"w-full py-4 rounded-xl bg-gradient-to-br from-primary-600 to-primary-500 text-white text-base font-semibold shadow-lg shadow-primary-500/40\">เธขเธทเธเธขเธฑเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\renewal\\QuotationStep.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'renewalId' is defined but never used.","line":13,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":55},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\renewal\\QuotationStep.tsx:14:31\n  12 |\n  13 | export function QuotationStep({ certificate, renewalId, isDark, onBack, onProceed }: QuotationStepProps) {\n> 14 |     const quoteNumber = `QT-${Date.now().toString(36).toUpperCase().slice(-6)}`;\n     |                               ^^^^^^^^^^ Cannot call impure function\n  15 |     const currentDate = new Date();\n  16 |     const validUntil = new Date(currentDate);\n  17 |     validUntil.setDate(validUntil.getDate() + 30);","line":14,"column":31,"nodeType":null,"endLine":14,"endColumn":41}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Certificate, RENEWAL_FEE } from './types';\r\n\r\ninterface QuotationStepProps {\r\n    certificate: Certificate | null;\r\n    renewalId: string | null;\r\n    isDark: boolean;\r\n    onBack: () => void;\r\n    onProceed: () => void;\r\n}\r\n\r\nexport function QuotationStep({ certificate, renewalId, isDark, onBack, onProceed }: QuotationStepProps) {\r\n    const quoteNumber = `QT-${Date.now().toString(36).toUpperCase().slice(-6)}`;\r\n    const currentDate = new Date();\r\n    const validUntil = new Date(currentDate);\r\n    validUntil.setDate(validUntil.getDate() + 30);\r\n\r\n    return (\r\n        <div className={`min-h-screen p-6 font-sans ${isDark ? 'bg-slate-900' : 'bg-surface-100'}`}>\r\n            <div className=\"max-w-3xl mx-auto\">\r\n                <button onClick={onBack} className={`inline-flex items-center gap-2 px-4 py-2 rounded-lg border mb-6 ${isDark ? 'border-slate-700 text-slate-400' : 'border-surface-200 text-slate-600'}`}>โ เธขเนเธญเธเธเธฅเธฑเธ</button>\r\n                <h1 className={`text-xl font-semibold mb-5 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เนเธเน€เธชเธเธญเธฃเธฒเธเธฒ / Quotation</h1>\r\n\r\n                {/* Official Document */}\r\n                <div className=\"bg-white text-slate-900 p-10 border border-surface-200 rounded shadow-lg mb-6 font-[Sarabun]\">\r\n                    {/* Header */}\r\n                    <div className=\"flex items-start gap-4 mb-6 pb-4 border-b-2 border-slate-800\">\r\n                        <div className=\"flex-1\">\r\n                            <div className=\"text-base font-bold text-slate-800 mb-0.5\">เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</div>\r\n                            <div className=\"text-[11px] text-slate-700 mb-0.5\">Department of Thai Traditional and Alternative Medicine</div>\r\n                            <div className=\"text-[10px] text-slate-500\">เธเธฃเธฐเธ—เธฃเธงเธเธชเธฒเธเธฒเธฃเธ“เธชเธธเธ | Ministry of Public Health</div>\r\n                        </div>\r\n                        <div className=\"text-right min-w-[160px]\">\r\n                            <div className=\"bg-gradient-to-r from-slate-800 to-blue-600 text-white px-3.5 py-1.5 text-sm font-semibold rounded mb-2\">เนเธเน€เธชเธเธญเธฃเธฒเธเธฒ</div>\r\n                            <div className=\"text-[11px] text-slate-700\">เน€เธฅเธเธ—เธตเน: <strong>{quoteNumber}</strong></div>\r\n                            <div className=\"text-[10px] text-slate-500\">เธงเธฑเธเธ—เธตเน: {currentDate.toLocaleDateString('th-TH')}</div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Recipient */}\r\n                    <div className=\"mb-5 p-3 bg-surface-100 rounded-md border border-surface-200\">\r\n                        <div className=\"text-[11px] text-slate-500 mb-1\">เน€เธฃเธตเธขเธ / To:</div>\r\n                        <div className=\"text-sm font-semibold\">{certificate?.siteName || 'เธเธนเนเธเธฃเธฐเธเธญเธเธเธฒเธฃ'}</div>\r\n                        <div className=\"text-[11px] text-slate-500\">เนเธเธฃเธฑเธเธฃเธญเธ: {certificate?.certificateNumber || '-'}</div>\r\n                    </div>\r\n\r\n                    {/* Fee Table */}\r\n                    <table className=\"w-full text-xs mb-5 border-collapse\">\r\n                        <thead><tr className=\"bg-slate-800 text-white\"><th className=\"p-2.5 text-center border border-slate-800 w-[50px]\">เธฅเธณเธ”เธฑเธ</th><th className=\"p-2.5 text-left border border-slate-800\">เธฃเธฒเธขเธเธฒเธฃ</th><th className=\"p-2.5 text-right border border-slate-800 w-[100px]\">เธเธณเธเธงเธเน€เธเธดเธ (เธเธฒเธ—)</th></tr></thead>\r\n                        <tbody>\r\n                            <tr><td className=\"p-3 border border-surface-200 text-center\">1</td><td className=\"p-3 border border-surface-200\">เธเนเธฒเธเธฃเธดเธเธฒเธฃเธ•เนเธญเธญเธฒเธขเธธเนเธเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP</td><td className=\"p-3 border border-surface-200 text-right\">{RENEWAL_FEE.toLocaleString()}</td></tr>\r\n                        </tbody>\r\n                        <tfoot>\r\n                            <tr className=\"bg-surface-100\"><td colSpan={2} className=\"p-3 border border-surface-200 text-right font-semibold\">เธฃเธงเธกเธ—เธฑเนเธเธชเธดเนเธ</td><td className=\"p-3 border border-surface-200 text-right font-bold text-slate-800\">{RENEWAL_FEE.toLocaleString()}</td></tr>\r\n                            <tr><td colSpan={3} className=\"p-2 border border-surface-200 text-center italic text-[11px] text-slate-600\">(เธชเธฒเธกเธซเธกเธทเนเธเธเธฒเธ—เธ–เนเธงเธ)</td></tr>\r\n                        </tfoot>\r\n                    </table>\r\n\r\n                    {/* Validity */}\r\n                    <div className=\"flex gap-4 mb-6\">\r\n                        <div className=\"flex-1 p-2.5 bg-secondary-50 border border-secondary-500 rounded-md\">\r\n                            <div className=\"text-[10px] text-secondary-800 mb-0.5\">เนเธเน€เธชเธเธญเธฃเธฒเธเธฒเธเธตเนเธกเธตเธญเธฒเธขเธธเธ–เธถเธ</div>\r\n                            <div className=\"text-xs font-semibold text-secondary-700\">{validUntil.toLocaleDateString('th-TH')}</div>\r\n                        </div>\r\n                        <div className=\"flex-1 p-2.5 bg-blue-50 border border-blue-500 rounded-md\">\r\n                            <div className=\"text-[10px] text-blue-800 mb-0.5\">เธเธณเธฃเธฐเน€เธเธดเธเธ เธฒเธขเนเธ</div>\r\n                            <div className=\"text-xs font-semibold text-blue-700\">7 เธงเธฑเธ เธซเธฅเธฑเธเธเธฒเธเธขเธทเธเธขเธฑเธ</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Actions */}\r\n                <div className=\"flex gap-3\">\r\n                    <button onClick={() => window.print()} className=\"flex-1 py-3.5 rounded-xl border-2 border-primary-600 text-primary-600 text-sm font-semibold flex items-center justify-center gap-2\">\r\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><polyline points=\"6 9 6 2 18 2 18 9\" /><path d=\"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2\" /><rect x=\"6\" y=\"14\" width=\"12\" height=\"8\" /></svg>\r\n                        เธเธดเธกเธเนเนเธเน€เธชเธเธญเธฃเธฒเธเธฒ\r\n                    </button>\r\n                    <button onClick={onProceed} className=\"flex-1 py-3.5 rounded-xl bg-gradient-to-br from-primary-600 to-primary-500 text-white text-sm font-semibold shadow-lg shadow-primary-500/40\">เธขเธทเธเธขเธฑเธเนเธฅเธฐเธญเธญเธเนเธเธงเธฒเธเธเธดเธฅ โ’</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\renewal\\SuccessStep.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\renewal\\SuccessStep.tsx:18:118\n  16 |             <div className=\"fixed inset-0 pointer-events-none overflow-hidden z-50\">\n  17 |                 {[...Array(30)].map((_, i) => (\n> 18 |                     <div key={i} className=\"absolute animate-[confetti_2s_ease-out_forwards]\" style={{ width: `${8 + Math.random() * 8}px`, height: `${8 + Math.random() * 8}px`, background: ['#10B981', '#F59E0B', '#3B82F6', '#EC4899', '#8B5CF6'][i % 5], borderRadius: i % 3 === 0 ? '50%' : '2px', left: `${Math.random() * 100}%`, top: '-20px', animationDelay: `${Math.random() * 0.8}s` }} />\n     |                                                                                                                      ^^^^^^^^^^^^^ Cannot call impure function\n  19 |                 ))}\n  20 |             </div>\n  21 |","line":18,"column":118,"nodeType":null,"endLine":18,"endColumn":131},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\renewal\\SuccessStep.tsx:18:156\n  16 |             <div className=\"fixed inset-0 pointer-events-none overflow-hidden z-50\">\n  17 |                 {[...Array(30)].map((_, i) => (\n> 18 |                     <div key={i} className=\"absolute animate-[confetti_2s_ease-out_forwards]\" style={{ width: `${8 + Math.random() * 8}px`, height: `${8 + Math.random() * 8}px`, background: ['#10B981', '#F59E0B', '#3B82F6', '#EC4899', '#8B5CF6'][i % 5], borderRadius: i % 3 === 0 ? '50%' : '2px', left: `${Math.random() * 100}%`, top: '-20px', animationDelay: `${Math.random() * 0.8}s` }} />\n     |                                                                                                                                                            ^^^^^^^^^^^^^ Cannot call impure function\n  19 |                 ))}\n  20 |             </div>\n  21 |","line":18,"column":156,"nodeType":null,"endLine":18,"endColumn":169},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\renewal\\SuccessStep.tsx:18:307\n  16 |             <div className=\"fixed inset-0 pointer-events-none overflow-hidden z-50\">\n  17 |                 {[...Array(30)].map((_, i) => (\n> 18 |                     <div key={i} className=\"absolute animate-[confetti_2s_ease-out_forwards]\" style={{ width: `${8 + Math.random() * 8}px`, height: `${8 + Math.random() * 8}px`, background: ['#10B981', '#F59E0B', '#3B82F6', '#EC4899', '#8B5CF6'][i % 5], borderRadius: i % 3 === 0 ? '50%' : '2px', left: `${Math.random() * 100}%`, top: '-20px', animationDelay: `${Math.random() * 0.8}s` }} />\n     |                                                                                                                                                                                                                                                                                                                   ^^^^^^^^^^^^^ Cannot call impure function\n  19 |                 ))}\n  20 |             </div>\n  21 |","line":18,"column":307,"nodeType":null,"endLine":18,"endColumn":320},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\renewal\\SuccessStep.tsx:18:364\n  16 |             <div className=\"fixed inset-0 pointer-events-none overflow-hidden z-50\">\n  17 |                 {[...Array(30)].map((_, i) => (\n> 18 |                     <div key={i} className=\"absolute animate-[confetti_2s_ease-out_forwards]\" style={{ width: `${8 + Math.random() * 8}px`, height: `${8 + Math.random() * 8}px`, background: ['#10B981', '#F59E0B', '#3B82F6', '#EC4899', '#8B5CF6'][i % 5], borderRadius: i % 3 === 0 ? '50%' : '2px', left: `${Math.random() * 100}%`, top: '-20px', animationDelay: `${Math.random() * 0.8}s` }} />\n     |                                                                                                                                                                                                                                                                                                                                                                            ^^^^^^^^^^^^^ Cannot call impure function\n  19 |                 ))}\n  20 |             </div>\n  21 |","line":18,"column":364,"nodeType":null,"endLine":18,"endColumn":377}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport Link from 'next/link';\r\nimport { Certificate, RENEWAL_FEE } from './types';\r\n\r\ninterface SuccessStepProps {\r\n    certificate: Certificate | null;\r\n    renewalId: string | null;\r\n    isDark: boolean;\r\n}\r\n\r\nexport function SuccessStep({ certificate, renewalId, isDark }: SuccessStepProps) {\r\n    return (\r\n        <div className={`min-h-screen p-6 font-sans ${isDark ? 'bg-slate-900' : 'bg-gradient-to-b from-primary-50 to-surface-100'}`}>\r\n            {/* Confetti */}\r\n            <div className=\"fixed inset-0 pointer-events-none overflow-hidden z-50\">\r\n                {[...Array(30)].map((_, i) => (\r\n                    <div key={i} className=\"absolute animate-[confetti_2s_ease-out_forwards]\" style={{ width: `${8 + Math.random() * 8}px`, height: `${8 + Math.random() * 8}px`, background: ['#10B981', '#F59E0B', '#3B82F6', '#EC4899', '#8B5CF6'][i % 5], borderRadius: i % 3 === 0 ? '50%' : '2px', left: `${Math.random() * 100}%`, top: '-20px', animationDelay: `${Math.random() * 0.8}s` }} />\r\n                ))}\r\n            </div>\r\n\r\n            <div className=\"text-center pt-10\">\r\n                {/* Success Icon */}\r\n                <div className=\"w-[90px] h-[90px] bg-gradient-to-br from-primary-700 via-primary-600 to-primary-400 rounded-full flex items-center justify-center mx-auto mb-5 shadow-xl shadow-primary-500/40 animate-[scaleIn_0.5s_ease-out]\">\r\n                    <svg width=\"45\" height=\"45\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"white\" strokeWidth=\"3\"><path d=\"M20 6L9 17L4 12\" /></svg>\r\n                </div>\r\n\r\n                <h1 className={`text-2xl font-bold mb-2 ${isDark ? 'text-surface-100' : 'text-primary-800'}`}>เธ•เนเธญเธชเธฑเธเธเธฒเธชเธณเน€เธฃเนเธ!</h1>\r\n                <p className={`text-sm mb-5 ${isDark ? 'text-slate-400' : 'text-primary-600'}`}>เธเธญเธเธเธธเธ“เธชเธณเธซเธฃเธฑเธเธเธฒเธฃเธ•เนเธญเธญเธฒเธขเธธเนเธเธฃเธฑเธเธฃเธญเธ GACP</p>\r\n\r\n                {/* Case Number */}\r\n                <div className={`inline-flex items-center gap-2 px-6 py-3 rounded-full border-2 border-primary-600 mb-6 shadow-sm ${isDark ? 'bg-slate-700' : 'bg-white'}`}>\r\n                    <span className={`text-sm ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธซเธกเธฒเธขเน€เธฅเธเน€เธเธช:</span>\r\n                    <strong className=\"text-base text-primary-600 tracking-wide\">{renewalId}</strong>\r\n                </div>\r\n\r\n                {/* Summary Card */}\r\n                <div className={`rounded-2xl p-6 max-w-md mx-auto mb-6 text-left shadow-lg border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                    <h3 className={`text-sm font-semibold mb-4 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธชเธฃเธธเธเธเธฒเธฃเธ•เนเธญเธชเธฑเธเธเธฒ</h3>\r\n                    <div className=\"grid gap-3\">\r\n                        <div className={`p-3 rounded-lg ${isDark ? 'bg-primary-500/15' : 'bg-primary-50'}`}>\r\n                            <div className={`text-xs mb-1 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เนเธเธฃเธฑเธเธฃเธญเธเน€เธฅเธเธ—เธตเน</div>\r\n                            <div className=\"text-sm font-semibold text-primary-600\">{certificate?.certificateNumber}</div>\r\n                        </div>\r\n                        <div className={`p-3 rounded-lg ${isDark ? 'bg-slate-700' : 'bg-surface-100'}`}>\r\n                            <div className={`text-xs mb-1 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธชเธ–เธฒเธเธ—เธตเน</div>\r\n                            <div className={`text-sm font-medium ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>{certificate?.siteName}</div>\r\n                        </div>\r\n                        <div className=\"p-3 bg-primary-50 border border-primary-600 rounded-lg\">\r\n                            <div className=\"text-xs text-primary-800 mb-1\">เธเธณเธเธงเธเน€เธเธดเธเธ—เธตเนเธเธณเธฃเธฐ</div>\r\n                            <div className=\"text-xl font-bold text-primary-600\">เธฟ{RENEWAL_FEE.toLocaleString()}</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Actions */}\r\n                <div className=\"flex flex-col gap-3 max-w-md mx-auto\">\r\n                    <Link href=\"/tracking\" className=\"py-4 px-6 rounded-xl bg-gradient-to-r from-primary-700 to-primary-600 text-white text-base font-semibold text-center flex items-center justify-center gap-2.5 shadow-xl shadow-primary-500/40\">\r\n                        <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z\" /><circle cx=\"12\" cy=\"10\" r=\"3\" /></svg>\r\n                        เธ•เธดเธ”เธ•เธฒเธกเธชเธ–เธฒเธเธฐ\r\n                    </Link>\r\n                    <Link href=\"/farmer/dashboard\" className={`py-4 px-6 rounded-xl text-center text-sm font-medium flex items-center justify-center gap-2 border-2 ${isDark ? 'bg-slate-700 border-slate-600 text-surface-100' : 'bg-white border-surface-200 text-slate-700'}`}>\r\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\" /><polyline points=\"9 22 9 12 15 12 15 22\" /></svg>\r\n                        เธเธฅเธฑเธเธซเธเนเธฒเธซเธฅเธฑเธ\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n\r\n            <style jsx global>{`\r\n                @keyframes scaleIn { from { opacity: 0; transform: scale(0.5); } to { opacity: 1; transform: scale(1); } }\r\n                @keyframes confetti { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }\r\n            `}</style>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\renewal\\UploadStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\renewal\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":23,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'file' is defined but never used.","line":52,"column":48,"nodeType":null,"messageId":"unusedVar","endLine":52,"endColumn":52}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Suspense, useEffect, useState } from 'react';\r\nimport { useRouter, useSearchParams } from 'next/navigation';\r\nimport Link from 'next/link';\r\nimport { apiClient as api } from '@/lib/api';\r\nimport { Certificate, RENEWAL_FEE, REQUIRED_DOCS, RenewalStep } from './types';\r\nimport { UploadStep } from './UploadStep';\r\nimport { QuotationStep } from './QuotationStep';\r\nimport { InvoiceStep } from './InvoiceStep';\r\nimport { PaymentStep } from './PaymentStep';\r\nimport { SuccessStep } from './SuccessStep';\r\n\r\nfunction RenewalLoadingFallback() {\r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center bg-surface-100 dark:bg-slate-900\">\r\n            <div className=\"w-10 h-10 border-[3px] border-surface-200 border-t-primary-600 rounded-full animate-spin\" />\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction RenewalContent() {\r\n    const router = useRouter();\r\n    const searchParams = useSearchParams();\r\n    const certId = searchParams.get('certId');\r\n\r\n    const [isDark, setIsDark] = useState(false);\r\n    const [certificate, setCertificate] = useState<Certificate | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [uploadedDocs, setUploadedDocs] = useState<Record<string, boolean>>({});\r\n    const [uploading, setUploading] = useState<string | null>(null);\r\n    const [step, setStep] = useState<RenewalStep>('upload');\r\n    const [renewalId, setRenewalId] = useState<string | null>(null);\r\n\r\n    useEffect(() => {\r\n        setIsDark(localStorage.getItem(\"theme\") === \"dark\");\r\n        const userData = localStorage.getItem(\"user\");\r\n        if (!userData) { window.location.href = \"/login\"; return; }\r\n        if (certId) loadCertificate(certId);\r\n        else setLoading(false);\r\n    }, [certId]);\r\n\r\n    const loadCertificate = async (id: string) => {\r\n        setLoading(true);\r\n        try {\r\n            const result = await api.get<{ data: Certificate }>(`/api/certificates/${id}`);\r\n            if (result.success && result.data?.data) setCertificate(result.data.data);\r\n        } catch { console.error('Failed to load certificate'); }\r\n        finally { setLoading(false); }\r\n    };\r\n\r\n    const handleUpload = async (docId: string, file: File) => {\r\n        setUploading(docId);\r\n        try { await new Promise(resolve => setTimeout(resolve, 500)); setUploadedDocs(prev => ({ ...prev, [docId]: true })); }\r\n        finally { setUploading(null); }\r\n    };\r\n\r\n    const handleSkipUpload = () => {\r\n        const allDocs: Record<string, boolean> = {};\r\n        REQUIRED_DOCS.forEach(doc => { allDocs[doc.id] = true; });\r\n        setUploadedDocs(allDocs);\r\n    };\r\n\r\n    const handleProceedToQuotation = async () => {\r\n        let newRenewalId = `RNW-${Date.now().toString(36).toUpperCase()}`;\r\n        if (certificate) {\r\n            try {\r\n                const result = await api.post<{ data: { applicationId: string } }>('/api/applications/renewal', { previousApplicationId: certificate.applicationId, certificateId: certificate._id, documentIds: Object.keys(uploadedDocs).filter(k => uploadedDocs[k]) });\r\n                if (result.success && result.data?.data?.applicationId) newRenewalId = result.data.data.applicationId;\r\n            } catch { console.warn('[Renewal] API failed, using demo ID'); }\r\n        }\r\n        setRenewalId(newRenewalId);\r\n        setStep('quotation');\r\n    };\r\n\r\n    const handlePaymentConfirm = async () => {\r\n        try { await api.post('/api/payments/confirm', { applicationId: renewalId, phase: 'renewal', amount: RENEWAL_FEE }); }\r\n        catch { console.warn('Payment confirmation failed'); }\r\n        localStorage.setItem('last_renewal_id', renewalId || '');\r\n        localStorage.setItem('last_renewal_payment', JSON.stringify({ amount: RENEWAL_FEE, certificateNumber: certificate?.certificateNumber, siteName: certificate?.siteName, paidAt: new Date().toISOString() }));\r\n        setStep('success');\r\n    };\r\n\r\n    if (loading) return <RenewalLoadingFallback />;\r\n\r\n    if (!certificate && !certId) {\r\n        return (\r\n            <div className={`min-h-screen p-8 font-sans ${isDark ? 'bg-slate-900' : 'bg-surface-100'}`}>\r\n                <div className=\"max-w-xl mx-auto text-center pt-16\">\r\n                    <div className={`w-20 h-20 rounded-2xl inline-flex items-center justify-center mb-6 ${isDark ? 'bg-primary-500/15' : 'bg-primary-50'}`}>\r\n                        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke={isDark ? '#34D399' : '#16A34A'} strokeWidth=\"1.5\"><path d=\"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z\" /><polyline points=\"13 2 13 9 20 9\" /></svg>\r\n                    </div>\r\n                    <h1 className={`text-2xl font-semibold mb-4 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธ•เนเธญเธญเธฒเธขเธธเนเธเธฃเธฑเธเธฃเธญเธ GACP</h1>\r\n                    <p className={`mb-6 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธเธฃเธธเธ“เธฒเน€เธฅเธทเธญเธเนเธเธฃเธฑเธเธฃเธญเธเธ—เธตเนเธ•เนเธญเธเธเธฒเธฃเธ•เนเธญเธญเธฒเธขเธธเธเธฒเธเธซเธเนเธฒเนเธเธฃเธฑเธเธฃเธญเธ</p>\r\n                    <Link href=\"/certificates\" className=\"inline-flex items-center gap-2 px-7 py-3.5 rounded-xl bg-gradient-to-br from-primary-600 to-primary-500 text-white font-semibold shadow-lg shadow-primary-500/40\">เนเธเธซเธเนเธฒเนเธเธฃเธฑเธเธฃเธญเธ</Link>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    switch (step) {\r\n        case 'success': return <SuccessStep certificate={certificate} renewalId={renewalId} isDark={isDark} />;\r\n        case 'payment': return <PaymentStep renewalId={renewalId} isDark={isDark} onBack={() => setStep('invoice')} onConfirm={handlePaymentConfirm} />;\r\n        case 'invoice': return <InvoiceStep certificate={certificate} renewalId={renewalId} isDark={isDark} onBack={() => setStep('quotation')} onProceed={() => setStep('payment')} />;\r\n        case 'quotation': return <QuotationStep certificate={certificate} renewalId={renewalId} isDark={isDark} onBack={() => setStep('upload')} onProceed={() => setStep('invoice')} />;\r\n        default: return <UploadStep certificate={certificate} uploadedDocs={uploadedDocs} uploading={uploading} isDark={isDark} onUpload={handleUpload} onSkipUpload={handleSkipUpload} onProceed={handleProceedToQuotation} />;\r\n    }\r\n}\r\n\r\nexport default function RenewalPage() {\r\n    return <Suspense fallback={<RenewalLoadingFallback />}><RenewalContent /></Suspense>;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\renewal\\types.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\applications\\replacement\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[798,801],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[798,801],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadCertificate'. Either include it or remove the dependency array.","line":22,"column":110,"nodeType":"ArrayExpression","endLine":22,"endColumn":118,"suggestions":[{"desc":"Update the dependencies array to be: [certId, loadCertificate]","fix":{"range":[980,988],"text":"[certId, loadCertificate]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":93,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":96,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1086,1089],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1086,1089],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1327,1330],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1327,1330],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-expressions","severity":1,"message":"Expected an assignment or function call and instead saw an expression.","line":79,"column":160,"nodeType":"ExpressionStatement","messageId":"unusedExpression","endLine":79,"endColumn":225},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":112,"column":166,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10405,10446],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ &quot;เธเธฒเธฃเน€เธเธดเธ\" เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10405,10446],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ &ldquo;เธเธฒเธฃเน€เธเธดเธ\" เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10405,10446],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ &#34;เธเธฒเธฃเน€เธเธดเธ\" เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10405,10446],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ &rdquo;เธเธฒเธฃเน€เธเธดเธ\" เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":112,"column":174,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10405,10446],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ \"เธเธฒเธฃเน€เธเธดเธ&quot; เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10405,10446],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ \"เธเธฒเธฃเน€เธเธดเธ&ldquo; เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10405,10446],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ \"เธเธฒเธฃเน€เธเธดเธ&#34; เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10405,10446],"text":"เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ \"เธเธฒเธฃเน€เธเธดเธ&rdquo; เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ"},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { Suspense, useEffect, useState } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport { apiClient as api } from \"@/lib/api\";\r\n\r\ntype ReasonType = 'lost' | 'damaged' | null;\r\n\r\nfunction ReplacementContent() {\r\n    const router = useRouter();\r\n    const searchParams = useSearchParams();\r\n    const certId = searchParams.get('certId');\r\n\r\n    const [isDark, setIsDark] = useState(false);\r\n    const [step, setStep] = useState<'reason' | 'upload' | 'confirm' | 'submitted'>('reason');\r\n    const [reason, setReason] = useState<ReasonType>(null);\r\n    const [policeReport, setPoliceReport] = useState<File | null>(null);\r\n    const [damagedCert, setDamagedCert] = useState<File | null>(null);\r\n    const [certificate, setCertificate] = useState<any>(null);\r\n    const [submitting, setSubmitting] = useState(false);\r\n\r\n    useEffect(() => { setIsDark(localStorage.getItem(\"theme\") === \"dark\"); if (certId) loadCertificate(); }, [certId]);\r\n\r\n    const loadCertificate = async () => { if (!certId) return; const result = await api.get<any>(`/certificates/${certId}`); if (result.success && result.data?.data) setCertificate(result.data.data); };\r\n\r\n    const handleSubmit = async () => {\r\n        setSubmitting(true);\r\n        try {\r\n            const result = await api.post<any>('/api/applications', { serviceType: 'replacement', originalCertificateId: certId, data: { replacementReason: reason, applicantInfo: certificate?.applicantInfo } });\r\n            if (result.success && result.data?.data) setStep('submitted');\r\n        } catch { } finally { setSubmitting(false); }\r\n    };\r\n\r\n    const stepLabels = ['เน€เธฅเธทเธญเธเธชเธฒเน€เธซเธ•เธธ', 'เนเธเธเธซเธฅเธฑเธเธเธฒเธ', 'เธขเธทเธเธขเธฑเธ', 'เน€เธชเธฃเนเธเธชเธดเนเธ'];\r\n    const stepKeys = ['reason', 'upload', 'confirm', 'submitted'];\r\n    const stepIndex = stepKeys.indexOf(step);\r\n\r\n    return (\r\n        <div className={`min-h-screen p-6 font-sans ${isDark ? 'bg-slate-900' : 'bg-surface-100'}`}>\r\n            <div className=\"max-w-xl mx-auto\">\r\n                <button onClick={() => router.back()} className={`inline-flex items-center gap-2 px-4 py-2 rounded-lg border mb-6 ${isDark ? 'border-slate-700 text-slate-400' : 'border-surface-200 text-slate-600'}`}>โ เธขเนเธญเธเธเธฅเธฑเธ</button>\r\n                <h1 className={`text-2xl font-semibold mb-2 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธเธญเนเธเธฃเธฑเธเธฃเธญเธเนเธ—เธ</h1>\r\n                <p className={`text-sm mb-8 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธเธฃเธ“เธตเนเธเธฃเธฑเธเธฃเธญเธเธชเธนเธเธซเธฒเธขเธซเธฃเธทเธญเธ–เธนเธเธ—เธณเธฅเธฒเธข</p>\r\n\r\n                {/* Progress Steps */}\r\n                <div className=\"flex gap-2 mb-8\">\r\n                    {stepLabels.map((label, idx) => (\r\n                        <div key={label} className=\"flex-1 text-center\">\r\n                            <div className={`w-8 h-8 rounded-full mx-auto mb-2 flex items-center justify-center text-sm font-semibold ${idx < stepIndex ? 'bg-primary-600 text-white' : idx === stepIndex ? 'bg-blue-600 text-white' : isDark ? 'bg-slate-700 text-slate-400' : 'bg-surface-200 text-slate-500'}`}>{idx + 1}</div>\r\n                            <div className={`text-xs ${idx === stepIndex ? 'text-blue-600' : isDark ? 'text-slate-500' : 'text-slate-400'}`}>{label}</div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Step: Reason */}\r\n                {step === 'reason' && (\r\n                    <div className={`rounded-2xl p-6 border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                        <h3 className={`text-base font-semibold mb-4 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธชเธฒเน€เธซเธ•เธธเธ—เธตเนเธ•เนเธญเธเธเธญเนเธเธฃเธฑเธเธฃเธญเธเนเธ—เธ</h3>\r\n                        <div className=\"space-y-3 mb-6\">\r\n                            {[{ value: 'lost', label: 'เนเธเธฃเธฑเธเธฃเธญเธเธชเธนเธเธซเธฒเธข', desc: 'เธ•เนเธญเธเนเธเธเนเธเนเธเนเธเธเธงเธฒเธกเธเธฒเธเธชเธ–เธฒเธเธตเธ•เธณเธฃเธงเธ' }, { value: 'damaged', label: 'เนเธเธฃเธฑเธเธฃเธญเธเธ–เธนเธเธ—เธณเธฅเธฒเธขเธซเธฃเธทเธญเธฅเธเน€เธฅเธทเธญเธ', desc: 'เธ•เนเธญเธเนเธเธเนเธเธฃเธฑเธเธฃเธญเธเธ—เธตเนเธเธณเธฃเธธเธ”' }].map(opt => (\r\n                                <label key={opt.value} className={`block p-4 rounded-xl cursor-pointer ${reason === opt.value ? 'border-2 border-blue-600 bg-blue-50' : (isDark ? 'border border-slate-600' : 'border border-surface-200')}`}>\r\n                                    <input type=\"radio\" name=\"reason\" value={opt.value} checked={reason === opt.value} onChange={() => setReason(opt.value as ReasonType)} className=\"mr-3\" />\r\n                                    <span className={`font-medium ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>{opt.label}</span>\r\n                                    <p className={`text-sm mt-1 ml-7 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{opt.desc}</p>\r\n                                </label>\r\n                            ))}\r\n                        </div>\r\n                        <button onClick={() => setStep('upload')} disabled={!reason} className={`w-full py-3.5 rounded-xl text-sm font-semibold ${reason ? 'bg-gradient-to-br from-blue-600 to-blue-500 text-white shadow-lg shadow-blue-500/40' : 'bg-surface-200 text-slate-400 cursor-not-allowed'}`}>เธ–เธฑเธ”เนเธ โ’</button>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Step: Upload */}\r\n                {step === 'upload' && (\r\n                    <div className={`rounded-2xl p-6 border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                        <h3 className={`text-base font-semibold mb-4 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>{reason === 'lost' ? 'เนเธเธเนเธเนเธเนเธเธเธงเธฒเธก' : 'เนเธเธเนเธเธฃเธฑเธเธฃเธญเธเธ—เธตเนเธเธณเธฃเธธเธ”'}</h3>\r\n                        <label className={`flex flex-col items-center gap-3 p-8 rounded-xl border-2 border-dashed cursor-pointer mb-6 ${isDark ? 'border-slate-600' : 'border-surface-200'}`}>\r\n                            <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" className={isDark ? 'text-slate-400' : 'text-slate-500'}><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" /><polyline points=\"17 8 12 3 7 8\" /><line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\" /></svg>\r\n                            <span className={`text-sm ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{reason === 'lost' ? (policeReport ? policeReport.name : 'เธเธฅเธดเธเน€เธเธทเนเธญเธญเธฑเธเนเธซเธฅเธ”เนเธเนเธเนเธเธเธงเธฒเธก') : (damagedCert ? damagedCert.name : 'เธเธฅเธดเธเน€เธเธทเนเธญเธญเธฑเธเนเธซเธฅเธ”เนเธเธฃเธฑเธเธฃเธญเธเธ—เธตเนเธเธณเธฃเธธเธ”')}</span>\r\n                            <input type=\"file\" accept=\".pdf,.jpg,.jpeg,.png\" className=\"hidden\" onChange={(e) => { const file = e.target.files?.[0]; if (file) reason === 'lost' ? setPoliceReport(file) : setDamagedCert(file); }} />\r\n                        </label>\r\n                        <div className=\"flex gap-3\">\r\n                            <button onClick={() => setStep('reason')} className={`flex-1 py-3.5 rounded-xl text-sm font-medium border ${isDark ? 'border-slate-600 text-slate-400' : 'border-surface-200 text-slate-600'}`}>โ เธขเนเธญเธเธเธฅเธฑเธ</button>\r\n                            <button onClick={() => setStep('confirm')} disabled={reason === 'lost' ? !policeReport : !damagedCert} className={`flex-1 py-3.5 rounded-xl text-sm font-semibold ${(reason === 'lost' ? policeReport : damagedCert) ? 'bg-gradient-to-br from-blue-600 to-blue-500 text-white shadow-lg shadow-blue-500/40' : 'bg-surface-200 text-slate-400 cursor-not-allowed'}`}>เธ–เธฑเธ”เนเธ โ’</button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Step: Confirm */}\r\n                {step === 'confirm' && (\r\n                    <div className={`rounded-2xl p-6 border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                        <h3 className={`text-base font-semibold mb-4 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธขเธทเธเธขเธฑเธเธเนเธญเธกเธนเธฅ</h3>\r\n                        <div className=\"bg-secondary-50 border border-secondary-500 rounded-xl p-4 mb-6\"><p className=\"text-sm text-secondary-800\">เธซเธฅเธฑเธเธเธฒเธเธชเนเธเธเธณเธเธญ เธ—เธตเธกเธเธฒเธเธเธฐเธเธฃเธฐเน€เธกเธดเธเนเธฅเธฐเธชเนเธเนเธเน€เธชเธเธญเธฃเธฒเธเธฒเนเธซเนเธ—เนเธฒเธเธเนเธฒเธเธฃเธฐเธเธ</p></div>\r\n                        <table className=\"w-full text-sm mb-6\">\r\n                            <tbody>\r\n                                <tr><td className={`py-2 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เนเธเธฃเธฑเธเธฃเธญเธเน€เธ”เธดเธก:</td><td className={`py-2 font-medium ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>{certificate?.certificateNumber || '-'}</td></tr>\r\n                                <tr><td className={`py-2 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธชเธฒเน€เธซเธ•เธธ:</td><td className={`py-2 font-medium ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>{reason === 'lost' ? 'เนเธเธฃเธฑเธเธฃเธญเธเธชเธนเธเธซเธฒเธข' : 'เนเธเธฃเธฑเธเธฃเธญเธเธ–เธนเธเธ—เธณเธฅเธฒเธข/เธฅเธเน€เธฅเธทเธญเธ'}</td></tr>\r\n                                <tr><td className={`py-2 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธซเธฅเธฑเธเธเธฒเธ:</td><td className={`py-2 font-medium ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>{reason === 'lost' ? policeReport?.name : damagedCert?.name}</td></tr>\r\n                            </tbody>\r\n                        </table>\r\n                        <div className=\"flex gap-3\">\r\n                            <button onClick={() => setStep('upload')} className={`flex-1 py-3.5 rounded-xl text-sm font-medium border ${isDark ? 'border-slate-600 text-slate-400' : 'border-surface-200 text-slate-600'}`}>โ เธขเนเธญเธเธเธฅเธฑเธ</button>\r\n                            <button onClick={handleSubmit} disabled={submitting} className={`flex-1 py-3.5 rounded-xl text-sm font-semibold bg-gradient-to-br from-blue-600 to-blue-500 text-white shadow-lg shadow-blue-500/40 ${submitting ? 'opacity-70' : ''}`}>{submitting ? 'เธเธณเธฅเธฑเธเธชเนเธ...' : 'เธชเนเธเธเธณเธเธญ'}</button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Step: Submitted */}\r\n                {step === 'submitted' && (\r\n                    <div className={`rounded-2xl p-8 border text-center ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                        <div className=\"w-16 h-16 rounded-full bg-primary-600 flex items-center justify-center mx-auto mb-4\"><svg width=\"28\" height=\"28\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"white\" strokeWidth=\"3\"><polyline points=\"20 6 9 17 4 12\" /></svg></div>\r\n                        <h3 className={`text-xl font-semibold mb-2 ${isDark ? 'text-surface-100' : 'text-slate-900'}`}>เธชเนเธเธเธณเธเธญเน€เธฃเธตเธขเธเธฃเนเธญเธข</h3>\r\n                        <p className={`text-sm mb-6 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธ—เธตเธกเธเธฒเธเธเธฐเธ•เธฃเธงเธเธชเธญเธเนเธฅเธฐเธชเนเธเนเธเน€เธชเธเธญเธฃเธฒเธเธฒเนเธซเนเธ—เนเธฒเธ<br />เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเนเธเธซเธเนเธฒ \"เธเธฒเธฃเน€เธเธดเธ\" เน€เธเธทเนเธญเธ”เธนเธชเธ–เธฒเธเธฐ</p>\r\n                        <div className=\"flex gap-3 justify-center\">\r\n                            <button onClick={() => router.push('/farmer/applications')} className={`px-6 py-3.5 rounded-xl text-sm font-medium border ${isDark ? 'border-slate-600 text-slate-400' : 'border-surface-200 text-slate-600'}`}>เธเธฅเธฑเธเธซเธเนเธฒเธเธณเธเธญ</button>\r\n                            <button onClick={() => router.push('/payments')} className=\"px-6 py-3.5 rounded-xl text-sm font-semibold bg-gradient-to-br from-blue-600 to-blue-500 text-white shadow-lg shadow-blue-500/40\">เนเธเธซเธเนเธฒเธเธฒเธฃเน€เธเธดเธ</button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction ReplacementLoadingFallback() {\r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center bg-surface-100\">\r\n            <div className=\"text-center\">\r\n                <div className=\"w-10 h-10 border-[3px] border-surface-200 border-t-blue-600 rounded-full animate-spin mx-auto mb-4\" />\r\n                <p className=\"text-slate-500 text-sm\">เธเธณเธฅเธฑเธเนเธซเธฅเธ”...</p>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default function ReplacementApplicationPage() { return <Suspense fallback={<ReplacementLoadingFallback />}><ReplacementContent /></Suspense>; }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\certificates\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'router'. Either include it or remove the dependency array.","line":28,"column":8,"nodeType":"ArrayExpression","endLine":28,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [router]","fix":{"range":[1215,1217],"text":"[router]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":137,"column":33,"nodeType":"JSXOpeningElement","endLine":137,"endColumn":170}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { apiClient as api } from \"@/lib/api\";\r\n\r\ninterface Certificate {\r\n    _id: string; certificateNumber: string; applicationId: string;\r\n    siteName: string; plantType: string; issuedDate: string; expiryDate: string;\r\n    status: 'ACTIVE' | 'EXPIRED' | 'SUSPENDED'; qrCode?: string;\r\n}\r\n\r\nexport default function CertificatesPage() {\r\n    const router = useRouter();\r\n    const [certificates, setCertificates] = useState<Certificate[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [viewCert, setViewCert] = useState<Certificate | null>(null);\r\n    const [showQR, setShowQR] = useState<Certificate | null>(null);\r\n    const [filter, setFilter] = useState<'ALL' | 'ACTIVE' | 'EXPIRED'>('ALL');\r\n    // Theme state is handled by Layout, just use system/css vars or simple dark mode classes if valid\r\n    // For specific dark mode in card, rely on standard dark: attributes\r\n\r\n    useEffect(() => {\r\n        const userData = localStorage.getItem(\"user\");\r\n        if (!userData) { router.push(\"/login\"); return; }\r\n        loadCertificates();\r\n    }, []);\r\n\r\n    const loadCertificates = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const result = await api.get<{ data: Certificate[] }>(\"/api/certificates/my\");\r\n            if (result.success && result.data?.data) setCertificates(result.data.data);\r\n            else setCertificates([]);\r\n        } catch { setCertificates([]); }\r\n        finally { setLoading(false); }\r\n    };\r\n\r\n    const formatDate = (d: string) => new Date(d).toLocaleDateString('th-TH', { year: 'numeric', month: 'long', day: 'numeric' });\r\n    const getDaysRemaining = (exp: string) => Math.ceil((new Date(exp).getTime() - Date.now()) / 86400000);\r\n\r\n    const filteredCerts = certificates.filter(c => filter === 'ALL' || c.status === filter);\r\n\r\n    return (\r\n        <div className=\"p-6 lg:p-10 pb-24 lg:pb-10 max-w-5xl mx-auto font-[Kanit] animate-fadeIn\">\r\n            <header className=\"flex justify-between items-center flex-wrap gap-4 mb-7\">\r\n                <div>\r\n                    <h1 className=\"text-2xl lg:text-3xl font-medium text-slate-900 dark:text-slate-100\">เนเธเธฃเธฑเธเธฃเธญเธ GACP</h1>\r\n                    <p className=\"text-sm text-slate-500 mt-1\">เนเธเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธเธเธฒเธฃเธเธฅเธนเธเนเธฅเธฐเน€เธเนเธเน€เธเธตเนเธขเธงเธเธทเธเธชเธกเธธเธเนเธเธฃ</p>\r\n                </div>\r\n                <div className=\"flex gap-1 p-1 rounded-xl bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700\">\r\n                    {(['ALL', 'ACTIVE', 'EXPIRED'] as const).map(f => (\r\n                        <button key={f} onClick={() => setFilter(f)} className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${filter === f ? 'bg-emerald-500 text-white' : 'text-slate-500 hover:bg-slate-50 dark:hover:bg-slate-700'}`}>\r\n                            {f === 'ALL' ? 'เธ—เธฑเนเธเธซเธกเธ”' : f === 'ACTIVE' ? 'เนเธเนเธเธฒเธเนเธ”เน' : 'เธซเธกเธ”เธญเธฒเธขเธธ'}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            </header>\r\n\r\n            {loading ? (\r\n                <div className=\"rounded-2xl p-16 text-center bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm\">\r\n                    <div className=\"w-10 h-10 border-3 border-emerald-500/30 border-t-emerald-500 rounded-full animate-spin mx-auto\" />\r\n                    <p className=\"mt-4 text-slate-500\">เธเธณเธฅเธฑเธเนเธซเธฅเธ”เนเธเธฃเธฑเธเธฃเธญเธ...</p>\r\n                </div>\r\n            ) : filteredCerts.length > 0 ? (\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5\">\r\n                    {filteredCerts.map(cert => {\r\n                        const daysLeft = getDaysRemaining(cert.expiryDate);\r\n                        const isActive = cert.status === 'ACTIVE';\r\n                        return (\r\n                            <div key={cert._id} className=\"rounded-2xl overflow-hidden bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow\">\r\n                                <div className={`p-6 text-white relative ${isActive ? 'bg-gradient-to-br from-emerald-600 to-emerald-400' : 'bg-gradient-to-br from-slate-500 to-slate-400'}`}>\r\n                                    <span className=\"absolute top-5 right-5 text-3xl opacity-20\">\r\n                                        <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><circle cx=\"12\" cy=\"8\" r=\"6\" /><path d=\"M15.477 12.89L17 22l-5-3-5 3 1.523-9.11\" /></svg>\r\n                                    </span>\r\n                                    <p className=\"text-xs opacity-80 mb-1\">เน€เธฅเธเธ—เธตเนเนเธเธฃเธฑเธเธฃเธญเธ</p>\r\n                                    <h3 className=\"text-xl font-semibold\">{cert.certificateNumber}</h3>\r\n                                </div>\r\n                                <div className=\"p-5\">\r\n                                    <p className=\"text-xs text-slate-500\">เธชเธ–เธฒเธเธ—เธตเน</p>\r\n                                    <p className=\"font-medium mb-4 text-slate-900 dark:text-slate-200\">{cert.siteName}</p>\r\n                                    <div className=\"grid grid-cols-2 gap-3 mb-4\">\r\n                                        <div><p className=\"text-xs text-slate-500\">เธเธฃเธฐเน€เธ เธ—เธเธทเธ</p><p className=\"text-sm font-medium text-slate-900 dark:text-slate-200\">{cert.plantType}</p></div>\r\n                                        <div>\r\n                                            <p className=\"text-xs text-slate-500\">เธชเธ–เธฒเธเธฐ</p>\r\n                                            <span className={`inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium ${isActive ? 'bg-emerald-100 text-emerald-700 dark:bg-emerald-500/20 dark:text-emerald-400' : 'bg-amber-100 text-amber-700 dark:bg-amber-500/20 dark:text-amber-400'}`}>\r\n                                                {isActive ? <><svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"3\" className=\"inline\"><polyline points=\"20 6 9 17 4 12\" /></svg> เนเธเนเธเธฒเธเนเธ”เน</> : 'เธซเธกเธ”เธญเธฒเธขเธธ'}\r\n                                            </span>\r\n                                        </div>\r\n                                        <div><p className=\"text-xs text-slate-500\">เธงเธฑเธเธ—เธตเนเธญเธญเธ</p><p className=\"text-sm text-slate-700 dark:text-slate-300\">{formatDate(cert.issuedDate)}</p></div>\r\n                                        <div>\r\n                                            <p className=\"text-xs text-slate-500\">เธงเธฑเธเธซเธกเธ”เธญเธฒเธขเธธ</p>\r\n                                            <p className={`text-sm ${daysLeft < 30 ? 'text-amber-500' : 'text-slate-700 dark:text-slate-300'}`}>{formatDate(cert.expiryDate)}</p>\r\n                                            {isActive && daysLeft <= 90 && <p className=\"text-xs text-amber-500\">(เน€เธซเธฅเธทเธญ {daysLeft} เธงเธฑเธ)</p>}\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex gap-2 pt-4 border-t border-slate-200 dark:border-slate-700\">\r\n                                        <button onClick={() => setViewCert(cert)} className=\"flex-1 py-2.5 rounded-lg text-sm flex items-center justify-center gap-1.5 bg-slate-100 text-slate-600 hover:bg-slate-200 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600\">เธ”เธน</button>\r\n                                        <button onClick={() => setShowQR(cert)} className=\"flex-1 py-2.5 rounded-lg text-sm flex items-center justify-center gap-1.5 bg-slate-100 text-slate-600 hover:bg-slate-200 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600\">QR</button>\r\n                                        <button className=\"px-4 py-2.5 rounded-lg bg-emerald-500 text-white text-sm hover:bg-emerald-600\">\r\n                                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" /><polyline points=\"7 10 12 15 17 10\" /><line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" /></svg>\r\n                                        </button>\r\n                                    </div>\r\n                                    {(daysLeft <= 90 || cert.status === 'EXPIRED') && (\r\n                                        <Link href={`/farmer/applications/renewal?certId=${cert._id}`} className={`flex items-center justify-center gap-2 mt-3 py-3 rounded-xl text-white text-sm font-semibold shadow-lg ${cert.status === 'EXPIRED' ? 'bg-gradient-to-br from-amber-500 to-amber-400 shadow-amber-500/30' : 'bg-gradient-to-br from-emerald-600 to-emerald-400 shadow-emerald-500/30'}`}>\r\n                                            {cert.status === 'EXPIRED' ? 'เธ•เนเธญเธชเธฑเธเธเธฒเน€เธฅเธข' : 'เธ•เนเธญเธชเธฑเธเธเธฒเธเนเธญเธเธซเธกเธ”เธญเธฒเธขเธธ'}\r\n                                        </Link>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            ) : (\r\n                <div className=\"rounded-2xl p-16 text-center bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm\">\r\n                    <div className=\"w-20 h-20 rounded-2xl flex items-center justify-center mx-auto mb-5 bg-emerald-50 dark:bg-emerald-500/15\">\r\n                        <svg width=\"40\" height=\"40\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#10B981\" strokeWidth=\"1.5\"><circle cx=\"12\" cy=\"8\" r=\"6\" /><path d=\"M15.477 12.89L17 22l-5-3-5 3 1.523-9.11\" /></svg>\r\n                    </div>\r\n                    <h3 className=\"text-lg font-medium mb-2 text-slate-900 dark:text-white\">เธขเธฑเธเนเธกเนเธกเธตเนเธเธฃเธฑเธเธฃเธญเธ</h3>\r\n                    <p className=\"text-sm text-slate-500 mb-5\">เน€เธกเธทเนเธญเธเธณเธเธญเนเธ”เนเธฃเธฑเธเธเธฒเธฃเธญเธเธธเธกเธฑเธ•เธด เนเธเธฃเธฑเธเธฃเธญเธเธเธฐเนเธชเธ”เธเธ—เธตเนเธเธตเน</p>\r\n                    <Link href=\"/farmer/applications/new\" className=\"inline-flex items-center gap-2 px-6 py-3 rounded-xl bg-gradient-to-br from-emerald-600 to-emerald-500 text-white font-medium shadow-lg shadow-emerald-500/30 hover:shadow-emerald-500/40 transition-shadow\">เธขเธทเนเธเธเธณเธเธญเนเธซเธกเน</Link>\r\n                </div>\r\n            )}\r\n\r\n            {/* View Certificate Modal */}\r\n            {viewCert && (\r\n                <div className=\"fixed inset-0 bg-black/70 z-[1000] flex items-center justify-center p-5\" onClick={() => setViewCert(null)}>\r\n                    <div className=\"w-full max-w-lg max-h-[90vh] overflow-auto bg-white rounded-2xl animate-scaleIn\" onClick={e => e.stopPropagation()}>\r\n                        <div className=\"flex justify-between items-center p-4 border-b border-slate-200\">\r\n                            <h3 className=\"text-lg font-semibold text-slate-900\">เนเธเธฃเธฑเธเธฃเธญเธ GACP</h3>\r\n                            <button onClick={() => setViewCert(null)} className=\"px-4 py-2 rounded-lg bg-red-500 text-white text-sm hover:bg-red-600\">เธเธดเธ”</button>\r\n                        </div>\r\n                        <div className=\"p-6 bg-slate-100\">\r\n                            <div className=\"bg-white border-2 border-emerald-500 rounded-xl p-8 text-center relative overflow-hidden\">\r\n                                <div className=\"absolute top-0 right-0 w-24 h-24 bg-emerald-100 rounded-bl-full opacity-50\"></div>\r\n                                <img src=\"/images/dtam-logo.png\" alt=\"DTAM\" className=\"w-16 h-16 mx-auto mb-4\" onError={e => (e.currentTarget.style.display = 'none')} />\r\n                                <h2 className=\"text-2xl font-bold text-emerald-600 mb-1\">เนเธเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP</h2>\r\n                                <p className=\"text-xs text-slate-500 mb-5\">Good Agricultural and Collection Practices</p>\r\n                                <div className=\"border-t border-b border-dashed border-slate-300 py-5 my-5\">\r\n                                    <p className=\"text-sm text-slate-600 mb-2\">เน€เธฅเธเธ—เธตเนเนเธเธฃเธฑเธเธฃเธญเธ</p>\r\n                                    <p className=\"text-2xl font-bold text-slate-900\">{viewCert.certificateNumber}</p>\r\n                                </div>\r\n                                <p className=\"text-sm text-slate-600 mb-1\">เธญเธญเธเนเธซเนเนเธเน</p>\r\n                                <p className=\"text-lg font-semibold text-slate-900 mb-4\">{viewCert.siteName}</p>\r\n                                <p className=\"text-sm text-slate-500\">เธเธฃเธฐเน€เธ เธ—เธเธทเธ: {viewCert.plantType}</p>\r\n                                <p className=\"text-sm text-slate-500 mt-2\">เธกเธตเธเธฅเธ•เธฑเนเธเนเธ•เน {formatDate(viewCert.issuedDate)} เธ–เธถเธ {formatDate(viewCert.expiryDate)}</p>\r\n                                <div className=\"mt-6 pt-5 border-t border-slate-200\">\r\n                                    <p className=\"text-xs text-slate-400\">เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</p>\r\n                                    <p className=\"text-xs text-slate-400\">เธเธฃเธฐเธ—เธฃเธงเธเธชเธฒเธเธฒเธฃเธ“เธชเธธเธ</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"flex gap-3 p-4 border-t border-slate-200\">\r\n                            <button\r\n                                onClick={() => window.open(`/api/certificates/${viewCert._id}/download`, '_blank')}\r\n                                className=\"flex-1 py-3 rounded-xl border border-emerald-500 text-emerald-500 font-medium flex items-center justify-center gap-1.5 hover:bg-emerald-50\">\r\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><polyline points=\"6 9 6 2 18 2 18 9\" /><path d=\"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2\" /><rect x=\"6\" y=\"14\" width=\"12\" height=\"8\" /></svg>\r\n                                เธเธดเธกเธเน\r\n                            </button>\r\n                            <button\r\n                                onClick={async () => {\r\n                                    try {\r\n                                        const res = await api.getBlob(`/api/certificates/${viewCert._id}/download`);\r\n                                        if (res) {\r\n                                            const url = window.URL.createObjectURL(res);\r\n                                            const a = document.createElement('a');\r\n                                            a.href = url;\r\n                                            a.download = `GACP-${viewCert.certificateNumber}.pdf`;\r\n                                            document.body.appendChild(a);\r\n                                            a.click();\r\n                                            window.URL.revokeObjectURL(url);\r\n                                            document.body.removeChild(a);\r\n                                        }\r\n                                    } catch (e) {\r\n                                        console.error(\"Download failed\", e);\r\n                                        alert(\"เธ”เธฒเธงเธเนเนเธซเธฅเธ”เนเธกเนเธชเธณเน€เธฃเนเธ\");\r\n                                    }\r\n                                }}\r\n                                className=\"flex-1 py-3 rounded-xl bg-emerald-500 text-white font-medium flex items-center justify-center gap-1.5 hover:bg-emerald-600\">\r\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" /><polyline points=\"7 10 12 15 17 10\" /><line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" /></svg>\r\n                                เธ”เธฒเธงเธเนเนเธซเธฅเธ” PDF\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* QR Modal */}\r\n            {showQR && (\r\n                <div className=\"fixed inset-0 bg-black/70 z-[1000] flex items-center justify-center p-5\" onClick={() => setShowQR(null)}>\r\n                    <div className=\"w-full max-w-sm bg-white rounded-2xl p-8 text-center animate-scaleIn\" onClick={e => e.stopPropagation()}>\r\n                        <h3 className=\"text-lg font-semibold text-slate-900 mb-5\">QR Code เธ•เธฃเธงเธเธชเธญเธ</h3>\r\n                        <div className=\"w-48 h-48 mx-auto mb-5 bg-slate-100 rounded-xl flex items-center justify-center\">\r\n                            <div className=\"w-40 h-40\" style={{ background: `url('https://api.qrserver.com/v1/create-qr-code/?size=160x160&data=https://gacp.dtam.go.th/verify/${showQR.certificateNumber}')`, backgroundSize: 'cover' }} />\r\n                        </div>\r\n                        <p className=\"text-sm text-slate-500 mb-2\">เธชเนเธเธเน€เธเธทเนเธญเธ•เธฃเธงเธเธชเธญเธเนเธเธฃเธฑเธเธฃเธญเธ</p>\r\n                        <p className=\"font-semibold text-slate-900\">{showQR.certificateNumber}</p>\r\n                        <button onClick={() => setShowQR(null)} className=\"mt-6 px-8 py-3 rounded-xl bg-emerald-500 text-white font-medium hover:bg-emerald-600\">เธเธดเธ”</button>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\dashboard\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":88,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":91,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1239,1242],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1239,1242],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":108,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":111,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4002,4005],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4002,4005],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":80,"column":97,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":80,"endColumn":100,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4528,4531],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4528,4531],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { ApplicationService, Application, Certificate } from \"@/lib/services/application-service\";\r\nimport { AuthService } from \"@/lib/services/auth-service\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { IconLeaf, IconDocument, IconCheckCircle, IconClock, IconSearch, IconWarning, IconReceipt, IconLock, Icons } from \"@/components/ui/icons\";\r\nimport { useLanguage } from \"@/lib/i18n/LanguageContext\";\r\n\r\ninterface User {\r\n    id: string;\r\n    firstName?: string;\r\n    lastName?: string;\r\n    companyName?: string;\r\n    accountType?: string;\r\n    verificationStatus?: string;\r\n}\r\n\r\nexport default function DashboardPage() {\r\n    const router = useRouter();\r\n    const { dict, language } = useLanguage();\r\n    const [user, setUser] = useState<User | null>(null);\r\n    const [applications, setApplications] = useState<Application[]>([]);\r\n    const [certificates, setCertificates] = useState<Certificate[]>([]);\r\n    const [stats, setStats] = useState({ total: 0, active: 0, certified: 0 });\r\n    const [isLoading, setIsLoading] = useState(true);\r\n\r\n    const STATUS_MAP: Record<string, { label: string; color: string; bg: string; icon: any }> = {\r\n        DRAFT: { label: dict.dashboard.status.draft, color: \"text-slate-600\", bg: \"bg-slate-100\", icon: IconDocument },\r\n        SUBMITTED: { label: dict.dashboard.status.submitted, color: \"text-blue-600\", bg: \"bg-blue-50\", icon: IconClock },\r\n        PAYMENT_1_PENDING: { label: dict.dashboard.status.payment1Pending, color: \"text-amber-600\", bg: \"bg-amber-50\", icon: IconReceipt },\r\n        PAID_PHASE_1: { label: dict.dashboard.status.paidPhase1, color: \"text-emerald-600\", bg: \"bg-emerald-50\", icon: IconCheckCircle },\r\n        PAYMENT_2_PENDING: { label: dict.dashboard.status.payment2Pending, color: \"text-pink-600\", bg: \"bg-pink-50\", icon: IconReceipt },\r\n        PAID_PHASE_2: { label: dict.dashboard.status.paidPhase2, color: \"text-emerald-600\", bg: \"bg-emerald-50\", icon: IconCheckCircle },\r\n        REVISION_REQUIRED: { label: dict.dashboard.status.revision, color: \"text-red-600\", bg: \"bg-red-50\", icon: IconWarning },\r\n        DOCUMENT_APPROVED: { label: dict.dashboard.status.docApproved, color: \"text-indigo-600\", bg: \"bg-indigo-50\", icon: IconCheckCircle },\r\n        PENDING_AUDIT: { label: dict.dashboard.status.pendingAudit, color: \"text-purple-600\", bg: \"bg-purple-50\", icon: IconSearch },\r\n        APPROVED: { label: dict.dashboard.status.approved, color: \"text-green-600\", bg: \"bg-green-50\", icon: IconCheckCircle },\r\n    };\r\n\r\n    useEffect(() => {\r\n        const sessionUser = AuthService.getUser();\r\n        if (!sessionUser) { router.push(\"/login\"); return; }\r\n        setUser(sessionUser);\r\n\r\n        const loadData = async () => {\r\n            try {\r\n                setIsLoading(true);\r\n                // Fetch fresh profile\r\n                try {\r\n                    const profileRes = await fetch(`${process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000/api'}/auth-farmer/me`, {\r\n                        headers: { 'Authorization': `Bearer ${AuthService.getToken()}` },\r\n                        cache: 'no-store'\r\n                    });\r\n                    if (profileRes.ok) {\r\n                        const profileData = await profileRes.json();\r\n                        const freshUser = profileData.data.user || profileData.data;\r\n                        setUser(freshUser);\r\n                        AuthService.updateUser(freshUser);\r\n                    }\r\n                } catch (err) { console.warn('Profile refresh failed', err); }\r\n\r\n                const [appRes, certRes] = await Promise.all([\r\n                    ApplicationService.getMyApplications(),\r\n                    ApplicationService.getMyCertificates()\r\n                ]);\r\n\r\n                if (appRes.success && appRes.data) {\r\n                    const apps: Application[] = Array.isArray(appRes.data) ? appRes.data : (appRes.data as any).data || [];\r\n                    setApplications(apps);\r\n                    setStats({\r\n                        total: apps.length,\r\n                        active: apps.filter(a => !['APPROVED', 'REJECTED'].includes(a.status)).length,\r\n                        certified: apps.filter(a => a.status === 'APPROVED').length\r\n                    });\r\n                }\r\n\r\n                if (certRes.success && certRes.data) {\r\n                    const certs = Array.isArray(certRes.data) ? certRes.data : (certRes.data as any).data || [];\r\n                    setCertificates(certs);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"Dashboard Load Error\", error);\r\n            } finally {\r\n                setIsLoading(false);\r\n            }\r\n        };\r\n        loadData();\r\n    }, [router]);\r\n\r\n    const getGreeting = () => {\r\n        const h = new Date().getHours();\r\n        if (h < 12) return dict.dashboard.welcome.morning;\r\n        if (h < 17) return dict.dashboard.welcome.afternoon;\r\n        return dict.dashboard.welcome.evening;\r\n    };\r\n\r\n    if (!user || isLoading) {\r\n        return (\r\n            <div className=\"flex flex-col items-center justify-center min-h-[60vh]\">\r\n                <div className=\"w-16 h-16 border-4 border-primary/20 border-t-primary rounded-full animate-spin mb-4\"></div>\r\n                <p className=\"text-slate-400 font-medium animate-pulse\">{dict.common?.loading || 'เธเธณเธฅเธฑเธเนเธซเธฅเธ”...'}</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const latestApp = applications[0];\r\n\r\n    return (\r\n        <div className=\"space-y-10 animate-fade-in\">\r\n            {/* 0. Verification Banner */}\r\n            {user.verificationStatus !== 'APPROVED' && (\r\n                <div className=\"gacp-card bg-gradient-to-r from-warning-bg to-white border-warning/20 overflow-visible\">\r\n                    <div className=\"flex flex-col md:flex-row items-center justify-between gap-6\">\r\n                        <div className=\"flex items-center gap-5\">\r\n                            <div className=\"w-14 h-14 rounded-2xl bg-warning-bg flex items-center justify-center shadow-inner\">\r\n                                <IconWarning className=\"w-8 h-8 text-warning\" />\r\n                            </div>\r\n                            <div>\r\n                                <h3 className=\"text-xl font-black text-warning-text leading-tight\">{dict.dashboard.identity.title}</h3>\r\n                                <p className=\"text-slate-600 mt-1 max-w-xl\">{dict.dashboard.identity.desc}</p>\r\n                            </div>\r\n                        </div>\r\n                        <Link href=\"/verify-identity\" className=\"gacp-btn-primary bg-gradient-to-r from-warning to-orange-600 shadow-warning/20 whitespace-nowrap\">\r\n                            {dict.dashboard.identity.button}\r\n                        </Link>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* 1. Hero & Stats Section */}\r\n            <div className=\"grid lg:grid-cols-4 gap-8\">\r\n                {/* Hero Card */}\r\n                <div className=\"lg:col-span-3 gacp-card bg-gradient-to-br from-primary to-primary-800 text-white border-0 shadow-elevated p-0 overflow-hidden min-h-[220px]\">\r\n                    <div className=\"absolute top-0 right-0 w-[40%] h-full bg-gradient-to-l from-white/10 to-transparent\"></div>\r\n                    <div className=\"absolute -bottom-20 -right-20 w-64 h-64 bg-white/5 rounded-full blur-3xl\"></div>\r\n\r\n                    <div className=\"h-full p-8 flex flex-col justify-between relative z-10\">\r\n                        <div>\r\n                            <div className=\"flex items-center gap-2 mb-3\">\r\n                                <div className=\"w-2 h-2 rounded-full bg-emerald-400 animate-pulse\"></div>\r\n                                <span className=\"text-emerald-100/80 text-sm font-medium tracking-widest uppercase\">{getGreeting()}</span>\r\n                            </div>\r\n                            <h1 className=\"text-4xl lg:text-5xl font-black text-white leading-tight\">\r\n                                {user.firstName} <span className=\"text-emerald-300\">{user.lastName}</span>\r\n                            </h1>\r\n                            <p className=\"text-emerald-100 font-medium mt-2\">{user.companyName || 'เธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธเน€เธเธฉเธ•เธฃเธเธฃเนเธ—เธข'}</p>\r\n                        </div>\r\n\r\n                        <div className=\"flex flex-wrap items-center gap-4 mt-6\">\r\n                            {user.verificationStatus === 'APPROVED' ? (\r\n                                <Link href=\"/farmer/applications/new\" className=\"gacp-btn-primary bg-white text-primary hover:bg-emerald-50 shadow-white/10 border-0 px-8\">\r\n                                    <IconLeaf className=\"w-5 h-5\" />\r\n                                    {dict.dashboard.hero.newApp}\r\n                                </Link>\r\n                            ) : (\r\n                                <button className=\"gacp-btn-secondary bg-white/10 border-white/20 text-white cursor-not-allowed px-8\">\r\n                                    <IconLock className=\"w-5 h-5 mr-2 opacity-50\" />\r\n                                    {dict.dashboard.hero.verifyToStart}\r\n                                </button>\r\n                            )}\r\n                            <div className=\"flex -space-x-3 overflow-hidden ml-2 items-center\">\r\n                                <div className=\"inline-block h-8 w-8 rounded-full ring-2 ring-primary bg-emerald-500 overflow-hidden flex items-center justify-center text-[10px] font-bold\">DT</div>\r\n                                <div className=\"inline-block h-8 w-8 rounded-full ring-2 ring-primary bg-emerald-600 overflow-hidden flex items-center justify-center text-[10px] font-bold\">AM</div>\r\n                                <span className=\"ml-4 text-xs text-emerald-100/60 font-medium\">Verified by Department</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Vertical Stat Cards */}\r\n                <div className=\"flex flex-col gap-4\">\r\n                    <div className=\"flex-1 gacp-card p-6 flex flex-col justify-between group hover:bg-primary-50\">\r\n                        <span className=\"text-xs font-black text-slate-400 uppercase tracking-widest\">{dict.dashboard.stats.total}</span>\r\n                        <div className=\"flex items-end justify-between\">\r\n                            <span className=\"text-4xl font-black text-slate-800\">{stats.total}</span>\r\n                            <div className=\"p-2 rounded-xl bg-slate-50 text-slate-400 group-hover:bg-white group-hover:text-primary transition-colors\">\r\n                                <IconDocument className=\"w-6 h-6\" />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"flex-1 gacp-card p-6 flex flex-col justify-between group hover:bg-emerald-50\">\r\n                        <span className=\"text-xs font-black text-slate-400 uppercase tracking-widest\">{dict.dashboard.stats.certified}</span>\r\n                        <div className=\"flex items-end justify-between\">\r\n                            <span className=\"text-4xl font-black text-primary\">{stats.certified}</span>\r\n                            <div className=\"p-2 rounded-xl bg-primary-50 text-primary transition-colors\">\r\n                                <IconCheckCircle className=\"w-6 h-6\" />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* 2. Main Content Grid */}\r\n            <div className=\"grid lg:grid-cols-3 gap-10\">\r\n\r\n                {/* Left Column: Recent Activity & Alerts */}\r\n                <div className=\"lg:col-span-2 space-y-8\">\r\n\r\n                    {/* Critical Alerts */}\r\n                    {(latestApp?.status === 'PAYMENT_1_PENDING' || latestApp?.status === 'PAYMENT_2_PENDING') && (\r\n                        <div className=\"gacp-card bg-gradient-to-br from-rose-600 to-pink-700 text-white border-0 shadow-premium group\">\r\n                            <div className=\"flex flex-col md:flex-row items-center justify-between gap-6\">\r\n                                <div className=\"flex items-center gap-4\">\r\n                                    <div className=\"w-14 h-14 rounded-2xl bg-white/20 backdrop-blur-md flex items-center justify-center group-hover:rotate-12 transition-transform\">\r\n                                        <IconReceipt className=\"w-8 h-8\" />\r\n                                    </div>\r\n                                    <div>\r\n                                        <h3 className=\"text-xl font-black\">{dict.dashboard.alerts?.payment2?.title || 'เนเธเนเธเน€เธ•เธทเธญเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ'}</h3>\r\n                                        <p className=\"text-rose-100 text-sm mt-1\">{dict.dashboard.alerts?.payment2?.desc || 'เธเธฃเธธเธ“เธฒเธ”เธณเน€เธเธดเธเธเธฒเธฃเธเธณเธฃเธฐเธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธกเน€เธเธทเนเธญเธ”เธณเน€เธเธดเธเธเธฒเธฃเธ•เนเธญ'}</p>\r\n                                    </div>\r\n                                </div>\r\n                                <Link href=\"/farmer/payments\" className=\"gacp-btn-primary bg-white text-rose-600 border-0 hover:bg-rose-50 shadow-white/10 px-8\">\r\n                                    {dict.dashboard.alerts?.payment2?.button || 'เธเธณเธฃเธฐเน€เธเธดเธ'}\r\n                                </Link>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Active Application Status */}\r\n                    <div className=\"space-y-4\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <h2 className=\"text-2xl font-black text-slate-800 flex items-center gap-3\">\r\n                                <span className=\"w-2 h-8 bg-primary rounded-full\"></span>\r\n                                {dict.dashboard.headers.recent}\r\n                            </h2>\r\n                            {latestApp && (\r\n                                <Link href=\"/farmer/applications\" className=\"text-sm font-bold text-primary hover:underline\">\r\n                                    {dict.common?.viewAll || 'เธ”เธนเธ—เธฑเนเธเธซเธกเธ”'}\r\n                                </Link>\r\n                            )}\r\n                        </div>\r\n\r\n                        {latestApp ? (\r\n                            <div className=\"gacp-card p-0 group overflow-visible\">\r\n                                <div className=\"p-8 border-b border-slate-100 flex flex-wrap justify-between items-start gap-4\">\r\n                                    <div className=\"flex items-center gap-5\">\r\n                                        <div className={`w-14 h-14 rounded-2xl flex items-center justify-center shadow-inner ${STATUS_MAP[latestApp.status]?.bg}`}>\r\n                                            {(() => {\r\n                                                const StatusIcon = STATUS_MAP[latestApp.status]?.icon || IconDocument;\r\n                                                return <StatusIcon className={`w-8 h-8 ${STATUS_MAP[latestApp.status]?.color || 'text-slate-400'}`} />;\r\n                                            })()}\r\n                                        </div>\r\n                                        <div>\r\n                                            <div className=\"flex items-center gap-2 mb-1\">\r\n                                                <h3 className=\"text-xl font-bold text-slate-800 uppercase tracking-tight\">{dict.dashboard.appCard.title}</h3>\r\n                                                <span className=\"text-xs font-mono font-bold text-slate-400\">#{latestApp._id?.slice(-8).toUpperCase()}</span>\r\n                                            </div>\r\n                                            <div className=\"flex items-center gap-3\">\r\n                                                <span className={`gacp-badge ${STATUS_MAP[latestApp.status]?.bg} ${STATUS_MAP[latestApp.status]?.color}`}>\r\n                                                    {STATUS_MAP[latestApp.status]?.label || latestApp.status}\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex flex-col items-end\">\r\n                                        <span className=\"text-[10px] font-black uppercase text-slate-400 tracking-widest\">{dict.dashboard.appCard.lastUpdate}</span>\r\n                                        <span className=\"text-sm font-bold text-slate-700\">\r\n                                            {new Date(latestApp.updatedAt || latestApp.createdAt).toLocaleDateString(language === 'th' ? 'th-TH' : 'en-US', {\r\n                                                day: 'numeric', month: 'long', year: 'numeric'\r\n                                            })}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"p-8 bg-slate-50/50 flex flex-col md:flex-row items-center justify-between gap-6\">\r\n                                    <div className=\"flex items-center gap-8\">\r\n                                        <div className=\"flex flex-col\">\r\n                                            <span className=\"text-[10px] font-black uppercase text-slate-400 tracking-widest\">Type</span>\r\n                                            <span className=\"text-sm font-bold text-slate-600\">GACP Certification</span>\r\n                                        </div>\r\n                                        <div className=\"w-px h-8 bg-slate-200\"></div>\r\n                                        <div className=\"flex flex-col\">\r\n                                            <span className=\"text-[10px] font-black uppercase text-slate-400 tracking-widest\">Plants</span>\r\n                                            <span className=\"text-sm font-bold text-slate-600\">{latestApp.items?.length || 0} Species</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <Link\r\n                                        href={`/farmer/applications/new/step/${latestApp.status === 'PAYMENT_1_PENDING' || latestApp.status === 'PAYMENT_2_PENDING' ? '14' : '1'}`}\r\n                                        className=\"gacp-btn-primary px-10\"\r\n                                    >\r\n                                        {dict.dashboard.appCard.continue}\r\n                                        <Icons.ArrowRight className=\"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform\" />\r\n                                    </Link>\r\n                                </div>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"gacp-card py-20 bg-white border-dashed border-2 flex flex-col items-center justify-center text-center opacity-70\">\r\n                                <div className=\"w-20 h-20 rounded-full bg-slate-50 flex items-center justify-center mb-6\">\r\n                                    <IconDocument className=\"w-10 h-10 text-slate-200\" />\r\n                                </div>\r\n                                <h3 className=\"text-xl font-bold text-slate-800\">{dict.dashboard.empty.title}</h3>\r\n                                <p className=\"text-slate-500 max-w-xs mx-auto mt-2\">{dict.dashboard.empty.desc}</p>\r\n                                <Link href=\"/farmer/applications/new\" className=\"gacp-btn-secondary mt-8 border-slate-200 text-slate-600\">\r\n                                    {dict.common?.startNow || 'เน€เธฃเธดเนเธกเธชเนเธเนเธเธชเธกเธฑเธเธฃ'}\r\n                                </Link>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Right Column: Widgets */}\r\n                <div className=\"space-y-8\">\r\n\r\n                    {/* Certificates Widget */}\r\n                    <div className=\"space-y-4\">\r\n                        <h2 className=\"text-2xl font-black text-slate-800 flex items-center gap-3\">\r\n                            <span className=\"w-2 h-8 bg-indigo-500 rounded-full\"></span>\r\n                            {dict.dashboard.headers.certificates}\r\n                        </h2>\r\n\r\n                        {certificates.length === 0 ? (\r\n                            <div className=\"gacp-card py-10 flex flex-col items-center justify-center text-center opacity-60\">\r\n                                <IconCheckCircle className=\"w-12 h-12 text-slate-200 mb-4\" />\r\n                                <p className=\"text-slate-400 font-bold\">{dict.dashboard.empty.noCert}</p>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"space-y-4\">\r\n                                {certificates.map(cert => (\r\n                                    <div key={cert._id} className=\"gacp-card p-5 hover:border-indigo-100 group\">\r\n                                        <div className=\"flex justify-between items-start mb-4\">\r\n                                            <div className=\"p-2 rounded-xl bg-indigo-50 text-indigo-600\">\r\n                                                <IconDocument className=\"w-6 h-6\" />\r\n                                            </div>\r\n                                            <span className=\"text-[10px] font-black uppercase text-slate-400 group-hover:text-indigo-400 transition-colors\">#{cert.certificateNumber}</span>\r\n                                        </div>\r\n                                        <h4 className=\"text-lg font-black text-slate-800 leading-tight\">{cert.plantType || 'Herb Plant'}</h4>\r\n                                        <p className=\"text-xs text-slate-500 mt-1\">Exp: {new Date(cert.expiryDate).toLocaleDateString()}</p>\r\n                                        <button className=\"w-full mt-4 py-2 border border-slate-100 rounded-xl text-xs font-black text-indigo-600 uppercase tracking-widest hover:bg-indigo-50 hover:border-indigo-100 transition-all\">\r\n                                            {dict.dashboard.buttons.download}\r\n                                        </button>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Quick Menu */}\r\n                    <div className=\"space-y-4\">\r\n                        <h2 className=\"text-2xl font-black text-slate-800 tracking-tight\">{dict.dashboard.headers.quickMenu}</h2>\r\n                        <div className=\"grid gap-4\">\r\n                            {[\r\n                                { title: dict.dashboard.quickMenu.manual, desc: dict.dashboard.quickMenu.manualDesc, icon: IconDocument, color: 'text-blue-600', bg: 'bg-blue-50' },\r\n                                { title: dict.dashboard.quickMenu.report, desc: dict.dashboard.quickMenu.reportDesc, icon: IconWarning, color: 'text-amber-600', bg: 'bg-amber-50' }\r\n                            ].map((item, idx) => (\r\n                                <button key={idx} className=\"gacp-card p-4 flex items-center gap-4 hover:bg-slate-50 text-left border-0 shadow-soft group\">\r\n                                    <div className={`w-12 h-12 rounded-2xl ${item.bg} ${item.color} flex items-center justify-center group-hover:scale-110 transition-transform`}>\r\n                                        <item.icon className=\"w-6 h-6\" />\r\n                                    </div>\r\n                                    <div>\r\n                                        <h4 className=\"font-black text-slate-800 text-sm whitespace-nowrap\">{item.title}</h4>\r\n                                        <p className=\"text-slate-400 text-xs mt-0.5 font-medium\">{item.desc}</p>\r\n                                    </div>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\documents\\[id]\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadDocument' and 'router'. Either include them or remove the dependency array.","line":22,"column":210,"nodeType":"ArrayExpression","endLine":22,"endColumn":214,"suggestions":[{"desc":"Update the dependencies array to be: [id, loadDocument, router]","fix":{"range":[1039,1043],"text":"[id, loadDocument, router]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":99,"column":33,"nodeType":"JSXOpeningElement","endLine":99,"endColumn":113}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter, useParams } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { apiClient as api } from \"@/lib/api\";\r\n\r\ninterface DocumentInfo { _id: string; name: string; type: string; url: string; size: number; uploadedAt: string; applicationId: string; }\r\n\r\nexport default function DocumentViewerPage() {\r\n    const router = useRouter();\r\n    const params = useParams();\r\n    const id = params?.id as string;\r\n\r\n    const [document, setDocument] = useState<DocumentInfo | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [zoom, setZoom] = useState(100);\r\n    const [mounted, setMounted] = useState(false);\r\n    const [isDark, setIsDark] = useState(false);\r\n\r\n    useEffect(() => { setMounted(true); setIsDark(localStorage.getItem(\"theme\") === \"dark\"); const userData = localStorage.getItem(\"user\"); if (!userData) { router.push(\"/login\"); return; } loadDocument(); }, [id]);\r\n\r\n    const loadDocument = async () => {\r\n        if (!id) return;\r\n        setLoading(true);\r\n        setError(null);\r\n        try {\r\n            const result = await api.get<{ data: DocumentInfo }>(`/documents/${id}`);\r\n            if (result.success && result.data?.data) { setDocument(result.data.data); }\r\n            else { setDocument({ _id: id, name: \"เน€เธญเธเธชเธฒเธฃเธเธฃเธฐเธเธญเธเธเธณเธเธญ.pdf\", type: \"application/pdf\", url: \"/api/documents/\" + id, size: 1024 * 1024 * 2.5, uploadedAt: new Date().toISOString(), applicationId: \"app_12345\" }); }\r\n        } catch { setError(\"เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เนเธซเธฅเธ”เน€เธญเธเธชเธฒเธฃเนเธ”เน\"); }\r\n        finally { setLoading(false); }\r\n    };\r\n\r\n    const handleDownload = () => { if (!document) return; const link = window.document.createElement('a'); link.href = document.url; link.download = document.name; window.document.body.appendChild(link); link.click(); window.document.body.removeChild(link); };\r\n    const formatFileSize = (bytes: number) => bytes < 1024 ? bytes + \" B\" : bytes < 1024 * 1024 ? (bytes / 1024).toFixed(1) + \" KB\" : (bytes / (1024 * 1024)).toFixed(2) + \" MB\";\r\n\r\n    if (!mounted) return null;\r\n    const isPdf = document?.type === \"application/pdf\";\r\n    const isImage = document?.type?.startsWith(\"image/\");\r\n\r\n    return (\r\n        <div className={`min-h-screen font-sans ${isDark ? 'bg-slate-900 text-surface-100' : 'bg-surface-100 text-slate-900'}`}>\r\n            {/* Header */}\r\n            <header className={`sticky top-0 z-50 px-6 py-3 flex justify-between items-center border-b ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                <div className=\"flex items-center gap-4\">\r\n                    <Link href=\"/farmer/applications\" className={`flex items-center gap-2 text-sm ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>\r\n                        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><path d=\"M15 18l-6-6 6-6\" /></svg> เธเธฅเธฑเธ\r\n                    </Link>\r\n                    {document && (\r\n                        <div className={`pl-4 border-l ${isDark ? 'border-slate-700' : 'border-surface-200'}`}>\r\n                            <h1 className=\"text-base font-medium\">{document.name}</h1>\r\n                            <p className={`text-xs ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{formatFileSize(document.size)} โ€ข เธญเธฑเธเนเธซเธฅเธ”เน€เธกเธทเนเธญ {new Date(document.uploadedAt).toLocaleDateString('th-TH')}</p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n                {document && (\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className={`flex items-center gap-1 rounded-lg p-1 border ${isDark ? 'bg-slate-700 border-slate-600' : 'bg-white border-surface-200'}`}>\r\n                            <button onClick={() => setZoom(Math.max(50, zoom - 25))} className=\"w-8 h-8 rounded-lg flex items-center justify-center hover:bg-surface-100\">\r\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><circle cx=\"11\" cy=\"11\" r=\"8\" /><line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" /><line x1=\"8\" y1=\"11\" x2=\"14\" y2=\"11\" /></svg>\r\n                            </button>\r\n                            <span className={`text-xs min-w-[40px] text-center ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{zoom}%</span>\r\n                            <button onClick={() => setZoom(Math.min(200, zoom + 25))} className=\"w-8 h-8 rounded-lg flex items-center justify-center hover:bg-surface-100\">\r\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><circle cx=\"11\" cy=\"11\" r=\"8\" /><line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" /><line x1=\"11\" y1=\"8\" x2=\"11\" y2=\"14\" /><line x1=\"8\" y1=\"11\" x2=\"14\" y2=\"11\" /></svg>\r\n                            </button>\r\n                        </div>\r\n                        <button onClick={() => window.print()} className={`px-4 py-2 rounded-lg text-sm flex items-center gap-1.5 border ${isDark ? 'border-slate-600' : 'border-surface-200'}`}>\r\n                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><polyline points=\"6 9 6 2 18 2 18 9\" /><path d=\"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2\" /><rect x=\"6\" y=\"14\" width=\"12\" height=\"8\" /></svg>\r\n                            เธเธดเธกเธเน\r\n                        </button>\r\n                        <button onClick={handleDownload} className=\"px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-1.5 bg-primary-600 text-white\">\r\n                            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" /><polyline points=\"7 10 12 15 17 10\" /><line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" /></svg>\r\n                            เธ”เธฒเธงเธเนเนเธซเธฅเธ”\r\n                        </button>\r\n                    </div>\r\n                )}\r\n            </header>\r\n\r\n            {/* Content */}\r\n            <main className=\"p-6 flex justify-center\">\r\n                {loading ? (\r\n                    <div className=\"flex flex-col items-center justify-center h-[60vh]\">\r\n                        <div className={`w-10 h-10 border-[3px] rounded-full animate-spin ${isDark ? 'border-slate-700 border-t-primary-500' : 'border-surface-200 border-t-primary-600'}`} />\r\n                        <p className={`mt-4 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>เธเธณเธฅเธฑเธเนเธซเธฅเธ”เน€เธญเธเธชเธฒเธฃ...</p>\r\n                    </div>\r\n                ) : error ? (\r\n                    <div className={`rounded-2xl p-16 text-center border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                        <p className=\"text-red-500 font-medium\">{error}</p>\r\n                        <Link href=\"/applications\" className=\"inline-block mt-4 px-5 py-2.5 rounded-lg bg-primary-600 text-white\">เธเธฅเธฑเธ</Link>\r\n                    </div>\r\n                ) : document ? (\r\n                    <div className=\"w-full max-w-[900px] transition-transform\" style={{ transform: `scale(${zoom / 100})`, transformOrigin: \"top center\" }}>\r\n                        {isPdf ? (\r\n                            <iframe src={document.url} className={`w-full h-[80vh] rounded-xl border ${isDark ? 'border-slate-700' : 'border-surface-200'}`} style={{ background: '#FFF' }} />\r\n                        ) : isImage ? (\r\n                            <div className={`rounded-xl p-4 text-center border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                                <img src={document.url} alt={document.name} className=\"max-w-full rounded-lg\" />\r\n                            </div>\r\n                        ) : (\r\n                            <div className={`rounded-2xl p-16 text-center border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                                <div className={`mb-4 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>\r\n                                    <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1\"><path d=\"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z\" /><polyline points=\"13 2 13 9 20 9\" /></svg>\r\n                                </div>\r\n                                <h3 className=\"text-lg font-medium mb-2\">{document.name}</h3>\r\n                                <p className={`text-sm mb-5 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เนเธชเธ”เธเธ•เธฑเธงเธญเธขเนเธฒเธเนเธ”เน</p>\r\n                                <button onClick={handleDownload} className=\"px-6 py-3 rounded-xl bg-primary-600 text-white font-medium inline-flex items-center gap-2\">\r\n                                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" /><polyline points=\"7 10 12 15 17 10\" /><line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" /></svg>\r\n                                    เธ”เธฒเธงเธเนเนเธซเธฅเธ”เน€เธเธทเนเธญเธ”เธน\r\n                                </button>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                ) : null}\r\n            </main>\r\n\r\n            <style jsx global>{`@media print { header { display: none !important; } main { padding: 0 !important; } }`}</style>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\establishments\\new\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":8,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":17},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\establishments\\new\\page.tsx:16:9\n  14 |\n  15 |     useEffect(() => {\n> 16 |         setMounted(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  17 |         setIsDark(localStorage.getItem(\"theme\") === \"dark\");\n  18 |         const userData = localStorage.getItem(\"user\");\n  19 |         if (!userData) { window.location.href = \"/login\"; }","line":16,"column":9,"nodeType":null,"endLine":16,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\n\r\nexport default function NewEstablishmentPage() {\r\n    const router = useRouter();\r\n    const [mounted, setMounted] = useState(false);\r\n    const [isDark, setIsDark] = useState(false);\r\n    const [name, setName] = useState(\"\");\r\n    const [address, setAddress] = useState(\"\");\r\n    const [area, setArea] = useState(\"\");\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        setIsDark(localStorage.getItem(\"theme\") === \"dark\");\r\n        const userData = localStorage.getItem(\"user\");\r\n        if (!userData) { window.location.href = \"/login\"; }\r\n    }, []);\r\n\r\n    const handleSubmit = (e: React.FormEvent) => { e.preventDefault(); alert(\"เธเธตเน€เธเธญเธฃเนเธเธตเนเธเธฐเน€เธเธดเธ”เนเธซเนเธเธฃเธดเธเธฒเธฃเน€เธฃเนเธงเน เธเธตเน\"); };\r\n\r\n    if (!mounted) return <div className={`min-h-screen flex items-center justify-center ${isDark ? 'bg-slate-900' : 'bg-surface-100'}`}><div className=\"w-10 h-10 border-[3px] border-surface-200 border-t-primary-600 rounded-full animate-spin\" /></div>;\r\n\r\n    return (\r\n        <div className={`min-h-screen font-sans transition-all ${isDark ? 'bg-slate-900 text-surface-100' : 'bg-surface-100 text-slate-900'}`}>\r\n            {/* Header */}\r\n            <header className={`px-6 py-5 border-b ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                <div className=\"max-w-[700px] mx-auto flex items-center gap-4\">\r\n                    <Link href=\"/establishments\" className={`flex items-center ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>\r\n                        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><path d=\"M15 18L9 12L15 6\" /></svg>\r\n                    </Link>\r\n                    <h1 className=\"text-xl font-medium\">เน€เธเธดเนเธกเนเธเธฅเธเธเธฅเธนเธเนเธซเธกเน</h1>\r\n                </div>\r\n            </header>\r\n\r\n            {/* Form */}\r\n            <main className=\"max-w-[700px] mx-auto p-6\">\r\n                <div className={`rounded-2xl p-7 border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                    <form onSubmit={handleSubmit}>\r\n                        <div className=\"mb-5\">\r\n                            <label className={`text-sm font-medium block mb-2 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธเธทเนเธญเนเธเธฅเธเธเธฅเธนเธ</label>\r\n                            <input type=\"text\" placeholder=\"เนเธเธฅเธเธชเธกเธธเธเนเธเธฃเธเนเธฒเธเนเธซเธกเน\" value={name} onChange={(e) => setName(e.target.value)} className={`w-full px-4 py-3.5 rounded-xl text-[15px] outline-none border ${isDark ? 'bg-slate-700 border-slate-600 text-surface-100 focus:border-primary-500' : 'bg-white border-surface-200 text-slate-900 focus:border-primary-600'}`} required />\r\n                        </div>\r\n                        <div className=\"mb-5\">\r\n                            <label className={`text-sm font-medium block mb-2 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธ—เธตเนเธญเธขเธนเน</label>\r\n                            <textarea placeholder=\"123 เธซเธกเธนเน 4 เธ•.เธเธฒเธเธเธฒ เธญ.เน€เธกเธทเธญเธ เธ.เธชเธกเธธเธ—เธฃเธเธฃเธฒเธเธฒเธฃ\" value={address} onChange={(e) => setAddress(e.target.value)} className={`w-full px-4 py-3.5 rounded-xl text-[15px] outline-none border min-h-[100px] resize-y ${isDark ? 'bg-slate-700 border-slate-600 text-surface-100 focus:border-primary-500' : 'bg-white border-surface-200 text-slate-900 focus:border-primary-600'}`} required />\r\n                        </div>\r\n                        <div className=\"mb-7\">\r\n                            <label className={`text-sm font-medium block mb-2 ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>เธเธทเนเธเธ—เธตเน (เนเธฃเน)</label>\r\n                            <input type=\"number\" placeholder=\"10\" value={area} onChange={(e) => setArea(e.target.value)} className={`w-full px-4 py-3.5 rounded-xl text-[15px] outline-none border ${isDark ? 'bg-slate-700 border-slate-600 text-surface-100 focus:border-primary-500' : 'bg-white border-surface-200 text-slate-900 focus:border-primary-600'}`} required />\r\n                        </div>\r\n                        <button type=\"submit\" className=\"w-full py-4 bg-gradient-to-br from-primary-700 to-primary-500 text-white text-base font-semibold rounded-xl shadow-lg shadow-primary-500/40\">เธเธฑเธเธ—เธถเธเนเธเธฅเธเธเธฅเธนเธ</button>\r\n                    </form>\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\establishments\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\layout.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\layout.tsx:16:9\n  14 |\n  15 |     useEffect(() => {\n> 16 |         setIsDark(localStorage.getItem(\"theme\") === \"dark\");\n     |         ^^^^^^^^^ Avoid calling setState() directly within an effect\n  17 |\n  18 |         // Listen for theme changes\n  19 |         const handleStorage = () => {","line":16,"column":9,"nodeType":null,"endLine":16,"endColumn":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { BottomNav } from '@/components/ui';\r\nimport { Sidebar } from '@/components/ui/sidebar';\r\nimport { usePathname } from 'next/navigation';\r\n\r\nexport default function Layout({ children }: { children: React.ReactNode }) {\r\n    const [isDark, setIsDark] = useState(false);\r\n\r\n    const pathname = usePathname();\r\n    // Hide sidebar on the application wizard page\r\n    const isWizard = pathname?.startsWith('/farmer/applications/new');\r\n\r\n    useEffect(() => {\r\n        setIsDark(localStorage.getItem(\"theme\") === \"dark\");\r\n\r\n        // Listen for theme changes\r\n        const handleStorage = () => {\r\n            setIsDark(localStorage.getItem(\"theme\") === \"dark\");\r\n        };\r\n        window.addEventListener('storage', handleStorage);\r\n        return () => window.removeEventListener('storage', handleStorage);\r\n    }, []);\r\n\r\n    const toggleTheme = () => {\r\n        const newTheme = !isDark;\r\n        setIsDark(newTheme);\r\n        localStorage.setItem(\"theme\", newTheme ? \"dark\" : \"light\");\r\n    };\r\n\r\n    return (\r\n        <div className={`min-h-screen transition-all duration-500 selection:bg-primary/30 ${isDark ? 'bg-slate-950 text-slate-100' : 'bg-[#F8F9FA] text-slate-800'}`}>\r\n            {/* Background decorative elements */}\r\n            {!isWizard && (\r\n                <div className=\"fixed inset-0 overflow-hidden pointer-events-none z-0\">\r\n                    <div className={`absolute -top-[10%] -right-[5%] w-[40%] h-[40%] rounded-full blur-[120px] opacity-20 ${isDark ? 'bg-primary-900' : 'bg-primary-100'}`}></div>\r\n                    <div className={`absolute top-[40%] -left-[10%] w-[30%] h-[50%] rounded-full blur-[100px] opacity-10 ${isDark ? 'bg-indigo-900' : 'bg-blue-50'}`}></div>\r\n                </div>\r\n            )}\r\n\r\n            {!isWizard && <Sidebar isDark={isDark} toggleTheme={toggleTheme} />}\r\n\r\n            <main className={`relative z-10 transition-all duration-500 ${isWizard ? 'w-full' : 'lg:ml-28 px-4 lg:px-8'} pb-[72px] lg:pb-12 pt-4 lg:pt-8`}>\r\n                <div className=\"max-w-[1440px] mx-auto\">\r\n                    {children}\r\n                </div>\r\n            </main>\r\n\r\n            <BottomNav isDark={isDark} />\r\n        </div>\r\n    );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\notifications\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'router'. Either include it or remove the dependency array.","line":39,"column":8,"nodeType":"ArrayExpression","endLine":39,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [router]","fix":{"range":[1971,1973],"text":"[router]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { apiClient as api } from \"@/lib/api\";\r\n\r\ninterface Notification {\r\n    id: string;\r\n    _id?: string;\r\n    title: string;\r\n    message: string;\r\n    type: 'INFO' | 'SUCCESS' | 'WARNING' | 'DANGER';\r\n    read: boolean;\r\n    createdAt: string;\r\n    actionUrl?: string;\r\n    actionLabel?: string;\r\n}\r\n\r\nconst DEMO_NOTIFICATIONS: Notification[] = [\r\n    { id: \"1\", title: \"เธขเธดเธเธ”เธตเธ•เนเธญเธเธฃเธฑเธเธชเธนเนเธฃเธฐเธเธ GACP\", message: \"เธฃเธฐเธเธเธเธฃเนเธญเธกเนเธซเนเธเธฃเธดเธเธฒเธฃเนเธฅเนเธง เธเธธเธ“เธชเธฒเธกเธฒเธฃเธ–เน€เธฃเธดเนเธกเธขเธทเนเธเธเธณเธเธญเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธเนเธ”เนเน€เธฅเธข\", type: \"SUCCESS\", read: false, createdAt: new Date(Date.now() - 1000 * 60 * 30).toISOString(), actionUrl: \"/applications/new\", actionLabel: \"เธขเธทเนเธเธเธณเธเธญเนเธซเธกเน\" },\r\n    { id: \"2\", title: \"เน€เธญเธเธชเธฒเธฃเธ–เธนเธเธ•เธฃเธงเธเธชเธญเธเนเธฅเนเธง\", message: \"เธเธณเธเธญ #APP-2024-001 เธเนเธฒเธเธเธฒเธฃเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃเน€เธเธทเนเธญเธเธ•เนเธ เธเธฃเธธเธ“เธฒเธเธณเธฃเธฐเน€เธเธดเธเธเธงเธ”เธ—เธตเน 2\", type: \"INFO\", read: false, createdAt: new Date(Date.now() - 1000 * 60 * 60 * 2).toISOString(), actionUrl: \"/payments?app=APP-2024-001\", actionLabel: \"เธเธณเธฃเธฐเน€เธเธดเธ\" },\r\n    { id: \"3\", title: \"เธเธฑเธ”เธซเธกเธฒเธขเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธเธชเธ–เธฒเธเธ—เธตเน\", message: \"เน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธเธฐเน€เธเนเธฒเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธเธชเธ–เธฒเธเธ—เธตเนเนเธเธงเธฑเธเธ—เธตเน 20 เธ.เธ. 2567 เน€เธงเธฅเธฒ 10:00 เธ.\", type: \"WARNING\", read: true, createdAt: new Date(Date.now() - 1000 * 60 * 60 * 24).toISOString(), actionUrl: \"/tracking\", actionLabel: \"เธ”เธนเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”\" },\r\n];\r\n\r\nexport default function NotificationsPage() {\r\n    const router = useRouter();\r\n    const [notifications, setNotifications] = useState<Notification[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [mounted, setMounted] = useState(false);\r\n    const [isDark, setIsDark] = useState(false);\r\n    const [filter, setFilter] = useState<'ALL' | 'UNREAD'>('ALL');\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        setIsDark(localStorage.getItem(\"theme\") === \"dark\");\r\n        if (!localStorage.getItem(\"user\")) { router.push(\"/login\"); return; }\r\n        loadNotifications();\r\n    }, []);\r\n\r\n    const loadNotifications = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const result = await api.get<{ data: Notification[] }>(\"/api/notifications\");\r\n            if (result.success && result.data) {\r\n                setNotifications(result.data.data || []);\r\n            } else {\r\n                setNotifications(DEMO_NOTIFICATIONS);\r\n            }\r\n        } catch {\r\n            setNotifications(DEMO_NOTIFICATIONS);\r\n        }\r\n        finally { setLoading(false); }\r\n    };\r\n\r\n    const markAsRead = async (id: string) => {\r\n        try { await api.post(`/api/notifications/${id}/read`, {}); } catch { }\r\n        setNotifications(prev => prev.map(n => (n.id === id || n._id === id) ? { ...n, read: true } : n));\r\n    };\r\n\r\n    const markAllAsRead = async () => {\r\n        try { await api.post(\"/api/notifications/read-all\", {}); } catch { }\r\n        setNotifications(prev => prev.map(n => ({ ...n, read: true })));\r\n    };\r\n\r\n    const toggleTheme = () => { setIsDark(!isDark); localStorage.setItem(\"theme\", !isDark ? \"dark\" : \"light\"); };\r\n    const handleLogout = () => { localStorage.removeItem(\"user\"); window.location.href = \"/api/auth/logout\"; };\r\n\r\n    const formatTime = (date: string) => {\r\n        const diff = Date.now() - new Date(date).getTime();\r\n        const mins = Math.floor(diff / 60000), hours = Math.floor(diff / 3600000), days = Math.floor(diff / 86400000);\r\n        if (mins < 60) return `${mins} เธเธฒเธ—เธตเธ—เธตเนเนเธฅเนเธง`;\r\n        if (hours < 24) return `${hours} เธเธฑเนเธงเนเธกเธเธ—เธตเนเนเธฅเนเธง`;\r\n        if (days < 7) return `${days} เธงเธฑเธเธ—เธตเนเนเธฅเนเธง`;\r\n        return new Date(date).toLocaleDateString('th-TH', { day: 'numeric', month: 'short' });\r\n    };\r\n\r\n    const getTypeClasses = (type: string, read: boolean) => {\r\n        const base = read ? 'bg-white border-surface-200 dark:bg-slate-800 dark:border-slate-700' : '';\r\n        switch (type) {\r\n            case 'SUCCESS': return read ? base : 'bg-primary-50 border-primary-200 dark:bg-primary-500/15 dark:border-primary-500/30';\r\n            case 'WARNING': return read ? base : 'bg-secondary-50 border-secondary-300 dark:bg-secondary-500/15 dark:border-secondary-500/30';\r\n            case 'DANGER': return read ? base : 'bg-red-50 border-red-300 dark:bg-red-500/15 dark:border-red-500/30';\r\n            default: return read ? base : 'bg-blue-50 border-blue-200 dark:bg-blue-500/15 dark:border-blue-500/30';\r\n        }\r\n    };\r\n\r\n    const getIconBg = (type: string) => {\r\n        switch (type) {\r\n            case 'SUCCESS': return 'bg-primary-100 text-primary-600 dark:bg-primary-500/20 dark:text-primary-400';\r\n            case 'WARNING': return 'bg-secondary-100 text-secondary-600 dark:bg-secondary-500/20 dark:text-secondary-400';\r\n            case 'DANGER': return 'bg-red-100 text-red-600 dark:bg-red-500/20 dark:text-red-400';\r\n            default: return 'bg-blue-100 text-blue-600 dark:bg-blue-500/20 dark:text-blue-400';\r\n        }\r\n    };\r\n\r\n    const getDotColor = (type: string) => {\r\n        switch (type) {\r\n            case 'SUCCESS': return 'bg-primary-500';\r\n            case 'WARNING': return 'bg-secondary-500';\r\n            case 'DANGER': return 'bg-red-500';\r\n            default: return 'bg-blue-500';\r\n        }\r\n    };\r\n\r\n    if (!mounted) return null;\r\n\r\n    const unreadCount = notifications.filter(n => !n.read).length;\r\n    const filteredNotifications = filter === 'UNREAD' ? notifications.filter(n => !n.read) : notifications;\r\n\r\n    const navItems = [\r\n        { href: \"/farmer/dashboard\", label: \"เธซเธเนเธฒเธซเธฅเธฑเธ\" },\r\n        { href: \"/farmer/applications\", label: \"เธเธณเธเธญ\" },\r\n        { href: \"/farmer/certificates\", label: \"เนเธเธฃเธฑเธเธฃเธญเธ\" },\r\n        { href: \"/farmer/tracking\", label: \"เธ•เธดเธ”เธ•เธฒเธก\" },\r\n        { href: \"/farmer/payments\", label: \"เธเธฒเธฃเน€เธเธดเธ\" },\r\n        { href: \"/farmer/profile\", label: \"เนเธเธฃเนเธเธฅเน\" },\r\n        { href: \"/payments\", label: \"เธเธฒเธฃเน€เธเธดเธ\" },\r\n        { href: \"/profile\", label: \"เนเธเธฃเนเธเธฅเน\" },\r\n    ];\r\n\r\n    return (\r\n        <div className={`min-h-screen font-sans transition-colors ${isDark ? 'dark bg-slate-900 text-slate-100' : 'bg-surface-50 text-slate-900'}`}>\r\n            {/* Sidebar */}\r\n            <aside className={`hidden lg:flex fixed left-0 top-0 bottom-0 w-[72px] flex-col items-center py-5 border-r z-50 ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                <div className=\"w-11 h-11 rounded-2xl bg-gradient-to-br from-primary-600 to-primary-400 flex items-center justify-center text-xl font-semibold text-white mb-8\">G</div>\r\n                <nav className=\"flex-1 flex flex-col gap-1 w-full px-2\">\r\n                    {navItems.map(item => (\r\n                        <Link key={item.href} href={item.href} className={`flex flex-col items-center gap-1 py-2.5 rounded-xl transition-all hover:bg-slate-100 dark:hover:bg-slate-700`}>\r\n                            <span className=\"text-[10px] font-medium text-slate-500\">{item.label}</span>\r\n                        </Link>\r\n                    ))}\r\n                </nav>\r\n                <div className=\"flex flex-col gap-3\">\r\n                    <button onClick={toggleTheme} className={`w-10 h-10 rounded-xl flex items-center justify-center ${isDark ? 'bg-primary-500/15' : 'bg-primary-50'}`}>\r\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">{isDark ? <><circle cx=\"12\" cy=\"12\" r=\"5\" /><line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\" /></> : <path d=\"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z\" />}</svg>\r\n                    </button>\r\n                    <button onClick={handleLogout} className=\"w-10 h-10 rounded-xl flex items-center justify-center text-slate-500\">\r\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\" /><polyline points=\"16 17 21 12 16 7\" /><line x1=\"21\" y1=\"12\" x2=\"9\" y2=\"12\" /></svg>\r\n                    </button>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* Mobile Nav */}\r\n            <nav className={`lg:hidden fixed bottom-0 inset-x-0 h-[72px] flex justify-around items-center z-50 border-t ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-surface-200'}`}>\r\n                {navItems.slice(0, 5).map(item => (\r\n                    <Link key={item.href} href={item.href} className=\"flex flex-col items-center gap-1 py-2 px-3\">\r\n                        <span className=\"text-[10px] font-medium text-slate-500\">{item.label}</span>\r\n                    </Link>\r\n                ))}\r\n            </nav>\r\n\r\n            {/* Main Content */}\r\n            <main className=\"lg:ml-[72px] p-6 lg:p-10 pb-24 lg:pb-10 max-w-3xl\">\r\n                {/* Header */}\r\n                <header className=\"flex justify-between items-start flex-wrap gap-4 mb-7\">\r\n                    <div>\r\n                        <h1 className=\"text-2xl lg:text-3xl font-medium flex items-center gap-3\">\r\n                            เธเธฒเธฃเนเธเนเธเน€เธ•เธทเธญเธ\r\n                            {unreadCount > 0 && (\r\n                                <span className=\"px-3 py-1 rounded-full text-sm font-semibold bg-primary-500 text-white\">{unreadCount} เนเธซเธกเน</span>\r\n                            )}\r\n                        </h1>\r\n                        <p className=\"text-sm text-slate-500 mt-1\">เธเนเธญเธเธงเธฒเธกเนเธฅเธฐเธเธฒเธฃเธญเธฑเธเน€เธ”เธ•เธเธฒเธเธฃเธฐเธเธ</p>\r\n                    </div>\r\n                    {unreadCount > 0 && (\r\n                        <button onClick={markAllAsRead} className={`px-5 py-2.5 rounded-xl text-sm font-medium flex items-center gap-2 ${isDark ? 'bg-slate-700 text-slate-300' : 'bg-white border border-surface-200 text-slate-600'}`}>\r\n                            เธญเนเธฒเธเธ—เธฑเนเธเธซเธกเธ”\r\n                        </button>\r\n                    )}\r\n                </header>\r\n\r\n                {/* Filter Tabs */}\r\n                <div className=\"flex gap-2 mb-5\">\r\n                    {[{ key: 'ALL', label: 'เธ—เธฑเนเธเธซเธกเธ”', count: notifications.length }, { key: 'UNREAD', label: 'เธขเธฑเธเนเธกเนเธญเนเธฒเธ', count: unreadCount }].map(tab => (\r\n                        <button key={tab.key} onClick={() => setFilter(tab.key as 'ALL' | 'UNREAD')} className={`px-5 py-2.5 rounded-full text-sm font-medium flex items-center gap-2 transition-colors ${filter === tab.key ? 'bg-primary-500 text-white' : `${isDark ? 'bg-slate-700 text-slate-300' : 'bg-white border border-surface-200 text-slate-600'}`}`}>\r\n                            {tab.label}\r\n                            <span className={`px-2 py-0.5 rounded-full text-xs ${filter === tab.key ? 'bg-white/20 text-white' : 'bg-primary-100 text-primary-600'}`}>{tab.count}</span>\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Notifications List */}\r\n                {loading ? (\r\n                    <div className={`rounded-2xl p-16 text-center ${isDark ? 'bg-slate-800 border border-slate-700' : 'bg-white border border-surface-200'}`}>\r\n                        <div className=\"w-10 h-10 border-3 border-primary-500/30 border-t-primary-500 rounded-full animate-spin mx-auto\" />\r\n                        <p className=\"mt-4 text-slate-500\">เธเธณเธฅเธฑเธเนเธซเธฅเธ”...</p>\r\n                    </div>\r\n                ) : filteredNotifications.length > 0 ? (\r\n                    <div className=\"flex flex-col gap-3\">\r\n                        {filteredNotifications.map(n => (\r\n                            <div\r\n                                key={n.id || n._id}\r\n                                onClick={() => !n.read && markAsRead(n.id || n._id || '')}\r\n                                className={`rounded-2xl p-5 border transition-all relative ${n.read ? '' : 'cursor-pointer'} ${getTypeClasses(n.type, n.read)}`}\r\n                            >\r\n                                {!n.read && <div className={`absolute top-5 right-5 w-2.5 h-2.5 rounded-full ${getDotColor(n.type)}`} />}\r\n                                <div className=\"flex gap-4\">\r\n                                    <div className={`w-11 h-11 rounded-xl flex items-center justify-center flex-shrink-0 text-xl ${getIconBg(n.type)}`}>\r\n                                        {n.type === 'SUCCESS' ? <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\"><polyline points=\"20 6 9 17 4 12\" /></svg> : n.type === 'WARNING' ? '!' : n.type === 'DANGER' ? 'X' : 'i'}\r\n                                    </div>\r\n                                    <div className=\"flex-1 min-w-0\">\r\n                                        <div className=\"flex justify-between items-start gap-4\">\r\n                                            <h3 className=\"text-base font-medium\">{n.title}</h3>\r\n                                            <span className=\"text-xs text-slate-400 whitespace-nowrap\">{formatTime(n.createdAt)}</span>\r\n                                        </div>\r\n                                        <p className=\"text-sm text-slate-500 mt-1.5 leading-relaxed\">{n.message}</p>\r\n                                        {n.actionUrl && (\r\n                                            <Link href={n.actionUrl} onClick={e => e.stopPropagation()} className=\"inline-flex items-center gap-1.5 mt-3 px-4 py-2 rounded-lg bg-primary-500 text-white text-xs font-medium\">\r\n                                                {n.actionLabel || \"เธ”เธนเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”\"} โ’\r\n                                            </Link>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                ) : (\r\n                    <div className={`rounded-2xl p-16 text-center ${isDark ? 'bg-slate-800 border border-slate-700' : 'bg-white border border-surface-200'}`}>\r\n                        <div className={`w-20 h-20 rounded-2xl flex items-center justify-center mx-auto mb-5 ${isDark ? 'bg-primary-500/15' : 'bg-primary-50'}`}>\r\n                            <svg width=\"40\" height=\"40\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\"><path d=\"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9\" /><path d=\"M13.73 21a2 2 0 0 1-3.46 0\" /></svg>\r\n                        </div>\r\n                        <h3 className=\"text-lg font-medium mb-2\">{filter === 'UNREAD' ? \"เนเธกเนเธกเธตเธเธฒเธฃเนเธเนเธเน€เธ•เธทเธญเธเธ—เธตเนเธขเธฑเธเนเธกเนเธญเนเธฒเธ\" : \"เนเธกเนเธกเธตเธเธฒเธฃเนเธเนเธเน€เธ•เธทเธญเธ\"}</h3>\r\n                        <p className=\"text-sm text-slate-500\">เน€เธกเธทเนเธญเธกเธตเธเธฒเธฃเนเธเนเธเน€เธ•เธทเธญเธเนเธซเธกเน เธเธฐเนเธชเธ”เธเธ—เธตเนเธเธตเน</p>\r\n                    </div>\r\n                )}\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\payments\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'payQR' is assigned a value but never used.","line":37,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setPayQR' is assigned a value but never used.","line":37,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":71,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":71,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'filteredPayments' is assigned a value but never used.","line":87,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":87,"endColumn":27},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":150,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7046,7049],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7046,7049],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":237,"column":41,"nodeType":"JSXOpeningElement","endLine":237,"endColumn":116},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":280,"column":51,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[17106,17244],"text":"\r\n                                        เธเธฃเธธเธ“เธฒเธเธฅเธดเธ &quot;เธเธณเธฃเธฐเน€เธเธดเธ (Ksher)\" เน€เธเธทเนเธญเธ”เธณเน€เธเธดเธเธเธฒเธฃเธเนเธฒเธเธฃเธฐเธเธเธญเธญเธเนเธฅเธเน\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[17106,17244],"text":"\r\n                                        เธเธฃเธธเธ“เธฒเธเธฅเธดเธ &ldquo;เธเธณเธฃเธฐเน€เธเธดเธ (Ksher)\" เน€เธเธทเนเธญเธ”เธณเน€เธเธดเธเธเธฒเธฃเธเนเธฒเธเธฃเธฐเธเธเธญเธญเธเนเธฅเธเน\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[17106,17244],"text":"\r\n                                        เธเธฃเธธเธ“เธฒเธเธฅเธดเธ &#34;เธเธณเธฃเธฐเน€เธเธดเธ (Ksher)\" เน€เธเธทเนเธญเธ”เธณเน€เธเธดเธเธเธฒเธฃเธเนเธฒเธเธฃเธฐเธเธเธญเธญเธเนเธฅเธเน\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[17106,17244],"text":"\r\n                                        เธเธฃเธธเธ“เธฒเธเธฅเธดเธ &rdquo;เธเธณเธฃเธฐเน€เธเธดเธ (Ksher)\" เน€เธเธทเนเธญเธ”เธณเน€เธเธดเธเธเธฒเธฃเธเนเธฒเธเธฃเธฐเธเธเธญเธญเธเนเธฅเธเน\r\n                                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":280,"column":68,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[17106,17244],"text":"\r\n                                        เธเธฃเธธเธ“เธฒเธเธฅเธดเธ \"เธเธณเธฃเธฐเน€เธเธดเธ (Ksher)&quot; เน€เธเธทเนเธญเธ”เธณเน€เธเธดเธเธเธฒเธฃเธเนเธฒเธเธฃเธฐเธเธเธญเธญเธเนเธฅเธเน\r\n                                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[17106,17244],"text":"\r\n                                        เธเธฃเธธเธ“เธฒเธเธฅเธดเธ \"เธเธณเธฃเธฐเน€เธเธดเธ (Ksher)&ldquo; เน€เธเธทเนเธญเธ”เธณเน€เธเธดเธเธเธฒเธฃเธเนเธฒเธเธฃเธฐเธเธเธญเธญเธเนเธฅเธเน\r\n                                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[17106,17244],"text":"\r\n                                        เธเธฃเธธเธ“เธฒเธเธฅเธดเธ \"เธเธณเธฃเธฐเน€เธเธดเธ (Ksher)&#34; เน€เธเธทเนเธญเธ”เธณเน€เธเธดเธเธเธฒเธฃเธเนเธฒเธเธฃเธฐเธเธเธญเธญเธเนเธฅเธเน\r\n                                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[17106,17244],"text":"\r\n                                        เธเธฃเธธเธ“เธฒเธเธฅเธดเธ \"เธเธณเธฃเธฐเน€เธเธดเธ (Ksher)&rdquo; เน€เธเธทเนเธญเธ”เธณเน€เธเธดเธเธเธฒเธฃเธเนเธฒเธเธฃเธฐเธเธเธญเธญเธเนเธฅเธเน\r\n                                    "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { PaymentService, PaymentRecord } from \"@/lib/services/payment-service\";\r\nimport { AuthService } from \"@/lib/services/auth-service\";\r\nimport { IconDocument, IconClock, IconCheckCircle } from \"@/components/ui/icons\";\r\n\r\n// ... (Imports logic)\r\n\r\n// PaymentRecord interface is now imported, remove local definition if matching or update\r\n// The imported one has serviceType.\r\n// Local one: interface PaymentRecord { ... } -> Remove\r\n\r\nconst TYPE_CONFIG = {\r\n    QUOTATION: { label: \"เนเธเน€เธชเธเธญเธฃเธฒเธเธฒ\", color: \"blue\", desc: \"เน€เธญเธเธชเธฒเธฃเน€เธชเธเธญเธฃเธฒเธเธฒเธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธก\" },\r\n    INVOICE: { label: \"เนเธเนเธเนเธเธซเธเธตเน\", color: \"amber\", desc: \"เน€เธญเธเธชเธฒเธฃเน€เธฃเธตเธขเธเน€เธเนเธเน€เธเธดเธ\" },\r\n    RECEIPT: { label: \"เนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธ\", color: \"emerald\", desc: \"เธซเธฅเธฑเธเธเธฒเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ\" }\r\n};\r\n\r\nconst STATUS_LABELS: Record<string, { label: string; color: string }> = {\r\n    PENDING_APPROVAL: { label: \"เธฃเธญเธเธฒเธฃเธ•เธฃเธงเธเธชเธญเธ\", color: \"amber\" },\r\n    APPROVED: { label: \"เธเธณเธฃเธฐเนเธฅเนเธง\", color: \"emerald\" },\r\n    REJECTED: { label: \"เธ–เธนเธเธเธเธดเน€เธชเธ\", color: \"red\" },\r\n    PENDING: { label: \"เธฃเธญเธเธณเธฃเธฐเน€เธเธดเธ\", color: \"amber\" },\r\n    DELIVERED: { label: \"เธญเธญเธเน€เธญเธเธชเธฒเธฃเนเธฅเนเธง\", color: \"blue\" },\r\n    ISSUED: { label: \"เธญเธญเธเน€เธญเธเธชเธฒเธฃเนเธฅเนเธง\", color: \"blue\" },\r\n    CANCELLED: { label: \"เธขเธเน€เธฅเธดเธ\", color: \"red\" },\r\n};\r\n\r\nexport default function PaymentsPage() {\r\n    const router = useRouter();\r\n    const [payments, setPayments] = useState<PaymentRecord[]>([]);\r\n    const [filter, setFilter] = useState<\"ALL\" | \"PENDING\" | \"PAID\">(\"ALL\");\r\n    const [viewDoc, setViewDoc] = useState<PaymentRecord | null>(null);\r\n    const [payQR, setPayQR] = useState<PaymentRecord | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [uploading, setUploading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const user = AuthService.getUser();\r\n        if (!user) {\r\n            router.push(\"/login\");\r\n            return;\r\n        }\r\n        loadPayments();\r\n    }, [router]);\r\n\r\n    const loadPayments = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const data = await PaymentService.getMyPayments();\r\n            setPayments(data);\r\n        } catch { setPayments([]); }\r\n        finally { setLoading(false); }\r\n    };\r\n\r\n    const handleKsherPay = async (invoiceId: string) => {\r\n        if (!confirm(\"เธ•เนเธญเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธเธเนเธฒเธ Ksher Gateway เนเธเนเธซเธฃเธทเธญเนเธกเน?\")) return;\r\n        setUploading(true); // Re-use uploading state for \"Processing\"\r\n        try {\r\n            const res = await PaymentService.payWithKsher(invoiceId);\r\n            if (res.success && res.data?.payment_url) {\r\n                // Redirect to Ksher (Mock) Payment Page\r\n                window.location.href = res.data.payment_url;\r\n            } else {\r\n                alert('เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เน€เธฃเธดเนเธกเธฃเธฒเธขเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธเนเธ”เน' + (res.error ? ': ' + res.error : ''));\r\n                setUploading(false);\r\n            }\r\n        } catch (error) {\r\n            alert('เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเน€เธเธทเนเธญเธกเธ•เนเธญ');\r\n            setUploading(false);\r\n        }\r\n    };\r\n\r\n    const formatAmount = (n: number) => new Intl.NumberFormat('th-TH', { style: 'currency', currency: 'THB' }).format(n);\r\n\r\n    // Heuristic + ServiceType\r\n    const getFeeName = (p: PaymentRecord) => {\r\n        if (p.serviceType === 'APPLICATION_FEE') return \"เธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธกเธเธณเธเธญ (Fee 1)\";\r\n        if (p.serviceType === 'AUDIT_FEE') return \"เธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธกเธเธฒเธฃเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ (Fee 2)\";\r\n        if (p.amount <= 5000) return \"เธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธกเธเธณเธเธญ (Fee 1)\";\r\n        return \"เธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธกเธเธฒเธฃเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ (Fee 2)\";\r\n    };\r\n\r\n    const filteredPayments = payments.filter(p => {\r\n        if (filter === \"ALL\") return true;\r\n        if (filter === \"PENDING\") return p.status === \"PENDING\";\r\n        if (filter === \"PAID\") return p.status === \"APPROVED\" || p.type === \"RECEIPT\";\r\n        return true;\r\n    });\r\n\r\n    const displayedPayments = payments.filter(p => {\r\n        if (filter === \"ALL\") return true;\r\n        if (filter === \"PENDING\") return p.status === \"PENDING\" || p.status === \"PENDING_APPROVAL\";\r\n        if (filter === \"PAID\") return p.status === \"APPROVED\" || p.type === \"RECEIPT\" || p.status === \"PAID\"; // Added PAID\r\n        return true;\r\n    });\r\n\r\n    const pendingAmount = payments.filter(p => (p.status === \"PENDING\" || p.status === \"PENDING_APPROVAL\")).reduce((sum, p) => sum + p.amount, 0);\r\n    const paidAmount = payments.filter(p => p.status === \"APPROVED\" || p.type === \"RECEIPT\" || p.status === \"PAID\").reduce((sum, p) => sum + p.amount, 0);\r\n\r\n    const stats = [\r\n        { label: \"เธขเธญเธ”เธ—เธตเนเธ•เนเธญเธเธเธณเธฃเธฐ (Pending)\", value: formatAmount(pendingAmount), Icon: IconClock, color: \"bg-amber-500\" },\r\n        { label: \"เธเธณเธฃเธฐเนเธฅเนเธง (Paid)\", value: formatAmount(paidAmount), Icon: IconCheckCircle, color: \"bg-emerald-500\" },\r\n    ];\r\n\r\n    const getColorCls = (color: string, bg = false) => {\r\n        const map: Record<string, { bg: string; text: string }> = {\r\n            emerald: { bg: 'bg-emerald-100', text: 'text-emerald-600' },\r\n            amber: { bg: 'bg-amber-100', text: 'text-amber-600' },\r\n            blue: { bg: 'bg-blue-100', text: 'text-blue-600' },\r\n            red: { bg: 'bg-red-100', text: 'text-red-600' },\r\n            slate: { bg: 'bg-slate-100', text: 'text-slate-600' },\r\n        };\r\n        return bg ? map[color]?.bg || 'bg-slate-100' : map[color]?.text || 'text-slate-600';\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-6 lg:p-10 pb-24 lg:pb-10 max-w-5xl mx-auto font-[Kanit] animate-fadeIn\">\r\n            {/* Header */}\r\n            <header className=\"mb-8 border-b pb-6\">\r\n                <h1 className=\"text-2xl lg:text-3xl font-bold text-slate-800\">เธเธฒเธฃเธเธณเธฃเธฐเธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธก</h1>\r\n                <p className=\"text-slate-500 mt-1\">เธ•เธดเธ”เธ•เธฒเธกเธชเธ–เธฒเธเธฐเนเธฅเธฐเธเธณเธฃเธฐเธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธกเธเธฒเธฃเธฃเธฑเธเธฃเธญเธ GACP</p>\r\n            </header>\r\n\r\n            {/* Stats */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8\">\r\n                {stats.map((stat, i) => (\r\n                    <div key={i} className=\"p-6 rounded-2xl bg-white border border-slate-200 shadow-sm flex items-center justify-between\">\r\n                        <div>\r\n                            <p className=\"text-sm text-slate-500 font-medium mb-1\">{stat.label}</p>\r\n                            <p className=\"text-2xl font-bold text-slate-800\">{stat.value}</p>\r\n                        </div>\r\n                        <div className={`w-12 h-12 rounded-xl ${stat.color} flex items-center justify-center text-white shadow-lg shadow-black/5`}>\r\n                            <stat.Icon size={24} />\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Filter */}\r\n            <div className=\"flex gap-2 mb-6\">\r\n                {[\r\n                    { key: \"ALL\", label: \"เธฃเธฒเธขเธเธฒเธฃเธ—เธฑเนเธเธซเธกเธ”\" },\r\n                    { key: \"PENDING\", label: \"เธฃเธญเธเธณเธฃเธฐเน€เธเธดเธ\" },\r\n                    { key: \"PAID\", label: \"เธเธฃเธฐเธงเธฑเธ•เธดเธเธฒเธฃเธเธณเธฃเธฐ\" }\r\n                ].map(tab => (\r\n                    <button key={tab.key} onClick={() => setFilter(tab.key as any)}\r\n                        className={`px-5 py-2.5 rounded-xl text-sm font-semibold transition-all ${filter === tab.key\r\n                            ? 'bg-slate-800 text-white shadow-md'\r\n                            : 'bg-white text-slate-600 border border-slate-200 hover:bg-slate-50'\r\n                            }`}>\r\n                        {tab.label}\r\n                    </button>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Payment List */}\r\n            <div className=\"space-y-4\">\r\n                {loading ? (\r\n                    <div className=\"text-center py-12 bg-white rounded-2xl border border-slate-200\">\r\n                        <div className=\"w-8 h-8 border-2 border-slate-300 border-t-slate-800 rounded-full animate-spin mx-auto mb-3\"></div>\r\n                        <p className=\"text-slate-500 text-sm\">เธเธณเธฅเธฑเธเนเธซเธฅเธ”เธเนเธญเธกเธนเธฅ...</p>\r\n                    </div>\r\n                ) : displayedPayments.length > 0 ? (\r\n                    displayedPayments.map(p => {\r\n                        const typeCfg = TYPE_CONFIG[p.type];\r\n                        const statusCfg = STATUS_LABELS[p.status] || { label: p.status, color: 'slate' };\r\n                        const feeName = getFeeName(p);\r\n\r\n                        return (\r\n                            <div key={p.id} className=\"bg-white rounded-2xl border border-slate-200 p-5 flex flex-col md:flex-row md:items-center justify-between gap-4 shadow-sm hover:shadow-md transition-shadow\">\r\n                                <div className=\"flex items-start gap-4\">\r\n                                    <div className={`w-12 h-12 rounded-2xl flex items-center justify-center flex-shrink-0 ${getColorCls(typeCfg.color, true)}`}>\r\n                                        <IconDocument size={20} className={getColorCls(typeCfg.color)} />\r\n                                    </div>\r\n                                    <div>\r\n                                        <div className=\"flex items-center gap-2 mb-1\">\r\n                                            <span className={`px-2 py-0.5 rounded text-[10px] font-bold tracking-wider uppercase ${getColorCls(typeCfg.color, true)} ${getColorCls(typeCfg.color)}`}>\r\n                                                {typeCfg.label}\r\n                                            </span>\r\n                                            <span className={`px-2 py-0.5 rounded text-[10px] font-bold tracking-wider uppercase ${getColorCls(statusCfg.color, true)} ${getColorCls(statusCfg.color)}`}>\r\n                                                {statusCfg.label}\r\n                                            </span>\r\n                                            <span className=\"text-xs text-slate-400 font-mono\">#{p.documentNumber}</span>\r\n                                        </div>\r\n                                        <h3 className=\"font-bold text-slate-800 text-lg\">{feeName}</h3>\r\n                                        <p className=\"text-sm text-slate-500\">เธชเธณเธซเธฃเธฑเธเธเธณเธเธญ: <Link href={`/tracking?appId=${p.applicationId}`} className=\"text-emerald-600 hover:underline font-mono ml-1\">{p.applicationId?.substring(0, 8)}...</Link></p>\r\n                                        <p className=\"text-xs text-slate-400 mt-1\">เธงเธฑเธเธ—เธตเน: {new Date(p.createdAt).toLocaleDateString('th-TH')}</p>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"flex items-center justify-between md:justify-end gap-6 border-t md:border-t-0 pt-4 md:pt-0 pl-16 md:pl-0\">\r\n                                    <div className=\"text-right\">\r\n                                        <p className=\"text-xs text-slate-500 mb-0.5\">เธเธณเธเธงเธเน€เธเธดเธ</p>\r\n                                        <p className=\"text-lg font-bold text-slate-800\">{formatAmount(p.amount)}</p>\r\n                                    </div>\r\n                                    <div className=\"flex gap-2\">\r\n                                        <button onClick={() => setViewDoc(p)} className=\"px-4 py-2 rounded-xl bg-slate-100 text-slate-600 font-medium text-sm hover:bg-slate-200 transition-colors\">\r\n                                            เธ”เธนเน€เธญเธเธชเธฒเธฃ\r\n                                        </button>\r\n                                        {p.status === \"PENDING\" && (\r\n                                            <button onClick={() => handleKsherPay(p.id)} disabled={uploading} className=\"px-5 py-2 rounded-xl bg-purple-600 text-white font-medium text-sm shadow-lg shadow-purple-200 hover:bg-purple-700 hover:-translate-y-0.5 transition-all flex items-center gap-2\">\r\n                                                {uploading ? 'Processing...' : 'เธเธณเธฃเธฐเน€เธเธดเธ (Ksher)'}\r\n                                            </button>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })\r\n                ) : (\r\n                    <div className=\"text-center py-16 bg-white rounded-2xl border border-dashed border-slate-300\">\r\n                        <div className=\"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-400\">\r\n                            <IconDocument size={32} />\r\n                        </div>\r\n                        <h3 className=\"text-lg font-medium text-slate-900\">เนเธกเนเธเธเธฃเธฒเธขเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ</h3>\r\n                        <p className=\"text-slate-500 text-sm\">เธฃเธฒเธขเธเธฒเธฃเน€เธฃเธตเธขเธเน€เธเนเธเน€เธเธดเธเธซเธฃเธทเธญเนเธเน€เธชเธฃเนเธเธเธฐเนเธชเธ”เธเธ—เธตเนเธเธตเน</p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Modal - View Document */}\r\n            {viewDoc && (\r\n                <div className=\"fixed inset-0 bg-black/80 z-[100] flex items-center justify-center p-4 backdrop-blur-sm\" onClick={() => setViewDoc(null)}>\r\n                    <div className=\"bg-white w-full max-w-2xl rounded-2xl shadow-2xl overflow-hidden animate-scaleIn\" onClick={e => e.stopPropagation()}>\r\n                        <div className=\"flex justify-between items-center p-5 border-b\">\r\n                            <h3 className=\"font-bold text-lg text-slate-800\">{TYPE_CONFIG[viewDoc.type].label}</h3>\r\n                            <button onClick={() => setViewDoc(null)} className=\"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 hover:bg-slate-200\">โ•</button>\r\n                        </div>\r\n                        <div className=\"p-8 bg-slate-50 max-h-[70vh] overflow-auto\">\r\n                            <div className=\"bg-white border border-slate-200 shadow-sm p-8 min-h-[500px] relative\">\r\n                                <div className=\"flex justify-between items-start mb-8\">\r\n                                    <div className=\"flex gap-4\">\r\n                                        <img src=\"/images/dtam-logo.png\" className=\"w-16 h-16 opacity-90\" alt=\"\" />\r\n                                        <div>\r\n                                            <h4 className=\"font-bold text-slate-800 text-lg\">เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเธฏ</h4>\r\n                                            <p className=\"text-xs text-slate-500 max-w-[200px] leading-relaxed\">88/23 เธซเธกเธนเน 4 เธ–เธเธเธ•เธดเธงเธฒเธเธเธ—เน เธ•.เธ•เธฅเธฒเธ”เธเธงเธฑเธ เธญ.เน€เธกเธทเธญเธ เธ.เธเธเธ—เธเธธเธฃเธต 11000</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"text-right\">\r\n                                        <div className=\"inline-block px-3 py-1 bg-slate-900 text-white text-xs font-bold rounded mb-2 tracking-wide uppercase\">\r\n                                            {viewDoc.type}\r\n                                        </div>\r\n                                        <p className=\"font-mono text-slate-600 font-medium\">{viewDoc.documentNumber}</p>\r\n                                        <p className=\"text-xs text-slate-400\">{new Date(viewDoc.createdAt).toLocaleDateString('th-TH')}</p>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"border-t-2 border-slate-100 my-8\"></div>\r\n\r\n                                <table className=\"w-full text-sm mb-8\">\r\n                                    <thead>\r\n                                        <tr className=\"text-slate-500 border-b border-slate-200\">\r\n                                            <th className=\"py-2 text-left w-12\">#</th>\r\n                                            <th className=\"py-2 text-left\">เธฃเธฒเธขเธเธฒเธฃ</th>\r\n                                            <th className=\"py-2 text-right\">เธเธณเธเธงเธเน€เธเธดเธ</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        <tr className=\"border-b border-slate-50\">\r\n                                            <td className=\"py-4 text-slate-400\">1</td>\r\n                                            <td className=\"py-4 font-medium text-slate-700\">{getFeeName(viewDoc)}</td>\r\n                                            <td className=\"py-4 text-right font-medium\">{formatAmount(viewDoc.amount)}</td>\r\n                                        </tr>\r\n                                    </tbody>\r\n                                    <tfoot>\r\n                                        <tr>\r\n                                            <td colSpan={2} className=\"pt-4 text-right text-slate-500\">เธฃเธงเธกเธ—เธฑเนเธเธชเธดเนเธ</td>\r\n                                            <td className=\"pt-4 text-right font-bold text-lg text-slate-900\">{formatAmount(viewDoc.amount)}</td>\r\n                                        </tr>\r\n                                    </tfoot>\r\n                                </table>\r\n\r\n                                {viewDoc.type === \"INVOICE\" && (\r\n                                    <div className=\"bg-amber-50 rounded-xl p-4 border border-amber-100 text-xs text-amber-800 leading-relaxed\">\r\n                                        <strong>โ ๏ธ เธซเธกเธฒเธขเน€เธซเธ•เธธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ:</strong><br />\r\n                                        เธเธฃเธธเธ“เธฒเธเธฅเธดเธ \"เธเธณเธฃเธฐเน€เธเธดเธ (Ksher)\" เน€เธเธทเนเธญเธ”เธณเน€เธเธดเธเธเธฒเธฃเธเนเธฒเธเธฃเธฐเธเธเธญเธญเธเนเธฅเธเน\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"p-5 border-t bg-white flex justify-end gap-3\">\r\n                            <button className=\"px-5 py-2.5 rounded-xl border border-slate-200 text-slate-600 font-medium hover:bg-slate-50\" onClick={() => window.print()}>\r\n                                เธเธดเธกเธเนเน€เธญเธเธชเธฒเธฃ\r\n                            </button>\r\n                            <button\r\n                                onClick={() => PaymentService.downloadInvoicePdf(viewDoc.id, viewDoc.documentNumber)}\r\n                                className=\"px-5 py-2.5 rounded-xl bg-slate-900 text-white font-medium hover:bg-slate-800\">\r\n                                เธ”เธฒเธงเธเนเนเธซเธฅเธ” PDF\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\planting\\new\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[273,276],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[273,276],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[815,818],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[815,818],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1465,1468],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1465,1468],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":77,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2954,2957],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2954,2957],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { apiClient } from '@/lib/api';\r\n\r\nexport default function NewPlantingCyclePage() {\r\n    const router = useRouter();\r\n    const [farms, setFarms] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [submitting, setSubmitting] = useState(false);\r\n    const [error, setError] = useState('');\r\n\r\n    const [form, setForm] = useState({\r\n        farmId: '',\r\n        pkantSpeciesId: 'P001', // Default \r\n        batchName: '',\r\n        cycleDate: new Date().toISOString().split('T')[0],\r\n        quantity: ''\r\n    });\r\n\r\n    useEffect(() => {\r\n        // Fetch only farms relevant to user\r\n        apiClient.get('/farms').then(res => {\r\n            setFarms((res.data as any[]) || []);\r\n            setLoading(false);\r\n        }).catch(err => {\r\n            console.error(err);\r\n            setError('Failed to load farms');\r\n            setLoading(false);\r\n        });\r\n    }, []);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setSubmitting(true);\r\n        setError('');\r\n\r\n        try {\r\n            await apiClient.post('/planting-cycles', {\r\n                ...form,\r\n                plantSpeciesId: 'P001', // Hardcode for now or fetch list\r\n                startDate: form.cycleDate\r\n            });\r\n            router.push('/planting');\r\n        } catch (err: any) {\r\n            console.error(err);\r\n            // Show the specific error from backend (check certificate)\r\n            const msg = err.response?.data?.message || err.response?.data?.error || 'Failed to create cycle';\r\n            setError(msg);\r\n        } finally {\r\n            setSubmitting(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-6 lg:p-10 max-w-2xl mx-auto\">\r\n            <h1 className=\"text-2xl font-medium mb-6\">เน€เธฃเธดเนเธกเธฃเธญเธเธเธฒเธฃเธเธฅเธนเธเนเธซเธกเน</h1>\r\n\r\n            {error && (\r\n                <div className=\"mb-6 p-4 bg-red-50 text-red-600 rounded-xl border border-red-100\">\r\n                    โ ๏ธ {error}\r\n                </div>\r\n            )}\r\n\r\n            <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n                <div>\r\n                    <label className=\"block text-sm font-medium text-slate-700 mb-2\">เน€เธฅเธทเธญเธเนเธเธฅเธเธเธฅเธนเธ (Certified Farm)</label>\r\n                    {loading ? <div className=\"text-sm text-slate-500\">Loading farms...</div> : (\r\n                        <select\r\n                            required\r\n                            className=\"w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-emerald-500 outline-none\"\r\n                            value={form.farmId}\r\n                            onChange={e => setForm({ ...form, farmId: e.target.value })}\r\n                        >\r\n                            <option value=\"\">-- เน€เธฅเธทเธญเธเธเธฒเธฃเนเธก --</option>\r\n                            {farms.map((f: any) => (\r\n                                <option key={f.id} value={f.id}>{f.farmName} ({f.status})</option>\r\n                            ))}\r\n                        </select>\r\n                    )}\r\n                    <p className=\"text-xs text-slate-500 mt-2\">\r\n                        * เน€เธเธเธฒเธฐเธเธฒเธฃเนเธกเธ—เธตเนเนเธ”เนเธฃเธฑเธเนเธเธฃเธฑเธเธฃเธญเธ (Status: VERIFIED/ACTIVE) เน€เธ—เนเธฒเธเธฑเนเธเธเธถเธเธเธฐเธชเธฒเธกเธฒเธฃเธ–เน€เธฃเธดเนเธกเธฃเธญเธเธเธฅเธนเธเนเธ”เน\r\n                    </p>\r\n                </div>\r\n\r\n                <div>\r\n                    <label className=\"block text-sm font-medium text-slate-700 mb-2\">เธเธทเนเธญเธฃเธญเธเธเธฅเธนเธ / Batch Name</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        required\r\n                        placeholder=\"e.g. Cycle-2024-001\"\r\n                        className=\"w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-emerald-500 outline-none\"\r\n                        value={form.batchName}\r\n                        onChange={e => setForm({ ...form, batchName: e.target.value })}\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-slate-700 mb-2\">เธงเธฑเธเธ—เธตเนเน€เธฃเธดเนเธกเธเธฅเธนเธ</label>\r\n                        <input\r\n                            type=\"date\"\r\n                            required\r\n                            className=\"w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-emerald-500 outline-none\"\r\n                            value={form.cycleDate}\r\n                            onChange={e => setForm({ ...form, cycleDate: e.target.value })}\r\n                        />\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-slate-700 mb-2\">เธเธณเธเธงเธเธ•เนเธ (เนเธ”เธขเธเธฃเธฐเธกเธฒเธ“)</label>\r\n                        <input\r\n                            type=\"number\"\r\n                            required\r\n                            placeholder=\"0\"\r\n                            className=\"w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-emerald-500 outline-none\"\r\n                            value={form.quantity}\r\n                            onChange={e => setForm({ ...form, quantity: e.target.value })}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"pt-4 flex gap-3\">\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={() => router.back()}\r\n                        className=\"flex-1 py-3 rounded-xl border border-slate-200 font-medium hover:bg-slate-50\"\r\n                    >\r\n                        เธขเธเน€เธฅเธดเธ\r\n                    </button>\r\n                    <button\r\n                        type=\"submit\"\r\n                        disabled={submitting}\r\n                        className=\"flex-1 py-3 rounded-xl bg-emerald-600 text-white font-medium hover:bg-emerald-700 disabled:opacity-50\"\r\n                    >\r\n                        {submitting ? 'เธเธณเธฅเธฑเธเธเธฑเธเธ—เธถเธ...' : 'เธเธฑเธเธ—เธถเธเธเนเธญเธกเธนเธฅ'}\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\planting\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[225,228],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[225,228],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[777,780],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[777,780],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[821,824],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[821,824],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1327,1330],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1327,1330],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1339,1342],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1339,1342],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":102,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":105,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1377,1380],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1377,1380],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":110,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":113,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1385,1388],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1385,1388],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":83,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4143,4146],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4143,4146],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\nimport { apiClient } from '@/lib/api';\r\n\r\nexport default function PlantingCyclesPage() {\r\n    const [cycles, setCycles] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState('');\r\n\r\n    useEffect(() => {\r\n        fetchCycles();\r\n    }, []);\r\n\r\n    const fetchCycles = async () => {\r\n        try {\r\n            // Need to get first farm ID or fetch all cycles for user?\r\n            // The API expects `farmId`. We should probably fetch farms first or update API to allow fetching all user's cycles.\r\n            // For now, let's fetch farms to get IDs, then fetch cycles.\r\n            const farmsRes = await apiClient.get<any[]>('/farms');\r\n            const farms: any[] = farmsRes.data || [];\r\n\r\n            if (farms.length === 0) {\r\n                setLoading(false);\r\n                return;\r\n            }\r\n\r\n            // Fetch cycles for all farms (Promise.all)\r\n            const cyclesPromises = farms.map(farm =>\r\n                apiClient.get(`/planting-cycles?farmId=${farm.id}`).then(res => res.data || []).catch(() => [])\r\n            );\r\n\r\n            const results = await Promise.all(cyclesPromises);\r\n            const allCycles = results.reduce((acc: any[], val: any) => acc.concat(val), []).sort((a: any, b: any) => new Date(b.startDate).getTime() - new Date(a.startDate).getTime());\r\n\r\n            setCycles(allCycles);\r\n        } catch (err) {\r\n            console.error(err);\r\n            setError('Failed to load planting cycles');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-6 lg:p-10 pb-24 lg:pb-10 max-w-6xl mx-auto\">\r\n            <header className=\"flex justify-between items-center mb-8\">\r\n                <div>\r\n                    <h1 className=\"text-2xl lg:text-3xl font-medium text-slate-900\">เธฃเธญเธเธเธฒเธฃเธเธฅเธนเธ</h1>\r\n                    <p className=\"text-slate-500 mt-1\">เธเธฑเธ”เธเธฒเธฃเธฃเธญเธเธเธฒเธฃเธเธฅเธนเธเนเธฅเธฐเธเธฑเธเธ—เธถเธเธเธดเธเธเธฃเธฃเธก</p>\r\n                </div>\r\n                <Link href=\"/planting/new\" className=\"flex items-center gap-2 px-6 py-3 rounded-xl bg-emerald-600 text-white font-medium shadow-lg shadow-emerald-500/30 hover:bg-emerald-700 transition-colors\">\r\n                    <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                        <path d=\"M12 5v14M5 12h14\" />\r\n                    </svg>\r\n                    เน€เธฃเธดเนเธกเธฃเธญเธเธเธฅเธนเธเนเธซเธกเน\r\n                </Link>\r\n            </header>\r\n\r\n            {loading ? (\r\n                <div className=\"text-center py-12\">\r\n                    <div className=\"w-10 h-10 border-3 border-emerald-500/30 border-t-emerald-500 rounded-full animate-spin mx-auto mb-4\" />\r\n                    <p className=\"text-slate-500\">เธเธณเธฅเธฑเธเนเธซเธฅเธ”เธเนเธญเธกเธนเธฅ...</p>\r\n                </div>\r\n            ) : error ? (\r\n                <div className=\"p-4 bg-red-50 text-red-600 rounded-xl\">{error}</div>\r\n            ) : cycles.length === 0 ? (\r\n                <div className=\"text-center py-12 bg-white rounded-3xl border border-slate-200\">\r\n                    <div className=\"w-16 h-16 bg-emerald-50 rounded-2xl flex items-center justify-center mx-auto mb-4\">\r\n                        <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" className=\"text-emerald-600\">\r\n                            <path d=\"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z\" />\r\n                        </svg>\r\n                    </div>\r\n                    <h3 className=\"text-lg font-medium text-slate-900\">เธขเธฑเธเนเธกเนเธกเธตเธฃเธญเธเธเธฒเธฃเธเธฅเธนเธ</h3>\r\n                    <p className=\"text-slate-500 mt-2 mb-6\">เน€เธฃเธดเนเธกเธเธฑเธเธ—เธถเธเธฃเธญเธเธเธฒเธฃเธเธฅเธนเธเนเธฃเธเธเธญเธเธเธธเธ“เน€เธเธทเนเธญเธ•เธดเธ”เธ•เธฒเธกเธเธฅเธเธฅเธดเธ•</p>\r\n                    <Link href=\"/planting/new\" className=\"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-700\">\r\n                        เน€เธฃเธดเนเธกเธฃเธญเธเธเธฅเธนเธเนเธซเธกเน &rarr;\r\n                    </Link>\r\n                </div>\r\n            ) : (\r\n                <div className=\"grid gap-4\">\r\n                    {cycles.map((cycle: any) => (\r\n                        <div key={cycle.id} className=\"bg-white p-6 rounded-2xl border border-slate-200 hover:border-emerald-500/50 transition-colors group\">\r\n                            <div className=\"flex justify-between items-start\">\r\n                                <div>\r\n                                    <h3 className=\"text-lg font-medium text-slate-900 group-hover:text-emerald-700 transition-colors\">\r\n                                        {cycle.cycleName}\r\n                                    </h3>\r\n                                    <div className=\"flex items-center gap-4 mt-2 text-sm text-slate-500\">\r\n                                        <span className=\"flex items-center gap-1\">\r\n                                            ๐ฑ {cycle.plantSpecies?.nameTH || 'N/A'}\r\n                                        </span>\r\n                                        <span className=\"flex items-center gap-1\">\r\n                                            ๐“… เน€เธฃเธดเนเธก: {new Date(cycle.startDate).toLocaleDateString('th-TH')}\r\n                                        </span>\r\n                                        <span className=\"flex items-center gap-1\">\r\n                                            ๐“ Cert: {cycle.certificate?.certificateNumber || 'N/A'}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                                <span className={`px-3 py-1 rounded-full text-xs font-medium ${cycle.status === 'ACTIVE' ? 'bg-emerald-100 text-emerald-700' :\r\n                                    cycle.status === 'HARVESTED' ? 'bg-blue-100 text-blue-700' :\r\n                                        'bg-slate-100 text-slate-600'\r\n                                    }`}>\r\n                                    {cycle.status}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\profile\\page.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`initForm` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\profile\\page.tsx:54:17\n  52 |                 const u = res.data;\n  53 |                 setUser(u);\n> 54 |                 initForm(u);\n     |                 ^^^^^^^^ `initForm` accessed before it is declared\n  55 |             } else {\n  56 |                 const u = AuthService.getUser();\n  57 |                 if (u) {\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\profile\\page.tsx:68:5\n  66 |     }, [router]);\n  67 |\n> 68 |     const initForm = (u: User) => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 69 |         setFirstName(u.firstName || \"\");\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 70 |         setLastName(u.lastName || \"\");\n     โ€ฆ\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |         });\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |     };\n     | ^^^^^^^ `initForm` is declared here\n  82 |\n  83 |     const validateEmail = (v: string) => /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(v);\n  84 |     const validatePhone = (v: string) => /^0[689]\\d{8}$/.test(v);","line":54,"column":17,"nodeType":null,"endLine":54,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { apiClient as api } from \"@/lib/api/api-client\";\r\nimport { AuthService } from \"@/lib/services/auth-service\";\r\nimport { Icons, IconUser, IconLock } from \"@/components/ui/icons\";\r\n\r\ninterface User {\r\n    id?: string;\r\n    firstName?: string;\r\n    lastName?: string;\r\n    email?: string;\r\n    phone?: string;\r\n    identifier?: string;\r\n    companyName?: string;\r\n    communityName?: string;\r\n    accountType?: string;\r\n    createdAt?: string;\r\n    lastLogin?: string;\r\n    verificationStatus?: string;\r\n}\r\n\r\nexport default function ProfilePage() {\r\n    const router = useRouter();\r\n    const [user, setUser] = useState<User | null>(null);\r\n    const [isEditing, setIsEditing] = useState(false);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n    const [message, setMessage] = useState(\"\");\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    const [firstName, setFirstName] = useState(\"\");\r\n    const [lastName, setLastName] = useState(\"\");\r\n    const [email, setEmail] = useState(\"\");\r\n    const [phone, setPhone] = useState(\"\");\r\n    const [companyName, setCompanyName] = useState(\"\");\r\n    const [originalValues, setOriginalValues] = useState({ firstName: \"\", lastName: \"\", email: \"\", phone: \"\", companyName: \"\" });\r\n\r\n    const hasChanges = isEditing && (\r\n        firstName !== originalValues.firstName ||\r\n        lastName !== originalValues.lastName ||\r\n        email !== originalValues.email ||\r\n        phone !== originalValues.phone ||\r\n        companyName !== originalValues.companyName\r\n    );\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        const fetchProfile = async () => {\r\n            const res = await api.get<User>('/auth/me');\r\n            if (res.success && res.data) {\r\n                const u = res.data;\r\n                setUser(u);\r\n                initForm(u);\r\n            } else {\r\n                const u = AuthService.getUser();\r\n                if (u) {\r\n                    setUser(u as User);\r\n                    initForm(u as User);\r\n                } else {\r\n                    router.push(\"/login\");\r\n                }\r\n            }\r\n        };\r\n        fetchProfile();\r\n    }, [router]);\r\n\r\n    const initForm = (u: User) => {\r\n        setFirstName(u.firstName || \"\");\r\n        setLastName(u.lastName || \"\");\r\n        setEmail(u.email || \"\");\r\n        setPhone(u.phone || \"\");\r\n        setCompanyName(u.companyName || u.communityName || \"\");\r\n        setOriginalValues({\r\n            firstName: u.firstName || \"\",\r\n            lastName: u.lastName || \"\",\r\n            email: u.email || \"\",\r\n            phone: u.phone || \"\",\r\n            companyName: u.companyName || u.communityName || \"\"\r\n        });\r\n    };\r\n\r\n    const validateEmail = (v: string) => /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(v);\r\n    const validatePhone = (v: string) => /^0[689]\\d{8}$/.test(v);\r\n\r\n    const handleSaveProfile = async () => {\r\n        if (email && !validateEmail(email)) { setMessage(\"โ เธฃเธนเธเนเธเธเธญเธตเน€เธกเธฅเนเธกเนเธ–เธนเธเธ•เนเธญเธ\"); return; }\r\n        if (phone && !validatePhone(phone)) { setMessage(\"โ เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เนเธ•เนเธญเธเธเธถเนเธเธ•เนเธเธ”เนเธงเธข 06, 08, 09\"); return; }\r\n        setIsSaving(true);\r\n        setMessage(\"\");\r\n\r\n        const result = await api.put(\"/auth-farmer/profile\", { firstName, lastName, email, phone, companyName });\r\n\r\n        if (result.success) {\r\n            const updatedUser = { ...user, firstName, lastName, email, phone, companyName };\r\n            localStorage.setItem(\"user\", JSON.stringify(updatedUser));\r\n            setUser(updatedUser);\r\n            setMessage(\"โ… เธเธฑเธเธ—เธถเธเธเนเธญเธกเธนเธฅเน€เธฃเธตเธขเธเธฃเนเธญเธขเนเธฅเนเธง\");\r\n            setIsEditing(false);\r\n            setOriginalValues({ firstName, lastName, email, phone, companyName });\r\n        } else {\r\n            setMessage(\"โ \" + (result.error || \"เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเธเธฑเธเธ—เธถเธ\"));\r\n        }\r\n        setIsSaving(false);\r\n    };\r\n\r\n    const handleLogout = () => {\r\n        AuthService.logout();\r\n        window.location.href = \"/login\";\r\n    };\r\n\r\n    const getAccountTypeThai = () => {\r\n        switch (user?.accountType) {\r\n            case \"INDIVIDUAL\": return \"เธเธธเธเธเธฅเธเธฃเธฃเธกเธ”เธฒ\";\r\n            case \"JURISTIC\": return \"เธเธดเธ•เธดเธเธธเธเธเธฅ\";\r\n            case \"COMMUNITY_ENTERPRISE\": return \"เธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ\";\r\n            default: return \"เน€เธเธฉเธ•เธฃเธเธฃ\";\r\n        }\r\n    };\r\n\r\n    if (!user || !mounted) return (\r\n        <div className=\"min-h-[60vh] flex flex-col items-center justify-center\">\r\n            <div className=\"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin mb-4\"></div>\r\n            <p className=\"text-slate-400 font-bold uppercase tracking-widest text-xs\">Loading Profile...</p>\r\n        </div>\r\n    );\r\n\r\n    const inputClass = `w-full py-3.5 px-5 rounded-2xl border-2 transition-all outline-none font-medium ${isEditing ? 'bg-white border-primary/20 focus:border-primary focus:ring-4 focus:ring-primary/5' : 'bg-slate-50 border-slate-50 text-slate-500 cursor-not-allowed'}`;\r\n\r\n    return (\r\n        <div className=\"container mx-auto max-w-5xl py-10 px-6 animate-fade-in group\">\r\n            {/* Header Section */}\r\n            <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-6 mb-10\">\r\n                <div>\r\n                    <h1 className=\"text-4xl font-black text-slate-800 tracking-tight mb-2\">เธเนเธญเธกเธนเธฅเธเธนเนเนเธเนเธเธฒเธ</h1>\r\n                    <p className=\"text-slate-500 font-medium\">เธเธฑเธ”เธเธฒเธฃเธเนเธญเธกเธนเธฅเธชเนเธงเธเธเธธเธเธเธฅเนเธฅเธฐเธเธฒเธฃเธ•เธฑเนเธเธเนเธฒเธเธฑเธเธเธตเธเธญเธเธเธธเธ“</p>\r\n                </div>\r\n                <div className=\"flex gap-3\">\r\n                    {!isEditing ? (\r\n                        <button\r\n                            onClick={() => setIsEditing(true)}\r\n                            className=\"gacp-btn-primary px-8 py-3.5 rounded-2xl font-black flex items-center gap-2\"\r\n                        >\r\n                            <Icons.Edit className=\"w-5 h-5\" />\r\n                            เนเธเนเนเธเนเธเธฃเนเธเธฅเน\r\n                        </button>\r\n                    ) : (\r\n                        <>\r\n                            <button\r\n                                onClick={() => { initForm(user); setIsEditing(false); setMessage(\"\"); }}\r\n                                className=\"gacp-btn-secondary px-8 py-3.5 rounded-2xl font-black text-rose-500 border-rose-100 hover:bg-rose-50\"\r\n                            >\r\n                                เธขเธเน€เธฅเธดเธ\r\n                            </button>\r\n                            <button\r\n                                onClick={handleSaveProfile}\r\n                                disabled={isSaving || !hasChanges}\r\n                                className=\"gacp-btn-primary px-8 py-3.5 rounded-2xl font-black disabled:opacity-50\"\r\n                            >\r\n                                {isSaving ? \"เธเธเธณเธฅเธฑเธเธเธฑเธเธ—เธถเธ...\" : \"เธเธฑเธเธ—เธถเธเธเธฒเธฃเน€เธเธฅเธตเนเธขเธเนเธเธฅเธ\"}\r\n                            </button>\r\n                        </>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {message && (\r\n                <div className={`mb-10 p-5 rounded-3xl border animate-head-shake flex items-center gap-3 font-bold text-sm ${message.includes('เน€เธฃเธตเธขเธเธฃเนเธญเธข') ? 'bg-emerald-50 border-emerald-100 text-emerald-600' : 'bg-rose-50 border-rose-100 text-rose-600'}`}>\r\n                    {message}\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n                {/* Left: User Card */}\r\n                <div className=\"lg:col-span-1 space-y-8\">\r\n                    <div className=\"gacp-card p-8 text-center relative overflow-hidden group/card shadow-premium\">\r\n                        <div className=\"absolute top-0 left-0 w-full h-24 bg-gradient-to-br from-primary to-emerald-600 opacity-10\"></div>\r\n                        <div className=\"relative z-10\">\r\n                            <div className=\"w-24 h-24 bg-white rounded-[2rem] shadow-elevated mx-auto mb-6 flex items-center justify-center border-4 border-white\">\r\n                                <IconUser className=\"w-12 h-12 text-primary\" />\r\n                            </div>\r\n                            <h2 className=\"text-2xl font-black text-slate-800 leading-tight\">\r\n                                {firstName || lastName ? `${firstName} ${lastName}` : companyName || 'เธขเธฑเธเนเธกเนเธฃเธฐเธเธธเธเธทเนเธญ'}\r\n                            </h2>\r\n                            <p className=\"text-sm font-black text-primary uppercase tracking-widest mt-2\">{getAccountTypeThai()}</p>\r\n\r\n                            <div className=\"mt-8 flex flex-col gap-2\">\r\n                                <div className={`py-2 px-4 rounded-full text-xs font-black uppercase tracking-widest ${user.verificationStatus === 'APPROVED' ? 'bg-emerald-100 text-emerald-600' : 'bg-amber-100 text-amber-600'}`}>\r\n                                    {user.verificationStatus === 'APPROVED' ? 'Verified Account' : 'Pending Verification'}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"gacp-card p-8 shadow-soft\">\r\n                        <h3 className=\"text-xs font-black uppercase tracking-[0.2em] text-slate-400 mb-6 flex items-center gap-2\">\r\n                            <Icons.Info className=\"w-4 h-4\" />\r\n                            เธเนเธญเธกเธนเธฅเธเธฒเธฃเนเธเนเธเธฒเธ\r\n                        </h3>\r\n                        <div className=\"space-y-6\">\r\n                            <div>\r\n                                <p className=\"text-[10px] font-black uppercase text-slate-400 mb-1\">Registered On</p>\r\n                                <p className=\"text-sm font-bold text-slate-700\">{user.createdAt ? new Date(user.createdAt).toLocaleDateString(\"th-TH\", { year: 'numeric', month: 'long', day: 'numeric' }) : \"-\"}</p>\r\n                            </div>\r\n                            <div>\r\n                                <p className=\"text-[10px] font-black uppercase text-slate-400 mb-1\">Last Logged In</p>\r\n                                <p className=\"text-sm font-bold text-slate-700\">{user.lastLogin ? new Date(user.lastLogin).toLocaleDateString(\"th-TH\", { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' }) : \"เนเธกเนเธฃเธฐเธเธธ\"}</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <button\r\n                        onClick={handleLogout}\r\n                        className=\"w-full py-5 rounded-3xl bg-rose-50 border border-rose-100 text-rose-500 font-black flex items-center justify-center gap-2 hover:bg-rose-100 transition-all shadow-soft\"\r\n                    >\r\n                        <Icons.Logout className=\"w-5 h-5 font-black\" />\r\n                        เธญเธญเธเธเธฒเธเธฃเธฐเธเธ\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Right: Form Details */}\r\n                <div className=\"lg:col-span-2 space-y-8\">\r\n                    <div className=\"gacp-card p-10 shadow-premium\">\r\n                        <h3 className=\"text-xl font-black text-slate-800 mb-8 border-b border-slate-50 pb-6 flex items-center gap-3\">\r\n                            <div className=\"w-10 h-10 bg-primary/10 rounded-xl flex items-center justify-center text-primary\">\r\n                                <IconUser className=\"w-5 h-5\" />\r\n                            </div>\r\n                            เธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”เธเนเธญเธกเธนเธฅเธชเนเธงเธเธเธธเธเธเธฅ\r\n                        </h3>\r\n\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6\">\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-xs font-black uppercase tracking-widest text-slate-400 px-1\">เธเธทเนเธญ</label>\r\n                                <input type=\"text\" value={firstName} onChange={(e) => setFirstName(e.target.value)} disabled={!isEditing} className={inputClass} />\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-xs font-black uppercase tracking-widest text-slate-400 px-1\">เธเธฒเธกเธชเธเธธเธฅ</label>\r\n                                <input type=\"text\" value={lastName} onChange={(e) => setLastName(e.target.value)} disabled={!isEditing} className={inputClass} />\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-xs font-black uppercase tracking-widest text-slate-400 px-1\">เธญเธตเน€เธกเธฅ</label>\r\n                                <input type=\"email\" value={email} onChange={(e) => setEmail(e.target.value)} disabled={!isEditing} className={inputClass} />\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                                <label className=\"text-xs font-black uppercase tracking-widest text-slate-400 px-1\">เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เน</label>\r\n                                <input type=\"tel\" value={phone} onChange={(e) => setPhone(e.target.value)} disabled={!isEditing} className={inputClass} />\r\n                            </div>\r\n                            <div className=\"md:col-span-2 space-y-2\">\r\n                                <label className=\"text-xs font-black uppercase tracking-widest text-slate-400 px-1\">เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธง (เธเธทเนเธญเธเธนเนเนเธเนเธเธฒเธ)</label>\r\n                                <div className=\"py-4 px-6 bg-slate-50 border-2 border-slate-50 rounded-2xl text-slate-400 font-mono text-lg tracking-wider\">\r\n                                    {user.identifier || \"-\"}\r\n                                </div>\r\n                            </div>\r\n                            {(companyName || user.accountType !== 'INDIVIDUAL') && (\r\n                                <div className=\"md:col-span-2 space-y-2\">\r\n                                    <label className=\"text-xs font-black uppercase tracking-widest text-slate-400 px-1\">เธเธทเนเธญเธญเธเธเนเธเธฃ/เธเธฃเธดเธฉเธฑเธ—</label>\r\n                                    <input type=\"text\" value={companyName} onChange={(e) => setCompanyName(e.target.value)} disabled={!isEditing} className={inputClass} />\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"gacp-card p-10 shadow-soft\">\r\n                        <h3 className=\"text-xl font-black text-slate-800 mb-8 border-b border-slate-50 pb-6 flex items-center gap-3\">\r\n                            <div className=\"w-10 h-10 bg-primary/10 rounded-xl flex items-center justify-center text-primary\">\r\n                                <IconLock className=\"w-5 h-5\" />\r\n                            </div>\r\n                            เธเธงเธฒเธกเธเธฅเธญเธ”เธ เธฑเธขเธเธญเธเธเธฑเธเธเธต\r\n                        </h3>\r\n\r\n                        <div className=\"flex flex-col md:flex-row items-center justify-between gap-6 p-6 bg-slate-50/50 rounded-3xl border border-dashed border-slate-200\">\r\n                            <div className=\"flex items-center gap-4\">\r\n                                <div className=\"w-12 h-12 bg-white rounded-2xl shadow-soft flex items-center justify-center\">\r\n                                    <Icons.Key className=\"w-6 h-6 text-slate-400\" />\r\n                                </div>\r\n                                <div>\r\n                                    <p className=\"font-black text-slate-700\">เธฃเธซเธฑเธชเธเนเธฒเธเธชเธณเธซเธฃเธฑเธเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ</p>\r\n                                    <p className=\"text-xs font-bold text-slate-400\">เธญเธฑเธเน€เธ”เธ•เธฃเธซเธฑเธชเธเนเธฒเธเธฅเนเธฒเธชเธธเธ”เน€เธกเธทเนเธญ 3 เน€เธ”เธทเธญเธเธ—เธตเนเธเนเธฒเธเธกเธฒ</p>\r\n                                </div>\r\n                            </div>\r\n                            <button\r\n                                onClick={() => alert(\"เธฃเธฐเธเธเน€เธเธฅเธตเนเธขเธเธฃเธซเธฑเธชเธเนเธฒเธเธเธณเธฅเธฑเธเธเธฐเน€เธเธดเธ”เนเธซเนเธเธฃเธดเธเธฒเธฃเน€เธฃเนเธงเน เธเธตเน\")}\r\n                                className=\"gacp-btn-secondary px-6 py-2.5 rounded-xl border-slate-200 text-slate-600 font-black text-sm\"\r\n                            >\r\n                                เน€เธเธฅเธตเนเธขเธเธฃเธซเธฑเธชเธเนเธฒเธ\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\settings\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\tracking\\cycles\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":179,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":179,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport Link from 'next/link';\r\n\r\ninterface PlantSpecies {\r\n    id: string;\r\n    code: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n}\r\n\r\ninterface Certificate {\r\n    id: string;\r\n    certificateNumber: string;\r\n    expiryDate: string;\r\n}\r\n\r\ninterface PlantingCycle {\r\n    id: string;\r\n    cycleName: string;\r\n    cycleNumber: number;\r\n    status: string;\r\n    startDate: string;\r\n    expectedHarvestDate: string;\r\n    actualHarvestDate: string | null;\r\n    plotName: string;\r\n    plotArea: number;\r\n    estimatedYield: number;\r\n    actualYield: number | null;\r\n    plantSpecies: {\r\n        nameTH: string;\r\n        nameEN: string;\r\n    };\r\n    certificate: Certificate | null;\r\n    _count: {\r\n        batches: number;\r\n    };\r\n}\r\n\r\ninterface CreateFormData {\r\n    speciesId: string;\r\n    certificateId: string;\r\n    plotName: string;\r\n    plotArea: number;\r\n    startDate: string;\r\n    expectedHarvestDate: string;\r\n    estimatedYield: number;\r\n    notes: string;\r\n}\r\n\r\nconst statusConfig: Record<string, { label: string; color: string }> = {\r\n    PLANNING: { label: 'เธงเธฒเธเนเธเธ', color: 'bg-gray-100 text-gray-700' },\r\n    PLANTED: { label: 'เธเธฅเธนเธเนเธฅเนเธง', color: 'bg-blue-100 text-blue-700' },\r\n    GROWING: { label: 'เธเธณเธฅเธฑเธเน€เธ•เธดเธเนเธ•', color: 'bg-green-100 text-green-700' },\r\n    READY_HARVEST: { label: 'เธเธฃเนเธญเธกเน€เธเนเธเน€เธเธตเนเธขเธง', color: 'bg-yellow-100 text-yellow-700' },\r\n    HARVESTED: { label: 'เน€เธเนเธเน€เธเธตเนเธขเธงเนเธฅเนเธง', color: 'bg-emerald-100 text-emerald-700' },\r\n    COMPLETED: { label: 'เน€เธชเธฃเนเธเธชเธดเนเธ', color: 'bg-purple-100 text-purple-700' },\r\n};\r\n\r\nconst defaultFormData: CreateFormData = {\r\n    speciesId: '',\r\n    certificateId: '',\r\n    plotName: '',\r\n    plotArea: 0,\r\n    startDate: new Date().toISOString().split('T')[0],\r\n    expectedHarvestDate: '',\r\n    estimatedYield: 0,\r\n    notes: ''\r\n};\r\n\r\nexport default function PlantingCyclesPage() {\r\n    const [cycles, setCycles] = useState<PlantingCycle[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [showCreateModal, setShowCreateModal] = useState(false);\r\n    const [saving, setSaving] = useState(false);\r\n    const [formData, setFormData] = useState<CreateFormData>(defaultFormData);\r\n    const [species, setSpecies] = useState<PlantSpecies[]>([]);\r\n    const [certificates, setCertificates] = useState<Certificate[]>([]);\r\n    const [message, setMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\r\n\r\n    // Get farmId from localStorage\r\n    const [farmId, setFarmId] = useState<string>('');\r\n\r\n    useEffect(() => {\r\n        const storedFarmId = localStorage.getItem('currentFarmId') || localStorage.getItem('farmId');\r\n        if (storedFarmId) {\r\n            setFarmId(storedFarmId);\r\n        }\r\n        fetchCycles();\r\n        fetchSpecies();\r\n        fetchCertificates();\r\n    }, []);\r\n\r\n    async function fetchCycles() {\r\n        try {\r\n            const storedFarmId = localStorage.getItem('currentFarmId') || localStorage.getItem('farmId');\r\n            if (!storedFarmId) {\r\n                setLoading(false);\r\n                return;\r\n            }\r\n            const res = await fetch(`/api/proxy/planting-cycles?farmId=${storedFarmId}`);\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                setCycles(data.data);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching cycles:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    async function fetchSpecies() {\r\n        try {\r\n            const res = await fetch('/api/proxy/plants');\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                setSpecies(data.data);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching species:', error);\r\n        }\r\n    }\r\n\r\n    async function fetchCertificates() {\r\n        try {\r\n            const res = await fetch('/api/proxy/certificates/my');\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                setCertificates(data.data);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching certificates:', error);\r\n        }\r\n    }\r\n\r\n    const formatDate = (dateStr: string) => {\r\n        if (!dateStr) return '-';\r\n        return new Date(dateStr).toLocaleDateString('th-TH', {\r\n            year: 'numeric',\r\n            month: 'short',\r\n            day: 'numeric'\r\n        });\r\n    };\r\n\r\n    async function handleCreate(e: React.FormEvent) {\r\n        e.preventDefault();\r\n        if (!farmId) {\r\n            setMessage({ type: 'error', text: 'เธเธฃเธธเธ“เธฒเน€เธฅเธทเธญเธเธเธฒเธฃเนเธกเธเนเธญเธ' });\r\n            return;\r\n        }\r\n\r\n        setSaving(true);\r\n        setMessage(null);\r\n\r\n        try {\r\n            const res = await fetch('/api/proxy/planting-cycles', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    farmId,\r\n                    ...formData,\r\n                    plotArea: parseFloat(formData.plotArea.toString()),\r\n                    estimatedYield: parseFloat(formData.estimatedYield.toString())\r\n                })\r\n            });\r\n\r\n            const data = await res.json();\r\n\r\n            if (data.success) {\r\n                setMessage({ type: 'success', text: 'เธชเธฃเนเธฒเธเธฃเธญเธเธเธฒเธฃเธเธฅเธนเธเธชเธณเน€เธฃเนเธ' });\r\n                setShowCreateModal(false);\r\n                setFormData(defaultFormData);\r\n                fetchCycles();\r\n            } else {\r\n                setMessage({ type: 'error', text: data.message || 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”' });\r\n            }\r\n        } catch (error) {\r\n            setMessage({ type: 'error', text: 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเน€เธเธทเนเธญเธกเธ•เนเธญ' });\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"p-6\">\r\n                <div className=\"animate-pulse space-y-4\">\r\n                    <div className=\"h-8 bg-gray-200 rounded w-1/4\"></div>\r\n                    <div className=\"h-32 bg-gray-200 rounded\"></div>\r\n                    <div className=\"h-32 bg-gray-200 rounded\"></div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-6\">\r\n            {/* Header */}\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n                <div>\r\n                    <h1 className=\"text-2xl font-bold text-gray-800\">๐ฑ เธฃเธญเธเธเธฒเธฃเธเธฅเธนเธ</h1>\r\n                    <p className=\"text-gray-500\">เธเธฑเธ”เธเธฒเธฃเธฃเธญเธเธเธฒเธฃเธเธฅเธนเธเนเธฅเธฐเน€เธเนเธเน€เธเธตเนเธขเธง</p>\r\n                </div>\r\n                <button\r\n                    onClick={() => setShowCreateModal(true)}\r\n                    className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center\"\r\n                >\r\n                    <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\r\n                    </svg>\r\n                    เธชเธฃเนเธฒเธเธฃเธญเธเนเธซเธกเน\r\n                </button>\r\n            </div>\r\n\r\n            {/* Message */}\r\n            {message && (\r\n                <div className={`mb-4 p-4 rounded-lg ${message.type === 'success' ? 'bg-green-50 text-green-700' : 'bg-red-50 text-red-700'}`}>\r\n                    {message.text}\r\n                </div>\r\n            )}\r\n\r\n            {/* No farmId warning */}\r\n            {!farmId && (\r\n                <div className=\"bg-yellow-50 border border-yellow-200 rounded-xl p-6 mb-6\">\r\n                    <div className=\"flex items-center text-yellow-700\">\r\n                        <svg className=\"w-5 h-5 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                            <path fillRule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\r\n                        </svg>\r\n                        <span>เธเธฃเธธเธ“เธฒเน€เธฅเธทเธญเธเธเธฒเธฃเนเธกเธเนเธญเธเน€เธฃเธดเนเธกเนเธเนเธเธฒเธ (เนเธเธ—เธตเนเธซเธเนเธฒเธเธฒเธฃเนเธกเธเธญเธเธเธฑเธ)</span>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Stats */}\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\r\n                <div className=\"bg-white p-4 rounded-xl shadow-sm border\">\r\n                    <div className=\"text-3xl font-bold text-blue-600\">{cycles.length}</div>\r\n                    <div className=\"text-gray-500 text-sm\">เธฃเธญเธเธ—เธฑเนเธเธซเธกเธ”</div>\r\n                </div>\r\n                <div className=\"bg-white p-4 rounded-xl shadow-sm border\">\r\n                    <div className=\"text-3xl font-bold text-green-600\">\r\n                        {cycles.filter(c => c.status === 'GROWING').length}\r\n                    </div>\r\n                    <div className=\"text-gray-500 text-sm\">เธเธณเธฅเธฑเธเธเธฅเธนเธ</div>\r\n                </div>\r\n                <div className=\"bg-white p-4 rounded-xl shadow-sm border\">\r\n                    <div className=\"text-3xl font-bold text-yellow-600\">\r\n                        {cycles.filter(c => c.status === 'READY_HARVEST').length}\r\n                    </div>\r\n                    <div className=\"text-gray-500 text-sm\">เธเธฃเนเธญเธกเน€เธเนเธเน€เธเธตเนเธขเธง</div>\r\n                </div>\r\n                <div className=\"bg-white p-4 rounded-xl shadow-sm border\">\r\n                    <div className=\"text-3xl font-bold text-emerald-600\">\r\n                        {cycles.filter(c => c.status === 'HARVESTED' || c.status === 'COMPLETED').length}\r\n                    </div>\r\n                    <div className=\"text-gray-500 text-sm\">เน€เธเนเธเน€เธเธตเนเธขเธงเนเธฅเนเธง</div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Cycles List */}\r\n            {cycles.length === 0 ? (\r\n                <div className=\"bg-white rounded-xl shadow-sm border p-12 text-center\">\r\n                    <div className=\"text-6xl mb-4\">๐พ</div>\r\n                    <h3 className=\"text-xl font-semibold text-gray-700 mb-2\">เธขเธฑเธเนเธกเนเธกเธตเธฃเธญเธเธเธฒเธฃเธเธฅเธนเธ</h3>\r\n                    <p className=\"text-gray-500 mb-4\">เน€เธฃเธดเนเธกเธชเธฃเนเธฒเธเธฃเธญเธเธเธฒเธฃเธเธฅเธนเธเนเธซเธกเนเน€เธเธทเนเธญเธ•เธดเธ”เธ•เธฒเธกเธเธฅเธเธฅเธดเธ•</p>\r\n                    <button\r\n                        onClick={() => setShowCreateModal(true)}\r\n                        className=\"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700\"\r\n                    >\r\n                        เธชเธฃเนเธฒเธเธฃเธญเธเนเธฃเธ\r\n                    </button>\r\n                </div>\r\n            ) : (\r\n                <div className=\"space-y-4\">\r\n                    {cycles.map((cycle) => (\r\n                        <div key={cycle.id} className=\"bg-white rounded-xl shadow-sm border overflow-hidden hover:shadow-md transition-shadow\">\r\n                            <div className=\"p-6\">\r\n                                <div className=\"flex justify-between items-start\">\r\n                                    <div className=\"flex-1\">\r\n                                        <div className=\"flex items-center mb-2\">\r\n                                            <h3 className=\"text-lg font-semibold text-gray-800 mr-3\">\r\n                                                {cycle.cycleName}\r\n                                            </h3>\r\n                                            <span className={`px-3 py-1 rounded-full text-sm font-medium ${statusConfig[cycle.status]?.color || 'bg-gray-100'}`}>\r\n                                                {statusConfig[cycle.status]?.label || cycle.status}\r\n                                            </span>\r\n                                        </div>\r\n                                        <p className=\"text-gray-500\">\r\n                                            {cycle.plantSpecies.nameTH} โ€ข {cycle.plotName || 'เนเธกเนเธฃเธฐเธเธธเนเธเธฅเธ'} โ€ข {cycle.plotArea || '-'} เนเธฃเน\r\n                                        </p>\r\n                                    </div>\r\n                                    <Link\r\n                                        href={`/tracking/cycles/${cycle.id}`}\r\n                                        className=\"px-4 py-2 border border-green-600 text-green-600 rounded-lg hover:bg-green-50\"\r\n                                    >\r\n                                        เธ”เธนเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”\r\n                                    </Link>\r\n                                </div>\r\n\r\n                                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 pt-4 border-t\">\r\n                                    <div>\r\n                                        <div className=\"text-gray-500 text-sm\">เธงเธฑเธเธเธฅเธนเธ</div>\r\n                                        <div className=\"font-medium\">{formatDate(cycle.startDate)}</div>\r\n                                    </div>\r\n                                    <div>\r\n                                        <div className=\"text-gray-500 text-sm\">เธเธณเธซเธเธ”เน€เธเนเธ</div>\r\n                                        <div className=\"font-medium\">{formatDate(cycle.expectedHarvestDate)}</div>\r\n                                    </div>\r\n                                    <div>\r\n                                        <div className=\"text-gray-500 text-sm\">เธเธฅเธเธฅเธดเธ•เธเธฒเธ”เธเธฒเธฃเธ“เน</div>\r\n                                        <div className=\"font-medium\">{cycle.estimatedYield || '-'} เธเธ.</div>\r\n                                    </div>\r\n                                    <div>\r\n                                        <div className=\"text-gray-500 text-sm\">Batch</div>\r\n                                        <div className=\"font-medium\">{cycle._count?.batches || 0} เธฃเธฒเธขเธเธฒเธฃ</div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {cycle.certificate && (\r\n                                    <div className=\"mt-4 pt-4 border-t flex items-center text-sm text-gray-500\">\r\n                                        <svg className=\"w-4 h-4 mr-2 text-green-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                                            <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                                        </svg>\r\n                                        เนเธเธฃเธฑเธเธฃเธญเธ: {cycle.certificate.certificateNumber} (เธซเธกเธ”เธญเธฒเธขเธธ: {formatDate(cycle.certificate.expiryDate)})\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            {/* Create Modal */}\r\n            {showCreateModal && (\r\n                <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n                    <div className=\"bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto\">\r\n                        <div className=\"p-6 border-b\">\r\n                            <h2 className=\"text-xl font-bold\">๐ฑ เธชเธฃเนเธฒเธเธฃเธญเธเธเธฒเธฃเธเธฅเธนเธเนเธซเธกเน</h2>\r\n                        </div>\r\n                        <form onSubmit={handleCreate} className=\"p-6 space-y-4\">\r\n                            {/* Species */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เธเธเธดเธ”เธเธทเธ *</label>\r\n                                <select\r\n                                    value={formData.speciesId}\r\n                                    onChange={(e) => setFormData({ ...formData, speciesId: e.target.value })}\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500\"\r\n                                    required\r\n                                >\r\n                                    <option value=\"\">-- เน€เธฅเธทเธญเธเธเธเธดเธ”เธเธทเธ --</option>\r\n                                    {species.map(s => (\r\n                                        <option key={s.id} value={s.id}>{s.nameTH} ({s.nameEN})</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n\r\n                            {/* Certificate */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เนเธเธฃเธฑเธเธฃเธญเธ GACP</label>\r\n                                <select\r\n                                    value={formData.certificateId}\r\n                                    onChange={(e) => setFormData({ ...formData, certificateId: e.target.value })}\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500\"\r\n                                >\r\n                                    <option value=\"\">-- เนเธกเนเธฃเธฐเธเธธ --</option>\r\n                                    {certificates.map(c => (\r\n                                        <option key={c.id} value={c.id}>{c.certificateNumber}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n\r\n                            {/* Plot Name */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เธเธทเนเธญเนเธเธฅเธ *</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={formData.plotName}\r\n                                    onChange={(e) => setFormData({ ...formData, plotName: e.target.value })}\r\n                                    placeholder=\"เน€เธเนเธ เนเธเธฅเธ A, เนเธเธฅเธเธฃเธดเธกเธเนเธณ\"\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Plot Area */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เธเธทเนเธเธ—เธตเน (เนเธฃเน) *</label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    step=\"0.01\"\r\n                                    value={formData.plotArea}\r\n                                    onChange={(e) => setFormData({ ...formData, plotArea: parseFloat(e.target.value) })}\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Start Date */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เธงเธฑเธเธ—เธตเนเน€เธฃเธดเนเธกเธเธฅเธนเธ *</label>\r\n                                <input\r\n                                    type=\"date\"\r\n                                    value={formData.startDate}\r\n                                    onChange={(e) => setFormData({ ...formData, startDate: e.target.value })}\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Expected Harvest Date */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เธงเธฑเธเธ—เธตเนเธเธฒเธ”เธงเนเธฒเธเธฐเน€เธเนเธเน€เธเธตเนเธขเธง</label>\r\n                                <input\r\n                                    type=\"date\"\r\n                                    value={formData.expectedHarvestDate}\r\n                                    onChange={(e) => setFormData({ ...formData, expectedHarvestDate: e.target.value })}\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Estimated Yield */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เธเธฅเธเธฅเธดเธ•เธ—เธตเนเธเธฒเธ”เธเธฒเธฃเธ“เน (เธเธ.)</label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    step=\"0.1\"\r\n                                    value={formData.estimatedYield}\r\n                                    onChange={(e) => setFormData({ ...formData, estimatedYield: parseFloat(e.target.value) })}\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Notes */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เธซเธกเธฒเธขเน€เธซเธ•เธธ</label>\r\n                                <textarea\r\n                                    value={formData.notes}\r\n                                    onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\r\n                                    rows={2}\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Actions */}\r\n                            <div className=\"flex gap-3 pt-4\">\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={() => setShowCreateModal(false)}\r\n                                    className=\"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50\"\r\n                                >\r\n                                    เธขเธเน€เธฅเธดเธ\r\n                                </button>\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    disabled={saving}\r\n                                    className=\"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50\"\r\n                                >\r\n                                    {saving ? 'เธเธณเธฅเธฑเธเธเธฑเธเธ—เธถเธ...' : 'เธชเธฃเนเธฒเธเธฃเธญเธ'}\r\n                                </button>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\tracking\\lots\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchBatches'. Either include it or remove the dependency array.","line":68,"column":8,"nodeType":"ArrayExpression","endLine":68,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchBatches]","fix":{"range":[1720,1722],"text":"[fetchBatches]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":280,"column":37,"nodeType":"JSXOpeningElement","endLine":280,"endColumn":109}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport Link from 'next/link';\r\nimport { useSearchParams } from 'next/navigation';\r\n\r\ninterface Lot {\r\n    id: string;\r\n    lotNumber: string;\r\n    packageType: string;\r\n    quantity: number;\r\n    unitWeight: number;\r\n    totalWeight: number;\r\n    status: string;\r\n    packagedAt: string;\r\n    expiryDate: string;\r\n    qrCode: string;\r\n    trackingUrl: string;\r\n    testStatus: string;\r\n    thcContent: number;\r\n    cbdContent: number;\r\n    batch: {\r\n        batchNumber: string;\r\n        harvestDate: string;\r\n        farm: {\r\n            farmName: string;\r\n        };\r\n        species: {\r\n            nameTH: string;\r\n        };\r\n    };\r\n}\r\n\r\ninterface HarvestBatch {\r\n    id: string;\r\n    batchNumber: string;\r\n    harvestDate: string;\r\n    status: string;\r\n    farm: {\r\n        farmName: string;\r\n    };\r\n    species: {\r\n        nameTH: string;\r\n    };\r\n}\r\n\r\nconst packageTypes: Record<string, string> = {\r\n    BAG_1KG: 'เธ–เธธเธ 1 เธเธ.',\r\n    BAG_500G: 'เธ–เธธเธ 500 เธเธฃเธฑเธก',\r\n    BOX_5KG: 'เธเธฅเนเธญเธ 5 เธเธ.',\r\n    BOTTLE_100ML: 'เธเธงเธ” 100 ml',\r\n    BOTTLE_500ML: 'เธเธงเธ” 500 ml',\r\n};\r\n\r\nexport default function LotsPage() {\r\n    const searchParams = useSearchParams();\r\n    const batchIdFromUrl = searchParams.get('batchId');\r\n\r\n    const [lots, setLots] = useState<Lot[]>([]);\r\n    const [batches, setBatches] = useState<HarvestBatch[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [selectedLot, setSelectedLot] = useState<Lot | null>(null);\r\n    const [qrDataUrl, setQrDataUrl] = useState<string>('');\r\n    const [selectedBatchId, setSelectedBatchId] = useState<string>(batchIdFromUrl || '');\r\n\r\n    useEffect(() => {\r\n        fetchBatches();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (selectedBatchId) {\r\n            fetchLots(selectedBatchId);\r\n        }\r\n    }, [selectedBatchId]);\r\n\r\n    async function fetchBatches() {\r\n        try {\r\n            const farmId = localStorage.getItem('currentFarmId') || localStorage.getItem('farmId');\r\n            if (!farmId) {\r\n                setLoading(false);\r\n                return;\r\n            }\r\n            const res = await fetch(`/api/proxy/harvest-batches?farmId=${farmId}`);\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                setBatches(data.data);\r\n                // Auto-select first batch if no batchId in URL\r\n                if (!batchIdFromUrl && data.data.length > 0) {\r\n                    setSelectedBatchId(data.data[0].id);\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching batches:', error);\r\n        } finally {\r\n            if (!selectedBatchId) {\r\n                setLoading(false);\r\n            }\r\n        }\r\n    }\r\n\r\n    async function fetchLots(batchId: string) {\r\n        setLoading(true);\r\n        try {\r\n            const res = await fetch(`/api/proxy/lots/batch/${batchId}`);\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                setLots(data.data);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching lots:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    const formatDate = (dateStr: string) => {\r\n        if (!dateStr) return '-';\r\n        return new Date(dateStr).toLocaleDateString('th-TH', {\r\n            year: 'numeric',\r\n            month: 'short',\r\n            day: 'numeric'\r\n        });\r\n    };\r\n\r\n    async function showQRPrint(lot: Lot) {\r\n        setSelectedLot(lot);\r\n        try {\r\n            const res = await fetch(`/api/proxy/lots/${lot.id}/qr/print`);\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                setQrDataUrl(data.data.label.qrCodeDataUrl);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching QR:', error);\r\n        }\r\n    }\r\n\r\n    function printQR() {\r\n        window.print();\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"p-6\">\r\n                <div className=\"animate-pulse space-y-4\">\r\n                    <div className=\"h-8 bg-gray-200 rounded w-1/4\"></div>\r\n                    <div className=\"h-32 bg-gray-200 rounded\"></div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-6\">\r\n            {/* Header */}\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n                <div>\r\n                    <h1 className=\"text-2xl font-bold text-gray-800\">๐“ฆ เธฅเนเธญเธ•เธเธฃเธฃเธเธธเธ เธฑเธ“เธ‘เน</h1>\r\n                    <p className=\"text-gray-500\">เธเธฑเธ”เธเธฒเธฃเธฅเนเธญเธ•เนเธฅเธฐเธเธดเธกเธเน QR Code</p>\r\n                </div>\r\n                <Link\r\n                    href=\"/tracking/cycles\"\r\n                    className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center\"\r\n                >\r\n                    <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\r\n                    </svg>\r\n                    เธชเธฃเนเธฒเธเธฅเนเธญเธ•เนเธซเธกเน\r\n                </Link>\r\n            </div>\r\n\r\n            {/* Batch Selector */}\r\n            {batches.length > 0 && (\r\n                <div className=\"bg-white rounded-xl shadow-sm border p-4 mb-6\">\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">เน€เธฅเธทเธญเธ Batch</label>\r\n                    <select\r\n                        value={selectedBatchId}\r\n                        onChange={(e) => setSelectedBatchId(e.target.value)}\r\n                        className=\"w-full md:w-1/2 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-green-500\"\r\n                    >\r\n                        <option value=\"\">-- เน€เธฅเธทเธญเธ Batch --</option>\r\n                        {batches.map(b => (\r\n                            <option key={b.id} value={b.id}>\r\n                                {b.batchNumber} โ€ข {b.species?.nameTH} โ€ข {formatDate(b.harvestDate)}\r\n                            </option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n            )}\r\n\r\n            {/* Empty State */}\r\n            {lots.length === 0 && (\r\n                <div className=\"bg-white rounded-xl shadow-sm border p-12 text-center\">\r\n                    <div className=\"text-6xl mb-4\">๐“ฆ</div>\r\n                    <h3 className=\"text-xl font-semibold text-gray-700 mb-2\">\r\n                        {selectedBatchId ? 'เธขเธฑเธเนเธกเนเธกเธตเธฅเนเธญเธ•เนเธ Batch เธเธตเน' : 'เธขเธฑเธเนเธกเนเธกเธตเธฅเนเธญเธ•เธเธฃเธฃเธเธธเธ เธฑเธ“เธ‘เน'}\r\n                    </h3>\r\n                    <p className=\"text-gray-500 mb-4\">\r\n                        {selectedBatchId\r\n                            ? 'เธชเธฃเนเธฒเธเธฅเนเธญเธ•เนเธซเธกเนเธเธฒเธเธซเธเนเธฒเธฃเธญเธเธเธฒเธฃเธเธฅเธนเธ'\r\n                            : 'เน€เธฃเธดเนเธกเธ•เนเธเธเธฒเธเธเธฒเธฃเธชเธฃเนเธฒเธเธฃเธญเธเธเธฒเธฃเธเธฅเธนเธเนเธฅเธฐเน€เธเนเธเน€เธเธตเนเธขเธงเธเนเธญเธ'}\r\n                    </p>\r\n                    <Link\r\n                        href=\"/tracking/cycles\"\r\n                        className=\"inline-block px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700\"\r\n                    >\r\n                        เนเธเธ—เธตเนเธฃเธญเธเธเธฒเธฃเธเธฅเธนเธ\r\n                    </Link>\r\n                </div>\r\n            )}\r\n\r\n            {/* Lots Grid */}\r\n            {lots.length > 0 && (\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    {lots.map((lot) => (\r\n                        <div key={lot.id} className=\"bg-white rounded-xl shadow-sm border p-6\">\r\n                            <div className=\"flex justify-between items-start mb-4\">\r\n                                <div>\r\n                                    <h3 className=\"font-mono font-semibold text-lg\">{lot.lotNumber}</h3>\r\n                                    <p className=\"text-gray-500\">{lot.batch?.species?.nameTH || '-'}</p>\r\n                                </div>\r\n                                <span className={`px-3 py-1 rounded-full text-sm ${lot.status === 'PACKAGED' ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-700'\r\n                                    }`}>\r\n                                    {lot.status === 'PACKAGED' ? 'เธเธฃเธฃเธเธธเนเธฅเนเธง' : lot.status}\r\n                                </span>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                                <div>\r\n                                    <span className=\"text-gray-500\">เธเธฃเธฃเธเธธเธ เธฑเธ“เธ‘เน</span>\r\n                                    <div className=\"font-medium\">{packageTypes[lot.packageType] || lot.packageType}</div>\r\n                                </div>\r\n                                <div>\r\n                                    <span className=\"text-gray-500\">เธเธณเธเธงเธ</span>\r\n                                    <div className=\"font-medium\">{lot.quantity} เธเธดเนเธ ({lot.totalWeight} เธเธ.)</div>\r\n                                </div>\r\n                                <div>\r\n                                    <span className=\"text-gray-500\">เธงเธฑเธเธเธฃเธฃเธเธธ</span>\r\n                                    <div className=\"font-medium\">{formatDate(lot.packagedAt)}</div>\r\n                                </div>\r\n                                <div>\r\n                                    <span className=\"text-gray-500\">เธซเธกเธ”เธญเธฒเธขเธธ</span>\r\n                                    <div className=\"font-medium text-red-600\">{formatDate(lot.expiryDate)}</div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"mt-4 pt-4 border-t flex justify-between\">\r\n                                <button\r\n                                    onClick={() => showQRPrint(lot)}\r\n                                    className=\"px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 flex items-center\"\r\n                                >\r\n                                    <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z\" />\r\n                                    </svg>\r\n                                    เธ”เธน QR Code\r\n                                </button>\r\n                                <Link\r\n                                    href={`/trace/${lot.qrCode}`}\r\n                                    target=\"_blank\"\r\n                                    className=\"px-4 py-2 text-gray-600 hover:text-gray-800\"\r\n                                >\r\n                                    เธ”เธนเธซเธเนเธฒ Trace โ’\r\n                                </Link>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            {/* QR Print Modal */}\r\n            {selectedLot && (\r\n                <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 print:bg-white print:relative\">\r\n                    <div className=\"bg-white rounded-2xl p-8 w-full max-w-md print:shadow-none print:rounded-none\">\r\n                        <div className=\"text-center print:text-left\">\r\n                            <h2 className=\"text-xl font-bold mb-4 print:hidden\">QR Code เธชเธณเธซเธฃเธฑเธเธเธดเธกเธเน</h2>\r\n\r\n                            {/* QR Label - This will be printed */}\r\n                            <div className=\"border-2 border-dashed border-gray-300 p-4 rounded-lg print:border-solid\">\r\n                                {qrDataUrl && (\r\n                                    <img src={qrDataUrl} alt=\"QR Code\" className=\"w-32 h-32 mx-auto mb-4\" />\r\n                                )}\r\n                                <div className=\"text-left\">\r\n                                    <div className=\"font-mono font-bold text-lg\">{selectedLot.lotNumber}</div>\r\n                                    <div className=\"text-sm text-gray-600\">{selectedLot.batch?.species?.nameTH}</div>\r\n                                    <div className=\"text-sm text-gray-600\">{selectedLot.batch?.farm?.farmName}</div>\r\n                                    <div className=\"text-sm mt-2\">\r\n                                        <span className=\"text-gray-500\">เน€เธเนเธเน€เธเธตเนเธขเธง:</span> {formatDate(selectedLot.batch?.harvestDate)}\r\n                                    </div>\r\n                                    <div className=\"text-sm\">\r\n                                        <span className=\"text-gray-500\">เธซเธกเธ”เธญเธฒเธขเธธ:</span> {formatDate(selectedLot.expiryDate)}\r\n                                    </div>\r\n                                    <div className=\"text-xs text-gray-400 mt-2\">เธชเนเธเธ QR เน€เธเธทเนเธญเธ”เธนเธเนเธญเธกเธนเธฅเธเธฅเธดเธ•เธ เธฑเธ“เธ‘เน</div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"mt-6 flex gap-4 print:hidden\">\r\n                                <button\r\n                                    onClick={() => setSelectedLot(null)}\r\n                                    className=\"flex-1 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200\"\r\n                                >\r\n                                    เธเธดเธ”\r\n                                </button>\r\n                                <button\r\n                                    onClick={printQR}\r\n                                    className=\"flex-1 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700\"\r\n                                >\r\n                                    ๐–จ๏ธ เธเธดเธกเธเน\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\tracking\\page.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadApplications` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\tracking\\page.tsx:58:9\n  56 |         }\n  57 |\n> 58 |         loadApplications();\n     |         ^^^^^^^^^^^^^^^^ `loadApplications` accessed before it is declared\n  59 |     }, [router]);\n  60 |\n  61 |     const loadApplications = async () => {\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\farmer\\tracking\\page.tsx:61:5\n  59 |     }, [router]);\n  60 |\n> 61 |     const loadApplications = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 62 |         const result = await api.get<Application[]>(\"/applications/my\");\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 63 |         if (result.success && result.data) {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 64 |             const apps = Array.isArray(result.data) ? result.data : (result.data as any).data || [];\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 65 |             setApplications(apps);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 66 |         }\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 67 |     };\n     | ^^^^^^^ `loadApplications` is declared here\n  68 |\n  69 |     const getStepForStatus = (status: string) => STEPS.findIndex(s => s.statuses.includes(status)) + 1;\n  70 |     const accentColor = isDark ? \"#10B981\" : \"#16A34A\";","line":58,"column":9,"nodeType":null,"endLine":58,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3118,3121],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3118,3121],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { apiClient as api } from \"@/lib/api/api-client\";\r\nimport { AuthService } from \"@/lib/services/auth-service\";\r\nimport PlantUnitList from \"@/components/PlantUnitList\";\r\n\r\n/* Reuse generic icons or keep specific ones if needed. \r\n   For now, defining local specific ones to ensure UI consistency with previous design \r\n   without needing to check shared library for every single path.\r\n*/\r\nconst Icons = {\r\n    check: (c: string) => <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke={c} strokeWidth=\"2.5\"><polyline points=\"20 6 9 17 4 12\" /></svg>,\r\n    clock: (c: string) => <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke={c} strokeWidth=\"1.5\"><circle cx=\"12\" cy=\"12\" r=\"10\" /><polyline points=\"12 6 12 12 16 14\" /></svg>,\r\n    compassLarge: (c: string) => <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"none\" stroke={c} strokeWidth=\"1.5\"><circle cx=\"12\" cy=\"12\" r=\"10\" /><polygon points=\"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76\" /></svg>,\r\n};\r\n\r\ninterface Application { _id: string; applicationNumber?: string; status: string; createdAt: string; data?: { farmId?: string }; }\r\n\r\nconst STEPS = [\r\n    { id: 1, label: \"เธขเธทเนเธเธเธณเธเธญ\", statuses: [\"DRAFT\"] },\r\n    { id: 2, label: \"เธเธณเธฃเธฐเธเธงเธ” 1\", statuses: [\"PAYMENT_1_PENDING\"] },\r\n    { id: 3, label: \"เธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ\", statuses: [\"SUBMITTED\", \"REVISION_REQ\"] },\r\n    { id: 4, label: \"เธเธณเธฃเธฐเธเธงเธ” 2\", statuses: [\"PAYMENT_2_PENDING\"] },\r\n    { id: 5, label: \"เธ•เธฃเธงเธเธชเธ–เธฒเธเธ—เธตเน\", statuses: [\"AUDIT_PENDING\", \"AUDIT_SCHEDULED\"] },\r\n    { id: 6, label: \"เธฃเธฑเธเธฃเธญเธ\", statuses: [\"CERTIFIED\"] },\r\n];\r\n\r\nconst STATUS_CONFIG: Record<string, { label: string; color: string }> = {\r\n    DRAFT: { label: \"เธฃเนเธฒเธ\", color: \"#6B7280\" },\r\n    PAYMENT_1_PENDING: { label: \"เธฃเธญเธเธณเธฃเธฐเน€เธเธดเธเธเธงเธ” 1\", color: \"#F59E0B\" },\r\n    SUBMITTED: { label: \"เธฃเธญเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ\", color: \"#3B82F6\" },\r\n    REVISION_REQ: { label: \"เธ•เนเธญเธเนเธเนเนเธ\", color: \"#EF4444\" },\r\n    PAYMENT_2_PENDING: { label: \"เธฃเธญเธเธณเธฃเธฐเน€เธเธดเธเธเธงเธ” 2\", color: \"#F59E0B\" },\r\n    AUDIT_PENDING: { label: \"เธฃเธญเธ•เธฃเธงเธเธชเธ–เธฒเธเธ—เธตเน\", color: \"#8B5CF6\" },\r\n    AUDIT_SCHEDULED: { label: \"เธเธฑเธ”เธ•เธฃเธงเธเนเธฅเนเธง\", color: \"#06B6D4\" },\r\n    CERTIFIED: { label: \"เนเธ”เนเธฃเธฑเธเธเธฒเธฃเธฃเธฑเธเธฃเธญเธ\", color: \"#10B981\" },\r\n};\r\n\r\nexport default function TrackingPage() {\r\n    const router = useRouter();\r\n    const [applications, setApplications] = useState<Application[]>([]);\r\n    const [mounted, setMounted] = useState(false);\r\n    const [isDark, setIsDark] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        setIsDark(localStorage.getItem(\"theme\") === \"dark\");\r\n\r\n        const user = AuthService.getUser();\r\n        if (!user) {\r\n            router.push(\"/login\");\r\n            return;\r\n        }\r\n\r\n        loadApplications();\r\n    }, [router]);\r\n\r\n    const loadApplications = async () => {\r\n        const result = await api.get<Application[]>(\"/applications/my\");\r\n        if (result.success && result.data) {\r\n            const apps = Array.isArray(result.data) ? result.data : (result.data as any).data || [];\r\n            setApplications(apps);\r\n        }\r\n    };\r\n\r\n    const getStepForStatus = (status: string) => STEPS.findIndex(s => s.statuses.includes(status)) + 1;\r\n    const accentColor = isDark ? \"#10B981\" : \"#16A34A\";\r\n\r\n    if (!mounted) return <div className={`min-h-screen flex items-center justify-center ${isDark ? 'bg-slate-900' : 'bg-stone-50'}`}><div className=\"w-10 h-10 border-3 border-slate-300 border-t-emerald-500 rounded-full animate-spin\" /></div>;\r\n\r\n    return (\r\n        <div className=\"p-6 lg:p-8 max-w-5xl mx-auto pb-24 lg:pb-8\">\r\n            <header className=\"mb-8\">\r\n                <h1 className=\"text-2xl lg:text-3xl font-medium\">เธ•เธดเธ”เธ•เธฒเธกเธชเธ–เธฒเธเธฐเธเธณเธเธญ</h1>\r\n                <p className={`text-sm mt-1 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>เธ•เธฃเธงเธเธชเธญเธเธเธงเธฒเธกเธเธทเธเธซเธเนเธฒเธเธฒเธฃเธเธญเนเธเธฃเธฑเธเธฃเธญเธ GACP</p>\r\n            </header>\r\n\r\n            {applications.length > 0 ? applications.map(app => {\r\n                const currentStep = getStepForStatus(app.status);\r\n                const statusInfo = STATUS_CONFIG[app.status];\r\n                return (\r\n                    <div key={app._id} className={`rounded-2xl p-7 mb-5 border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-slate-200'}`}>\r\n                        <div className=\"flex flex-wrap justify-between items-center gap-4 mb-6\">\r\n                            <div>\r\n                                <p className={`text-xs mb-1 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>เน€เธฅเธเธ—เธตเนเธเธณเธเธญ</p>\r\n                                <p className=\"text-xl font-semibold\">{app.applicationNumber || `#${app._id.slice(-6).toUpperCase()}`}</p>\r\n                            </div>\r\n                            <span className=\"px-4 py-2 rounded-full text-sm font-semibold\" style={{ backgroundColor: `${statusInfo?.color}15`, color: statusInfo?.color, border: `1px solid ${statusInfo?.color}30` }}>\r\n                                {statusInfo?.label}\r\n                            </span>\r\n                        </div>\r\n\r\n                        {/* Progress */}\r\n                        <div className=\"relative mb-6\">\r\n                            <div className={`h-1 rounded ${isDark ? 'bg-slate-700' : 'bg-slate-200'}`} />\r\n                            <div className=\"absolute top-0 left-0 h-1 rounded bg-gradient-to-r from-emerald-600 to-emerald-400 transition-all duration-500\" style={{ width: `${((currentStep - 1) / (STEPS.length - 1)) * 100}%` }} />\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-3 lg:grid-cols-6 gap-3\">\r\n                            {STEPS.map(step => {\r\n                                const isDone = step.id < currentStep;\r\n                                const isCurrent = step.id === currentStep;\r\n                                return (\r\n                                    <div key={step.id} className=\"text-center\">\r\n                                        <div className={`w-12 h-12 rounded-2xl mx-auto mb-2 flex items-center justify-center transition-all ${isDone ? 'bg-emerald-500' : isCurrent ? (isDark ? 'bg-emerald-900/50 border-2 border-emerald-500' : 'bg-emerald-50 border-2 border-emerald-500') : (isDark ? 'bg-slate-700' : 'bg-slate-200')}`}>\r\n                                            {isDone ? Icons.check(\"#FFF\") : isCurrent ? Icons.clock(accentColor) : <span className={`text-sm font-medium ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>{step.id}</span>}\r\n                                        </div>\r\n                                        <span className={`text-xs ${isCurrent ? 'text-emerald-500 font-semibold' : isDark ? 'text-slate-500' : 'text-slate-400'}`}>{step.label}</span>\r\n                                    </div>\r\n                                );\r\n                            })}\r\n                        </div>\r\n\r\n\r\n\r\n                        <div className={`mt-6 p-4 rounded-xl ${isDark ? 'bg-slate-700/50' : 'bg-slate-50'}`}>\r\n                            <div className=\"flex justify-between items-center mb-2\">\r\n                                <p className={`text-sm ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>\r\n                                    <strong>เธงเธฑเธเธ—เธตเนเธขเธทเนเธ:</strong> {new Date(app.createdAt).toLocaleDateString('th-TH', { year: 'numeric', month: 'long', day: 'numeric' })}\r\n                                </p>\r\n                            </div>\r\n\r\n                            {/* Insert PlantUnitList if Certified or Approved */}\r\n                            {(app.status === 'CERTIFIED' || app.status === 'AUDIT_SCHEDULED' || app.status === 'AUDIT_PENDING' || app.status === 'SUBMITTED') && app.data?.farmId && (\r\n                                <div className=\"mt-4 pt-4 border-t border-gray-200/50\">\r\n                                    <PlantUnitList farmId={app.data.farmId} applicationId={app._id} canEdit={true} />\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                );\r\n            }) : (\r\n                <div className={`rounded-2xl p-16 text-center border ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-slate-200'}`}>\r\n                    <div className={`w-20 h-20 rounded-2xl mx-auto mb-5 flex items-center justify-center ${isDark ? 'bg-emerald-900/30' : 'bg-emerald-50'}`}>{Icons.compassLarge(accentColor)}</div>\r\n                    <h3 className=\"text-lg font-medium mb-2\">เธขเธฑเธเนเธกเนเธกเธตเธเธณเธเธญเธ—เธตเนเธ•เนเธญเธเธ•เธดเธ”เธ•เธฒเธก</h3>\r\n                    <p className={`text-sm mb-5 ${isDark ? 'text-slate-500' : 'text-slate-400'}`}>เธขเธทเนเธเธเธณเธเธญเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ GACP เน€เธเธทเนเธญเน€เธฃเธดเนเธกเธ•เนเธ</p>\r\n                    <Link href=\"/farmer/applications/new\" className=\"inline-block px-6 py-3 rounded-xl bg-gradient-to-br from-emerald-600 to-emerald-500 text-white font-medium\">เธขเธทเนเธเธเธณเธเธญเนเธซเธกเน</Link>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\global-error.tsx","messages":[{"ruleId":"@next/next/no-html-link-for-pages","severity":2,"message":"Do not use an `<a>` element to navigate to `/`. Use `<Link />` from `next/link` instead. See: https://nextjs.org/docs/messages/no-html-link-for-pages","line":52,"column":29,"nodeType":"JSXOpeningElement","endLine":55,"endColumn":30}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\n/**\r\n * Custom 500 Error Page\r\n * Apple-Standard Global Error Handler with Thai locale\r\n */\r\n\r\nexport default function GlobalError({\r\n    error,\r\n    reset,\r\n}: {\r\n    error: Error & { digest?: string };\r\n    reset: () => void;\r\n}) {\r\n    return (\r\n        <html>\r\n            <body>\r\n                <div className=\"min-h-screen bg-gradient-to-br from-red-50 to-orange-100 flex items-center justify-center p-4\">\r\n                    <div className=\"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center\">\r\n                        {/* Apple-style error illustration */}\r\n                        <div className=\"w-32 h-32 mx-auto mb-6 rounded-full bg-red-100 flex items-center justify-center\">\r\n                            <svg width=\"64\" height=\"64\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#DC2626\" strokeWidth=\"1.5\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\" /><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\" /><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\" /></svg>\r\n                        </div>\r\n\r\n                        <h1 className=\"text-6xl font-bold text-red-600 mb-2\">500</h1>\r\n\r\n                        <h2 className=\"text-2xl font-semibold text-gray-800 mb-4\">\r\n                            เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เธเธญเธเธฃเธฐเธเธ\r\n                        </h2>\r\n\r\n                        <p className=\"text-gray-600 mb-8\">\r\n                            เธเธญเธญเธ เธฑเธข เธฃเธฐเธเธเน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เธ เธฒเธขเนเธ\r\n                            <br />\r\n                            เธ—เธตเธกเธเธฒเธเนเธ”เนเธฃเธฑเธเนเธเนเธเนเธฅเนเธงเนเธฅเธฐเธเธณเธฅเธฑเธเธ”เธณเน€เธเธดเธเธเธฒเธฃเนเธเนเนเธ\r\n                        </p>\r\n\r\n                        {/* Error digest for support */}\r\n                        {error.digest && (\r\n                            <p className=\"mb-6 text-sm text-gray-500 bg-gray-100 rounded-lg p-3\">\r\n                                เธฃเธซเธฑเธชเธเนเธญเธเธดเธ”เธเธฅเธฒเธ”: <code className=\"font-mono\">{error.digest}</code>\r\n                            </p>\r\n                        )}\r\n\r\n                        {/* Action buttons */}\r\n                        <div className=\"flex flex-col sm:flex-row gap-3 justify-center\">\r\n                            <button\r\n                                onClick={reset}\r\n                                className=\"px-6 py-3 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors font-medium\"\r\n                            >\r\n                                เธฅเธญเธเนเธซเธกเน\r\n                            </button>\r\n                            <a\r\n                                href=\"/\"\r\n                                className=\"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium\"\r\n                            >\r\n                                เธเธฅเธฑเธเธซเธเนเธฒเนเธฃเธ\r\n                            </a>\r\n                        </div>\r\n\r\n                        {/* Support contact */}\r\n                        <div className=\"mt-8 pt-6 border-t border-gray-100\">\r\n                            <p className=\"text-sm text-gray-600\">\r\n                                เธซเธฒเธเธเธฑเธเธซเธฒเธขเธฑเธเธเธเธญเธขเธนเน เธเธฃเธธเธ“เธฒเธ•เธดเธ”เธ•เนเธญ\r\n                            </p>\r\n                            <a\r\n                                href=\"mailto:support@gacp.go.th\"\r\n                                className=\"text-emerald-600 hover:underline font-medium\"\r\n                            >\r\n                                support@gacp.go.th\r\n                            </a>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </body>\r\n        </html>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\not-found.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\accounting\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4122,4125],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4122,4125],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":154,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":154,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":164,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7839,7842],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7839,7842],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":331,"column":75,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19708,19862],"text":"\r\n                                            เธเธฒเธฃเธเธฃเธฐเธ—เธณเธเธตเนเธเธฐเน€เธเธฅเธตเนเธขเธเธชเธ–เธฒเธเธฐเน€เธเนเธ &quot;เธเธณเธฃเธฐเนเธฅเนเธง\" เนเธฅเธฐเธญเธญเธเนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธเธ—เธฑเธเธ—เธต\r\n                                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19708,19862],"text":"\r\n                                            เธเธฒเธฃเธเธฃเธฐเธ—เธณเธเธตเนเธเธฐเน€เธเธฅเธตเนเธขเธเธชเธ–เธฒเธเธฐเน€เธเนเธ &ldquo;เธเธณเธฃเธฐเนเธฅเนเธง\" เนเธฅเธฐเธญเธญเธเนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธเธ—เธฑเธเธ—เธต\r\n                                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19708,19862],"text":"\r\n                                            เธเธฒเธฃเธเธฃเธฐเธ—เธณเธเธตเนเธเธฐเน€เธเธฅเธตเนเธขเธเธชเธ–เธฒเธเธฐเน€เธเนเธ &#34;เธเธณเธฃเธฐเนเธฅเนเธง\" เนเธฅเธฐเธญเธญเธเนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธเธ—เธฑเธเธ—เธต\r\n                                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19708,19862],"text":"\r\n                                            เธเธฒเธฃเธเธฃเธฐเธ—เธณเธเธตเนเธเธฐเน€เธเธฅเธตเนเธขเธเธชเธ–เธฒเธเธฐเน€เธเนเธ &rdquo;เธเธณเธฃเธฐเนเธฅเนเธง\" เนเธฅเธฐเธญเธญเธเนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธเธ—เธฑเธเธ—เธต\r\n                                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":331,"column":84,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[19708,19862],"text":"\r\n                                            เธเธฒเธฃเธเธฃเธฐเธ—เธณเธเธตเนเธเธฐเน€เธเธฅเธตเนเธขเธเธชเธ–เธฒเธเธฐเน€เธเนเธ \"เธเธณเธฃเธฐเนเธฅเนเธง&quot; เนเธฅเธฐเธญเธญเธเนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธเธ—เธฑเธเธ—เธต\r\n                                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[19708,19862],"text":"\r\n                                            เธเธฒเธฃเธเธฃเธฐเธ—เธณเธเธตเนเธเธฐเน€เธเธฅเธตเนเธขเธเธชเธ–เธฒเธเธฐเน€เธเนเธ \"เธเธณเธฃเธฐเนเธฅเนเธง&ldquo; เนเธฅเธฐเธญเธญเธเนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธเธ—เธฑเธเธ—เธต\r\n                                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[19708,19862],"text":"\r\n                                            เธเธฒเธฃเธเธฃเธฐเธ—เธณเธเธตเนเธเธฐเน€เธเธฅเธตเนเธขเธเธชเธ–เธฒเธเธฐเน€เธเนเธ \"เธเธณเธฃเธฐเนเธฅเนเธง&#34; เนเธฅเธฐเธญเธญเธเนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธเธ—เธฑเธเธ—เธต\r\n                                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[19708,19862],"text":"\r\n                                            เธเธฒเธฃเธเธฃเธฐเธ—เธณเธเธตเนเธเธฐเน€เธเธฅเธตเนเธขเธเธชเธ–เธฒเธเธฐเน€เธเนเธ \"เธเธณเธฃเธฐเนเธฅเนเธง&rdquo; เนเธฅเธฐเธญเธญเธเนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธเธ—เธฑเธเธ—เธต\r\n                                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":342,"column":41,"nodeType":"JSXOpeningElement","endLine":346,"endColumn":43}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState, useCallback } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { apiClient as api } from \"@/lib/api\";\r\nimport StaffLayout from \"../components/StaffLayout\";\r\nimport { IconDocument, IconCreditCard, IconCheckCircle, IconClock } from \"@/components/ui/icons\";\r\n\r\n// Additional icons\r\nconst IconDollar = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"23\" />\r\n        <path d=\"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\" />\r\n    </svg>\r\n);\r\n\r\nconst IconWarning = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\" />\r\n        <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\" />\r\n        <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\" />\r\n    </svg>\r\n);\r\n\r\nconst IconDownload = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\r\n        <polyline points=\"7 10 12 15 17 10\" />\r\n        <line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" />\r\n    </svg>\r\n);\r\n\r\nconst IconEye = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\" />\r\n        <circle cx=\"12\" cy=\"12\" r=\"3\" />\r\n    </svg>\r\n);\r\n\r\ninterface InvoiceItem {\r\n    _id: string;\r\n    invoiceNumber: string;\r\n    applicationNumber: string;\r\n    farmerName: string;\r\n    amount: number;\r\n    status: \"PENDING\" | \"PAID\" | \"OVERDUE\" | \"CANCELLED\" | \"payment_verification_pending\";\r\n    dueDate: string;\r\n    paidAt?: string;\r\n    createdAt: string;\r\n    notes?: string; // Added for slip parsing\r\n    id: string; // Ensure we have id\r\n}\r\n\r\ninterface PaymentSummary {\r\n    totalRevenue: number;\r\n    pendingAmount: number;\r\n    overdueAmount: number;\r\n    monthlyRevenue: number;\r\n    invoiceCount: { total: number; pending: number; paid: number; overdue: number };\r\n}\r\n\r\nexport default function AccountingDashboard() {\r\n    const router = useRouter();\r\n    const [summary, setSummary] = useState<PaymentSummary | null>(null);\r\n    const [invoices, setInvoices] = useState<InvoiceItem[]>([]);\r\n    const [activeTab, setActiveTab] = useState<\"all\" | \"pending\" | \"paid\" | \"overdue\">(\"all\");\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [isDark, setIsDark] = useState(false);\r\n\r\n    // Modal State\r\n    const [selectedInvoice, setSelectedInvoice] = useState<InvoiceItem | null>(null);\r\n    const [isVerifying, setIsVerifying] = useState(false);\r\n\r\n    const fetchData = useCallback(async () => {\r\n        setIsLoading(true);\r\n        try {\r\n            const [summaryRes, invoicesRes] = await Promise.all([\r\n                api.get<{ data: PaymentSummary }>('/api/invoices/summary'),\r\n                api.get<{ data: { invoices: InvoiceItem[] } }>('/api/invoices')\r\n            ]);\r\n            if (summaryRes.success && summaryRes.data) setSummary(summaryRes.data);\r\n            else setSummary({ totalRevenue: 0, pendingAmount: 0, overdueAmount: 0, monthlyRevenue: 0, invoiceCount: { total: 0, pending: 0, paid: 0, overdue: 0 } });\r\n\r\n            if (invoicesRes.success && invoicesRes.data?.invoices) {\r\n                // Map _id to id if needed, Prisma usually returns id\r\n                const mappedInvoices = invoicesRes.data.invoices.map((inv: any) => ({\r\n                    ...inv,\r\n                    items: inv.items ? (typeof inv.items === 'string' ? JSON.parse(inv.items) : inv.items) : [],\r\n                }));\r\n                setInvoices(mappedInvoices);\r\n            }\r\n            else setInvoices([]);\r\n        } catch { setSummary(null); setInvoices([]); }\r\n        finally { setIsLoading(false); }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        setIsDark(localStorage.getItem(\"theme\") === \"dark\");\r\n        const token = localStorage.getItem(\"staff_token\");\r\n        const userData = localStorage.getItem(\"staff_user\");\r\n        if (!token || !userData) { router.push(\"/staff/login\"); return; }\r\n        try {\r\n            const user = JSON.parse(userData);\r\n            if (![\"ACCOUNTANT\", \"ADMIN\", \"SUPER_ADMIN\", \"accountant\", \"admin\"].includes(user.role)) {\r\n                router.push(\"/staff/dashboard\"); return;\r\n            }\r\n            fetchData();\r\n        } catch { router.push(\"/staff/login\"); }\r\n    }, [router, fetchData]);\r\n\r\n    const formatCurrency = (amt: number) => new Intl.NumberFormat(\"th-TH\", { style: \"currency\", currency: \"THB\", minimumFractionDigits: 0 }).format(amt);\r\n    const formatDate = (d: string) => new Date(d).toLocaleDateString(\"th-TH\", { year: \"numeric\", month: \"short\", day: \"numeric\" });\r\n\r\n    const getStatusBadge = (status: string) => {\r\n        const config: Record<string, { color: string; label: string }> = {\r\n            PENDING: { color: \"bg-amber-100 text-amber-700\", label: \"เธฃเธญเธเธณเธฃเธฐ\" },\r\n            PAID: { color: \"bg-emerald-100 text-emerald-700\", label: \"เธเธณเธฃเธฐเนเธฅเนเธง\" },\r\n            OVERDUE: { color: \"bg-red-100 text-red-700\", label: \"เน€เธเธดเธเธเธณเธซเธเธ”\" },\r\n            CANCELLED: { color: \"bg-slate-100 text-slate-700\", label: \"เธขเธเน€เธฅเธดเธ\" },\r\n            payment_verification_pending: { color: \"bg-blue-100 text-blue-700\", label: \"เธฃเธญเธ•เธฃเธงเธเธชเธญเธ\" }\r\n        };\r\n        const c = config[status] || { color: \"bg-gray-100\", label: status };\r\n        return <span className={`px-3 py-1 rounded-lg text-xs font-medium ${c.color}`}>{c.label}</span>;\r\n    };\r\n\r\n    // Extract slip filename from notes\r\n    const getSlipUrl = (notes?: string) => {\r\n        if (!notes) return null;\r\n        const match = notes.match(/\\[Slip Uploaded: (.*?)\\]/);\r\n        if (match && match[1]) {\r\n            // BACKEND_URL needs to be accessible. \r\n            // We can hardcode specific dev/prod logic or just use relative if proxy was set up (it isn't for /uploads).\r\n            // Using direct port 5000 for now or relying on Next.js env.\r\n            // A robust way: use the API base and strip '/api'\r\n            return `http://localhost:5000/uploads/${match[1]}`;\r\n        }\r\n        return null;\r\n    };\r\n\r\n    const handleVerifyPayment = async () => {\r\n        if (!selectedInvoice) return;\r\n        if (!confirm(\"เธขเธทเธเธขเธฑเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธเนเธเนเธซเธฃเธทเธญเนเธกเน?\")) return;\r\n\r\n        setIsVerifying(true);\r\n        try {\r\n            const res = await api.post(`/api/invoices/${selectedInvoice.id}/pay`, { transactionId: 'MANUAL_VERIFY' });\r\n            if (res.success) {\r\n                alert(\"เธเธฑเธเธ—เธถเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธเน€เธฃเธตเธขเธเธฃเนเธญเธขเนเธฅเนเธง\");\r\n                setSelectedInvoice(null);\r\n                fetchData();\r\n            } else {\r\n                alert(\"เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”: \" + res.error);\r\n            }\r\n        } catch (error) {\r\n            alert(\"เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเน€เธเธทเนเธญเธกเธ•เนเธญ\");\r\n        } finally {\r\n            setIsVerifying(false);\r\n        }\r\n    };\r\n\r\n    const filteredInvoices = invoices.filter(inv => {\r\n        if (activeTab === \"all\") return true;\r\n        if (activeTab === \"pending\") return inv.status === \"PENDING\" || inv.status === \"payment_verification_pending\";\r\n        return inv.status === (activeTab.toUpperCase() as any);\r\n    });\r\n\r\n    const stats = [\r\n        { label: \"เธฃเธฒเธขเนเธ”เนเธฃเธงเธก\", value: summary ? formatCurrency(summary.totalRevenue) : \"เธฟ0\", Icon: IconDollar, bgColor: \"bg-emerald-500\", sub: `${summary?.invoiceCount.paid || 0} เนเธเน€เธชเธฃเนเธ` },\r\n        { label: \"เธฃเธญเธเธณเธฃเธฐ\", value: summary ? formatCurrency(summary.pendingAmount) : \"เธฟ0\", Icon: IconClock, bgColor: \"bg-amber-500\", sub: `${summary?.invoiceCount.pending || 0} เธฃเธฒเธขเธเธฒเธฃ` },\r\n        { label: \"เน€เธเธดเธเธเธณเธซเธเธ”\", value: summary ? formatCurrency(summary.overdueAmount) : \"เธฟ0\", Icon: IconWarning, bgColor: \"bg-red-500\", sub: `${summary?.invoiceCount.overdue || 0} เธฃเธฒเธขเธเธฒเธฃ` },\r\n        { label: \"เธฃเธฒเธขเนเธ”เนเน€เธ”เธทเธญเธเธเธตเน\", value: summary ? formatCurrency(summary.monthlyRevenue) : \"เธฟ0\", Icon: IconCreditCard, bgColor: \"bg-blue-500\", sub: \"เธก.เธ. 2569\" },\r\n    ];\r\n\r\n    if (isLoading && invoices.length === 0) {\r\n        return (\r\n            <StaffLayout title=\"เธฃเธฐเธเธเธเธฑเธเธเธต\" subtitle=\"เธเธณเธฅเธฑเธเนเธซเธฅเธ”...\">\r\n                <div className=\"flex justify-center py-20\">\r\n                    <div className=\"w-12 h-12 border-4 border-emerald-200 border-t-emerald-600 rounded-full animate-spin\" />\r\n                </div>\r\n            </StaffLayout>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <StaffLayout title=\"เธฃเธฐเธเธเธเธฑเธเธเธตเนเธฅเธฐเธเธฒเธฃเน€เธเธดเธ\" subtitle=\"Accountant Dashboard\">\r\n            {/* Summary Cards */}\r\n            <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\r\n                {stats.map((stat, i) => (\r\n                    <div key={i} className={`p-4 rounded-xl border transition-all hover:shadow-md ${isDark ? 'bg-slate-800/50 border-slate-700/50' : 'bg-white border-slate-200'}`}>\r\n                        <div className=\"flex items-center justify-between mb-3\">\r\n                            <span className={`text-xs font-medium ${isDark ? 'text-slate-400' : 'text-slate-500'}`}>{stat.label}</span>\r\n                            <div className={`w-8 h-8 rounded-lg ${stat.bgColor} flex items-center justify-center`}>\r\n                                <stat.Icon size={16} className=\"text-white\" />\r\n                            </div>\r\n                        </div>\r\n                        <p className=\"text-xl font-semibold\">{stat.value}</p>\r\n                        <p className=\"text-xs text-slate-400 mt-1\">{stat.sub}</p>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Invoice Table */}\r\n            <div className={`rounded-xl overflow-hidden border ${isDark ? 'bg-slate-800/50 border-slate-700/50' : 'bg-white border-slate-200'}`}>\r\n                <div className={`px-6 py-4 border-b flex items-center justify-between flex-wrap gap-4 ${isDark ? 'border-slate-700' : 'border-slate-200'}`}>\r\n                    <div className=\"flex gap-2\">\r\n                        {[\r\n                            { key: \"all\", label: \"เธ—เธฑเนเธเธซเธกเธ”\", count: invoices.length },\r\n                            { key: \"pending\", label: \"เธฃเธญเธเธณเธฃเธฐ\", count: invoices.filter(i => i.status === \"PENDING\" || i.status === \"payment_verification_pending\").length },\r\n                            { key: \"paid\", label: \"เธเธณเธฃเธฐเนเธฅเนเธง\", count: invoices.filter(i => i.status === \"PAID\").length },\r\n                            { key: \"overdue\", label: \"เน€เธเธดเธเธเธณเธซเธเธ”\", count: invoices.filter(i => i.status === \"OVERDUE\").length },\r\n                        ].map(tab => (\r\n                            <button\r\n                                key={tab.key}\r\n                                onClick={() => setActiveTab(tab.key as typeof activeTab)}\r\n                                className={`px-4 py-2 rounded-xl text-sm font-medium transition-all ${activeTab === tab.key ? \"bg-emerald-600 text-white\" : `${isDark ? 'bg-slate-700 text-slate-300' : 'bg-slate-100 text-slate-600'} hover:bg-slate-200`\r\n                                    }`}\r\n                            >\r\n                                {tab.label} ({tab.count})\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                    <button className=\"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-xl text-sm hover:bg-emerald-700\">\r\n                        <IconDownload size={16} /> เธชเนเธเธญเธญเธ Excel\r\n                    </button>\r\n                </div>\r\n\r\n                <div className=\"overflow-x-auto\">\r\n                    <table className=\"w-full\">\r\n                        <thead className={isDark ? 'bg-slate-700' : 'bg-slate-50'}>\r\n                            <tr>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase\">เน€เธฅเธเธ—เธตเนเนเธเนเธเนเธเธซเธเธตเน</th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase\">เธเธนเนเธเธฃเธฐเธเธญเธเธเธฒเธฃ</th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase\">เธเธณเธเธงเธเน€เธเธดเธ</th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase\">เธชเธ–เธฒเธเธฐ</th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase\">เธเธณเธซเธเธ”เธเธณเธฃเธฐ</th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase\">เธเธฒเธฃเธ”เธณเน€เธเธดเธเธเธฒเธฃ</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className={`divide-y ${isDark ? 'divide-slate-700' : 'divide-slate-200'}`}>\r\n                            {filteredInvoices.map(inv => (\r\n                                <tr key={inv.id} className={`${isDark ? 'hover:bg-slate-700/50' : 'hover:bg-slate-50'} transition-colors`}>\r\n                                    <td className=\"px-6 py-4\">\r\n                                        <p className=\"font-mono text-sm font-semibold\">{inv.invoiceNumber}</p>\r\n                                        <p className=\"text-xs text-slate-400\">{inv.applicationNumber}</p>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 text-sm\">{inv.farmerName}</td>\r\n                                    <td className=\"px-6 py-4 text-sm font-semibold\">{formatCurrency(inv.amount)}</td>\r\n                                    <td className=\"px-6 py-4\">{getStatusBadge(inv.status)}</td>\r\n                                    <td className=\"px-6 py-4\">\r\n                                        <p className=\"text-sm\">{formatDate(inv.dueDate)}</p>\r\n                                        {inv.paidAt && <p className=\"text-xs text-emerald-600\">เธเธณเธฃเธฐ: {formatDate(inv.paidAt)}</p>}\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4\">\r\n                                        <div className=\"flex gap-2\">\r\n                                            <button\r\n                                                onClick={() => setSelectedInvoice(inv)}\r\n                                                className={`flex items-center gap-1 px-3 py-1.5 text-xs rounded-lg ${isDark ? 'bg-slate-700 text-slate-300' : 'bg-slate-100 text-slate-700'}`}>\r\n                                                <IconEye size={12} /> เธ”เธน\r\n                                            </button>\r\n                                            {inv.status === \"payment_verification_pending\" && (\r\n                                                <button\r\n                                                    onClick={() => { setSelectedInvoice(inv); }}\r\n                                                    className=\"flex items-center gap-1 px-3 py-1.5 text-xs bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200\">\r\n                                                    <IconCheckCircle size={12} /> เธ•เธฃเธงเธเธชเธญเธ\r\n                                                </button>\r\n                                            )}\r\n                                        </div>\r\n                                    </td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n                {filteredInvoices.length === 0 && (\r\n                    <div className=\"p-12 text-center text-slate-400\">\r\n                        <IconDocument size={32} className=\"mx-auto mb-3\" />\r\n                        <p>เนเธกเนเธเธเธฃเธฒเธขเธเธฒเธฃ</p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Payment Verification Modal */}\r\n            {selectedInvoice && (\r\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm\">\r\n                    <div className={`max-w-4xl w-full max-h-[90vh] overflow-y-auto rounded-2xl shadow-2xl ${isDark ? 'bg-slate-800' : 'bg-white'}`}>\r\n                        <div className=\"p-6 border-b border-slate-200 flex justify-between items-center sticky top-0 bg-inherit z-10\">\r\n                            <div>\r\n                                <h3 className=\"text-lg font-bold\">เธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”เธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ</h3>\r\n                                <p className=\"text-sm text-slate-500\">Invoice: {selectedInvoice.invoiceNumber}</p>\r\n                            </div>\r\n                            <button onClick={() => setSelectedInvoice(null)} className=\"p-2 hover:bg-slate-100 rounded-full\">\r\n                                โ•\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"p-6 grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                            {/* Invoice Info */}\r\n                            <div className=\"space-y-4\">\r\n                                <h4 className=\"font-semibold text-emerald-600 border-b pb-2\">เธเนเธญเธกเธนเธฅเนเธเนเธเนเธเธซเธเธตเน</h4>\r\n                                <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                                    <div className=\"text-slate-500\">เธเธณเธเธงเธเน€เธเธดเธ:</div>\r\n                                    <div className=\"font-bold text-lg\">{formatCurrency(selectedInvoice.amount)}</div>\r\n\r\n                                    <div className=\"text-slate-500\">เธงเธฑเธเธ—เธตเนเธญเธญเธเน€เธญเธเธชเธฒเธฃ:</div>\r\n                                    <div>{formatDate(selectedInvoice.createdAt)}</div>\r\n\r\n                                    <div className=\"text-slate-500\">เธเธณเธซเธเธ”เธเธณเธฃเธฐ:</div>\r\n                                    <div>{formatDate(selectedInvoice.dueDate)}</div>\r\n\r\n                                    <div className=\"text-slate-500\">เน€เธเธฉเธ•เธฃเธเธฃ:</div>\r\n                                    <div>{selectedInvoice.farmerName}</div>\r\n\r\n                                    <div className=\"text-slate-500\">เน€เธฅเธเธ—เธตเนเนเธเธชเธกเธฑเธเธฃ:</div>\r\n                                    <div>{selectedInvoice.applicationNumber}</div>\r\n\r\n                                    <div className=\"text-slate-500\">เธชเธ–เธฒเธเธฐเธเธฑเธเธเธธเธเธฑเธ:</div>\r\n                                    <div>{getStatusBadge(selectedInvoice.status)}</div>\r\n                                </div>\r\n\r\n                                {(selectedInvoice.status === \"PENDING\" || selectedInvoice.status === \"payment_verification_pending\") && (\r\n                                    <div className=\"pt-4 mt-4 border-t\">\r\n                                        <button\r\n                                            onClick={handleVerifyPayment}\r\n                                            disabled={isVerifying}\r\n                                            className=\"w-full py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-bold shadow-lg shadow-emerald-200 transition-all flex justify-center items-center gap-2\">\r\n                                            {isVerifying ? 'เธเธณเธฅเธฑเธเธเธฑเธเธ—เธถเธ...' :\r\n                                                <><IconCheckCircle /> เธขเธทเธเธขเธฑเธเธเธฒเธฃเนเธ”เนเธฃเธฑเธเน€เธเธดเธเธ–เธนเธเธ•เนเธญเธ</>\r\n                                            }\r\n                                        </button>\r\n                                        <p className=\"text-xs text-center text-slate-400 mt-2\">\r\n                                            เธเธฒเธฃเธเธฃเธฐเธ—เธณเธเธตเนเธเธฐเน€เธเธฅเธตเนเธขเธเธชเธ–เธฒเธเธฐเน€เธเนเธ \"เธเธณเธฃเธฐเนเธฅเนเธง\" เนเธฅเธฐเธญเธญเธเนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธเธ—เธฑเธเธ—เธต\r\n                                        </p>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Slip Image */}\r\n                            <div className=\"bg-slate-50 rounded-xl p-4 border border-slate-200 flex flex-col items-center\">\r\n                                <h4 className=\"font-semibold text-slate-700 mb-4 w-full\">เธซเธฅเธฑเธเธเธฒเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ</h4>\r\n                                {getSlipUrl(selectedInvoice.notes) ? (\r\n                                    <a href={getSlipUrl(selectedInvoice.notes)!} target=\"_blank\" rel=\"noopener noreferrer\" className=\"block w-full\">\r\n                                        <img\r\n                                            src={getSlipUrl(selectedInvoice.notes)!}\r\n                                            alt=\"Payment Slip\"\r\n                                            className=\"w-full h-auto rounded-lg shadow-sm hover:shadow-md transition-shadow cursor-zoom-in\"\r\n                                        />\r\n                                        <p className=\"text-center text-xs text-blue-500 mt-2\">เธเธฅเธดเธเน€เธเธทเนเธญเธ”เธนเธฃเธนเธเธเธขเธฒเธข</p>\r\n                                    </a>\r\n                                ) : (\r\n                                    <div className=\"flex flex-col items-center justify-center h-64 text-slate-400 w-full bg-slate-100 rounded-lg border-dashed border-2 border-slate-300\">\r\n                                        <IconDocument size={48} className=\"mb-2 opacity-50\" />\r\n                                        <p>เนเธกเนเธเธเธซเธฅเธฑเธเธเธฒเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ</p>\r\n                                        <p className=\"text-xs\">เธซเธฃเธทเธญเธขเธฑเธเนเธกเนเนเธ”เนเธญเธฑเธเนเธซเธฅเธ”</p>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n        </StaffLayout>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\analytics\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'router'. Either include it or remove the dependency array.","line":61,"column":8,"nodeType":"ArrayExpression","endLine":61,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [router]","fix":{"range":[2952,2954],"text":"[router]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport StaffLayout from \"../components/StaffLayout\";\r\nimport { IconChart, IconDocument, IconLeaf, IconCheckCircle } from \"@/components/ui/icons\";\r\n\r\n// Additional icons\r\nconst IconRefresh = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <polyline points=\"23 4 23 10 17 10\" />\r\n        <polyline points=\"1 20 1 14 7 14\" />\r\n        <path d=\"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15\" />\r\n    </svg>\r\n);\r\n\r\nconst IconDownload = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\r\n        <polyline points=\"7 10 12 15 17 10\" />\r\n        <line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" />\r\n    </svg>\r\n);\r\n\r\nconst IconTrendUp = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <polyline points=\"23 6 13.5 15.5 8.5 10.5 1 18\" />\r\n        <polyline points=\"17 6 23 6 23 12\" />\r\n    </svg>\r\n);\r\n\r\nconst IconMapPin = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z\" />\r\n        <circle cx=\"12\" cy=\"10\" r=\"3\" />\r\n    </svg>\r\n);\r\n\r\ninterface DashboardData {\r\n    overview: { totalApplications: number; pendingReview: number; approved: number; rejected: number; };\r\n    byStatus: Record<string, number>;\r\n    byPlantType: Record<string, number>;\r\n    byProvince: Record<string, number>;\r\n    monthlyTrend: Array<{ month: number; applications: number; approved: number }>;\r\n}\r\n\r\nexport default function AnalyticsPage() {\r\n    const router = useRouter();\r\n    const [data, setData] = useState<DashboardData | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [mounted, setMounted] = useState(false);\r\n    const [isDark, setIsDark] = useState(false);\r\n    const [exporting, setExporting] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        setIsDark(localStorage.getItem(\"theme\") === \"dark\");\r\n        const token = localStorage.getItem(\"staff_token\");\r\n        if (!token) { router.push(\"/staff/login\"); return; }\r\n        loadData();\r\n    }, []);\r\n\r\n    const loadData = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const res = await fetch(\"/api/reports/dashboard\", { credentials: \"include\" });\r\n            const result = await res.json();\r\n            if (result.success) setData(result.data);\r\n            else setData({\r\n                overview: { totalApplications: 1234, pendingReview: 45, approved: 1089, rejected: 100 },\r\n                byStatus: { CERTIFIED: 1003, AUDIT_PENDING: 56, SUBMITTED: 45, PAYMENT_1_PENDING: 34, DRAFT: 23 },\r\n                byPlantType: { 'เธเธฑเธเธเธฒ': 450, 'เธเธฃเธฐเธ—เนเธญเธก': 320, 'เธเธกเธดเนเธเธเธฑเธ': 180, 'เธเธดเธ': 120, 'เธเธฃเธฐเธเธฒเธขเธ”เธณ': 90 },\r\n                byProvince: { 'เธเธฃเธธเธเน€เธ—เธเธฏ': 120, 'เน€เธเธตเธขเธเนเธซเธกเน': 98, 'เธเธเธฃเธฃเธฒเธเธชเธตเธกเธฒ': 87, 'เธเธญเธเนเธเนเธ': 76, 'เธญเธธเธเธฅเธฏ': 65 },\r\n                monthlyTrend: Array.from({ length: 12 }, (_, i) => ({ month: i + 1, applications: Math.floor(Math.random() * 100) + 50, approved: Math.floor(Math.random() * 80) + 30 })),\r\n            });\r\n        } catch { setData({ overview: { totalApplications: 1234, pendingReview: 45, approved: 1089, rejected: 100 }, byStatus: { CERTIFIED: 1003 }, byPlantType: { 'เธเธฑเธเธเธฒ': 450 }, byProvince: { 'เธเธฃเธธเธเน€เธ—เธเธฏ': 120 }, monthlyTrend: Array.from({ length: 12 }, (_, i) => ({ month: i + 1, applications: 70, approved: 50 })) }); }\r\n        finally { setLoading(false); }\r\n    };\r\n\r\n    const handleExport = (format: 'csv' | 'json', type: string) => {\r\n        setExporting(true);\r\n        window.open(`/api/reports/export?format=${format}&type=${type}`, '_blank');\r\n        setExporting(false);\r\n    };\r\n\r\n    if (!mounted) return null;\r\n\r\n    const getMaxValue = (obj: Record<string, number>) => Math.max(...Object.values(obj), 1);\r\n    const chartColors = ['bg-emerald-500', 'bg-blue-500', 'bg-amber-500', 'bg-red-500', 'bg-violet-500', 'bg-cyan-500'];\r\n    const months = ['เธก.เธ.', 'เธ.เธ.', 'เธกเธต.เธ.', 'เน€เธก.เธข.', 'เธ.เธ.', 'เธกเธด.เธข.', 'เธ.เธ.', 'เธช.เธ.', 'เธ.เธข.', 'เธ•.เธ.', 'เธ.เธข.', 'เธ.เธ.'];\r\n\r\n    return (\r\n        <StaffLayout title=\"Analytics Dashboard\" subtitle=\"เธ เธฒเธเธฃเธงเธกเนเธฅเธฐเธชเธ–เธดเธ•เธดเธฃเธฐเธเธเธฃเธฑเธเธฃเธญเธ GACP\">\r\n            <div className=\"flex gap-3 mb-8\">\r\n                <button onClick={loadData} disabled={loading} className={`flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm ${isDark ? 'bg-slate-700 border border-slate-600 text-slate-300' : 'bg-white border border-slate-200 text-slate-600'}`}>\r\n                    <IconRefresh size={16} /> เธฃเธตเน€เธเธฃเธ\r\n                </button>\r\n                <button onClick={() => handleExport('csv', 'applications')} disabled={exporting} className=\"flex items-center gap-2 px-5 py-2.5 rounded-xl bg-emerald-600 text-white text-sm font-medium\">\r\n                    <IconDownload size={16} /> Export CSV\r\n                </button>\r\n            </div>\r\n\r\n            {loading ? (\r\n                <div className=\"flex justify-center p-24\">\r\n                    <div className=\"w-10 h-10 border-3 border-emerald-500/30 border-t-emerald-500 rounded-full animate-spin\" />\r\n                </div>\r\n            ) : data ? (\r\n                <>\r\n                    {/* Overview Cards */}\r\n                    <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\r\n                        {[\r\n                            { label: \"เธเธณเธเธญเธ—เธฑเนเธเธซเธกเธ”\", value: data.overview.totalApplications, Icon: IconDocument, bgColor: \"bg-emerald-500\", trend: \"+12%\", up: true },\r\n                            { label: \"เธฃเธญเธ•เธฃเธงเธเธชเธญเธ\", value: data.overview.pendingReview, Icon: IconChart, bgColor: \"bg-blue-500\", trend: \"-5%\", up: false },\r\n                            { label: \"เนเธ”เนเธฃเธฑเธเธฃเธญเธ\", value: data.overview.approved, Icon: IconCheckCircle, bgColor: \"bg-emerald-500\", trend: \"+8%\", up: true },\r\n                            { label: \"เนเธกเนเธเนเธฒเธ\", value: data.overview.rejected, Icon: IconDocument, bgColor: \"bg-red-500\", trend: \"-2%\", up: false },\r\n                        ].map((card, i) => (\r\n                            <div key={i} className={`p-5 rounded-xl border ${isDark ? 'bg-slate-800/50 border-slate-700/50' : 'bg-white border-slate-200'}`}>\r\n                                <div className=\"flex items-center justify-between mb-3\">\r\n                                    <span className=\"text-sm text-slate-500\">{card.label}</span>\r\n                                    <div className={`w-8 h-8 rounded-lg ${card.bgColor} flex items-center justify-center`}>\r\n                                        <card.Icon size={16} className=\"text-white\" />\r\n                                    </div>\r\n                                </div>\r\n                                <p className=\"text-2xl font-semibold\">{card.value.toLocaleString()}</p>\r\n                                <div className=\"flex items-center gap-1 mt-2\">\r\n                                    <span className={`text-xs ${card.up ? 'text-emerald-500' : 'text-red-500'}`}>{card.up ? 'โ‘' : 'โ“'} {card.trend}</span>\r\n                                    <span className=\"text-xs text-slate-500\">vs เน€เธ”เธทเธญเธเธเนเธญเธ</span>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n\r\n                    {/* Charts Row */}\r\n                    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 mb-8\">\r\n                        {/* Monthly Trend */}\r\n                        <div className={`lg:col-span-2 p-5 rounded-xl border ${isDark ? 'bg-slate-800/50 border-slate-700/50' : 'bg-white border-slate-200'}`}>\r\n                            <h3 className=\"flex items-center gap-2 text-base font-semibold mb-5\"><IconTrendUp size={18} className=\"text-emerald-600\" /> เนเธเธงเนเธเนเธกเธฃเธฒเธขเน€เธ”เธทเธญเธ</h3>\r\n                            <div className=\"flex items-end h-48 gap-2\">\r\n                                {data.monthlyTrend.map((m, i) => (\r\n                                    <div key={i} className=\"flex-1 flex flex-col items-center gap-1\">\r\n                                        <div className=\"w-full flex gap-0.5 justify-center\">\r\n                                            <div className=\"w-[40%] bg-emerald-500/30 rounded-t\" style={{ height: `${(m.applications / 120) * 160}px` }} />\r\n                                            <div className=\"w-[40%] bg-emerald-500 rounded-t\" style={{ height: `${(m.approved / 120) * 160}px` }} />\r\n                                        </div>\r\n                                        <span className=\"text-[10px] text-slate-500\">{months[i]}</span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                            <div className=\"flex justify-center gap-6 mt-4\">\r\n                                <div className=\"flex items-center gap-2\"><div className=\"w-3 h-3 bg-emerald-500/30 rounded\" /><span className=\"text-xs text-slate-500\">เธเธณเธเธญเนเธซเธกเน</span></div>\r\n                                <div className=\"flex items-center gap-2\"><div className=\"w-3 h-3 bg-emerald-500 rounded\" /><span className=\"text-xs text-slate-500\">เนเธ”เนเธฃเธฑเธเธฃเธญเธ</span></div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* By Plant Type */}\r\n                        <div className={`p-5 rounded-xl border ${isDark ? 'bg-slate-800/50 border-slate-700/50' : 'bg-white border-slate-200'}`}>\r\n                            <h3 className=\"flex items-center gap-2 text-base font-semibold mb-5\"><IconLeaf size={18} className=\"text-emerald-600\" /> เธ•เธฒเธกเธเธฃเธฐเน€เธ เธ—เธเธทเธ</h3>\r\n                            <div className=\"space-y-3\">\r\n                                {Object.entries(data.byPlantType).slice(0, 5).map(([name, count], i) => (\r\n                                    <div key={name}>\r\n                                        <div className=\"flex justify-between text-sm mb-1\"><span>{name}</span><span className=\"font-semibold\">{count}</span></div>\r\n                                        <div className={`h-2 rounded-full overflow-hidden ${isDark ? 'bg-slate-700' : 'bg-slate-200'}`}>\r\n                                            <div className={`h-full ${chartColors[i % chartColors.length]} rounded-full`} style={{ width: `${(count / getMaxValue(data.byPlantType)) * 100}%` }} />\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Bottom Row */}\r\n                    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\r\n                        {/* By Status */}\r\n                        <div className={`p-5 rounded-xl border ${isDark ? 'bg-slate-800/50 border-slate-700/50' : 'bg-white border-slate-200'}`}>\r\n                            <h3 className=\"flex items-center gap-2 text-base font-semibold mb-5\"><IconDocument size={18} className=\"text-emerald-600\" /> เธ•เธฒเธกเธชเธ–เธฒเธเธฐ</h3>\r\n                            <div className=\"space-y-2.5\">\r\n                                {Object.entries(data.byStatus).map(([status, count], i) => {\r\n                                    const labels: Record<string, string> = { CERTIFIED: 'เนเธ”เนเธฃเธฑเธเธฃเธญเธ', AUDIT_PENDING: 'เธฃเธญเธ•เธฃเธงเธ', SUBMITTED: 'เธขเธทเนเธเนเธฅเนเธง', PAYMENT_1_PENDING: 'เธฃเธญเธเธณเธฃเธฐ 1', DRAFT: 'เธฃเนเธฒเธ', REVISION_REQ: 'เธ•เนเธญเธเนเธเนเนเธ' };\r\n                                    return (\r\n                                        <div key={status} className=\"flex items-center gap-3\">\r\n                                            <div className={`w-2.5 h-2.5 ${chartColors[i % chartColors.length]} rounded`} />\r\n                                            <span className=\"flex-1 text-sm text-slate-500\">{labels[status] || status}</span>\r\n                                            <span className=\"text-sm font-semibold\">{count}</span>\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* By Province */}\r\n                        <div className={`p-5 rounded-xl border ${isDark ? 'bg-slate-800/50 border-slate-700/50' : 'bg-white border-slate-200'}`}>\r\n                            <h3 className=\"flex items-center gap-2 text-base font-semibold mb-5\"><IconMapPin size={18} className=\"text-emerald-600\" /> เธ•เธฒเธกเธเธฑเธเธซเธงเธฑเธ” (Top 5)</h3>\r\n                            <div className=\"space-y-3\">\r\n                                {Object.entries(data.byProvince).slice(0, 5).map(([name, count], i) => (\r\n                                    <div key={name}>\r\n                                        <div className=\"flex justify-between text-sm mb-1\"><span>{name}</span><span className=\"font-semibold\">{count}</span></div>\r\n                                        <div className={`h-2 rounded-full overflow-hidden ${isDark ? 'bg-slate-700' : 'bg-slate-200'}`}>\r\n                                            <div className={`h-full ${chartColors[(i + 2) % chartColors.length]} rounded-full`} style={{ width: `${(count / getMaxValue(data.byProvince)) * 100}%` }} />\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </>\r\n            ) : null}\r\n        </StaffLayout>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\applications\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3059,3062],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3059,3062],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isSubmitting' is assigned a value but never used.","line":93,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":93,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { IconDocument, IconCheckCircle, IconSearch } from \"@/components/ui/icons\";\r\n\r\n// Additional icons\r\nconst IconClock = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <circle cx=\"12\" cy=\"12\" r=\"10\" />\r\n        <polyline points=\"12 6 12 12 16 14\" />\r\n    </svg>\r\n);\r\n\r\nconst IconX = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\r\n        <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\r\n    </svg>\r\n);\r\n\r\nconst IconEye = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\" />\r\n        <circle cx=\"12\" cy=\"12\" r=\"3\" />\r\n    </svg>\r\n);\r\n\r\nconst IconWarning = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\" />\r\n        <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\" />\r\n        <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\" />\r\n    </svg>\r\n);\r\n\r\nconst IconReturn = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <polyline points=\"9 10 4 15 9 20\" />\r\n        <path d=\"M20 4v7a4 4 0 0 1-4 4H4\" />\r\n    </svg>\r\n);\r\n\r\nconst IconVideo = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <polygon points=\"23 7 16 12 23 17 23 7\" />\r\n        <rect x=\"1\" y=\"5\" width=\"15\" height=\"14\" rx=\"2\" ry=\"2\" />\r\n    </svg>\r\n);\r\n\r\ninterface Application {\r\n    id: string;\r\n    applicantName: string;\r\n    applicantType: string;\r\n    plantType: string;\r\n    areaType?: string; // [NEW]\r\n    status: string;\r\n    phase: number;\r\n    submissionCount: number;\r\n    submittedAt: string;\r\n    lastUpdatedAt: string;\r\n    slaTimer: string;\r\n    documents: { name: string; status: string; url: string; metadata?: any }[];\r\n    reviewHistory: { date: string; action: string; comment: string; by: string }[];\r\n    auditRecord?: { checklist: { item: string; passed: boolean }[]; photos: string[]; result: string };\r\n    payments: { phase: number; amount: number; paidAt: string }[];\r\n    youtubeUrl?: string; // Feature: Visual Evidence\r\n}\r\n\r\nconst STATUS_LABELS: Record<string, { label: string; color: string }> = {\r\n    SUBMITTED: { label: \"เธขเธทเนเธเธเธณเธเธญ\", color: \"bg-slate-100 text-slate-700\" },\r\n    PAID_PHASE_1: { label: \"เธเนเธฒเธขเธเธงเธ” 1\", color: \"bg-blue-100 text-blue-700\" },\r\n    PENDING_REVIEW: { label: \"เธฃเธญเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ\", color: \"bg-amber-100 text-amber-700\" },\r\n    REVISION_REQUIRED: { label: \"เนเธเนเนเธเน€เธญเธเธชเธฒเธฃ\", color: \"bg-red-100 text-red-700\" },\r\n    DOCUMENT_APPROVED: { label: \"เน€เธญเธเธชเธฒเธฃเธเนเธฒเธ\", color: \"bg-green-100 text-green-700\" },\r\n    PAID_PHASE_2: { label: \"เธเนเธฒเธขเธเธงเธ” 2\", color: \"bg-blue-100 text-blue-700\" },\r\n    PENDING_SCHEDULE: { label: \"เธฃเธญเธเธฑเธ”เธเธดเธง\", color: \"bg-purple-100 text-purple-700\" },\r\n    SCHEDULED: { label: \"เธเธฑเธ”เธซเธกเธฒเธขเนเธฅเนเธง\", color: \"bg-purple-100 text-purple-700\" },\r\n    PENDING_AUDIT: { label: \"เธฃเธญเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ\", color: \"bg-amber-100 text-amber-700\" },\r\n    AUDIT_PASSED: { label: \"เธ•เธฃเธงเธเธเนเธฒเธ\", color: \"bg-green-100 text-green-700\" },\r\n    APPROVED: { label: \"เธญเธเธธเธกเธฑเธ•เธด\", color: \"bg-emerald-100 text-emerald-700\" },\r\n};\r\n\r\nexport default function JobSheetPage() {\r\n    const params = useParams();\r\n    const router = useRouter();\r\n    const [app, setApp] = useState<Application | null>(null);\r\n    const [activeTab, setActiveTab] = useState<\"documents\" | \"history\" | \"audit\">(\"documents\");\r\n    const [showActionModal, setShowActionModal] = useState(false);\r\n    const [actionType, setActionType] = useState<\"approve\" | \"reject\">(\"approve\");\r\n    const [comment, setComment] = useState(\"\");\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const token = localStorage.getItem(\"staff_token\");\r\n        if (!token) {\r\n            router.push(\"/staff/login\");\r\n            return;\r\n        }\r\n\r\n        // Fetch real application data\r\n        const fetchApplication = async () => {\r\n            try {\r\n                const res = await fetch(`/api/applications/${params.id}`, {\r\n                    headers: { 'Authorization': `Bearer ${token}` }\r\n                });\r\n                if (res.ok) {\r\n                    const result = await res.json();\r\n                    if (result.success && result.data) {\r\n                        const data = result.data;\r\n                        const formData = data.formData || {}; // Correctly access formData\r\n\r\n                        setApp({\r\n                            id: data._id || data.id || params.id as string,\r\n                            applicantName: formData.applicantData?.name || formData.applicantData?.firstName ? `${formData.applicantData?.firstName} ${formData.applicantData?.lastName}` : 'เนเธกเนเธฃเธฐเธเธธเธเธทเนเธญ',\r\n                            applicantType: formData.applicantData?.applicantType || 'เธเธธเธเธเธฅเธเธฃเธฃเธกเธ”เธฒ',\r\n                            plantType: formData.plantName || formData.plantId || 'เนเธกเนเธฃเธฐเธเธธ',\r\n                            areaType: data.areaType || formData.areaType || 'OUTDOOR', // Map areaType\r\n                            status: data.status,\r\n                            phase: data.status?.includes('AUDIT') ? 2 : 1,\r\n                            submissionCount: (data.rejectCount || 0) + 1,\r\n                            submittedAt: data.createdAt?.split('T')[0] || '-',\r\n                            lastUpdatedAt: data.updatedAt || data.createdAt || '-',\r\n                            slaTimer: getSLATimer(data.createdAt),\r\n                            documents: formData.documents || [], // Get from formData\r\n                            reviewHistory: [],\r\n                            payments: [],\r\n                            youtubeUrl: formData.youtubeUrl // Extract YouTube URL\r\n                        });\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                console.error('Error fetching application:', error);\r\n            }\r\n        };\r\n        fetchApplication();\r\n    }, [params.id, router]);\r\n\r\n    const getSLATimer = (createdAt: string): string => {\r\n        if (!createdAt) return '-';\r\n        const created = new Date(createdAt);\r\n        const now = new Date();\r\n        const diffDays = Math.floor((now.getTime() - created.getTime()) / (1000 * 60 * 60 * 24));\r\n        if (diffDays <= 3) return `${diffDays} เธงเธฑเธ`;\r\n        if (diffDays <= 5) return `${diffDays} เธงเธฑเธ`;\r\n        return `${diffDays} เธงเธฑเธ - เน€เธเธดเธ SLA`;\r\n    };\r\n\r\n    const handleAction = (type: \"approve\" | \"reject\") => {\r\n        setActionType(type);\r\n        setComment(\"\");\r\n        setShowActionModal(true);\r\n    };\r\n\r\n    const submitAction = async () => {\r\n        const token = localStorage.getItem(\"staff_token\");\r\n        if (!token || !app) return;\r\n\r\n        setIsSubmitting(true);\r\n        try {\r\n            const res = await fetch(`/api/applications/${app.id}/review`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`,\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify({\r\n                    action: actionType === \"approve\" ? \"APPROVE\" : \"REJECT\",\r\n                    comment: comment\r\n                })\r\n            });\r\n\r\n            if (res.ok) {\r\n                alert(`${actionType === \"approve\" ? \"เธญเธเธธเธกเธฑเธ•เธดเธชเธณเน€เธฃเนเธ\" : \"เธชเนเธเธเธทเธเนเธเนเนเธเธชเธณเน€เธฃเนเธ\"}`);\r\n                setShowActionModal(false);\r\n                router.push('/staff/dashboard');\r\n            } else {\r\n                const err = await res.json();\r\n                alert(`เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”: ${err.error || 'เนเธกเนเธ—เธฃเธฒเธเธชเธฒเน€เธซเธ•เธธ'}`);\r\n            }\r\n        } catch (error) {\r\n            console.error('Submit error:', error);\r\n            alert('เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเธชเนเธเธเนเธญเธกเธนเธฅ');\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    if (!app) {\r\n        return <div className=\"min-h-screen flex items-center justify-center\"><div className=\"w-10 h-10 border-4 border-emerald-200 border-t-emerald-600 rounded-full animate-spin\"></div></div>;\r\n    }\r\n\r\n    const statusInfo = STATUS_LABELS[app.status] || { label: app.status, color: \"bg-slate-100\" };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-slate-50\">\r\n            {/* Header */}\r\n            <header className=\"bg-slate-800 text-white shadow-lg sticky top-0 z-10\">\r\n                <div className=\"max-w-7xl mx-auto px-6 py-4\">\r\n                    <div className=\"flex justify-between items-start\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <Link href=\"/staff/dashboard\" className=\"text-slate-400 hover:text-white\">โ เธเธฅเธฑเธ</Link>\r\n                            <div className=\"h-10 w-px bg-slate-600\" />\r\n                            <div>\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <p className=\"font-mono text-lg\">{app.id}</p>\r\n                                    <span className={`px-2 py-1 rounded-full text-xs ${statusInfo.color}`}>{statusInfo.label}</span>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2 text-slate-400 text-sm mt-1\">\r\n                                    <span>{app.applicantName}</span>\r\n                                    <span>โ€ข</span>\r\n                                    <span>{app.plantType}</span>\r\n                                    {app.areaType && (\r\n                                        <>\r\n                                            <span>โ€ข</span>\r\n                                            <span className=\"text-emerald-400 font-medium\">\r\n                                                {app.areaType === 'GREENHOUSE' ? 'เนเธฃเธเน€เธฃเธทเธญเธ (Greenhouse)' :\r\n                                                    app.areaType === 'INDOOR' ? 'เธฃเธฐเธเธเธเธดเธ” (Indoor)' : 'เธเธฅเธฒเธเนเธเนเธ (Outdoor)'}\r\n                                            </span>\r\n                                        </>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                            <div className={`px-3 py-1 rounded-lg ${app.slaTimer.includes(\"เน€เธฅเธข\") ? \"bg-red-500\" : app.slaTimer.includes(\"เธงเธฑเธ\") ? \"bg-amber-500\" : \"bg-green-500\"\r\n                                }`}>\r\n                                <p className=\"text-xs\">SLA Timer</p>\r\n                                <p className=\"font-bold\">{app.slaTimer}</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Progress Bar */}\r\n                    <div className=\"mt-4 flex items-center gap-2 text-sm\">\r\n                        {[\r\n                            { label: \"เธขเธทเนเธเธเธณเธเธญ\", done: true },\r\n                            { label: \"เธเนเธฒเธขเธเธงเธ” 1\", done: true },\r\n                            { label: \"เธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ\", done: false, active: app.phase === 1 },\r\n                            { label: \"เธเนเธฒเธขเธเธงเธ” 2\", done: false },\r\n                            { label: \"เธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ\", done: false, active: app.phase === 2 },\r\n                            { label: \"เธญเธเธธเธกเธฑเธ•เธด\", done: false },\r\n                        ].map((step, i) => (\r\n                            <div key={i} className=\"flex items-center gap-2\">\r\n                                <div className={`w-6 h-6 rounded-full flex items-center justify-center text-xs ${step.done ? \"bg-green-500 text-white\" :\r\n                                    step.active ? \"bg-blue-500 text-white animate-pulse\" :\r\n                                        \"bg-slate-600 text-slate-400\"\r\n                                    }`}>\r\n                                    {step.done ? \"โ“\" : i + 1}\r\n                                </div>\r\n                                <span className={step.active ? \"text-white font-bold\" : \"text-slate-400\"}>{step.label}</span>\r\n                                {i < 5 && <span className=\"text-slate-600\">โ’</span>}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </header>\r\n\r\n            <main className=\"max-w-7xl mx-auto px-6 py-8\">\r\n                {/* Tabs */}\r\n                <div className=\"flex gap-2 mb-6\">\r\n                    {[\r\n                        { id: \"documents\", label: \"เน€เธญเธเธชเธฒเธฃ\", count: app.documents.length, Icon: IconDocument },\r\n                        { id: \"history\", label: \"เธเธฃเธฐเธงเธฑเธ•เธด\", count: app.reviewHistory.length, Icon: IconDocument },\r\n                        { id: \"audit\", label: \"เธเธฅเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ\", disabled: app.phase < 2, Icon: IconSearch },\r\n                    ].map((tab) => (\r\n                        <button\r\n                            key={tab.id}\r\n                            onClick={() => !tab.disabled && setActiveTab(tab.id as typeof activeTab)}\r\n                            disabled={tab.disabled}\r\n                            className={`px-6 py-3 rounded-xl font-semibold transition-all ${activeTab === tab.id\r\n                                ? \"bg-slate-800 text-white\"\r\n                                : tab.disabled\r\n                                    ? \"bg-slate-100 text-slate-400 cursor-not-allowed\"\r\n                                    : \"bg-white text-slate-600 hover:bg-slate-50\"\r\n                                }`}\r\n                        >\r\n                            {tab.label} {tab.count !== undefined && `(${tab.count})`}\r\n                        </button>\r\n                    ))}\r\n\r\n                    {/* Submission Counter */}\r\n                    <div className={`ml-auto px-4 py-3 rounded-xl font-semibold ${app.submissionCount >= 3 ? \"bg-red-100 text-red-700\" :\r\n                        app.submissionCount === 2 ? \"bg-amber-100 text-amber-700\" :\r\n                            \"bg-green-100 text-green-700\"\r\n                        }`}>\r\n                        เธชเนเธเธเธฃเธฑเนเธเธ—เธตเน: {app.submissionCount}/3\r\n                        {app.submissionCount >= 3 && \" (เธเธฃเธเนเธเธงเธ•เธฒเธเธฃเธต)\"}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Tab Content */}\r\n                {activeTab === \"documents\" && (\r\n                    <div className=\"bg-white rounded-2xl shadow-lg overflow-hidden\">\r\n                        <div className=\"px-6 py-4 border-b\">\r\n                            <h3 className=\"font-semibold\">เน€เธญเธเธชเธฒเธฃเนเธเธ ({app.documents.length} เธฃเธฒเธขเธเธฒเธฃ)</h3>\r\n                        </div>\r\n\r\n                        {/* Visual Evidence Section */}\r\n                        {app.youtubeUrl && (\r\n                            <div className=\"p-4 bg-blue-50/50 border-b border-blue-100 flex items-start gap-4\">\r\n                                <div className=\"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center text-blue-600 shrink-0\">\r\n                                    <IconVideo size={20} />\r\n                                </div>\r\n                                <div className=\"flex-1\">\r\n                                    <h4 className=\"font-semibold text-blue-900 mb-1\">เธชเธทเนเธญเธเธฑเธเธ—เธถเธเธ เธฒเธ/เธงเธดเธ”เธตเนเธญ (Evidence)</h4>\r\n                                    <p className=\"text-sm text-blue-700 mb-2\">เน€เธเธฉเธ•เธฃเธเธฃเนเธ”เนเนเธเธเธฅเธดเธเธเนเธงเธดเธ”เธตเนเธญเนเธเธฐเธเธณเธเธฒเธฃเนเธก/เนเธเธฅเธเธเธฅเธนเธ</p>\r\n                                    <a\r\n                                        href={app.youtubeUrl}\r\n                                        target=\"_blank\"\r\n                                        rel=\"noopener noreferrer\"\r\n                                        className=\"inline-flex items-center gap-2 text-sm font-medium text-blue-600 hover:text-blue-800 hover:underline bg-white px-3 py-1.5 rounded-lg border border-blue-200 shadow-sm transition-colors\"\r\n                                    >\r\n                                        <IconVideo size={16} />\r\n                                        เน€เธเธดเธ”เธ”เธนเธงเธดเธ”เธตเนเธญ (YouTube)\r\n                                    </a>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                        <div className=\"divide-y\">\r\n                            {app.documents.map((doc, i) => (\r\n                                <div key={i} className=\"p-4 hover:bg-slate-50 border-b last:border-b-0\">\r\n                                    <div className=\"flex items-center gap-4\">\r\n                                        <div className={`w-10 h-10 rounded-lg flex items-center justify-center ${doc.status === \"verified\" ? \"bg-green-100\" :\r\n                                            doc.status === \"issue\" ? \"bg-red-100\" :\r\n                                                \"bg-amber-100\"\r\n                                            }`}>\r\n                                            {doc.status === \"verified\" ? <IconCheckCircle size={16} className=\"text-green-600\" /> : doc.status === \"issue\" ? <IconX size={16} className=\"text-red-600\" /> : <IconClock size={16} className=\"text-amber-600\" />}\r\n                                        </div>\r\n                                        <div className=\"flex-1\">\r\n                                            <p className=\"font-medium\">{doc.name}</p>\r\n                                            <p className={`text-sm ${doc.status === \"verified\" ? \"text-green-600\" :\r\n                                                doc.status === \"issue\" ? \"text-red-600\" :\r\n                                                    \"text-amber-600\"\r\n                                                }`}>\r\n                                                {doc.status === \"verified\" ? \"เธ–เธนเธเธ•เนเธญเธ\" : doc.status === \"issue\" ? \"เธ•เนเธญเธเนเธเนเนเธ\" : \"เธฃเธญเธ•เธฃเธงเธเธชเธญเธ\"}\r\n                                            </p>\r\n                                        </div>\r\n                                        <button className=\"flex items-center gap-1.5 px-4 py-2 bg-slate-100 rounded-lg hover:bg-slate-200 text-sm\">\r\n                                            <IconEye size={14} /> Preview\r\n                                        </button>\r\n                                    </div>\r\n\r\n                                    {/* [NEW] Metadata Display (Land Info) */}\r\n                                    {doc.metadata?.area && (\r\n                                        <div className=\"ml-14 mt-2 bg-slate-100 rounded-lg p-3 text-xs w-fit border border-slate-200\">\r\n                                            <span className=\"font-bold text-slate-700 block mb-1\">\r\n                                                เธเนเธญเธกเธนเธฅเธ—เธตเนเธ”เธดเธ ({doc.metadata.manualEntry ? 'Manual Edited' : 'AI Extracted'})\r\n                                            </span>\r\n                                            <div className=\"flex gap-4 text-slate-600\">\r\n                                                <span>เนเธฃเน: <b className=\"text-slate-900\">{doc.metadata.area.rai}</b></span>\r\n                                                <span>เธเธฒเธ: <b className=\"text-slate-900\">{doc.metadata.area.ngan}</b></span>\r\n                                                <span>เธ•เธฃ.เธง.: <b className=\"text-slate-900\">{doc.metadata.area.sqWa}</b></span>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n\r\n                {\r\n                    activeTab === \"history\" && (\r\n                        <div className=\"bg-white rounded-2xl shadow-lg overflow-hidden\">\r\n                            <div className=\"px-6 py-4 border-b\">\r\n                                <h3 className=\"font-semibold\">เธเธฃเธฐเธงเธฑเธ•เธดเธเธฒเธฃเธ”เธณเน€เธเธดเธเธเธฒเธฃ</h3>\r\n                            </div>\r\n                            <div className=\"p-6\">\r\n                                <div className=\"relative pl-8\">\r\n                                    {app.reviewHistory.map((item, i) => (\r\n                                        <div key={i} className=\"relative pb-8 last:pb-0\">\r\n                                            {i < app.reviewHistory.length - 1 && (\r\n                                                <div className=\"absolute left-[-20px] top-6 w-0.5 h-full bg-slate-200\" />\r\n                                            )}\r\n                                            <div className=\"absolute left-[-24px] w-3 h-3 rounded-full bg-emerald-500 border-2 border-white\" />\r\n                                            <div className=\"bg-slate-50 rounded-xl p-4\">\r\n                                                <div className=\"flex justify-between items-start mb-2\">\r\n                                                    <p className=\"font-semibold\">{item.action}</p>\r\n                                                    <p className=\"text-sm text-slate-500\">{item.date}</p>\r\n                                                </div>\r\n                                                <p className=\"text-slate-600\">{item.comment}</p>\r\n                                                <p className=\"text-sm text-slate-400 mt-1\">เนเธ”เธข: {item.by}</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )\r\n                }\r\n\r\n                {/* Action Bar - Fixed at bottom during Phase 1 */}\r\n                {\r\n                    app.phase === 1 && (\r\n                        <div className=\"fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg p-4\">\r\n                            <div className=\"max-w-7xl mx-auto flex justify-end gap-4\">\r\n                                <button\r\n                                    onClick={() => handleAction(\"reject\")}\r\n                                    className=\"px-8 py-3 bg-red-600 text-white rounded-xl font-semibold hover:bg-red-700 flex items-center gap-2\"\r\n                                >\r\n                                    <IconReturn size={16} /> เธชเนเธเธเธทเธเนเธเนเนเธ\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => handleAction(\"approve\")}\r\n                                    className=\"px-8 py-3 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 flex items-center gap-2\"\r\n                                >\r\n                                    <IconCheckCircle size={16} /> เธญเธเธธเธกเธฑเธ•เธดเน€เธญเธเธชเธฒเธฃ\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    )\r\n                }\r\n            </main >\r\n\r\n            {/* Action Modal */}\r\n            {\r\n                showActionModal && (\r\n                    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50\">\r\n                        <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-md\">\r\n                            <div className=\"px-6 py-4 border-b\">\r\n                                <h3 className=\"text-lg font-semibold\">\r\n                                    {actionType === \"approve\" ? <><IconCheckCircle size={16} /> เธขเธทเธเธขเธฑเธเธญเธเธธเธกเธฑเธ•เธดเน€เธญเธเธชเธฒเธฃ</> : <><IconReturn size={16} /> เธชเนเธเธเธทเธเนเธเนเนเธ</>}\r\n                                </h3>\r\n                            </div>\r\n                            <div className=\"p-6 space-y-4\">\r\n                                {actionType === \"reject\" && (\r\n                                    <div className=\"flex items-center gap-2 p-3 bg-amber-50 border border-amber-200 rounded-lg text-amber-700 text-sm\">\r\n                                        <IconWarning size={16} /> เธเธนเนเธชเธกเธฑเธเธฃเนเธเนเนเธเธเธฃเธต {3 - app.submissionCount} เธเธฃเธฑเนเธ เธซเธฅเธฑเธเธเธฒเธเธเธฑเนเธเธ•เนเธญเธเธเธณเธฃเธฐเธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธกเนเธซเธกเน\r\n                                    </div>\r\n                                )}\r\n                                <textarea\r\n                                    value={comment}\r\n                                    onChange={(e) => setComment(e.target.value)}\r\n                                    placeholder={actionType === \"approve\" ? \"เธซเธกเธฒเธขเน€เธซเธ•เธธ (เธ–เนเธฒเธกเธต)...\" : \"เธฃเธฐเธเธธเธเธธเธ”เธ—เธตเนเธ•เนเธญเธเนเธเนเนเธเธญเธขเนเธฒเธเธฅเธฐเน€เธญเธตเธขเธ”...\"}\r\n                                    rows={4}\r\n                                    className=\"w-full px-3 py-2 border rounded-lg\"\r\n                                    required={actionType === \"reject\"}\r\n                                />\r\n                                <div className=\"flex gap-3\">\r\n                                    <button onClick={() => setShowActionModal(false)} className=\"flex-1 py-3 border border-slate-300 rounded-xl\">\r\n                                        เธขเธเน€เธฅเธดเธ\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={submitAction}\r\n                                        disabled={actionType === \"reject\" && !comment}\r\n                                        className={`flex-1 py-3 text-white rounded-xl disabled:opacity-50 ${actionType === \"approve\" ? \"bg-emerald-600 hover:bg-emerald-700\" : \"bg-red-600 hover:bg-red-700\"\r\n                                            }`}\r\n                                    >\r\n                                        เธขเธทเธเธขเธฑเธ\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n        </div >\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\applications\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\audits\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IconWarning' is assigned a value but never used.","line":31,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isSaving' is assigned a value but never used.","line":102,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":102,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState, useCallback } from \"react\";\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { apiClient as api } from \"@/lib/api\";\r\nimport { IconDocument, IconCheckCircle } from \"@/components/ui/icons\";\r\n\r\n// Additional icons for this page\r\nconst IconVideo = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <polygon points=\"23 7 16 12 23 17 23 7\" />\r\n        <rect x=\"1\" y=\"5\" width=\"15\" height=\"14\" rx=\"2\" ry=\"2\" />\r\n    </svg>\r\n);\r\n\r\nconst IconMapPin = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z\" />\r\n        <circle cx=\"12\" cy=\"10\" r=\"3\" />\r\n    </svg>\r\n);\r\n\r\nconst IconX = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\r\n        <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\r\n    </svg>\r\n);\r\n\r\nconst IconWarning = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\" />\r\n        <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\" />\r\n        <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\" />\r\n    </svg>\r\n);\r\n\r\ninterface ChecklistItem {\r\n    itemCode: string;\r\n    category: string;\r\n    title?: string;\r\n    titleTh?: string;\r\n    response: \"PASS\" | \"FAIL\" | \"NA\" | \"PENDING\";\r\n    notes?: string;\r\n    photos?: { url: string; caption?: string }[];\r\n}\r\n\r\ninterface AuditDetail {\r\n    _id: string;\r\n    auditNumber: string;\r\n    applicationNumber: string;\r\n    farmerName: string;\r\n    farmName?: string;\r\n    plantType?: string;\r\n    auditMode: \"ONLINE\" | \"ONSITE\" | \"HYBRID\";\r\n    status: string;\r\n    scheduledDate: string;\r\n    scheduledTime?: string;\r\n    onlineSession?: {\r\n        platform: string;\r\n        meetingUrl?: string;\r\n        meetingId?: string;\r\n    };\r\n    farmLocation?: {\r\n        address: string;\r\n        province: string;\r\n    };\r\n    responses: ChecklistItem[];\r\n    overallScore?: number;\r\n    result?: string;\r\n}\r\n\r\ninterface TemplateItem {\r\n    itemCode: string;\r\n    title: string;\r\n    titleTh: string;\r\n    category: string;\r\n    checkType: string;\r\n    isCritical?: boolean;\r\n}\r\n\r\ninterface AuditTemplate {\r\n    templateCode: string;\r\n    nameTh: string;\r\n    categories: {\r\n        categoryCode: string;\r\n        nameTh: string;\r\n        items: TemplateItem[];\r\n    }[];\r\n}\r\n\r\nexport default function AuditDetailPage() {\r\n    const params = useParams();\r\n    const router = useRouter();\r\n    const [audit, setAudit] = useState<AuditDetail | null>(null);\r\n    const [template, setTemplate] = useState<AuditTemplate | null>(null);\r\n    const [showResultModal, setShowResultModal] = useState(false);\r\n    const [result, setResult] = useState<\"PASS\" | \"MINOR\" | \"MAJOR\">(\"PASS\");\r\n    const [resultNote, setResultNote] = useState(\"\");\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n    const [activeCategory, setActiveCategory] = useState<string>(\"\");\r\n\r\n    const fetchAudit = useCallback(async () => {\r\n        setIsLoading(true);\r\n        try {\r\n            // Fetch audit details\r\n            const auditResult = await api.get<{ data: AuditDetail }>(`/api/audits/${params.id}`);\r\n            if (auditResult.success && auditResult.data?.data) {\r\n                setAudit(auditResult.data.data);\r\n\r\n                // Fetch template if needed\r\n                const templateCode = (auditResult.data.data as unknown as { templateCode?: string }).templateCode;\r\n                if (templateCode) {\r\n                    // Assuming template route might still be under field-audits or needs migration. \r\n                    // For now, let's keep it or if it fails, handle gracefully.\r\n                    // Or map it to a new public/master-data endpoint if available.\r\n                    // Let's assume templates are still fetched via old route or we mock them.\r\n                    // If templates endpoint is missing, this might fail.\r\n                    try {\r\n                        const templateResult = await api.get<{ data: AuditTemplate }>(`/api/field-audits/templates/${templateCode}`);\r\n                        if (templateResult.success && templateResult.data?.data) {\r\n                            setTemplate(templateResult.data.data);\r\n                            setActiveCategory(templateResult.data.data.categories[0]?.categoryCode || \"\");\r\n                        }\r\n                    } catch (e) {\r\n                        // Fallback/Silent fail for template\r\n                        console.warn(\"Template fetch failed\", e);\r\n                    }\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error fetching audit:\", error);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }, [params.id]);\r\n\r\n    useEffect(() => {\r\n        const token = localStorage.getItem(\"staff_token\");\r\n        if (!token) {\r\n            router.push(\"/staff/login\");\r\n            return;\r\n        }\r\n        fetchAudit();\r\n    }, [router, fetchAudit]);\r\n\r\n    const updateResponse = (itemCode: string, response: \"PASS\" | \"FAIL\" | \"NA\", notes?: string) => {\r\n        if (!audit) return;\r\n        setAudit({\r\n            ...audit,\r\n            responses: audit.responses.map((r: ChecklistItem) =>\r\n                r.itemCode === itemCode ? { ...r, response, notes: notes ?? r.notes } : r\r\n            ),\r\n        });\r\n    };\r\n\r\n    const handleSubmitResult = async () => {\r\n        if (!audit) return;\r\n        setIsSaving(true);\r\n        try {\r\n            await api.post(`/api/audits/${audit._id}/result`, {\r\n                result: result, // 'PASS' | 'Incomplete/FAIL' mapped by backend? Backend expects result='PASS' or something?\r\n                // Backend logic: const newStatus = result === 'PASS' ? 'APPROVED' : 'REVISION_REQUIRED';\r\n                // Frontend 'result' state can be \"PASS\" | \"MINOR\" | \"MAJOR\".\r\n                // I need to map MINOR/MAJOR to backend expectation if needed. \r\n                // Backend expects 'PASS' or 'FAIL' ideally.\r\n                // Or I update backend to handle MINOR/MAJOR?\r\n                // The backend `submitResult` checks `if (result === 'PASS')`. \r\n                // So MINOR/MAJOR will go to REVISION_REQUIRED, which is correct (Audit Failed/Revision).\r\n                notes: resultNote,\r\n                auditMode: audit.auditMode,\r\n                checklist: audit.responses\r\n            });\r\n            router.push(\"/staff/dashboard\");\r\n        } catch (error) {\r\n            console.error(\"Error submitting result:\", error);\r\n            alert(\"เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเธเธฑเธเธ—เธถเธเธเธฅ\");\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    if (isLoading || !audit) {\r\n        return <div className=\"min-h-screen flex items-center justify-center\"><div className=\"w-10 h-10 border-4 border-emerald-200 border-t-emerald-600 rounded-full animate-spin\"></div></div>;\r\n    }\r\n\r\n    const completedChecks = audit.responses.filter((r: ChecklistItem) => r.response !== \"PENDING\").length;\r\n    const passedChecks = audit.responses.filter((r: ChecklistItem) => r.response === \"PASS\").length;\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-slate-50\">\r\n            {/* Header */}\r\n            <header className=\"bg-slate-800 text-white shadow-lg sticky top-0 z-10\">\r\n                <div className=\"max-w-7xl mx-auto px-6 py-4 flex justify-between items-center\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <Link href=\"/staff/dashboard\" className=\"text-slate-400 hover:text-white\">โ เธเธฅเธฑเธ</Link>\r\n                        <div className=\"h-6 w-px bg-slate-600\" />\r\n                        <div>\r\n                            <p className=\"font-mono text-sm text-slate-400\">{audit.auditNumber}</p>\r\n                            <h1 className=\"font-bold\">{audit.farmerName}</h1>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-4\">\r\n                        {audit.auditMode === \"ONLINE\" && audit.onlineSession?.meetingUrl && (\r\n                            <a\r\n                                href={audit.onlineSession.meetingUrl}\r\n                                target=\"_blank\"\r\n                                rel=\"noopener noreferrer\"\r\n                                className=\"flex items-center gap-2 px-6 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700\"\r\n                            >\r\n                                <IconVideo size={20} />\r\n                                <span>เน€เธเนเธฒเธซเนเธญเธ VDO Call</span>\r\n                            </a>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </header>\r\n\r\n            <main className=\"max-w-7xl mx-auto px-6 py-8\">\r\n                <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n                    {/* Left: Info & Documents */}\r\n                    <div className=\"lg:col-span-1 space-y-6\">\r\n                        {/* Appointment Info */}\r\n                        <div className=\"bg-white rounded-2xl shadow-lg p-6\">\r\n                            <h3 className=\"flex items-center gap-2 font-semibold mb-4\"><IconDocument size={18} className=\"text-emerald-600\" /> เธเนเธญเธกเธนเธฅเธเธฑเธ”เธซเธกเธฒเธข</h3>\r\n                            <div className=\"space-y-3\">\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-slate-500\">เธเธทเธ:</span>\r\n                                    <span className=\"font-medium\">{audit.plantType}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-slate-500\">เธงเธฑเธเธ—เธตเน:</span>\r\n                                    <span className=\"font-medium\">{new Date(audit.scheduledDate).toLocaleDateString(\"th-TH\")}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-slate-500\">เน€เธงเธฅเธฒ:</span>\r\n                                    <span className=\"font-medium\">{audit.scheduledTime} เธ.</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-slate-500\">เธฃเธนเธเนเธเธ:</span>\r\n                                    <span className={`px-2 py-1 rounded-full text-xs ${audit.auditMode === \"ONLINE\" ? \"bg-blue-100 text-blue-700\" : \"bg-purple-100 text-purple-700\"\r\n                                        }`}>\r\n                                        {audit.auditMode === \"ONLINE\" ? <><IconVideo size={12} /> VDO Call</> : <><IconMapPin size={12} /> เธฅเธเธเธทเนเธเธ—เธตเน</>}\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {audit.auditMode === \"ONLINE\" && audit.onlineSession?.meetingUrl && (\r\n                                <div className=\"mt-4 p-3 bg-blue-50 rounded-lg\">\r\n                                    <p className=\"text-xs text-blue-600 mb-1\">เธฅเธดเธเธเนเธซเนเธญเธเธเธฃเธฐเธเธธเธก:</p>\r\n                                    <a href={audit.onlineSession.meetingUrl} target=\"_blank\" className=\"text-blue-700 underline text-sm break-all\">\r\n                                        {audit.onlineSession.meetingUrl}\r\n                                    </a>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Template Info */}\r\n                        <div className=\"bg-white rounded-2xl shadow-lg p-6\">\r\n                            <h3 className=\"flex items-center gap-2 font-semibold mb-4\"><IconDocument size={18} className=\"text-emerald-600\" /> เธเนเธญเธกเธนเธฅ Template</h3>\r\n                            <div className=\"space-y-2\">\r\n                                {template ? (\r\n                                    <>\r\n                                        <p className=\"text-sm text-slate-600\">Template: {template.nameTh}</p>\r\n                                        <p className=\"text-xs text-slate-500\">เธฃเธซเธฑเธช: {template.templateCode}</p>\r\n                                        <div className=\"flex flex-wrap gap-1 mt-2\">\r\n                                            {template.categories.map((cat) => (\r\n                                                <button\r\n                                                    key={cat.categoryCode}\r\n                                                    onClick={() => setActiveCategory(cat.categoryCode)}\r\n                                                    className={`px-2 py-1 text-xs rounded ${activeCategory === cat.categoryCode\r\n                                                        ? \"bg-emerald-600 text-white\"\r\n                                                        : \"bg-slate-100 text-slate-600 hover:bg-slate-200\"\r\n                                                        }`}\r\n                                                >\r\n                                                    {cat.nameTh}\r\n                                                </button>\r\n                                            ))}\r\n                                        </div>\r\n                                    </>\r\n                                ) : (\r\n                                    <p className=\"text-sm text-slate-400\">เธเธณเธฅเธฑเธเนเธซเธฅเธ”...</p>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Right: Checklist */}\r\n                    <div className=\"lg:col-span-2\">\r\n                        <div className=\"bg-white rounded-2xl shadow-lg overflow-hidden\">\r\n                            <div className=\"px-6 py-4 border-b flex justify-between items-center\">\r\n                                <h3 className=\"flex items-center gap-2 font-semibold\"><IconCheckCircle size={18} className=\"text-emerald-600\" /> Checklist เธเธฒเธฃเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ</h3>\r\n                                <span className=\"text-sm text-slate-500\">\r\n                                    {completedChecks}/{audit.responses.length} เธฃเธฒเธขเธเธฒเธฃ | เธเนเธฒเธ {passedChecks} เธฃเธฒเธขเธเธฒเธฃ\r\n                                </span>\r\n                            </div>\r\n\r\n                            <div className=\"divide-y\">\r\n                                {audit.responses.map((item: ChecklistItem, idx: number) => (\r\n                                    <div key={item.itemCode} className=\"p-4 hover:bg-slate-50\">\r\n                                        <div className=\"flex items-start gap-4\">\r\n                                            <span className=\"text-lg font-mono text-slate-400\">{idx + 1}.</span>\r\n                                            <div className=\"flex-1\">\r\n                                                <p className=\"font-medium\">{item.titleTh || item.itemCode}</p>\r\n                                                <p className=\"text-xs text-slate-400 mt-1\">{item.itemCode}</p>\r\n                                                <div className=\"flex gap-2 mt-2\">\r\n                                                    <button\r\n                                                        onClick={() => updateResponse(item.itemCode, \"PASS\")}\r\n                                                        className={`px-4 py-1 rounded-lg text-sm transition-all ${item.response === \"PASS\"\r\n                                                            ? \"bg-green-600 text-white\"\r\n                                                            : \"bg-green-100 text-green-700 hover:bg-green-200\"\r\n                                                            }`}\r\n                                                    >\r\n                                                        เธเนเธฒเธ\r\n                                                    </button>\r\n                                                    <button\r\n                                                        onClick={() => updateResponse(item.itemCode, \"FAIL\")}\r\n                                                        className={`px-4 py-1 rounded-lg text-sm transition-all ${item.response === \"FAIL\"\r\n                                                            ? \"bg-red-600 text-white\"\r\n                                                            : \"bg-red-100 text-red-700 hover:bg-red-200\"\r\n                                                            }`}\r\n                                                    >\r\n                                                        เนเธกเนเธเนเธฒเธ\r\n                                                    </button>\r\n                                                    <button\r\n                                                        onClick={() => updateResponse(item.itemCode, \"NA\")}\r\n                                                        className={`px-4 py-1 rounded-lg text-sm transition-all ${item.response === \"NA\"\r\n                                                            ? \"bg-slate-600 text-white\"\r\n                                                            : \"bg-slate-100 text-slate-700 hover:bg-slate-200\"\r\n                                                            }`}\r\n                                                    >\r\n                                                        N/A\r\n                                                    </button>\r\n                                                </div>\r\n                                                {item.response === \"FAIL\" && (\r\n                                                    <input\r\n                                                        type=\"text\"\r\n                                                        value={item.notes || \"\"}\r\n                                                        onChange={(e) => updateResponse(item.itemCode, \"FAIL\", e.target.value)}\r\n                                                        placeholder=\"เธฃเธฐเธเธธเน€เธซเธ•เธธเธเธฅ...\"\r\n                                                        className=\"mt-2 w-full px-3 py-2 border rounded-lg text-sm\"\r\n                                                    />\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Action Buttons */}\r\n                        <div className=\"mt-6 flex gap-4\">\r\n                            <button\r\n                                onClick={() => { setResult(\"PASS\"); setShowResultModal(true); }}\r\n                                className=\"flex-1 py-4 bg-green-600 text-white rounded-xl font-semibold hover:bg-green-700\"\r\n                            >\r\n                                เธเนเธฒเธ - เธญเธญเธเนเธเธฃเธฑเธเธฃเธญเธ\r\n                            </button>\r\n                            <button\r\n                                onClick={() => { setResult(\"MINOR\"); setShowResultModal(true); }}\r\n                                className=\"flex-1 py-4 bg-amber-500 text-white rounded-xl font-semibold hover:bg-amber-600\"\r\n                            >\r\n                                เนเธเนเนเธเน€เธฅเนเธเธเนเธญเธข (Minor)\r\n                            </button>\r\n                            <button\r\n                                onClick={() => { setResult(\"MAJOR\"); setShowResultModal(true); }}\r\n                                className=\"flex-1 py-4 bg-red-600 text-white rounded-xl font-semibold hover:bg-red-700\"\r\n                            >\r\n                                เนเธกเนเธเนเธฒเธ/เธเธฑเธ”เนเธซเธกเน (Major)\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </main>\r\n\r\n            {/* Result Modal */}\r\n            {showResultModal && (\r\n                <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50\">\r\n                    <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-md\">\r\n                        <div className=\"px-6 py-4 border-b flex justify-between items-center\">\r\n                            <h3 className=\"text-lg font-semibold\">\r\n                                {result === \"PASS\" && \"เธขเธทเธเธขเธฑเธเธญเธเธธเธกเธฑเธ•เธด\"}\r\n                                {result === \"MINOR\" && \"เธเธญเธเนเธญเธกเธนเธฅเน€เธเธดเนเธกเน€เธ•เธดเธก\"}\r\n                                {result === \"MAJOR\" && \"เนเธกเนเธเนเธฒเธ - เธญเธญเธ CARs\"}\r\n                            </h3>\r\n                            <button onClick={() => setShowResultModal(false)} className=\"text-slate-400 hover:text-slate-600\"><IconX size={20} /></button>\r\n                        </div>\r\n                        <div className=\"p-6 space-y-4\">\r\n                            <textarea\r\n                                value={resultNote}\r\n                                onChange={(e) => setResultNote(e.target.value)}\r\n                                placeholder={result === \"PASS\" ? \"เธซเธกเธฒเธขเน€เธซเธ•เธธ (เธ–เนเธฒเธกเธต)...\" : \"เธฃเธฐเธเธธเธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”เธ—เธตเนเธ•เนเธญเธเนเธเนเนเธ...\"}\r\n                                rows={4}\r\n                                className=\"w-full px-3 py-2 border rounded-lg\"\r\n                            />\r\n                            <div className=\"flex gap-3\">\r\n                                <button\r\n                                    onClick={() => setShowResultModal(false)}\r\n                                    className=\"flex-1 py-3 border border-slate-300 rounded-xl\"\r\n                                >\r\n                                    เธขเธเน€เธฅเธดเธ\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleSubmitResult}\r\n                                    className={`flex-1 py-3 text-white rounded-xl ${result === \"PASS\" ? \"bg-green-600 hover:bg-green-700\" :\r\n                                        result === \"MINOR\" ? \"bg-amber-500 hover:bg-amber-600\" :\r\n                                            \"bg-red-600 hover:bg-red-700\"\r\n                                        }`}\r\n                                >\r\n                                    เธขเธทเธเธขเธฑเธ\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\audits\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\calendar\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\certificates\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Link' is defined but never used.","line":4,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { apiClient as api } from \"@/lib/api\";\r\n\r\ninterface Certificate {\r\n    id: string; // The backend returns 'id', keeping it standard or need to check prisma response\r\n    certificateNumber: string;\r\n    siteName: string;\r\n    plantType: string;\r\n    issuedDate: string;\r\n    expiryDate: string;\r\n    status: string;\r\n}\r\n\r\nexport default function StaffCertificatesPage() {\r\n    const [certificates, setCertificates] = useState<Certificate[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        loadCertificates();\r\n    }, []);\r\n\r\n    const loadCertificates = async () => {\r\n        setLoading(true);\r\n        try {\r\n            // The route in certificates.js for staff is GET /api/certificates\r\n            const result = await api.get<{ data: Certificate[] }>(\"/api/certificates\");\r\n            if (result.success && result.data?.data) {\r\n                setCertificates(result.data.data);\r\n            }\r\n        } catch (error) {\r\n            console.error(error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-8\">\r\n            <h1 className=\"text-2xl font-bold mb-6 text-slate-800\">เธเธฑเธ”เธเธฒเธฃเนเธเธฃเธฑเธเธฃเธญเธ (Certificates)</h1>\r\n\r\n            <div className=\"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden\">\r\n                <table className=\"w-full text-left text-sm\">\r\n                    <thead className=\"bg-slate-50 border-b border-slate-200\">\r\n                        <tr>\r\n                            <th className=\"px-6 py-4 font-semibold text-slate-600\">เน€เธฅเธเธ—เธตเนเนเธเธฃเธฑเธเธฃเธญเธ</th>\r\n                            <th className=\"px-6 py-4 font-semibold text-slate-600\">เธเธทเนเธญเธชเธ–เธฒเธเธ—เธตเน</th>\r\n                            <th className=\"px-6 py-4 font-semibold text-slate-600\">เธเธทเธ</th>\r\n                            <th className=\"px-6 py-4 font-semibold text-slate-600\">เธงเธฑเธเธ—เธตเนเธญเธญเธ</th>\r\n                            <th className=\"px-6 py-4 font-semibold text-slate-600\">เธชเธ–เธฒเธเธฐ</th>\r\n                            <th className=\"px-6 py-4 font-semibold text-slate-600\">เธเธฑเธ”เธเธฒเธฃ</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-slate-100\">\r\n                        {loading ? (\r\n                            <tr><td colSpan={6} className=\"px-6 py-8 text-center text-slate-500\">เธเธณเธฅเธฑเธเนเธซเธฅเธ”...</td></tr>\r\n                        ) : certificates.length === 0 ? (\r\n                            <tr><td colSpan={6} className=\"px-6 py-8 text-center text-slate-500\">เนเธกเนเธเธเนเธเธฃเธฑเธเธฃเธญเธ</td></tr>\r\n                        ) : (\r\n                            certificates.map((cert) => (\r\n                                <tr key={cert.id} className=\"hover:bg-slate-50 transition-colors\">\r\n                                    <td className=\"px-6 py-4 font-medium text-slate-900\">{cert.certificateNumber}</td>\r\n                                    <td className=\"px-6 py-4 text-slate-600\">{cert.siteName}</td>\r\n                                    <td className=\"px-6 py-4 text-slate-600\">{cert.plantType}</td>\r\n                                    <td className=\"px-6 py-4 text-slate-600\">{new Date(cert.issuedDate).toLocaleDateString(\"th-TH\")}</td>\r\n                                    <td className=\"px-6 py-4\">\r\n                                        <span className={`px-2 py-1 rounded-full text-xs font-semibold ${cert.status.toUpperCase() === 'ACTIVE' ? 'bg-emerald-100 text-emerald-700' :\r\n                                                cert.status.toUpperCase() === 'EXPIRED' ? 'bg-red-100 text-red-700' : 'bg-gray-100 text-gray-600'\r\n                                            }`}>\r\n                                            {cert.status}\r\n                                        </span>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4\">\r\n                                        <button\r\n                                            onClick={() => window.open(`/api/certificates/${cert.id}/download`, '_blank')}\r\n                                            className=\"text-emerald-600 hover:text-emerald-700 font-medium text-xs border border-emerald-200 px-3 py-1.5 rounded-lg hover:bg-emerald-50\"\r\n                                        >\r\n                                            เธ”เธฒเธงเธเนเนเธซเธฅเธ” PDF\r\n                                        </button>\r\n                                    </td>\r\n                                </tr>\r\n                            ))\r\n                        )}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\components\\StaffLayout.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'subtitle' is defined but never used.","line":66,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":66,"endColumn":64},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\components\\StaffLayout.tsx:74:9\n  72 |\n  73 |     useEffect(() => {\n> 74 |         setMounted(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  75 |         // Force slate/dark theme preference for staff if not set\n  76 |         const saved = localStorage.getItem(\"staff_theme\");\n  77 |         setIsDark(saved === \"light\" ? false : true);","line":74,"column":9,"nodeType":null,"endLine":74,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport Link from \"next/link\";\r\nimport { usePathname, useRouter } from \"next/navigation\";\r\nimport { useEffect, useState } from \"react\";\r\nimport {\r\n    IconHome, IconDocument, IconSearch, IconCalendar, IconCreditCard,\r\n    IconChart, IconUser, IconSun, IconMoon, IconLogout, IconCertificate\r\n} from \"@/components/ui/icons\";\r\n\r\ninterface StaffUser {\r\n    id: string;\r\n    firstName?: string;\r\n    lastName?: string;\r\n    email: string;\r\n    role: string;\r\n}\r\n\r\ninterface NavItem {\r\n    href: string;\r\n    Icon: React.FC<{ size?: number; className?: string }>;\r\n    label: string;\r\n    roles?: string[];\r\n}\r\n\r\nconst ROLE_LABELS: Record<string, { label: string }> = {\r\n    assessor: { label: \"เธเธนเนเธ•เธฃเธงเธเธชเธญเธ\" },\r\n    scheduler: { label: \"เน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธเธฑเธ”เธเธดเธง\" },\r\n    accountant: { label: \"เธเธเธฑเธเธเธฒเธเธเธฑเธเธเธต\" },\r\n    admin: { label: \"เธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธ\" },\r\n    REVIEWER_AUDITOR: { label: \"เธเธนเนเธ•เธฃเธงเธเธชเธญเธ\" },\r\n    SCHEDULER: { label: \"เน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธเธฑเธ”เธเธดเธง\" },\r\n    ACCOUNTANT: { label: \"เธเธเธฑเธเธเธฒเธเธเธฑเธเธเธต\" },\r\n    ADMIN: { label: \"เธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธ\" },\r\n    SUPER_ADMIN: { label: \"เธเธนเนเธ”เธนเนเธฅเธชเธนเธเธชเธธเธ”\" },\r\n};\r\n\r\n// Users Management Icon\r\nconst IconUsers = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\" />\r\n        <circle cx=\"9\" cy=\"7\" r=\"4\" />\r\n        <path d=\"M23 21v-2a4 4 0 0 0-3-3.87\" />\r\n        <path d=\"M16 3.13a4 4 0 0 1 0 7.75\" />\r\n    </svg>\r\n);\r\n\r\nconst NAV_ITEMS: NavItem[] = [\r\n    { href: \"/staff/dashboard\", Icon: IconHome, label: \"เธซเธเนเธฒเธซเธฅเธฑเธ\" },\r\n    { href: \"/staff/applications\", Icon: IconDocument, label: \"เธเธณเธเธญ\" },\r\n    { href: \"/staff/audits\", Icon: IconSearch, label: \"เธ•เธฃเธงเธเนเธเธฅเธ\" },\r\n    { href: \"/staff/certificates\", Icon: IconCertificate, label: \"เนเธเธฃเธฑเธเธฃเธญเธ\" },\r\n    { href: \"/staff/calendar\", Icon: IconCalendar, label: \"เธเธเธดเธ—เธดเธ\" },\r\n    { href: \"/staff/accounting\", Icon: IconCreditCard, label: \"เธเธฑเธเธเธต\", roles: [\"accountant\", \"ACCOUNTANT\", \"admin\", \"ADMIN\", \"SUPER_ADMIN\"] },\r\n    { href: \"/staff/analytics\", Icon: IconChart, label: \"เธชเธ–เธดเธ•เธด\" },\r\n    { href: \"/staff/verification\", Icon: IconUsers, label: \"เธ•เธฃเธงเธเธชเธญเธเธ•เธฑเธงเธ•เธ\", roles: [\"admin\", \"ADMIN\", \"SUPER_ADMIN\"] },\r\n    { href: \"/staff/management\", Icon: IconUsers, label: \"เธเธฑเธ”เธเธฒเธฃ\", roles: [\"admin\", \"ADMIN\", \"SUPER_ADMIN\"] },\r\n];\r\n\r\ninterface StaffLayoutProps {\r\n    children: React.ReactNode;\r\n    title?: string;\r\n    subtitle?: string;\r\n}\r\n\r\nexport default function StaffLayout({ children, title, subtitle }: StaffLayoutProps) {\r\n    const pathname = usePathname();\r\n    const router = useRouter();\r\n    const [user, setUser] = useState<StaffUser | null>(null);\r\n    const [isDark, setIsDark] = useState(true); // Default to Dark for Admin\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        // Force slate/dark theme preference for staff if not set\r\n        const saved = localStorage.getItem(\"staff_theme\");\r\n        setIsDark(saved === \"light\" ? false : true);\r\n\r\n        const userData = localStorage.getItem(\"staff_user\");\r\n        if (!userData) { router.push(\"/staff/login\"); return; }\r\n        try { setUser(JSON.parse(userData)); } catch { router.push(\"/staff/login\"); }\r\n    }, [router]);\r\n\r\n    const toggleTheme = () => {\r\n        const next = !isDark;\r\n        setIsDark(next);\r\n        localStorage.setItem(\"staff_theme\", next ? \"dark\" : \"light\");\r\n    };\r\n\r\n    const handleLogout = () => {\r\n        localStorage.removeItem(\"staff_token\");\r\n        localStorage.removeItem(\"staff_user\");\r\n        document.cookie = \"staff_token=; path=/; max-age=0\";\r\n        router.push(\"/staff/login\");\r\n    };\r\n\r\n    const filteredNavItems = NAV_ITEMS.filter(item => {\r\n        if (!item.roles) return true;\r\n        if (!user) return false;\r\n        return item.roles.includes(user.role);\r\n    });\r\n\r\n    const roleInfo = user ? ROLE_LABELS[user.role] || { label: user.role } : { label: \"\" };\r\n\r\n    if (!mounted) return <div className=\"min-h-screen bg-slate-900 flex items-center justify-center\"><div className=\"w-8 h-8 border-4 border-slate-600 border-t-slate-400 rounded-full animate-spin\" /></div>;\r\n\r\n    const bgClass = isDark ? \"bg-slate-900 text-slate-200\" : \"bg-slate-50 text-slate-800\";\r\n    const sidebarClass = isDark ? \"bg-slate-950 border-slate-800\" : \"bg-white border-slate-200\";\r\n\r\n    return (\r\n        <div className={`min-h-screen font-sans flex ${bgClass}`}>\r\n            {/* Sidebar - Desktop */}\r\n            <aside className={`hidden lg:flex fixed left-0 top-0 bottom-0 w-64 flex-col border-r transition-colors ${sidebarClass}`}>\r\n                <div className=\"p-6\">\r\n                    <div className=\"flex items-center gap-3 mb-8\">\r\n                        <div className=\"w-10 h-10 rounded-lg bg-indigo-600 flex items-center justify-center text-white font-bold text-xl shadow-lg shadow-indigo-900/50\">D</div>\r\n                        <div>\r\n                            <h1 className=\"font-bold text-lg leading-tight\">DTAM Staff</h1>\r\n                            <p className=\"text-xs text-slate-500\">Backoffice Portal</p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <nav className=\"flex flex-col gap-1\">\r\n                        <p className=\"px-3 text-xs font-bold text-slate-500 uppercase tracking-wider mb-2\">Menu</p>\r\n                        {filteredNavItems.map(item => {\r\n                            const isActive = pathname === item.href || pathname.startsWith(item.href + \"/\");\r\n                            return (\r\n                                <Link\r\n                                    key={item.href}\r\n                                    href={item.href}\r\n                                    className={`flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all ${isActive\r\n                                        ? 'bg-indigo-600/10 text-indigo-400'\r\n                                        : 'text-slate-500 hover:text-slate-300 hover:bg-slate-800/50'\r\n                                        }`}\r\n                                >\r\n                                    <item.Icon size={20} className={isActive ? \"text-indigo-500\" : \"\"} />\r\n                                    <span className={`text-sm font-medium ${isActive ? \"text-indigo-400\" : \"\"}`}>{item.label}</span>\r\n                                </Link>\r\n                            );\r\n                        })}\r\n                    </nav>\r\n                </div>\r\n\r\n                <div className=\"mt-auto p-4 border-t border-slate-800\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-9 h-9 rounded-full bg-slate-800 flex items-center justify-center text-slate-400\">\r\n                                <IconUser size={18} />\r\n                            </div>\r\n                            <div className=\"text-sm\">\r\n                                <p className=\"font-medium text-slate-300\">{user?.firstName}</p>\r\n                                <p className=\"text-xs text-slate-500\">{roleInfo.label}</p>\r\n                            </div>\r\n                        </div>\r\n                        <button onClick={handleLogout} className=\"text-slate-500 hover:text-red-400 transition-colors\"><IconLogout size={18} /></button>\r\n                    </div>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* Main Content */}\r\n            <main className=\"flex-1 lg:ml-64 relative\">\r\n                {/* Topbar */}\r\n                <header className={`h-16 border-b flex items-center justify-between px-6 sticky top-0 z-20 backdrop-blur-md ${isDark ? 'bg-slate-900/80 border-slate-800' : 'bg-white/80 border-slate-200'}`}>\r\n                    <h2 className=\"font-semibold text-lg\">{title || 'Dashboard'}</h2>\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <button onClick={toggleTheme} className=\"text-slate-500 hover:text-slate-300\">\r\n                            {isDark ? <IconSun size={20} /> : <IconMoon size={20} />}\r\n                        </button>\r\n                    </div>\r\n                </header>\r\n\r\n                <div className=\"p-6 lg:p-8 max-w-7xl mx-auto\">\r\n                    {children}\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\criteria\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":136,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":136,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":158,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":158,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\n\r\ninterface Criterion {\r\n    id: string;\r\n    code: string;\r\n    category: string;\r\n    categoryTH: string | null;\r\n    label: string;\r\n    description: string | null;\r\n    icon: string | null;\r\n    sortOrder: number;\r\n    isRequired: boolean;\r\n    inputType: string;\r\n    isActive: boolean;\r\n    createdAt: string;\r\n}\r\n\r\ninterface CriterionForm {\r\n    code: string;\r\n    category: string;\r\n    categoryTH: string;\r\n    label: string;\r\n    description: string;\r\n    icon: string;\r\n    sortOrder: number;\r\n    isRequired: boolean;\r\n    inputType: string;\r\n    isActive: boolean;\r\n}\r\n\r\nconst defaultForm: CriterionForm = {\r\n    code: '',\r\n    category: '',\r\n    categoryTH: '',\r\n    label: '',\r\n    description: '',\r\n    icon: '๐“',\r\n    sortOrder: 0,\r\n    isRequired: false,\r\n    inputType: 'checkbox',\r\n    isActive: true\r\n};\r\n\r\nconst categoryOptions = [\r\n    { value: 'TESTING', label: 'เธเธฒเธฃเธ—เธ”เธชเธญเธเนเธฅเธฐเธ•เธฃเธงเธเธชเธญเธ', icon: '๐งช' },\r\n    { value: 'PRODUCTION', label: 'เธเธฑเนเธเธ•เธญเธเธเธฒเธฃเธเธฅเธดเธ•', icon: 'โ๏ธ' },\r\n    { value: 'SEED_SOURCE', label: 'เนเธซเธฅเนเธเธ—เธตเนเธกเธฒเน€เธกเธฅเนเธ”เธเธฑเธเธเธธเน', icon: '๐ฑ' },\r\n    { value: 'HYGIENE', label: 'เธชเธธเธเธญเธเธฒเธกเธฑเธขเนเธฅเธฐเธเธงเธฒเธกเธเธฅเธญเธ”เธ เธฑเธข', icon: '๐ก๏ธ' },\r\n    { value: 'OTHER', label: 'เธญเธทเนเธเน', icon: '๐“' }\r\n];\r\n\r\nconst inputTypeOptions = [\r\n    { value: 'checkbox', label: 'เธ•เธดเนเธเธ–เธนเธ (Checkbox)' },\r\n    { value: 'text', label: 'เธเนเธญเธเธงเธฒเธก (Text)' },\r\n    { value: 'number', label: 'เธ•เธฑเธงเน€เธฅเธ (Number)' },\r\n    { value: 'file', label: 'เนเธเธฅเนเนเธเธ (File)' }\r\n];\r\n\r\nexport default function CriteriaManagementPage() {\r\n    const [criteria, setCriteria] = useState<Criterion[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [saving, setSaving] = useState(false);\r\n    const [showForm, setShowForm] = useState(false);\r\n    const [editingId, setEditingId] = useState<string | null>(null);\r\n    const [form, setForm] = useState<CriterionForm>(defaultForm);\r\n    const [message, setMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\r\n\r\n    useEffect(() => {\r\n        fetchCriteria();\r\n    }, []);\r\n\r\n    async function fetchCriteria() {\r\n        try {\r\n            const res = await fetch('/api/proxy/criteria/all');\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                setCriteria(data.data);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    function handleEdit(criterion: Criterion) {\r\n        setForm({\r\n            code: criterion.code,\r\n            category: criterion.category,\r\n            categoryTH: criterion.categoryTH || '',\r\n            label: criterion.label,\r\n            description: criterion.description || '',\r\n            icon: criterion.icon || '๐“',\r\n            sortOrder: criterion.sortOrder,\r\n            isRequired: criterion.isRequired,\r\n            inputType: criterion.inputType,\r\n            isActive: criterion.isActive\r\n        });\r\n        setEditingId(criterion.id);\r\n        setShowForm(true);\r\n    }\r\n\r\n    function handleNew() {\r\n        setForm(defaultForm);\r\n        setEditingId(null);\r\n        setShowForm(true);\r\n    }\r\n\r\n    async function handleSubmit(e: React.FormEvent) {\r\n        e.preventDefault();\r\n        setSaving(true);\r\n        setMessage(null);\r\n\r\n        try {\r\n            const url = editingId\r\n                ? `/api/proxy/criteria/${editingId}`\r\n                : '/api/proxy/criteria';\r\n\r\n            const res = await fetch(url, {\r\n                method: editingId ? 'PATCH' : 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(form)\r\n            });\r\n\r\n            const data = await res.json();\r\n\r\n            if (data.success) {\r\n                setMessage({ type: 'success', text: editingId ? 'เธญเธฑเธเน€เธ”เธ•เน€เธฃเธตเธขเธเธฃเนเธญเธข' : 'เธชเธฃเนเธฒเธเน€เธฃเธตเธขเธเธฃเนเธญเธข' });\r\n                setShowForm(false);\r\n                fetchCriteria();\r\n            } else {\r\n                setMessage({ type: 'error', text: data.message || 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”' });\r\n            }\r\n        } catch (error) {\r\n            setMessage({ type: 'error', text: 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเน€เธเธทเนเธญเธกเธ•เนเธญ' });\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    }\r\n\r\n    async function handleDelete(id: string) {\r\n        if (!confirm('เธ•เนเธญเธเธเธฒเธฃเธฅเธเน€เธเธ“เธ‘เนเธเธตเน?')) return;\r\n\r\n        try {\r\n            const res = await fetch(`/api/proxy/criteria/${id}`, {\r\n                method: 'DELETE'\r\n            });\r\n            const data = await res.json();\r\n\r\n            if (data.success) {\r\n                setMessage({ type: 'success', text: 'เธฅเธเน€เธฃเธตเธขเธเธฃเนเธญเธข' });\r\n                fetchCriteria();\r\n            } else {\r\n                setMessage({ type: 'error', text: data.message || 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”' });\r\n            }\r\n        } catch (error) {\r\n            setMessage({ type: 'error', text: 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเน€เธเธทเนเธญเธกเธ•เนเธญ' });\r\n        }\r\n    }\r\n\r\n    async function handleToggleActive(id: string, isActive: boolean) {\r\n        try {\r\n            const res = await fetch(`/api/proxy/criteria/${id}`, {\r\n                method: 'PATCH',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ isActive: !isActive })\r\n            });\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                fetchCriteria();\r\n            }\r\n        } catch (error) {\r\n            console.error('Error:', error);\r\n        }\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"p-6\">\r\n                <div className=\"animate-pulse space-y-4\">\r\n                    <div className=\"h-10 bg-gray-200 rounded w-1/3\"></div>\r\n                    <div className=\"h-64 bg-gray-200 rounded\"></div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-6 max-w-6xl mx-auto\">\r\n            {/* Header */}\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n                <div>\r\n                    <h1 className=\"text-2xl font-bold text-gray-800\">เธเธฑเธ”เธเธฒเธฃเน€เธเธ“เธ‘เนเน€เธชเธฃเธดเธก</h1>\r\n                    <p className=\"text-gray-500\">เน€เธเธดเนเธก เธฅเธ เนเธเนเนเธเน€เธเธ“เธ‘เนเธ—เธตเนเนเธชเธ”เธเนเธเธเธญเธฃเนเธกเนเธเธชเธกเธฑเธเธฃ</p>\r\n                </div>\r\n                <button\r\n                    onClick={handleNew}\r\n                    className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2\"\r\n                >\r\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\r\n                    </svg>\r\n                    เน€เธเธดเนเธกเน€เธเธ“เธ‘เนเนเธซเธกเน\r\n                </button>\r\n            </div>\r\n\r\n            {/* Message */}\r\n            {message && (\r\n                <div className={`mb-4 p-4 rounded-lg ${message.type === 'success' ? 'bg-green-50 text-green-700' : 'bg-red-50 text-red-700'}`}>\r\n                    {message.text}\r\n                </div>\r\n            )}\r\n\r\n            {/* Form Modal */}\r\n            {showForm && (\r\n                <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\r\n                    <div className=\"bg-white rounded-xl max-w-lg w-full max-h-[90vh] overflow-y-auto\">\r\n                        <div className=\"p-6 border-b\">\r\n                            <h2 className=\"text-xl font-bold\">{editingId ? 'เนเธเนเนเธเน€เธเธ“เธ‘เน' : 'เน€เธเธดเนเธกเน€เธเธ“เธ‘เนเนเธซเธกเน'}</h2>\r\n                        </div>\r\n                        <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\r\n                            {/* Code */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เธฃเธซเธฑเธชเน€เธเธ“เธ‘เน *</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={form.code}\r\n                                    onChange={(e) => setForm({ ...form, code: e.target.value.toUpperCase() })}\r\n                                    placeholder=\"เน€เธเนเธ CONTAMINANT_TEST\"\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n                                    required\r\n                                    disabled={!!editingId}\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Category */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เธซเธกเธงเธ”เธซเธกเธนเน *</label>\r\n                                <select\r\n                                    value={form.category}\r\n                                    onChange={(e) => {\r\n                                        const opt = categoryOptions.find(o => o.value === e.target.value);\r\n                                        setForm({\r\n                                            ...form,\r\n                                            category: e.target.value,\r\n                                            categoryTH: opt?.label || '',\r\n                                            icon: opt?.icon || '๐“'\r\n                                        });\r\n                                    }}\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n                                    required\r\n                                >\r\n                                    <option value=\"\">-- เน€เธฅเธทเธญเธเธซเธกเธงเธ”เธซเธกเธนเน --</option>\r\n                                    {categoryOptions.map(opt => (\r\n                                        <option key={opt.value} value={opt.value}>{opt.icon} {opt.label}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n\r\n                            {/* Label */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เธเธทเนเธญเน€เธเธ“เธ‘เน *</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={form.label}\r\n                                    onChange={(e) => setForm({ ...form, label: e.target.value })}\r\n                                    placeholder=\"เน€เธเนเธ เธเธฅเธ•เธฃเธงเธเธชเธฒเธฃเธเธเน€เธเธทเนเธญเธ\"\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Description */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เธเธณเธญเธเธดเธเธฒเธข</label>\r\n                                <textarea\r\n                                    value={form.description}\r\n                                    onChange={(e) => setForm({ ...form, description: e.target.value })}\r\n                                    placeholder=\"เธเธณเธญเธเธดเธเธฒเธขเน€เธเธดเนเธกเน€เธ•เธดเธก...\"\r\n                                    rows={2}\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Input Type */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เธเธฃเธฐเน€เธ เธ— Input</label>\r\n                                <select\r\n                                    value={form.inputType}\r\n                                    onChange={(e) => setForm({ ...form, inputType: e.target.value })}\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n                                >\r\n                                    {inputTypeOptions.map(opt => (\r\n                                        <option key={opt.value} value={opt.value}>{opt.label}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n\r\n                            {/* Sort Order */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">เธฅเธณเธ”เธฑเธเธเธฒเธฃเนเธชเธ”เธ</label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={form.sortOrder}\r\n                                    onChange={(e) => setForm({ ...form, sortOrder: parseInt(e.target.value) || 0 })}\r\n                                    className=\"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Checkboxes */}\r\n                            <div className=\"flex gap-6\">\r\n                                <label className=\"flex items-center gap-2\">\r\n                                    <input\r\n                                        type=\"checkbox\"\r\n                                        checked={form.isRequired}\r\n                                        onChange={(e) => setForm({ ...form, isRequired: e.target.checked })}\r\n                                        className=\"w-4 h-4\"\r\n                                    />\r\n                                    <span className=\"text-sm\">เธเธฑเธเธเธฑเธเธเธฃเธญเธ</span>\r\n                                </label>\r\n                                <label className=\"flex items-center gap-2\">\r\n                                    <input\r\n                                        type=\"checkbox\"\r\n                                        checked={form.isActive}\r\n                                        onChange={(e) => setForm({ ...form, isActive: e.target.checked })}\r\n                                        className=\"w-4 h-4\"\r\n                                    />\r\n                                    <span className=\"text-sm\">เน€เธเธดเธ”เนเธเนเธเธฒเธ</span>\r\n                                </label>\r\n                            </div>\r\n\r\n                            {/* Actions */}\r\n                            <div className=\"flex gap-3 pt-4\">\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={() => setShowForm(false)}\r\n                                    className=\"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50\"\r\n                                >\r\n                                    เธขเธเน€เธฅเธดเธ\r\n                                </button>\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    disabled={saving}\r\n                                    className=\"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50\"\r\n                                >\r\n                                    {saving ? 'เธเธณเธฅเธฑเธเธเธฑเธเธ—เธถเธ...' : 'เธเธฑเธเธ—เธถเธ'}\r\n                                </button>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Table */}\r\n            <div className=\"bg-white rounded-xl shadow-sm border overflow-hidden\">\r\n                <table className=\"w-full\">\r\n                    <thead className=\"bg-gray-50 border-b\">\r\n                        <tr>\r\n                            <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-600\">เน€เธเธ“เธ‘เน</th>\r\n                            <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-600\">เธซเธกเธงเธ”เธซเธกเธนเน</th>\r\n                            <th className=\"px-4 py-3 text-center text-sm font-medium text-gray-600\">เธเธฃเธฐเน€เธ เธ—</th>\r\n                            <th className=\"px-4 py-3 text-center text-sm font-medium text-gray-600\">เธชเธ–เธฒเธเธฐ</th>\r\n                            <th className=\"px-4 py-3 text-center text-sm font-medium text-gray-600\">เธเธฑเธ”เธเธฒเธฃ</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y\">\r\n                        {criteria.length === 0 ? (\r\n                            <tr>\r\n                                <td colSpan={5} className=\"px-4 py-12 text-center text-gray-500\">\r\n                                    เธขเธฑเธเนเธกเนเธกเธตเน€เธเธ“เธ‘เนเนเธเธฃเธฐเธเธ\r\n                                </td>\r\n                            </tr>\r\n                        ) : (\r\n                            criteria.map((item) => (\r\n                                <tr key={item.id} className={!item.isActive ? 'bg-gray-50' : ''}>\r\n                                    <td className=\"px-4 py-3\">\r\n                                        <div className=\"font-medium text-gray-800\">{item.label}</div>\r\n                                        <div className=\"text-xs text-gray-500\">{item.code}</div>\r\n                                    </td>\r\n                                    <td className=\"px-4 py-3\">\r\n                                        <span className=\"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 rounded text-sm\">\r\n                                            {item.icon} {item.categoryTH || item.category}\r\n                                        </span>\r\n                                    </td>\r\n                                    <td className=\"px-4 py-3 text-center\">\r\n                                        <span className=\"text-sm text-gray-600\">{item.inputType}</span>\r\n                                    </td>\r\n                                    <td className=\"px-4 py-3 text-center\">\r\n                                        <button\r\n                                            onClick={() => handleToggleActive(item.id, item.isActive)}\r\n                                            className={`px-2 py-1 rounded text-xs font-medium ${item.isActive\r\n                                                ? 'bg-green-100 text-green-700'\r\n                                                : 'bg-gray-200 text-gray-600'\r\n                                                }`}\r\n                                        >\r\n                                            {item.isActive ? 'โ“ เน€เธเธดเธ”' : 'โ— เธเธดเธ”'}\r\n                                        </button>\r\n                                    </td>\r\n                                    <td className=\"px-4 py-3 text-center\">\r\n                                        <div className=\"flex justify-center gap-2\">\r\n                                            <button\r\n                                                onClick={() => handleEdit(item)}\r\n                                                className=\"p-1 text-blue-600 hover:bg-blue-50 rounded\"\r\n                                                title=\"เนเธเนเนเธ\"\r\n                                            >\r\n                                                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\r\n                                                </svg>\r\n                                            </button>\r\n                                            <button\r\n                                                onClick={() => handleDelete(item.id)}\r\n                                                className=\"p-1 text-red-600 hover:bg-red-50 rounded\"\r\n                                                title=\"เธฅเธ\"\r\n                                            >\r\n                                                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                                                </svg>\r\n                                            </button>\r\n                                        </div>\r\n                                    </td>\r\n                                </tr>\r\n                            ))\r\n                        )}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n\r\n            {/* Stats */}\r\n            <div className=\"mt-6 grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                <div className=\"bg-blue-50 rounded-lg p-4 text-center\">\r\n                    <div className=\"text-2xl font-bold text-blue-600\">{criteria.length}</div>\r\n                    <div className=\"text-sm text-blue-600\">เน€เธเธ“เธ‘เนเธ—เธฑเนเธเธซเธกเธ”</div>\r\n                </div>\r\n                <div className=\"bg-green-50 rounded-lg p-4 text-center\">\r\n                    <div className=\"text-2xl font-bold text-green-600\">{criteria.filter(c => c.isActive).length}</div>\r\n                    <div className=\"text-sm text-green-600\">เน€เธเธดเธ”เนเธเนเธเธฒเธ</div>\r\n                </div>\r\n                <div className=\"bg-gray-100 rounded-lg p-4 text-center\">\r\n                    <div className=\"text-2xl font-bold text-gray-600\">{criteria.filter(c => !c.isActive).length}</div>\r\n                    <div className=\"text-sm text-gray-600\">เธเธดเธ”เนเธเนเธเธฒเธ</div>\r\n                </div>\r\n                <div className=\"bg-purple-50 rounded-lg p-4 text-center\">\r\n                    <div className=\"text-2xl font-bold text-purple-600\">{new Set(criteria.map(c => c.category)).size}</div>\r\n                    <div className=\"text-sm text-purple-600\">เธซเธกเธงเธ”เธซเธกเธนเน</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\dashboard\\admin\\page.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\dashboard\\admin\\page.tsx:50:9\n  48 |             return;\n  49 |         }\n> 50 |         setUser(JSON.parse(stored));\n     |         ^^^^^^^ Avoid calling setState() directly within an effect\n  51 |     }, [router]);\n  52 |\n  53 |     const handleLogout = () => {","line":50,"column":9,"nodeType":null,"endLine":50,"endColumn":16}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { IconDocument, IconChart, IconCalendar, IconCreditCard, IconUser, IconCheckCircle, IconClock } from \"@/components/ui/icons\";\r\n\r\n// Additional icons\r\nconst IconUsers = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\" />\r\n        <circle cx=\"9\" cy=\"7\" r=\"4\" />\r\n        <path d=\"M23 21v-2a4 4 0 0 0-3-3.87\" />\r\n        <path d=\"M16 3.13a4 4 0 0 1 0 7.75\" />\r\n    </svg>\r\n);\r\n\r\nconst IconSettings = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <circle cx=\"12\" cy=\"12\" r=\"3\" />\r\n        <path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\" />\r\n    </svg>\r\n);\r\n\r\nconst IconLeaf = ({ size = 24, className }: { size?: number; className?: string }) => (\r\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}>\r\n        <path d=\"M6.3 20.3a2.4 2.4 0 0 0 3.4 0L12 18l2.3 2.3a2.4 2.4 0 0 0 3.4-3.4L15.4 14.6l6-6c4.5-4.5.5-8.5-4-4l-6.3 6.3-2.4-2.4a2.4 2.4 0 0 0-3.4 3.4L7.7 14.3l-4 4a2.4 2.4 0 0 0 0 3.4l2.6-1.4z\" />\r\n    </svg>\r\n);\r\n\r\ninterface StaffUser {\r\n    username: string;\r\n    email: string;\r\n    role: string;\r\n    department?: string;\r\n    firstName?: string;\r\n    lastName?: string;\r\n}\r\n\r\nexport default function AdminDashboardPage() {\r\n    const router = useRouter();\r\n    const [user, setUser] = useState<StaffUser | null>(null);\r\n\r\n    useEffect(() => {\r\n        const stored = localStorage.getItem(\"staff_user\");\r\n        if (!stored) {\r\n            router.push(\"/staff/login\");\r\n            return;\r\n        }\r\n        setUser(JSON.parse(stored));\r\n    }, [router]);\r\n\r\n    const handleLogout = () => {\r\n        localStorage.removeItem(\"staff_token\");\r\n        localStorage.removeItem(\"staff_user\");\r\n        router.push(\"/staff/login\");\r\n    };\r\n\r\n    if (!user) return null;\r\n\r\n    const stats = [\r\n        { label: \"เธเธณเธเธญเธ—เธฑเนเธเธซเธกเธ”\", value: \"1,234\", Icon: IconDocument, bgColor: \"bg-emerald-500\" },\r\n        { label: \"เธฃเธญเธ•เธฃเธงเธเธชเธญเธ\", value: \"45\", Icon: IconClock, bgColor: \"bg-amber-500\" },\r\n        { label: \"เธญเธเธธเธกเธฑเธ•เธดเนเธฅเนเธง\", value: \"1,189\", Icon: IconCheckCircle, bgColor: \"bg-emerald-500\" },\r\n        { label: \"เน€เธเนเธฒเธซเธเนเธฒเธ—เธตเน\", value: \"12\", Icon: IconUsers, bgColor: \"bg-blue-500\" },\r\n    ];\r\n\r\n    const recentActivities = [\r\n        { action: \"เธญเธเธธเธกเธฑเธ•เธดเธเธณเธเธญ #12345\", time: \"5 เธเธฒเธ—เธตเธ—เธตเนเนเธฅเนเธง\", user: \"เธเธนเนเธ•เธฃเธงเธเธชเธญเธ A\" },\r\n        { action: \"เธชเธฃเนเธฒเธเธเธฑเธเธเธตเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเนเธซเธกเน\", time: \"1 เธเธฑเนเธงเนเธกเธเธ—เธตเนเนเธฅเนเธง\", user: \"Admin\" },\r\n        { action: \"เธญเธญเธเนเธเธฃเธฑเธเธฃเธญเธ GACP-2024-001234\", time: \"2 เธเธฑเนเธงเนเธกเธเธ—เธตเนเนเธฅเนเธง\", user: \"เธเธนเนเธ•เธฃเธงเธเธชเธญเธ B\" },\r\n    ];\r\n\r\n    const quickActions = [\r\n        { Icon: IconUsers, label: \"เธเธฑเธ”เธเธฒเธฃเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเน\", href: \"/staff/applications\", color: \"bg-slate-600\" },\r\n        { Icon: IconDocument, label: \"เธ”เธนเธเธณเธเธญเธ—เธฑเนเธเธซเธกเธ”\", href: \"/staff/applications\", color: \"bg-blue-500\" },\r\n        { Icon: IconChart, label: \"เธฃเธฒเธขเธเธฒเธเธชเธ–เธดเธ•เธด\", href: \"/staff/analytics\", color: \"bg-violet-500\" },\r\n        { Icon: IconCalendar, label: \"เธ•เธฒเธฃเธฒเธเธเธฑเธ”เธซเธกเธฒเธข\", href: \"/staff/calendar\", color: \"bg-emerald-500\" },\r\n        { Icon: IconCreditCard, label: \"เธเธฑเธเธเธต/เธเธฒเธฃเน€เธเธดเธ\", href: \"/staff/accounting\", color: \"bg-amber-500\" },\r\n        { Icon: IconSettings, label: \"เธ•เธฑเนเธเธเนเธฒเธฃเธฐเธเธ\", href: \"/staff/dashboard\", color: \"bg-red-500\" },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-slate-900 text-white font-sans\">\r\n            {/* Header */}\r\n            <header className=\"px-8 py-4 border-b border-emerald-500/20 flex justify-between items-center\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-10 h-10 rounded-xl bg-emerald-600 flex items-center justify-center\">\r\n                        <IconLeaf size={24} className=\"text-white\" />\r\n                    </div>\r\n                    <div>\r\n                        <h1 className=\"text-xl font-semibold m-0\">GACP Admin Dashboard</h1>\r\n                        <p className=\"text-xs text-slate-400 m-0\">เธฃเธฐเธเธเธเธฑเธ”เธเธฒเธฃ GACP - เธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธ</p>\r\n                    </div>\r\n                </div>\r\n                <div className=\"flex items-center gap-4\">\r\n                    <span className=\"flex items-center gap-2 text-emerald-400\">\r\n                        <IconUser size={18} /> {user.firstName || user.username} ({user.role})\r\n                    </span>\r\n                    <button\r\n                        onClick={handleLogout}\r\n                        className=\"px-4 py-2 bg-transparent border border-red-500 text-red-500 rounded-lg hover:bg-red-500/10 transition-colors\"\r\n                    >\r\n                        เธญเธญเธเธเธฒเธเธฃเธฐเธเธ\r\n                    </button>\r\n                </div>\r\n            </header>\r\n\r\n            {/* Main Content */}\r\n            <main className=\"p-8\">\r\n                {/* Welcome */}\r\n                <div className=\"mb-8\">\r\n                    <h2 className=\"text-2xl font-semibold m-0\">\r\n                        เธชเธงเธฑเธชเธ”เธต, {user.firstName || user.username}!\r\n                    </h2>\r\n                    <p className=\"text-slate-400 mt-1\">\r\n                        เธขเธดเธเธ”เธตเธ•เนเธญเธเธฃเธฑเธเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธเธเธฑเธ”เธเธฒเธฃ GACP เธชเธณเธซเธฃเธฑเธเธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธ\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Stats Grid */}\r\n                <div className=\"grid grid-cols-4 gap-6 mb-8\">\r\n                    {stats.map((stat, i) => (\r\n                        <div\r\n                            key={i}\r\n                            className=\"bg-emerald-500/10 border border-emerald-500/30 rounded-xl p-6 text-center hover:bg-emerald-500/15 transition-colors\"\r\n                        >\r\n                            <div className={`w-12 h-12 mx-auto rounded-xl ${stat.bgColor} flex items-center justify-center mb-3`}>\r\n                                <stat.Icon size={24} className=\"text-white\" />\r\n                            </div>\r\n                            <div className=\"text-3xl font-bold text-emerald-400\">{stat.value}</div>\r\n                            <div className=\"text-sm text-slate-400\">{stat.label}</div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Quick Actions & Activity */}\r\n                <div className=\"grid grid-cols-3 gap-6\">\r\n                    {/* Quick Actions Panel */}\r\n                    <div className=\"col-span-2 bg-emerald-500/10 border border-emerald-500/30 rounded-xl p-6\">\r\n                        <h3 className=\"text-lg font-semibold mb-4\">เธเธฒเธฃเธ”เธณเน€เธเธดเธเธเธฒเธฃเธ”เนเธงเธ</h3>\r\n                        <div className=\"grid grid-cols-3 gap-4\">\r\n                            {quickActions.map((action, i) => (\r\n                                <Link\r\n                                    key={i}\r\n                                    href={action.href}\r\n                                    className=\"p-4 bg-emerald-500/10 border border-emerald-500/30 rounded-lg text-white hover:bg-emerald-500/20 hover:border-emerald-400 transition-all\"\r\n                                >\r\n                                    <div className={`w-10 h-10 rounded-lg ${action.color} flex items-center justify-center mb-3`}>\r\n                                        <action.Icon size={20} className=\"text-white\" />\r\n                                    </div>\r\n                                    <div className=\"text-sm\">{action.label}</div>\r\n                                </Link>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Recent Activity */}\r\n                    <div className=\"bg-emerald-500/10 border border-emerald-500/30 rounded-xl p-6\">\r\n                        <h3 className=\"text-lg font-semibold mb-4\">เธเธดเธเธเธฃเธฃเธกเธฅเนเธฒเธชเธธเธ”</h3>\r\n                        <div className=\"flex flex-col gap-3\">\r\n                            {recentActivities.map((activity, i) => (\r\n                                <div\r\n                                    key={i}\r\n                                    className=\"p-3 bg-black/20 rounded-lg\"\r\n                                >\r\n                                    <div className=\"text-sm\">{activity.action}</div>\r\n                                    <div className=\"text-xs text-slate-400 mt-1\">\r\n                                        {activity.user} โ€ข {activity.time}\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\dashboard\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IconClock' is defined but never used.","line":9,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":31},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchPendingData'. Either include it or remove the dependency array.","line":62,"column":8,"nodeType":"ArrayExpression","endLine":62,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [fetchPendingData, router]","fix":{"range":[2319,2327],"text":"[fetchPendingData, router]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":144,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6716,6719],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6716,6719],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport StaffLayout from \"../components/StaffLayout\";\r\nimport {\r\n    IconDocument, IconSearch, IconChart, IconCreditCard, IconCalendar,\r\n    IconCheckCircle, IconClock, IconUser\r\n} from \"@/components/ui/icons\";\r\nimport { ApplicationService, DashboardStats, Application } from \"@/lib/services/application-service\";\r\nimport DataTable from \"@/components/ui/DataTable\";\r\n\r\ninterface StaffUser {\r\n    id: string;\r\n    email: string;\r\n    firstName?: string;\r\n    lastName?: string;\r\n    role: string;\r\n}\r\n\r\ninterface PendingItem {\r\n    id: string;\r\n    applicantName: string;\r\n    plantType: string;\r\n    status: string;\r\n    submittedAt: string;\r\n    submissionCount?: number;\r\n    waitTime: string;\r\n}\r\n\r\nconst ROLE_LABELS: Record<string, { label: string }> = {\r\n    REVIEWER_AUDITOR: { label: \"เธเธนเนเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ/เธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ\" },\r\n    SCHEDULER: { label: \"เน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธเธฑเธ”เธเธดเธง\" },\r\n    ACCOUNTANT: { label: \"เธเธเธฑเธเธเธฒเธเธเธฑเธเธเธต\" },\r\n    ADMIN: { label: \"เธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธ\" },\r\n    assessor: { label: \"เธเธนเนเธ•เธฃเธงเธเธชเธญเธ\" },\r\n    scheduler: { label: \"เน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธเธฑเธ”เธเธดเธง\" },\r\n    accountant: { label: \"เธเธเธฑเธเธเธฒเธเธเธฑเธเธเธต\" },\r\n    admin: { label: \"เธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธ\" },\r\n};\r\n\r\nexport default function StaffDashboardPage() {\r\n    const router = useRouter();\r\n    const [user, setUser] = useState<StaffUser | null>(null);\r\n    const [activeTab, setActiveTab] = useState<\"documents\" | \"audits\">(\"documents\");\r\n    const [pendingDocuments, setPendingDocuments] = useState<PendingItem[]>([]);\r\n    const [pendingAudits, setPendingAudits] = useState<PendingItem[]>([]);\r\n    const [dashboardStats, setDashboardStats] = useState<DashboardStats>({ total: 0, pending: 0, approved: 0, todayChecked: 0 });\r\n    const [isLoading, setIsLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const token = localStorage.getItem(\"staff_token\");\r\n        const userData = localStorage.getItem(\"staff_user\");\r\n        if (!token || !userData) { router.push(\"/staff/login\"); return; }\r\n        try {\r\n            const parsed = JSON.parse(userData);\r\n            setUser(parsed);\r\n            if (parsed.role === \"SCHEDULER\") setActiveTab(\"audits\");\r\n            fetchPendingData();\r\n        } catch { router.push(\"/staff/login\"); }\r\n    }, [router]);\r\n\r\n    const fetchPendingData = async () => {\r\n        try {\r\n            const [pendingRes, auditsRes, statsRes] = await Promise.all([\r\n                ApplicationService.getPendingReviews(),\r\n                ApplicationService.getPendingAudits(),\r\n                ApplicationService.getStats()\r\n            ]);\r\n\r\n            if (pendingRes.success) {\r\n                setPendingDocuments(mapApplicationsToPendingItems(pendingRes.data as Application[]));\r\n            }\r\n            if (auditsRes.success) {\r\n                setPendingAudits(mapApplicationsToPendingItems(auditsRes.data as Application[]));\r\n            }\r\n            if (statsRes.success && statsRes.data) {\r\n                setDashboardStats(statsRes.data);\r\n            }\r\n        } catch (e) {\r\n            console.error('Error fetching dashboard data:', e);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const mapApplicationsToPendingItems = (apps: Application[] | undefined): PendingItem[] => {\r\n        if (!apps || !Array.isArray(apps)) return [];\r\n        return apps.map(app => ({\r\n            id: app._id || app.applicationNumber || 'Unknown',\r\n            applicantName: app.data?.applicantInfo?.name || 'เนเธกเนเธฃเธฐเธเธธ',\r\n            plantType: app.data?.formData?.plantId || 'เนเธกเนเธฃเธฐเธเธธ',\r\n            status: app.status,\r\n            submittedAt: app.audit?.scheduledDate || app.createdAt,\r\n            submissionCount: (app.rejectCount || 0) + 1,\r\n            waitTime: getWaitTime(app.createdAt)\r\n        }));\r\n    };\r\n\r\n    const getWaitTime = (date: string) => {\r\n        const diff = Date.now() - new Date(date).getTime();\r\n        const hours = Math.floor(diff / 3600000);\r\n        return hours < 24 ? `${hours} เธเธก.` : `${Math.floor(hours / 24)} เธงเธฑเธ`;\r\n    };\r\n\r\n    if (!user || isLoading) return <div className=\"p-8 flex justify-center\"><div className=\"w-8 h-8 border-4 border-slate-300 border-t-slate-600 rounded-full animate-spin\"></div></div>;\r\n\r\n    const roleInfo = ROLE_LABELS[user.role] || { label: user.role };\r\n\r\n    return (\r\n        <StaffLayout title=\"Dashboard\" subtitle={`เธ เธฒเธเธฃเธงเธกเธเธฒเธฃเธ—เธณเธเธฒเธ (${roleInfo.label})`}>\r\n            {/* 1. Key Metrics */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\r\n                {[\r\n                    { label: \"เธเธฒเธเธ—เธฑเนเธเธซเธกเธ”เนเธเธฃเธฐเธเธ\", value: dashboardStats.total, icon: IconCalendar, color: \"text-slate-400\" },\r\n                    { label: \"เธฃเธญเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ\", value: pendingDocuments.length, icon: IconDocument, color: \"text-amber-500\" },\r\n                    { label: \"เธฃเธญเน€เธเนเธฒเธ•เธฃเธงเธเนเธเธฅเธ\", value: pendingAudits.length, icon: IconSearch, color: \"text-purple-500\" },\r\n                    { label: \"เธญเธเธธเธกเธฑเธ•เธดเธงเธฑเธเธเธตเน\", value: dashboardStats.todayChecked, icon: IconCheckCircle, color: \"text-emerald-500\" },\r\n                ].map((stat, i) => (\r\n                    <div key={i} className=\"bg-white dark:bg-slate-800 p-6 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm\">\r\n                        <div className=\"flex justify-between items-start\">\r\n                            <div>\r\n                                <p className=\"text-sm font-medium text-slate-500 dark:text-slate-400\">{stat.label}</p>\r\n                                <h3 className=\"text-3xl font-bold mt-2 text-slate-800 dark:text-slate-100\">{stat.value}</h3>\r\n                            </div>\r\n                            <stat.icon size={24} className={stat.color} />\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* 2. Work Queue (Tabs & Table) */}\r\n            <div className=\"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden mb-8\">\r\n                {/* Tabs */}\r\n                {user.role === \"REVIEWER_AUDITOR\" && (\r\n                    <div className=\"flex border-b border-slate-200 dark:border-slate-700\">\r\n                        {[\r\n                            { key: \"documents\", label: `เธฃเธญเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ (${pendingDocuments.length})`, icon: IconDocument },\r\n                            { key: \"audits\", label: `เธฃเธญเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ (${pendingAudits.length})`, icon: IconSearch }\r\n                        ].map(tab => (\r\n                            <button\r\n                                key={tab.key}\r\n                                onClick={() => setActiveTab(tab.key as any)}\r\n                                className={`flex items-center gap-2 px-6 py-4 text-sm font-medium transition-colors border-b-2 -mb-px ${activeTab === tab.key\r\n                                    ? 'border-indigo-500 text-indigo-600 dark:text-indigo-400 bg-indigo-50/50 dark:bg-indigo-950/10'\r\n                                    : 'border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700/50'\r\n                                    }`}\r\n                            >\r\n                                <tab.icon size={18} />\r\n                                {tab.label}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Table Header */}\r\n                <div className=\"px-6 py-4 flex justify-between items-center bg-slate-50 dark:bg-slate-800/50 border-b border-slate-200 dark:border-slate-700\">\r\n                    <h3 className=\"font-semibold text-slate-700 dark:text-slate-200\">\r\n                        {activeTab === \"documents\" ? \"เธฃเธฒเธขเธเธฒเธฃเน€เธญเธเธชเธฒเธฃเธฃเธญเธ•เธฃเธงเธเธชเธญเธ\" : \"เธฃเธฒเธขเธเธฒเธฃเธเธฑเธ”เธซเธกเธฒเธขเธ•เธฃเธงเธเนเธเธฅเธ\"}\r\n                    </h3>\r\n                    <div className=\"flex gap-2\">\r\n                        <span className=\"text-xs px-2 py-1 rounded bg-amber-100 text-amber-700 border border-amber-200\">Priority: เธชเธนเธ</span>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Table Body */}\r\n                <DataTable\r\n                    columns={[\r\n                        { key: 'id', label: 'JobID', render: (item: PendingItem) => <span className=\"font-mono text-slate-500\">#{item.id?.slice(-6)}</span> },\r\n                        { key: 'applicantName', label: 'เธเธนเนเธขเธทเนเธเธเธณเธเธญ' },\r\n                        { key: 'plantType', label: 'เธเธเธดเธ”เธเธทเธ' },\r\n                        {\r\n                            key: 'status', label: 'เธชเธ–เธฒเธเธฐ', render: (item: PendingItem) => (\r\n                                <span className={`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border ${item.submissionCount === 1\r\n                                    ? 'bg-blue-50 text-blue-700 border-blue-200 dark:bg-blue-900/20 dark:text-blue-300 dark:border-blue-800'\r\n                                    : 'bg-amber-50 text-amber-700 border-amber-200 dark:bg-amber-900/20 dark:text-amber-300 dark:border-amber-800'\r\n                                    }`}>\r\n                                    <span className={`w-1.5 h-1.5 rounded-full ${item.submissionCount === 1 ? 'bg-blue-500' : 'bg-amber-500'}`}></span>\r\n                                    {item.submissionCount === 1 ? 'เธขเธทเนเธเนเธซเธกเน' : `เนเธเนเนเธเธเธฃเธฑเนเธเธ—เธตเน ${(item.submissionCount || 1) - 1}`}\r\n                                </span>\r\n                            )\r\n                        },\r\n                        { key: 'waitTime', label: 'เน€เธงเธฅเธฒเธฃเธญเธเธญเธข' },\r\n                        {\r\n                            key: 'actions', label: 'เธเธฑเธ”เธเธฒเธฃ', render: (item: PendingItem) => (\r\n                                <div className=\"text-right\">\r\n                                    <Link\r\n                                        href={`/staff/applications/${item.id}`}\r\n                                        className=\"inline-flex items-center px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md text-xs font-bold transition-colors shadow-sm\"\r\n                                    >\r\n                                        เธ•เธฃเธงเธเธชเธญเธ\r\n                                    </Link>\r\n                                </div>\r\n                            )\r\n                        }\r\n                    ]}\r\n                    data={activeTab === \"documents\" ? pendingDocuments : pendingAudits}\r\n                    emptyMessage=\"เนเธกเนเธกเธตเธฃเธฒเธขเธเธฒเธฃเธ—เธตเนเธ•เนเธญเธเธ”เธณเน€เธเธดเธเธเธฒเธฃเนเธเธเธ“เธฐเธเธตเน\"\r\n                />\r\n            </div>\r\n\r\n            {/* 3. Quick Actions Grid */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                {/* Internal Tools */}\r\n                <div className=\"md:col-span-2 bg-white dark:bg-slate-800 p-6 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm\">\r\n                    <h3 className=\"font-semibold mb-4 text-slate-800 dark:text-slate-200\">เน€เธเธฃเธทเนเธญเธเธกเธทเธญเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเน</h3>\r\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                        {[\r\n                            { title: \"เธเธฑเธ”เธเธฒเธฃเธเธนเนเนเธเน\", icon: IconUser, href: \"/staff/management\", color: \"bg-blue-100 text-blue-600\" },\r\n                            { title: \"เธฃเธฒเธขเธเธฒเธเธชเธ–เธดเธ•เธด\", icon: IconChart, href: \"/staff/analytics\", color: \"bg-emerald-100 text-emerald-600\" },\r\n                            { title: \"เธฃเธฐเธเธเธเธฑเธเธเธต\", icon: IconCreditCard, href: \"/staff/accounting\", color: \"bg-amber-100 text-amber-600\" },\r\n                            { title: \"เธ•เธฒเธฃเธฒเธเธเธฒเธ\", icon: IconCalendar, href: \"/staff/calendar\", color: \"bg-purple-100 text-purple-600\" },\r\n                        ].map((tool, i) => (\r\n                            <Link key={i} href={tool.href} className=\"flex flex-col items-center justify-center p-4 rounded-lg bg-slate-50 dark:bg-slate-900 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors border border-transparent hover:border-slate-200 dark:hover:border-slate-700 text-center gap-3\">\r\n                                <div className={`w-10 h-10 rounded-full flex items-center justify-center ${tool.color} dark:bg-opacity-20`}>\r\n                                    <tool.icon size={20} />\r\n                                </div>\r\n                                <span className=\"text-xs font-medium text-slate-700 dark:text-slate-300\">{tool.title}</span>\r\n                            </Link>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* System Status */}\r\n                <div className=\"bg-slate-900 text-white p-6 rounded-xl shadow-lg relative overflow-hidden\">\r\n                    <div className=\"absolute top-0 right-0 -mr-8 -mt-8 w-32 h-32 bg-indigo-500 rounded-full blur-3xl opacity-20\"></div>\r\n                    <div className=\"relative z-10\">\r\n                        <h3 className=\"font-semibold mb-1\">เธชเธ–เธฒเธเธฐเธฃเธฐเธเธ</h3>\r\n                        <p className=\"text-xs text-slate-400 mb-4\">Version 2.0.1 (Stable)</p>\r\n                        <div className=\"space-y-3\">\r\n                            <div className=\"flex justify-between text-sm\">\r\n                                <span className=\"text-slate-300\">Database</span>\r\n                                <span className=\"text-emerald-400 flex items-center gap-1\"><span className=\"w-2 h-2 rounded-full bg-emerald-400\"></span> Connected</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between text-sm\">\r\n                                <span className=\"text-slate-300\">API Gateway</span>\r\n                                <span className=\"text-emerald-400 flex items-center gap-1\"><span className=\"w-2 h-2 rounded-full bg-emerald-400\"></span> Online</span>\r\n                            </div>\r\n                            <div className=\"mt-4 pt-4 border-t border-slate-700\">\r\n                                <p className=\"text-xs text-slate-400\">Last backup: 2 hours ago</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </StaffLayout>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\login\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IconUser' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2496,2499],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2496,2499],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { apiClient } from \"@/lib/api\";\r\nimport { IconUser, IconLock, EyeIcon } from \"@/components/ui/icons\";\r\n\r\n// Local Icons\r\nconst UserIcon = () => (\r\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" className=\"text-emerald-700\">\r\n        <circle cx=\"12\" cy=\"8\" r=\"4\" />\r\n        <path d=\"M4 20c0-4 4-7 8-7s8 3 8 7\" />\r\n    </svg>\r\n);\r\n\r\nconst ShieldIcon = () => (\r\n    <svg width=\"40\" height=\"40\" viewBox=\"0 0 48 48\" className=\"fill-emerald-700\">\r\n        <path d=\"M24 4L8 10V22C8 32.5 14.5 42 24 46C33.5 42 40 32.5 40 22V10L24 4Z\" />\r\n        <path d=\"M24 8L12 13V22C12 30 17 38 24 41C31 38 36 30 36 22V13L24 8Z\" fill=\"white\" fillOpacity=\"0.3\" />\r\n        <path d=\"M20 24L23 27L28 21\" stroke=\"white\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" fill=\"none\" />\r\n    </svg>\r\n);\r\n\r\nconst WarningIcon = () => (\r\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"text-amber-600\">\r\n        <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\" />\r\n        <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\" />\r\n        <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\" />\r\n    </svg>\r\n);\r\n\r\nconst LockKeyIcon = () => (\r\n    <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"text-slate-400\">\r\n        <rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\" />\r\n        <path d=\"M7 11V7a5 5 0 0 1 10 0v4\" />\r\n    </svg>\r\n);\r\n\r\nexport default function StaffLoginPage() {\r\n    const router = useRouter();\r\n    const [loginId, setLoginId] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [showPassword, setShowPassword] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState(\"\");\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError(\"\");\r\n        setIsLoading(true);\r\n\r\n        if (!loginId.trim()) {\r\n            setError(\"เธเธฃเธธเธ“เธฒเธเธฃเธญเธเธเธทเนเธญเธเธนเนเนเธเนเธซเธฃเธทเธญเธฃเธซเธฑเธชเธเธเธฑเธเธเธฒเธ\");\r\n            setIsLoading(false);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const response = await apiClient.post<{\r\n                user: any,\r\n                token: string,\r\n                tokens?: { accessToken: string }\r\n            }>('/auth-dtam/login', {\r\n                username: loginId.trim(),\r\n                password,\r\n                userType: 'DTAM_STAFF',\r\n            });\r\n\r\n            if (!response.success || !response.data) {\r\n                setError(response.error || 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ” เธเธฃเธธเธ“เธฒเธฅเธญเธเนเธซเธกเน');\r\n                setIsLoading(false);\r\n                return;\r\n            }\r\n\r\n            const responseData = response.data;\r\n            const user = responseData?.user;\r\n            const token = responseData?.token || responseData?.tokens?.accessToken;\r\n\r\n            if (!user || !token) {\r\n                setError(\"เนเธกเนเธเธเธเนเธญเธกเธนเธฅเธเธนเนเนเธเนเธเธฒเธเธซเธฃเธทเธญ Token\");\r\n                setIsLoading(false);\r\n                return;\r\n            }\r\n\r\n            // Validate Role\r\n            // Allow all for now, as backend should have validated basic access\r\n\r\n            localStorage.setItem(\"staff_token\", token);\r\n            localStorage.setItem(\"staff_user\", JSON.stringify(user));\r\n\r\n            // Set cookie for middleware compatibility\r\n            document.cookie = `staff_token=${token}; path=/; max-age=${60 * 60 * 8}; SameSite=Lax`;\r\n\r\n            setIsLoading(false);\r\n            router.push(\"/staff/dashboard\");\r\n        } catch (err) {\r\n            console.error(\"Login error:\", err);\r\n            setError(\"เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ\");\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-stone-50 flex items-center justify-center p-6\">\r\n            <div className=\"w-full max-w-md\">\r\n                {/* Logo */}\r\n                <div className=\"text-center mb-8\">\r\n                    <div className=\"w-20 h-20 mx-auto mb-5 bg-emerald-50 rounded-full flex items-center justify-center\">\r\n                        <ShieldIcon />\r\n                    </div>\r\n                    <h1 className=\"text-2xl font-black text-emerald-700 mb-3\">\r\n                        เธฃเธฐเธเธเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเน GACP\r\n                    </h1>\r\n                    <div className=\"inline-block px-5 py-2 bg-emerald-50 rounded-full border border-emerald-200 text-sm font-semibold text-emerald-700\">\r\n                        เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Card */}\r\n                <div className=\"bg-white rounded-2xl p-6 shadow-lg\">\r\n                    {/* Warning Badge */}\r\n                    <div className=\"flex items-center gap-2.5 p-3 bg-amber-50 rounded-xl mb-5 border border-amber-200\">\r\n                        <WarningIcon />\r\n                        <span className=\"text-sm text-amber-800 font-medium\">\r\n                            เธชเธณเธซเธฃเธฑเธเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธ—เธตเนเนเธ”เนเธฃเธฑเธเธญเธเธธเธเธฒเธ•เน€เธ—เนเธฒเธเธฑเนเธ\r\n                        </span>\r\n                    </div>\r\n\r\n                    {/* Error */}\r\n                    {error && (\r\n                        <div className=\"flex items-center gap-2 p-3 bg-red-50 rounded-xl text-red-600 text-sm mb-4 border border-red-100\">\r\n                            <WarningIcon /> {error}\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Form */}\r\n                    <form onSubmit={handleSubmit}>\r\n                        {/* Login ID */}\r\n                        <div className=\"mb-4\">\r\n                            <label className=\"text-sm font-semibold text-emerald-700 block mb-2\">\r\n                                เธเธทเนเธญเธเธนเนเนเธเน / เธฃเธซเธฑเธชเธเธเธฑเธเธเธฒเธ / เธญเธตเน€เธกเธฅ\r\n                            </label>\r\n                            <div className=\"relative\">\r\n                                <div className=\"absolute left-3.5 top-1/2 -translate-y-1/2\">\r\n                                    <UserIcon />\r\n                                </div>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={loginId}\r\n                                    onChange={(e) => setLoginId(e.target.value)}\r\n                                    placeholder=\"admin / EMP001 / officer@dtam.go.th\"\r\n                                    className=\"w-full py-3.5 px-4 pl-12 border border-slate-200 rounded-xl text-base outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-100\"\r\n                                    required\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Password */}\r\n                        <div className=\"mb-5\">\r\n                            <label className=\"text-sm font-semibold text-emerald-700 block mb-2\">\r\n                                เธฃเธซเธฑเธชเธเนเธฒเธ\r\n                            </label>\r\n                            <div className=\"relative\">\r\n                                <div className=\"absolute left-3.5 top-1/2 -translate-y-1/2\">\r\n                                    <IconLock />\r\n                                </div>\r\n                                <input\r\n                                    type={showPassword ? \"text\" : \"password\"}\r\n                                    value={password}\r\n                                    onChange={(e) => setPassword(e.target.value)}\r\n                                    placeholder=\"เธเธฃเธญเธเธฃเธซเธฑเธชเธเนเธฒเธ\"\r\n                                    className=\"w-full py-3.5 px-12 border border-slate-200 rounded-xl text-base outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-100\"\r\n                                    required\r\n                                />\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={() => setShowPassword(!showPassword)}\r\n                                    className=\"absolute right-3 top-1/2 -translate-y-1/2 p-1 bg-transparent border-none cursor-pointer\"\r\n                                >\r\n                                    <EyeIcon open={showPassword} />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Submit */}\r\n                        <button\r\n                            type=\"submit\"\r\n                            disabled={isLoading}\r\n                            className={`w-full py-4 rounded-xl text-white text-base font-bold flex items-center justify-center gap-2 transition-all ${isLoading\r\n                                ? 'bg-slate-400 cursor-not-allowed'\r\n                                : 'bg-emerald-700 hover:bg-emerald-800 shadow-lg shadow-emerald-700/30'\r\n                                }`}\r\n                        >\r\n                            {isLoading ? (\r\n                                <>\r\n                                    <span className=\"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin\" />\r\n                                    เธเธณเธฅเธฑเธเธ•เธฃเธงเธเธชเธญเธ...\r\n                                </>\r\n                            ) : (\r\n                                <>เน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธเน€เธเนเธฒเธซเธเนเธฒเธ—เธตเน</>\r\n                            )}\r\n                        </button>\r\n                    </form>\r\n\r\n                    <p className=\"text-center text-sm text-slate-500 mt-5\">\r\n                        เธซเธฒเธเธขเธฑเธเนเธกเนเธกเธตเธเธฑเธเธเธต เธเธฃเธธเธ“เธฒเธ•เธดเธ”เธ•เนเธญเธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธ\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Back Link */}\r\n                <div className=\"text-center mt-6\">\r\n                    <Link href=\"/\" className=\"text-emerald-600 text-sm font-medium hover:underline\">\r\n                        โ เธเธฅเธฑเธเธซเธเนเธฒเธซเธฅเธฑเธ\r\n                    </Link>\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"text-center mt-8\">\r\n                    <p className=\"text-xs text-slate-400\"><LockKeyIcon /> เธฃเธฐเธเธเธฃเธฑเธเธฉเธฒเธเธงเธฒเธกเธเธฅเธญเธ”เธ เธฑเธขเธฃเธฐเธ”เธฑเธเธชเธนเธ</p>\r\n                    <p className=\"text-[11px] text-slate-400 mt-1\">Staff Portal v2.6.0</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\management\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\profile\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\verification\\[id]\\page.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":220,"column":41,"nodeType":"JSXOpeningElement","endLine":224,"endColumn":43},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":241,"column":45,"nodeType":"JSXOpeningElement","endLine":245,"endColumn":47}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter, useParams } from 'next/navigation';\r\n// import { useAuth } from '@/lib/services/auth-provider'; // Assume context exists or handled by layout\r\nimport { Icons } from '@/components/ui/icons';\r\nimport StaffLayout from '../../components/StaffLayout';\r\n\r\ninterface UserDetail {\r\n    id: string;\r\n    firstName: string;\r\n    lastName: string;\r\n    email: string;\r\n    accountType: string;\r\n    verificationSubmittedAt: string;\r\n    taxId?: string;\r\n    laserCode?: string;\r\n    companyName?: string;\r\n    verificationDocuments: {\r\n        idCard?: string;\r\n        companyCert?: string;\r\n        selfie?: string;\r\n    };\r\n}\r\n\r\nexport default function VerificationDetailPage() {\r\n    const params = useParams();\r\n    const router = useRouter();\r\n    const [user, setUser] = useState<UserDetail | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [processing, setProcessing] = useState(false);\r\n    const [rejectReason, setRejectReason] = useState('');\r\n    const [showRejectForm, setShowRejectForm] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (params.id) fetchUser(params.id as string);\r\n    }, [params.id]);\r\n\r\n    const fetchUser = async (id: string) => {\r\n        try {\r\n            const token = localStorage.getItem('staff_token');\r\n            const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000/api'}/identity/user/${id}`, {\r\n                headers: { 'Authorization': `Bearer ${token}` }\r\n            });\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                setUser(data.data);\r\n            }\r\n        } catch (err) {\r\n            console.error(err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleAction = async (action: 'APPROVE' | 'REJECT') => {\r\n        if (!confirm(`Are you sure you want to ${action} this user?`)) return;\r\n        setProcessing(true);\r\n\r\n        try {\r\n            const token = localStorage.getItem('staff_token');\r\n            const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000/api'}/identity/review/${user?.id}`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`,\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify({\r\n                    action,\r\n                    note: action === 'REJECT' ? rejectReason : undefined\r\n                })\r\n            });\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                alert(`User ${action}D successfully`);\r\n                router.push('/staff/verification');\r\n            } else {\r\n                alert('Error: ' + data.error);\r\n            }\r\n        } catch (err) {\r\n            console.error(err);\r\n            alert('Failed to process request');\r\n        } finally {\r\n            setProcessing(false);\r\n        }\r\n    };\r\n\r\n    if (loading) return <StaffLayout><div className=\"text-slate-400\">Loading...</div></StaffLayout>;\r\n    if (!user) return <StaffLayout><div className=\"text-red-400\">User not found</div></StaffLayout>;\r\n\r\n    const getImageUrl = (path?: string) => {\r\n        if (!path) return null;\r\n        return `${process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000'}${path}`;\r\n    };\r\n\r\n    return (\r\n        <StaffLayout title=\"Review Identity\" subtitle={`Request from ${user.firstName} ${user.lastName}`}>\r\n            <button\r\n                onClick={() => router.back()}\r\n                className=\"flex items-center text-slate-400 hover:text-slate-200 mb-6 transition-colors\"\r\n            >\r\n                <Icons.ArrowLeft className=\"w-4 h-4 mr-2\" /> Back to list\r\n            </button>\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n                {/* Left: User Info */}\r\n                <div className=\"lg:col-span-1 space-y-6\">\r\n                    <div className=\"bg-slate-800 rounded-xl border border-slate-700 p-6\">\r\n                        <h3 className=\"text-lg font-semibold text-slate-100 mb-4 flex items-center gap-2\">\r\n                            <Icons.User className=\"w-5 h-5 text-indigo-400\" />\r\n                            Applicant Info\r\n                        </h3>\r\n                        <div className=\"space-y-4 text-sm\">\r\n                            <div>\r\n                                <label className=\"text-slate-500 block mb-1\">Name</label>\r\n                                <p className=\"text-slate-200 font-medium\">{user.firstName} {user.lastName}</p>\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"text-slate-500 block mb-1\">Email</label>\r\n                                <p className=\"text-slate-200 font-medium\">{user.email}</p>\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"text-slate-500 block mb-1\">Account Type</label>\r\n                                <span className=\"inline-block px-2 py-1 rounded bg-slate-700 text-slate-300 text-xs\">\r\n                                    {user.accountType}\r\n                                </span>\r\n                            </div>\r\n                            {user.accountType !== 'INDIVIDUAL' && (\r\n                                <div>\r\n                                    <label className=\"text-slate-500 block mb-1\">Company Name</label>\r\n                                    <p className=\"text-slate-200 font-medium\">{user.companyName || '-'}</p>\r\n                                </div>\r\n                            )}\r\n                            <div>\r\n                                <label className=\"text-slate-500 block mb-1\">ID / Tax Number</label>\r\n                                <p className=\"text-slate-200 font-mono bg-slate-900 p-2 rounded border border-slate-700\">\r\n                                    {user.taxId || user.laserCode || 'N/A'}\r\n                                </p>\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"text-slate-500 block mb-1\">Submitted At</label>\r\n                                <p className=\"text-slate-400\">\r\n                                    {new Date(user.verificationSubmittedAt).toLocaleString()}\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Actions */}\r\n                    <div className=\"bg-slate-800 rounded-xl border border-slate-700 p-6\">\r\n                        <h3 className=\"text-lg font-semibold text-slate-100 mb-4\">Actions</h3>\r\n\r\n                        {!showRejectForm ? (\r\n                            <div className=\"space-y-3\">\r\n                                <button\r\n                                    onClick={() => handleAction('APPROVE')}\r\n                                    disabled={processing}\r\n                                    className=\"w-full py-3 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg font-medium flex items-center justify-center gap-2 transition-colors disabled:opacity-50\"\r\n                                >\r\n                                    <Icons.CheckCircle className=\"w-5 h-5\" />\r\n                                    Approve & Activate\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => setShowRejectForm(true)}\r\n                                    disabled={processing}\r\n                                    className=\"w-full py-3 bg-red-600/10 hover:bg-red-600/20 text-red-400 border border-red-900/50 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors disabled:opacity-50\"\r\n                                >\r\n                                    <Icons.XCircle className=\"w-5 h-5\" />\r\n                                    Reject\r\n                                </button>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"space-y-4\">\r\n                                <div>\r\n                                    <label className=\"text-sm text-slate-400 mb-2 block\">Reason for Rejection</label>\r\n                                    <textarea\r\n                                        value={rejectReason}\r\n                                        onChange={e => setRejectReason(e.target.value)}\r\n                                        placeholder=\"e.g. ID card blurred, Name mismatch...\"\r\n                                        className=\"w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-slate-200 text-sm focus:ring-red-500 focus:border-red-500\"\r\n                                        rows={3}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"flex gap-3\">\r\n                                    <button\r\n                                        onClick={() => setShowRejectForm(false)}\r\n                                        className=\"flex-1 py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600\"\r\n                                    >\r\n                                        Cancel\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => handleAction('REJECT')}\r\n                                        disabled={!rejectReason || processing}\r\n                                        className=\"flex-1 py-2 bg-red-600 text-white rounded-lg hover:bg-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                                    >\r\n                                        Confirm Reject\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Right: Documents */}\r\n                <div className=\"lg:col-span-2 space-y-6\">\r\n                    <div className=\"bg-slate-800 rounded-xl border border-slate-700 p-6\">\r\n                        <h3 className=\"text-lg font-semibold text-slate-100 mb-6 flex items-center gap-2\">\r\n                            <Icons.Document className=\"w-5 h-5 text-indigo-400\" />\r\n                            Submitted Evidence\r\n                        </h3>\r\n\r\n                        <div className=\"space-y-8\">\r\n                            {/* ID Card */}\r\n                            <div>\r\n                                <h4 className=\"text-sm font-medium text-slate-400 mb-3 uppercase tracking-wider\">\r\n                                    {user.accountType === 'INDIVIDUAL' ? 'ID Card Photo' : 'Director ID Card'}\r\n                                </h4>\r\n                                {user.verificationDocuments?.idCard ? (\r\n                                    <div className=\"rounded-lg overflow-hidden border border-slate-700 bg-slate-900\">\r\n                                        <img\r\n                                            src={getImageUrl(user.verificationDocuments.idCard)!}\r\n                                            alt=\"ID Card\"\r\n                                            className=\"w-full h-auto max-h-[500px] object-contain\"\r\n                                        />\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"p-8 text-center text-slate-500 bg-slate-900 rounded-lg border border-slate-700 border-dashed\">\r\n                                        No ID card image uploaded\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Company Cert */}\r\n                            {user.accountType !== 'INDIVIDUAL' && (\r\n                                <div>\r\n                                    <h4 className=\"text-sm font-medium text-slate-400 mb-3 uppercase tracking-wider\">\r\n                                        Company Affidavit\r\n                                    </h4>\r\n                                    {user.verificationDocuments?.companyCert ? (\r\n                                        <div className=\"rounded-lg overflow-hidden border border-slate-700 bg-slate-900\">\r\n                                            <img\r\n                                                src={getImageUrl(user.verificationDocuments.companyCert)!}\r\n                                                alt=\"Certificate\"\r\n                                                className=\"w-full h-auto max-h-[500px] object-contain\"\r\n                                            />\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"p-8 text-center text-slate-500 bg-slate-900 rounded-lg border border-slate-700 border-dashed\">\r\n                                            No certificate uploaded\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </StaffLayout>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\staff\\verification\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'staffUser' is assigned a value but never used.","line":19,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useAuth } from '@/lib/services/auth-provider';\r\nimport { Icons } from '@/components/ui/icons';\r\nimport StaffLayout from '../components/StaffLayout';\r\n\r\ninterface PendingUser {\r\n    id: string;\r\n    firstName: string;\r\n    lastName: string;\r\n    email: string;\r\n    accountType: string;\r\n    verificationSubmittedAt: string;\r\n}\r\n\r\nexport default function StaffVerificationPage() {\r\n    const { user: staffUser } = useAuth(); // Actually staff user\r\n    const router = useRouter();\r\n    const [users, setUsers] = useState<PendingUser[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        fetchPending();\r\n    }, []);\r\n\r\n    const fetchPending = async () => {\r\n        try {\r\n            const token = localStorage.getItem('staff_token');\r\n            const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000/api'}/identity/pending`, {\r\n                headers: { 'Authorization': `Bearer ${token}` }\r\n            });\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                setUsers(data.data);\r\n            }\r\n        } catch (err) {\r\n            console.error(err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <StaffLayout title=\"Identity Verification\" subtitle=\"Review pending identity documents\">\r\n            <div className=\"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden\">\r\n                <div className=\"p-6 border-b border-slate-700 flex justify-between items-center\">\r\n                    <h2 className=\"text-xl font-semibold text-slate-100 flex items-center gap-2\">\r\n                        <Icons.Clock className=\"w-5 h-5 text-amber-500\" />\r\n                        Pending Requests\r\n                        <span className=\"bg-amber-500/10 text-amber-500 text-xs px-2 py-1 rounded-full\">{users.length}</span>\r\n                    </h2>\r\n                </div>\r\n\r\n                {loading ? (\r\n                    <div className=\"p-12 text-center text-slate-500\">Loading...</div>\r\n                ) : users.length === 0 ? (\r\n                    <div className=\"p-12 text-center text-slate-500\">\r\n                        <Icons.CheckCircle className=\"w-12 h-12 mx-auto mb-4 text-emerald-500 opacity-50\" />\r\n                        <p>No pending verifications</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"divide-y divide-slate-700\">\r\n                        {users.map((u) => (\r\n                            <div\r\n                                key={u.id}\r\n                                className=\"p-4 hover:bg-slate-700/50 transition-colors cursor-pointer flex items-center justify-between group\"\r\n                                onClick={() => router.push(`/staff/verification/${u.id}`)}\r\n                            >\r\n                                <div className=\"flex items-center gap-4\">\r\n                                    <div className=\"w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center text-slate-400\">\r\n                                        <Icons.User size={20} />\r\n                                    </div>\r\n                                    <div>\r\n                                        <h3 className=\"font-medium text-slate-200\">{u.firstName} {u.lastName}</h3>\r\n                                        <p className=\"text-sm text-slate-400\">{u.email}</p>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-6\">\r\n                                    <div className=\"text-right\">\r\n                                        <span className={`text-xs px-2 py-1 rounded-full ${u.accountType === 'JURISTIC' ? 'bg-purple-500/10 text-purple-400' : 'bg-blue-500/10 text-blue-400'}`}>\r\n                                            {u.accountType}\r\n                                        </span>\r\n                                        <p className=\"text-xs text-slate-500 mt-1\">\r\n                                            {new Date(u.verificationSubmittedAt).toLocaleDateString()}\r\n                                        </p>\r\n                                    </div>\r\n                                    <Icons.ChevronRight className=\"w-5 h-5 text-slate-600 group-hover:text-slate-400\" />\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </StaffLayout>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\app\\trace\\[qrCode]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":140,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":140,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isHarvestBatch' is assigned a value but never used.","line":190,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":190,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useParams } from 'next/navigation';\r\n\r\ninterface TraceData {\r\n    type: 'PLANTING_CYCLE' | 'HARVEST_BATCH' | 'LOT';\r\n    data: {\r\n        // Farm info\r\n        farm: {\r\n            name: string;\r\n            type?: string;\r\n            location: string;\r\n            address?: string;\r\n        };\r\n        // Plot info\r\n        plot?: {\r\n            name: string;\r\n            area?: number;\r\n            unit?: string;\r\n        };\r\n        // Plant info\r\n        plant: {\r\n            code?: string;\r\n            nameTH: string;\r\n            nameEN?: string;\r\n            scientificName?: string;\r\n            variety?: string;\r\n        };\r\n        // Cultivation info\r\n        cultivation?: {\r\n            method: string;\r\n            methodCode?: string;\r\n            seedSource?: string;\r\n            soilType?: string;\r\n            irrigationType?: string;\r\n            cycleName?: string;\r\n            cycleNumber?: number;\r\n        };\r\n        // Dates\r\n        dates?: {\r\n            planted?: string;\r\n            plantedTH?: string;\r\n            expectedHarvest?: string;\r\n            expectedHarvestTH?: string;\r\n            actualHarvest?: string;\r\n            actualHarvestTH?: string;\r\n        };\r\n        // Yield\r\n        yield?: {\r\n            estimated?: number;\r\n            actual?: number;\r\n            unit?: string;\r\n        };\r\n        // Status\r\n        status?: string;\r\n        // Batch info (for HARVEST_BATCH)\r\n        batch?: {\r\n            number?: string;\r\n            batchNumber?: string;\r\n            plantingDate?: string;\r\n            plantingDateTH?: string;\r\n            harvestDate?: string;\r\n            harvestDateTH?: string;\r\n            yield?: number;\r\n            yieldUnit?: string;\r\n            qualityGrade?: string;\r\n            status?: string;\r\n        };\r\n        // Harvests (for PLANTING_CYCLE)\r\n        harvests?: Array<{\r\n            batchNumber: string;\r\n            harvestDate?: string;\r\n            harvestDateTH?: string;\r\n            yield?: number;\r\n            yieldUnit?: string;\r\n            grade?: string;\r\n            status?: string;\r\n        }>;\r\n        // Lot info\r\n        lot?: {\r\n            lotNumber: string;\r\n            packageType: string;\r\n            quantity: number;\r\n            unitWeight: number;\r\n            status: string;\r\n            packagedAt: string;\r\n            expiryDate: string;\r\n            labTest?: {\r\n                status: string;\r\n                thcContent: number;\r\n                cbdContent: number;\r\n                moistureContent: number;\r\n            };\r\n        };\r\n        // Certificate\r\n        certificate?: {\r\n            number: string;\r\n            standard?: string;\r\n            issuedDate?: string;\r\n            issuedDateTH?: string;\r\n            expiryDate?: string;\r\n            expiryDateTH?: string;\r\n            status?: string;\r\n            isValid: boolean;\r\n        };\r\n        // Verification\r\n        verification: {\r\n            valid: boolean;\r\n            certified?: boolean;\r\n            scannedAt: string;\r\n            verifiedBy?: string;\r\n        };\r\n    };\r\n}\r\n\r\nexport default function TracePage() {\r\n    const params = useParams();\r\n    const qrCode = params?.qrCode as string;\r\n\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [traceData, setTraceData] = useState<TraceData | null>(null);\r\n\r\n    useEffect(() => {\r\n        if (!qrCode) return;\r\n\r\n        async function fetchTraceData() {\r\n            try {\r\n                // Direct API call (Nginx routes /api/* to backend)\r\n                const res = await fetch(`/api/trace/${qrCode}`);\r\n                const data = await res.json();\r\n\r\n                if (!data.success) {\r\n                    setError(data.message || 'เนเธกเนเธเธเธเนเธญเธกเธนเธฅเธเธฅเธดเธ•เธ เธฑเธ“เธ‘เน');\r\n                    return;\r\n                }\r\n\r\n                setTraceData(data);\r\n            } catch (err) {\r\n                setError('เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเน€เธเธทเนเธญเธกเธ•เนเธญ');\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        }\r\n\r\n        fetchTraceData();\r\n    }, [qrCode]);\r\n\r\n    const formatDate = (dateStr: string) => {\r\n        if (!dateStr) return '-';\r\n        return new Date(dateStr).toLocaleDateString('th-TH', {\r\n            year: 'numeric',\r\n            month: 'long',\r\n            day: 'numeric'\r\n        });\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100 flex items-center justify-center\">\r\n                <div className=\"text-center\">\r\n                    <div className=\"animate-spin rounded-full h-16 w-16 border-4 border-green-500 border-t-transparent mx-auto mb-4\"></div>\r\n                    <p className=\"text-gray-600\">เธเธณเธฅเธฑเธเธ•เธฃเธงเธเธชเธญเธ...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (error || !traceData) {\r\n        return (\r\n            <div className=\"min-h-screen bg-gradient-to-br from-red-50 to-orange-100 flex items-center justify-center p-4\">\r\n                <div className=\"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full text-center\">\r\n                    <div className=\"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                        <svg className=\"w-10 h-10 text-red-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                        </svg>\r\n                    </div>\r\n                    <h1 className=\"text-2xl font-bold text-gray-800 mb-2\">เนเธกเนเธเธเธเนเธญเธกเธนเธฅ</h1>\r\n                    <p className=\"text-gray-600 mb-6\">{error || 'QR Code เธเธตเนเนเธกเนเธ–เธนเธเธ•เนเธญเธเธซเธฃเธทเธญเนเธกเนเธกเธตเนเธเธฃเธฐเธเธ'}</p>\r\n                    <p className=\"text-sm text-gray-400\">เธฃเธซเธฑเธช: {qrCode}</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const { data, type } = traceData;\r\n    const cert = data.certificate;\r\n    const isPlantingCycle = type === 'PLANTING_CYCLE';\r\n    const isHarvestBatch = type === 'HARVEST_BATCH';\r\n    const isLot = type === 'LOT';\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100 py-8 px-4\">\r\n            <div className=\"max-w-lg mx-auto\">\r\n                {/* Header */}\r\n                <div className=\"bg-white rounded-2xl shadow-xl overflow-hidden mb-6\">\r\n                    <div className=\"bg-gradient-to-r from-green-600 to-emerald-600 p-6 text-white text-center\">\r\n                        <div className=\"flex items-center justify-center mb-3\">\r\n                            <svg className=\"w-8 h-8 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                            </svg>\r\n                            <span className=\"text-lg font-semibold\">\r\n                                {cert?.isValid ? 'เธเนเธฒเธเธเธฒเธฃเธฃเธฑเธเธฃเธญเธ GACP' : 'เธเนเธญเธกเธนเธฅเธเธฒเธฃเธเธฅเธดเธ•'}\r\n                            </span>\r\n                        </div>\r\n                        <h1 className=\"text-2xl font-bold\">\r\n                            ๐ฟ GACP Traceability\r\n                        </h1>\r\n                        <p className=\"text-green-100 text-sm mt-1\">เธฃเธฐเธเธเธ•เธฃเธงเธเธชเธญเธเธขเนเธญเธเธเธฅเธฑเธเธเธฅเธดเธ•เธ เธฑเธ“เธ‘เนเธชเธกเธธเธเนเธเธฃ</p>\r\n                    </div>\r\n\r\n                    {/* Verification Badge */}\r\n                    <div className=\"p-4 bg-green-50 border-b flex items-center justify-center\">\r\n                        <div className=\"flex items-center space-x-2 text-green-700\">\r\n                            <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                                <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\r\n                            </svg>\r\n                            <span className=\"font-medium\">เธ•เธฃเธงเธเธชเธญเธเน€เธกเธทเนเธญ: {formatDate(data.verification.scannedAt)}</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* GACP Certificate Badge */}\r\n                {cert && (\r\n                    <div className={`rounded-2xl shadow-lg p-6 mb-6 ${cert.isValid ? 'bg-gradient-to-r from-green-500 to-emerald-500' : 'bg-gradient-to-r from-gray-500 to-gray-600'}`}>\r\n                        <div className=\"text-white text-center\">\r\n                            <div className=\"flex items-center justify-center mb-2\">\r\n                                <svg className=\"w-12 h-12\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <div className=\"text-xl font-bold mb-1\">\r\n                                {cert.isValid ? 'โ“ เนเธ”เนเธฃเธฑเธเธฃเธญเธ GACP' : 'โ— เนเธเธฃเธฑเธเธฃเธญเธเธซเธกเธ”เธญเธฒเธขเธธ'}\r\n                            </div>\r\n                            <div className=\"text-lg font-mono bg-white/20 rounded-lg py-2 px-4 inline-block mb-2\">\r\n                                {cert.number}\r\n                            </div>\r\n                            <div className=\"text-sm opacity-90\">\r\n                                เธญเธญเธเน€เธกเธทเนเธญ: {cert.issuedDateTH || formatDate(cert.issuedDate || '')} โ€ข เธซเธกเธ”เธญเธฒเธขเธธ: {cert.expiryDateTH || formatDate(cert.expiryDate || '')}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* No Certificate Warning */}\r\n                {!cert && (\r\n                    <div className=\"bg-yellow-50 border border-yellow-200 rounded-2xl p-4 mb-6\">\r\n                        <div className=\"flex items-center text-yellow-700\">\r\n                            <svg className=\"w-5 h-5 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                                <path fillRule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\r\n                            </svg>\r\n                            <span>เธญเธขเธนเนเธฃเธฐเธซเธงเนเธฒเธเธ”เธณเน€เธเธดเธเธเธฒเธฃเธเธญเธฃเธฑเธเธฃเธญเธ GACP</span>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Farm Info */}\r\n                <div className=\"bg-white rounded-2xl shadow-lg p-6 mb-6\">\r\n                    <h2 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center\">\r\n                        <span className=\"text-2xl mr-2\">๐ </span> เธเนเธญเธกเธนเธฅเธเธฒเธฃเนเธก\r\n                    </h2>\r\n                    <div className=\"space-y-3\">\r\n                        <div className=\"flex justify-between\">\r\n                            <span className=\"text-gray-500\">เธเธทเนเธญเธเธฒเธฃเนเธก</span>\r\n                            <span className=\"font-medium text-gray-800\">{data.farm.name}</span>\r\n                        </div>\r\n                        <div className=\"flex justify-between\">\r\n                            <span className=\"text-gray-500\">เธ—เธตเนเธ•เธฑเนเธ</span>\r\n                            <span className=\"font-medium text-gray-800\">{data.farm.location}</span>\r\n                        </div>\r\n                        {data.plot && (\r\n                            <>\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-gray-500\">เนเธเธฅเธ/เนเธฃเธเธเธฅเธนเธ</span>\r\n                                    <span className=\"font-medium text-gray-800\">{data.plot.name}</span>\r\n                                </div>\r\n                                {data.plot.area && (\r\n                                    <div className=\"flex justify-between\">\r\n                                        <span className=\"text-gray-500\">เธเธทเนเธเธ—เธตเน</span>\r\n                                        <span className=\"font-medium text-gray-800\">{data.plot.area} {data.plot.unit}</span>\r\n                                    </div>\r\n                                )}\r\n                            </>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Plant & Variety Info */}\r\n                <div className=\"bg-white rounded-2xl shadow-lg p-6 mb-6\">\r\n                    <h2 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center\">\r\n                        <span className=\"text-2xl mr-2\">๐ฑ</span> เธเนเธญเธกเธนเธฅเธเธทเธ\r\n                    </h2>\r\n                    <div className=\"space-y-3\">\r\n                        <div className=\"flex justify-between\">\r\n                            <span className=\"text-gray-500\">เธเธเธดเธ”เธเธทเธ</span>\r\n                            <span className=\"font-medium text-gray-800\">{data.plant.nameTH}</span>\r\n                        </div>\r\n                        {data.plant.nameEN && (\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-500\">เธเธทเนเธญเธ เธฒเธฉเธฒเธญเธฑเธเธเธคเธฉ</span>\r\n                                <span className=\"font-medium text-gray-800\">{data.plant.nameEN}</span>\r\n                            </div>\r\n                        )}\r\n                        {data.plant.scientificName && (\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-500\">เธเธทเนเธญเธงเธดเธ—เธขเธฒเธจเธฒเธชเธ•เธฃเน</span>\r\n                                <span className=\"font-medium text-gray-800 italic\">{data.plant.scientificName}</span>\r\n                            </div>\r\n                        )}\r\n                        {data.plant.variety && (\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-500\">เธเธฑเธเธเธธเน</span>\r\n                                <span className=\"font-medium text-emerald-600\">{data.plant.variety}</span>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Cultivation Method Info */}\r\n                {data.cultivation && (\r\n                    <div className=\"bg-white rounded-2xl shadow-lg p-6 mb-6\">\r\n                        <h2 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center\">\r\n                            <span className=\"text-2xl mr-2\">๐พ</span> เธงเธดเธเธตเธเธฒเธฃเธเธฅเธนเธ\r\n                        </h2>\r\n                        <div className=\"space-y-3\">\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-500\">เธงเธดเธเธตเธเธฒเธฃ</span>\r\n                                <span className=\"font-medium text-gray-800\">{data.cultivation.method}</span>\r\n                            </div>\r\n                            {data.cultivation.seedSource && data.cultivation.seedSource !== 'เนเธกเนเธฃเธฐเธเธธ' && (\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-gray-500\">เนเธซเธฅเนเธเน€เธกเธฅเนเธ”เธเธฑเธเธเธธเน</span>\r\n                                    <span className=\"font-medium text-gray-800\">{data.cultivation.seedSource}</span>\r\n                                </div>\r\n                            )}\r\n                            {data.cultivation.soilType && data.cultivation.soilType !== 'เนเธกเนเธฃเธฐเธเธธ' && (\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-gray-500\">เธเธฃเธฐเน€เธ เธ—เธ”เธดเธ</span>\r\n                                    <span className=\"font-medium text-gray-800\">{data.cultivation.soilType}</span>\r\n                                </div>\r\n                            )}\r\n                            {data.cultivation.irrigationType && data.cultivation.irrigationType !== 'เนเธกเนเธฃเธฐเธเธธ' && (\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-gray-500\">เธฃเธฐเธเธเธเนเธณ</span>\r\n                                    <span className=\"font-medium text-gray-800\">{data.cultivation.irrigationType}</span>\r\n                                </div>\r\n                            )}\r\n                            {data.cultivation.cycleName && (\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-gray-500\">เธฃเธญเธเธเธฒเธฃเธเธฅเธนเธ</span>\r\n                                    <span className=\"font-medium text-gray-800\">{data.cultivation.cycleName}</span>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Dates Info */}\r\n                {(data.dates || data.batch) && (\r\n                    <div className=\"bg-white rounded-2xl shadow-lg p-6 mb-6\">\r\n                        <h2 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center\">\r\n                            <span className=\"text-2xl mr-2\">๐“…</span> เธงเธฑเธเธ—เธตเนเธชเธณเธเธฑเธ\r\n                        </h2>\r\n                        <div className=\"space-y-3\">\r\n                            {/* For PLANTING_CYCLE */}\r\n                            {data.dates && (\r\n                                <>\r\n                                    <div className=\"flex justify-between\">\r\n                                        <span className=\"text-gray-500\">เธงเธฑเธเน€เธเธฒเธฐเธเธฅเธนเธ</span>\r\n                                        <span className=\"font-medium text-emerald-600\">\r\n                                            {data.dates.plantedTH || formatDate(data.dates.planted || '')}\r\n                                        </span>\r\n                                    </div>\r\n                                    {data.dates.expectedHarvest && (\r\n                                        <div className=\"flex justify-between\">\r\n                                            <span className=\"text-gray-500\">เธเธณเธซเธเธ”เน€เธเนเธเน€เธเธตเนเธขเธง</span>\r\n                                            <span className=\"font-medium text-gray-800\">\r\n                                                {data.dates.expectedHarvestTH || formatDate(data.dates.expectedHarvest)}\r\n                                            </span>\r\n                                        </div>\r\n                                    )}\r\n                                    {data.dates.actualHarvest && (\r\n                                        <div className=\"flex justify-between\">\r\n                                            <span className=\"text-gray-500\">เธงเธฑเธเน€เธเนเธเน€เธเธตเนเธขเธงเธเธฃเธดเธ</span>\r\n                                            <span className=\"font-medium text-emerald-600\">\r\n                                                {data.dates.actualHarvestTH || formatDate(data.dates.actualHarvest)}\r\n                                            </span>\r\n                                        </div>\r\n                                    )}\r\n                                </>\r\n                            )}\r\n                            {/* For HARVEST_BATCH */}\r\n                            {data.batch && (\r\n                                <>\r\n                                    <div className=\"flex justify-between\">\r\n                                        <span className=\"text-gray-500\">เธงเธฑเธเธเธฅเธนเธ</span>\r\n                                        <span className=\"font-medium text-gray-800\">\r\n                                            {data.batch.plantingDateTH || formatDate(data.batch.plantingDate || '')}\r\n                                        </span>\r\n                                    </div>\r\n                                    <div className=\"flex justify-between\">\r\n                                        <span className=\"text-gray-500\">เธงเธฑเธเน€เธเนเธเน€เธเธตเนเธขเธง</span>\r\n                                        <span className=\"font-medium text-emerald-600\">\r\n                                            {data.batch.harvestDateTH || formatDate(data.batch.harvestDate || '')}\r\n                                        </span>\r\n                                    </div>\r\n                                    {data.batch.qualityGrade && (\r\n                                        <div className=\"flex justify-between\">\r\n                                            <span className=\"text-gray-500\">เน€เธเธฃเธ”เธเธธเธ“เธ เธฒเธ</span>\r\n                                            <span className=\"font-medium text-green-600\">เน€เธเธฃเธ” {data.batch.qualityGrade}</span>\r\n                                        </div>\r\n                                    )}\r\n                                </>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Yield Info */}\r\n                {data.yield && (data.yield.estimated || data.yield.actual) && (\r\n                    <div className=\"bg-white rounded-2xl shadow-lg p-6 mb-6\">\r\n                        <h2 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center\">\r\n                            <span className=\"text-2xl mr-2\">๐“</span> เธเธฅเธเธฅเธดเธ•\r\n                        </h2>\r\n                        <div className=\"grid grid-cols-2 gap-4 text-center\">\r\n                            {data.yield.estimated && (\r\n                                <div className=\"bg-blue-50 rounded-xl p-4\">\r\n                                    <div className=\"text-2xl font-bold text-blue-600\">{data.yield.estimated}</div>\r\n                                    <div className=\"text-xs text-gray-500\">{data.yield.unit || 'เธเธ.'} (เธเธฒเธ”เธเธฒเธฃเธ“เน)</div>\r\n                                </div>\r\n                            )}\r\n                            {data.yield.actual && (\r\n                                <div className=\"bg-green-50 rounded-xl p-4\">\r\n                                    <div className=\"text-2xl font-bold text-green-600\">{data.yield.actual}</div>\r\n                                    <div className=\"text-xs text-gray-500\">{data.yield.unit || 'เธเธ.'} (เธเธฃเธดเธ)</div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Harvest History (for PLANTING_CYCLE) */}\r\n                {isPlantingCycle && data.harvests && data.harvests.length > 0 && (\r\n                    <div className=\"bg-white rounded-2xl shadow-lg p-6 mb-6\">\r\n                        <h2 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center\">\r\n                            <span className=\"text-2xl mr-2\">๐งบ</span> เธเธฃเธฐเธงเธฑเธ•เธดเธเธฒเธฃเน€เธเนเธเน€เธเธตเนเธขเธง\r\n                        </h2>\r\n                        <div className=\"space-y-3\">\r\n                            {data.harvests.map((h, i) => (\r\n                                <div key={i} className=\"bg-gray-50 rounded-xl p-4\">\r\n                                    <div className=\"flex justify-between items-center\">\r\n                                        <span className=\"font-mono text-sm\">{h.batchNumber}</span>\r\n                                        {h.grade && <span className=\"px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full\">เน€เธเธฃเธ” {h.grade}</span>}\r\n                                    </div>\r\n                                    <div className=\"text-sm text-gray-500 mt-1\">\r\n                                        {h.harvestDateTH || formatDate(h.harvestDate || '')} โ€ข {h.yield} {h.yieldUnit}\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Lot Info (for LOT type) */}\r\n                {isLot && data.lot && (\r\n                    <div className=\"bg-white rounded-2xl shadow-lg p-6 mb-6\">\r\n                        <h2 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center\">\r\n                            <span className=\"text-2xl mr-2\">๐“ฆ</span> เธเนเธญเธกเธนเธฅเธฅเนเธญเธ•\r\n                        </h2>\r\n                        <div className=\"space-y-3\">\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-500\">เธฃเธซเธฑเธชเธฅเนเธญเธ•</span>\r\n                                <span className=\"font-mono font-medium text-gray-800\">{data.lot.lotNumber}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-500\">เธเธฃเธฃเธเธธเธ เธฑเธ“เธ‘เน</span>\r\n                                <span className=\"font-medium text-gray-800\">{data.lot.packageType}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-500\">เธเนเธณเธซเธเธฑเธเธ•เนเธญเธซเธเนเธงเธข</span>\r\n                                <span className=\"font-medium text-gray-800\">{data.lot.unitWeight} เธเธ.</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-500\">เธงเธฑเธเธเธฃเธฃเธเธธ</span>\r\n                                <span className=\"font-medium text-gray-800\">{formatDate(data.lot.packagedAt)}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-500\">เธงเธฑเธเธซเธกเธ”เธญเธฒเธขเธธ</span>\r\n                                <span className=\"font-medium text-red-600\">{formatDate(data.lot.expiryDate)}</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Lab Test Results (for LOT) */}\r\n                {isLot && data.lot?.labTest && (\r\n                    <div className=\"bg-white rounded-2xl shadow-lg p-6 mb-6\">\r\n                        <h2 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center\">\r\n                            <span className=\"text-2xl mr-2\">๐งช</span> เธเธฅเธเธฒเธฃเธ•เธฃเธงเธ Lab\r\n                        </h2>\r\n                        <div className=\"grid grid-cols-3 gap-4 text-center\">\r\n                            <div className=\"bg-blue-50 rounded-xl p-3\">\r\n                                <div className=\"text-2xl font-bold text-blue-600\">{data.lot.labTest.thcContent || 0}%</div>\r\n                                <div className=\"text-xs text-gray-500\">THC</div>\r\n                            </div>\r\n                            <div className=\"bg-green-50 rounded-xl p-3\">\r\n                                <div className=\"text-2xl font-bold text-green-600\">{data.lot.labTest.cbdContent || 0}%</div>\r\n                                <div className=\"text-xs text-gray-500\">CBD</div>\r\n                            </div>\r\n                            <div className=\"bg-amber-50 rounded-xl p-3\">\r\n                                <div className=\"text-2xl font-bold text-amber-600\">{data.lot.labTest.moistureContent || 0}%</div>\r\n                                <div className=\"text-xs text-gray-500\">เธเธงเธฒเธกเธเธทเนเธ</div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"mt-4 flex items-center justify-center\">\r\n                            <span className={`px-4 py-2 rounded-full text-sm font-medium ${data.lot.labTest.status === 'PASSED'\r\n                                ? 'bg-green-100 text-green-700'\r\n                                : 'bg-yellow-100 text-yellow-700'\r\n                                }`}>\r\n                                {data.lot.labTest.status === 'PASSED' ? 'โ… เธเนเธฒเธเธเธฒเธฃเธ•เธฃเธงเธเธชเธญเธ' : 'โณ เธฃเธญเธเธฅเธ•เธฃเธงเธ'}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Footer */}\r\n                <div className=\"text-center text-gray-500 text-sm mt-8\">\r\n                    <p>เธฃเธฐเธเธเธ•เธฃเธงเธเธชเธญเธเธขเนเธญเธเธเธฅเธฑเธเธเธฅเธดเธ•เธ เธฑเธ“เธ‘เนเธชเธกเธธเธเนเธเธฃ</p>\r\n                    <p className=\"mt-1\">เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</p>\r\n                    <p className=\"mt-2 font-mono text-xs text-gray-400\">ID: {qrCode}</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\CultivationMethodSelector.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'subType' is assigned a value but never used.","line":96,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":96,"endColumn":12},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'multiSelect' is assigned a value but never used.","line":101,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":101,"endColumn":16},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\CultivationMethodSelector.tsx:112:13\n  110 |     useEffect(() => {\n  111 |         if (selectedTypes.length > 0) {\n> 112 |             setLocalSelectedTypes(selectedTypes);\n      |             ^^^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  113 |         }\n  114 |     }, [selectedTypes]);\n  115 |","line":112,"column":13,"nodeType":null,"endLine":112,"endColumn":34}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useMasterData, type GACPFees } from '@/hooks/useMasterData';\r\nimport { getCultivationIcon, CheckIcon } from './icons/PlantIcons';\r\n\r\n// Main cultivation types (3 types that affect fees)\r\nexport type MainCultivationType = 'outdoor' | 'greenhouse' | 'indoor';\r\nexport type SubCultivationType = 'vertical' | 'hydroponic' | 'none';\r\nexport type CultivationType = MainCultivationType | 'vertical' | 'hydroponic';\r\nexport type CultivationMethod = CultivationType;\r\n\r\n// Fee constants (FALLBACK - actual data comes from API)\r\nexport const GACP_FEES: GACPFees = {\r\n    documentReview: 5000,\r\n    siteInspection: 25000,\r\n    perTypeTotal: 30000,\r\n    platformFeePercent: 10,\r\n};\r\n\r\ninterface MainMethodOption {\r\n    id: MainCultivationType;\r\n    name: string;\r\n    nameEn: string;\r\n    description: string;\r\n    pros: string[];\r\n    cons: string[];\r\n}\r\n\r\n// Only 3 main cultivation types\r\nconst MAIN_CULTIVATION_METHODS: MainMethodOption[] = [\r\n    {\r\n        id: 'outdoor',\r\n        name: 'เธเธฅเธฒเธเนเธเนเธ',\r\n        nameEn: 'Outdoor',\r\n        description: 'เธเธฅเธนเธเนเธเนเธเธฅเธเธเธฅเธฒเธเนเธเนเธ เธญเธฒเธจเธฑเธขเนเธชเธเนเธ”เธ”เธเธฃเธฃเธกเธเธฒเธ•เธด',\r\n        pros: ['เธ•เนเธเธ—เธธเธเธ•เนเธณ', 'เน€เธซเธกเธฒเธฐเธเธฑเธเธเธทเนเธเธ—เธตเนเธเธงเนเธฒเธ'],\r\n        cons: ['เธเธงเธเธเธธเธกเธชเธ เธฒเธเนเธงเธ”เธฅเนเธญเธกเธขเธฒเธ'],\r\n    },\r\n    {\r\n        id: 'greenhouse',\r\n        name: 'เนเธฃเธเน€เธฃเธทเธญเธ',\r\n        nameEn: 'Greenhouse',\r\n        description: 'เธเธฅเธนเธเนเธเนเธฃเธเน€เธฃเธทเธญเธเธ—เธตเนเธกเธตเธซเธฅเธฑเธเธเธฒเนเธเธฃเนเธเนเธชเธ',\r\n        pros: ['เธเธงเธเธเธธเธกเธชเธ เธฒเธเนเธงเธ”เธฅเนเธญเธกเนเธ”เนเธเธฒเธเธชเนเธงเธ', 'เธเธฅเธนเธเนเธ”เนเธ•เธฅเธญเธ”เธเธต'],\r\n        cons: ['เธ•เนเธเธ—เธธเธเธชเธนเธเธเธงเนเธฒเธเธฅเธฒเธเนเธเนเธ'],\r\n    },\r\n    {\r\n        id: 'indoor',\r\n        name: 'เธญเธฒเธเธฒเธฃเธเธงเธเธเธธเธก',\r\n        nameEn: 'Indoor Controlled',\r\n        description: 'เธเธฅเธนเธเนเธเธญเธฒเธเธฒเธฃเธเธดเธ”เธ—เธตเนเธเธงเธเธเธธเธกเธชเธ เธฒเธเนเธงเธ”เธฅเนเธญเธกเธ—เธฑเนเธเธซเธกเธ”',\r\n        pros: ['เธเธงเธเธเธธเธกเธ—เธธเธเธเธฑเธเธเธฑเธขเนเธ”เน', 'เธเธธเธ“เธ เธฒเธเธชเธกเนเธณเน€เธชเธกเธญ'],\r\n        cons: ['เธ•เนเธเธ—เธธเธเธชเธนเธ', 'เธเนเธฒเนเธเธเนเธฒเธชเธนเธ'],\r\n    },\r\n];\r\n\r\nexport interface CultivationConfig {\r\n    mainTypes: MainCultivationType[];\r\n    subType?: SubCultivationType;\r\n}\r\n\r\ninterface CultivationMethodSelectorProps {\r\n    value?: CultivationMethod;\r\n    selectedTypes?: MainCultivationType[];\r\n    subType?: SubCultivationType;\r\n    onChange?: (method: CultivationMethod, option?: MainMethodOption) => void;\r\n    onConfigChange?: (config: CultivationConfig) => void;\r\n    error?: string;\r\n    disabled?: boolean;\r\n    multiSelect?: boolean;\r\n}\r\n\r\n// Calculate total fee based on selected cultivation types\r\nexport function calculateGACPFee(selectedTypes: MainCultivationType[]): {\r\n    documentReview: number;\r\n    siteInspection: number;\r\n    total: number;\r\n    typeCount: number;\r\n    breakdown: Array<{ type: string; fee: number }>;\r\n} {\r\n    const typeCount = selectedTypes.length;\r\n    const documentReview = GACP_FEES.documentReview * typeCount;\r\n    const siteInspection = GACP_FEES.siteInspection * typeCount;\r\n    const total = documentReview + siteInspection;\r\n    const breakdown = selectedTypes.map(type => {\r\n        const method = MAIN_CULTIVATION_METHODS.find(m => m.id === type);\r\n        return { type: method?.name || type, fee: GACP_FEES.perTypeTotal };\r\n    });\r\n    return { documentReview, siteInspection, total, typeCount, breakdown };\r\n}\r\n\r\nexport function CultivationMethodSelector({\r\n    value,\r\n    selectedTypes = [],\r\n    subType = 'none',\r\n    onChange,\r\n    onConfigChange,\r\n    error,\r\n    disabled = false,\r\n    multiSelect = false,\r\n}: CultivationMethodSelectorProps) {\r\n    const { fees } = useMasterData();\r\n    const activeFees = fees || GACP_FEES;\r\n\r\n    const [localSelectedTypes, setLocalSelectedTypes] = useState<MainCultivationType[]>(\r\n        selectedTypes.length > 0 ? selectedTypes : (value ? [value as MainCultivationType] : [])\r\n    );\r\n\r\n    useEffect(() => {\r\n        if (selectedTypes.length > 0) {\r\n            setLocalSelectedTypes(selectedTypes);\r\n        }\r\n    }, [selectedTypes]);\r\n\r\n    const handleMainTypeSelect = (typeId: MainCultivationType) => {\r\n        if (disabled) return;\r\n\r\n        // Single select mode only now\r\n        setLocalSelectedTypes([typeId]);\r\n        const method = MAIN_CULTIVATION_METHODS.find(m => m.id === typeId);\r\n        onChange?.(typeId, method);\r\n        onConfigChange?.({ mainTypes: [typeId], subType: 'none' });\r\n    };\r\n\r\n    const feeInfo = calculateGACPFee(localSelectedTypes);\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Main cultivation types (3 options) */}\r\n            <div className=\"grid grid-cols-1 desktop:grid-cols-3 gap-5\">\r\n                {MAIN_CULTIVATION_METHODS.map((method) => {\r\n                    const isSelected = localSelectedTypes.includes(method.id);\r\n                    return (\r\n                        <button\r\n                            key={method.id}\r\n                            type=\"button\"\r\n                            onClick={() => handleMainTypeSelect(method.id)}\r\n                            disabled={disabled}\r\n                            className={`\r\n                                group relative p-5 rounded-xl text-left transition-all duration-300 transform\r\n                                ${isSelected\r\n                                    ? 'bg-gradient-to-br from-dtam-100 via-dtam-200 to-dtam-300 shadow-3d-hover scale-[1.02] border-2 border-dtam'\r\n                                    : 'bg-white shadow-3d hover:shadow-3d-hover hover:scale-[1.02] hover:-translate-y-1 border border-surface-200'\r\n                                }\r\n                                ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\r\n                            `}\r\n                        >\r\n                            {/* Selection indicator */}\r\n                            {isSelected && (\r\n                                <span className=\"absolute -top-2 -right-2 w-7 h-7 bg-gradient-to-br from-dtam-light to-dtam rounded-full flex items-center justify-center shadow-green-glow\">\r\n                                    <CheckIcon className=\"text-white\" size={14} />\r\n                                </span>\r\n                            )}\r\n\r\n                            {/* Icon & Name */}\r\n                            <div className=\"flex items-center gap-3 mb-3\">\r\n                                <div className={`\r\n                                    w-11 h-11 rounded-xl flex items-center justify-center transition-all duration-300\r\n                                    ${isSelected\r\n                                        ? 'bg-gradient-to-br from-dtam-light to-dtam text-white shadow-lg'\r\n                                        : 'bg-gradient-to-br from-surface-100 to-surface-200 text-dtam group-hover:from-dtam-100 group-hover:to-dtam-200 group-hover:text-dtam-dark'\r\n                                    }\r\n                                `}>\r\n                                    {getCultivationIcon(method.id, { size: 24 })}\r\n                                </div>\r\n                                <div>\r\n                                    <div className={`font-bold ${isSelected ? 'text-dtam-dark' : 'text-content-primary group-hover:text-dtam-dark'}`}>\r\n                                        {method.name}\r\n                                    </div>\r\n                                    <div className={`text-[10px] ${isSelected ? 'text-dtam' : 'text-content-muted'}`}>{method.nameEn}</div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Description */}\r\n                            <p className={`text-xs leading-relaxed mb-3 ${isSelected ? 'text-dtam-dark' : 'text-content-secondary group-hover:text-content-primary'}`}>\r\n                                {method.description}\r\n                            </p>\r\n\r\n                            {/* Pros/Cons (shown when selected) */}\r\n                            {isSelected && (\r\n                                <div className=\"pt-3 border-t border-dtam-300 space-y-2 text-xs\">\r\n                                    <div className=\"flex items-start gap-2\">\r\n                                        <span className=\"font-bold text-dtam-light\">เธเนเธญเธ”เธต:</span>\r\n                                        <span className=\"text-dtam-dark\"> {method.pros.join(', ')}</span>\r\n                                    </div>\r\n                                    <div className=\"flex items-start gap-2\">\r\n                                        <span className=\"font-bold text-amber-500\">เธเนเธญเธเธณเธเธฑเธ”:</span>\r\n                                        <span className=\"text-dtam-dark\"> {method.cons.join(', ')}</span>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </button>\r\n                    );\r\n                })}\r\n            </div>\r\n\r\n            {/* Fee calculation preview */}\r\n            {localSelectedTypes.length > 0 && (\r\n                <div className=\"bg-gradient-to-r from-dtam-50 via-surface-50 to-dtam-100 border-2 border-dtam-200 rounded-xl p-5 shadow-card\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div>\r\n                            <p className=\"text-base font-bold text-dtam-dark\">เธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธก GACP (เธเธฃเธฐเธกเธฒเธ“เธเธฒเธฃ)</p>\r\n                            <p className=\"text-sm text-content-secondary mt-1\">\r\n                                เธเนเธฒเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ เธฟ{activeFees.documentReview.toLocaleString()} + เธเนเธฒเธ•เธฃเธงเธเธเธทเนเธเธ—เธตเน เธฟ{activeFees.siteInspection.toLocaleString()}\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                            <p className=\"text-3xl font-bold bg-gradient-to-r from-dtam-light to-dtam bg-clip-text text-transparent\">เธฟ{feeInfo.total.toLocaleString()}</p>\r\n                            <p className=\"text-xs text-dtam\">เธ•เนเธญเนเธเธเธณเธเธญ</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {error && (\r\n                <p className=\"text-xs text-red-600\">{error}</p>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport { MAIN_CULTIVATION_METHODS };\r\nexport type { MainMethodOption };\r\nexport default CultivationMethodSelector;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\FarmLayoutSelector.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":3,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FarmLayout' is defined but never used.","line":4,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GrowingStyle' is defined but never used.","line":4,"column":54,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":66}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect, useMemo } from 'react';\r\nimport { useCultivationConfig, type FarmLayout, type GrowingStyle } from '@/hooks/useCultivationConfig';\r\n\r\n/**\r\n * FarmLayoutSelector Component\r\n * \r\n * Select farm layout based on cultivation method\r\n * - Outdoor: เนเธเธฅเธเธขเธฒเธง, เนเธเธฅเธเธขเธเธฃเนเธญเธ, เนเธเธฅเธเธเธฅเนเธญเธ, เธเธฃเธฐเธ–เธฒเธ\r\n * - Greenhouse: เนเธเธฅเธเธเธทเนเธ, เนเธ•เนเธฐเธขเธเธชเธนเธ, เนเธฎเนเธ”เธฃเนเธเธเธดเธเธชเน\r\n * - Indoor: เนเธฎเนเธ”เธฃเนเธเธเธดเธเธชเน + Growing styles (SOG/ScrOG/Vertical)\r\n * \r\n * @author เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ (DTAM)\r\n */\r\n\r\n// Icon components\r\nconst LayoutIcon = ({ type, size = 20 }: { type: string; size?: number }) => {\r\n    const iconMap: Record<string, React.ReactNode> = {\r\n        rows: (\r\n            <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <line x1=\"3\" y1=\"6\" x2=\"21\" y2=\"6\" />\r\n                <line x1=\"3\" y1=\"12\" x2=\"21\" y2=\"12\" />\r\n                <line x1=\"3\" y1=\"18\" x2=\"21\" y2=\"18\" />\r\n            </svg>\r\n        ),\r\n        layer: (\r\n            <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <polygon points=\"12,2 22,8.5 12,15 2,8.5\" />\r\n                <polyline points=\"2,15.5 12,22 22,15.5\" />\r\n            </svg>\r\n        ),\r\n        grid: (\r\n            <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <rect x=\"3\" y=\"3\" width=\"7\" height=\"7\" />\r\n                <rect x=\"14\" y=\"3\" width=\"7\" height=\"7\" />\r\n                <rect x=\"3\" y=\"14\" width=\"7\" height=\"7\" />\r\n                <rect x=\"14\" y=\"14\" width=\"7\" height=\"7\" />\r\n            </svg>\r\n        ),\r\n        pot: (\r\n            <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <path d=\"M3 9h18l-2 12H5L3 9z\" />\r\n                <path d=\"M7 9V7a5 5 0 0 1 10 0v2\" />\r\n            </svg>\r\n        ),\r\n        table: (\r\n            <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <rect x=\"3\" y=\"4\" width=\"18\" height=\"8\" />\r\n                <line x1=\"6\" y1=\"12\" x2=\"6\" y2=\"20\" />\r\n                <line x1=\"18\" y1=\"12\" x2=\"18\" y2=\"20\" />\r\n            </svg>\r\n        ),\r\n        drop: (\r\n            <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <path d=\"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z\" />\r\n            </svg>\r\n        ),\r\n        plant: (\r\n            <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <path d=\"M12 22V8\" />\r\n                <path d=\"M12 8c-3 0-5.5-2.5-5.5-5.5\" />\r\n                <path d=\"M12 8c3 0 5.5-2.5 5.5-5.5\" />\r\n            </svg>\r\n        ),\r\n        'grid-3x3': (\r\n            <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <rect x=\"3\" y=\"3\" width=\"5\" height=\"5\" />\r\n                <rect x=\"9.5\" y=\"3\" width=\"5\" height=\"5\" />\r\n                <rect x=\"16\" y=\"3\" width=\"5\" height=\"5\" />\r\n                <rect x=\"3\" y=\"9.5\" width=\"5\" height=\"5\" />\r\n                <rect x=\"9.5\" y=\"9.5\" width=\"5\" height=\"5\" />\r\n                <rect x=\"16\" y=\"9.5\" width=\"5\" height=\"5\" />\r\n                <rect x=\"3\" y=\"16\" width=\"5\" height=\"5\" />\r\n                <rect x=\"9.5\" y=\"16\" width=\"5\" height=\"5\" />\r\n                <rect x=\"16\" y=\"16\" width=\"5\" height=\"5\" />\r\n            </svg>\r\n        ),\r\n        net: (\r\n            <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" />\r\n                <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\" />\r\n                <line x1=\"3\" y1=\"15\" x2=\"21\" y2=\"15\" />\r\n                <line x1=\"9\" y1=\"3\" x2=\"9\" y2=\"21\" />\r\n                <line x1=\"15\" y1=\"3\" x2=\"15\" y2=\"21\" />\r\n            </svg>\r\n        ),\r\n        layers: (\r\n            <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                <polygon points=\"12,2 22,8.5 12,15 2,8.5\" />\r\n                <polyline points=\"2,12 12,18.5 22,12\" />\r\n                <polyline points=\"2,15.5 12,22 22,15.5\" />\r\n            </svg>\r\n        ),\r\n    };\r\n    return iconMap[type] || iconMap.rows;\r\n};\r\n\r\ninterface FarmLayoutSelectorProps {\r\n    cultivationMethod: 'outdoor' | 'greenhouse' | 'indoor';\r\n    selectedLayoutId?: string;\r\n    selectedStyleId?: string;\r\n    tiers?: number;\r\n    onLayoutChange: (layoutId: string) => void;\r\n    onStyleChange?: (styleId: string) => void;\r\n    onTiersChange?: (tiers: number) => void;\r\n    disabled?: boolean;\r\n    showPlantEstimate?: boolean;\r\n    areaSqm?: number;\r\n}\r\n\r\nexport function FarmLayoutSelector({\r\n    cultivationMethod,\r\n    selectedLayoutId,\r\n    selectedStyleId,\r\n    tiers = 1,\r\n    onLayoutChange,\r\n    onStyleChange,\r\n    onTiersChange,\r\n    disabled = false,\r\n    showPlantEstimate = true,\r\n    areaSqm = 0,\r\n}: FarmLayoutSelectorProps) {\r\n    const { getLayoutsForMethod, growingStyles, estimatePlantCount, isIndoorMethod, loading } = useCultivationConfig();\r\n\r\n    // Get layouts for current method\r\n    const layouts = useMemo(() => getLayoutsForMethod(cultivationMethod), [cultivationMethod, getLayoutsForMethod]);\r\n\r\n    // Show growing styles only for indoor\r\n    const showGrowingStyles = isIndoorMethod(cultivationMethod);\r\n\r\n    // Calculate estimated plant count\r\n    const plantEstimate = useMemo(() => {\r\n        if (!selectedLayoutId || areaSqm <= 0) return null;\r\n        return estimatePlantCount(areaSqm, selectedLayoutId, selectedStyleId, tiers);\r\n    }, [selectedLayoutId, selectedStyleId, tiers, areaSqm, estimatePlantCount]);\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"p-4 text-center text-[#78909C]\">\r\n                <div className=\"animate-spin inline-block w-6 h-6 border-2 border-[#00695C] border-t-transparent rounded-full\" />\r\n                <p className=\"mt-2 text-sm\">เธเธณเธฅเธฑเธเนเธซเธฅเธ”เธเนเธญเธกเธนเธฅ...</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Farm Layout Selection */}\r\n            <div>\r\n                <label className=\"block text-sm font-semibold text-[#263238] mb-3\">\r\n                    เธฃเธนเธเนเธเธเนเธเธฅเธเธเธฅเธนเธ <span className=\"text-red-500\">*</span>\r\n                </label>\r\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n                    {layouts.map((layout) => {\r\n                        const isSelected = selectedLayoutId === layout.id;\r\n                        return (\r\n                            <button\r\n                                key={layout.id}\r\n                                type=\"button\"\r\n                                onClick={() => onLayoutChange(layout.id)}\r\n                                disabled={disabled}\r\n                                className={`\r\n                                    p-4 rounded-lg border-2 text-left transition-all\r\n                                    ${isSelected\r\n                                        ? 'border-[#00695C] bg-[#E0F2F1]'\r\n                                        : 'border-[#E0E0E0] bg-white hover:border-[#80CBC4]'\r\n                                    }\r\n                                    ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\r\n                                `}\r\n                            >\r\n                                <div className={`w-10 h-10 rounded-lg flex items-center justify-center mb-2 ${isSelected ? 'bg-[#00695C] text-white' : 'bg-[#ECEFF1] text-[#546E7A]'\r\n                                    }`}>\r\n                                    <LayoutIcon type={layout.icon} size={20} />\r\n                                </div>\r\n                                <div className={`font-medium text-sm ${isSelected ? 'text-[#00695C]' : 'text-[#263238]'}`}>\r\n                                    {layout.nameTH}\r\n                                </div>\r\n                                <div className=\"text-xs text-[#90A4AE] mt-1\">\r\n                                    {layout.nameEN}\r\n                                </div>\r\n                                {layout.plantsPerSqm > 0 && (\r\n                                    <div className=\"text-xs text-[#78909C] mt-2 flex items-center gap-1\">\r\n                                        <span className=\"inline-block w-2 h-2 bg-[#4CAF50] rounded-full\" />\r\n                                        {layout.plantsPerSqm} เธ•เนเธ/ใก\r\n                                    </div>\r\n                                )}\r\n                                {layout.manualPlantCount && (\r\n                                    <div className=\"text-xs text-[#FF9800] mt-2\">\r\n                                        เธเธฃเธญเธเธเธณเธเธงเธเน€เธญเธ\r\n                                    </div>\r\n                                )}\r\n                            </button>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Growing Styles (Indoor Only) */}\r\n            {showGrowingStyles && (\r\n                <div>\r\n                    <label className=\"block text-sm font-semibold text-[#263238] mb-3\">\r\n                        เธฃเธนเธเนเธเธเธเธฒเธฃเธเธฅเธนเธ (Indoor) <span className=\"text-red-500\">*</span>\r\n                    </label>\r\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n                        {growingStyles.map((style) => {\r\n                            const isSelected = selectedStyleId === style.id;\r\n                            return (\r\n                                <button\r\n                                    key={style.id}\r\n                                    type=\"button\"\r\n                                    onClick={() => onStyleChange?.(style.id)}\r\n                                    disabled={disabled}\r\n                                    className={`\r\n                                        p-4 rounded-lg border-2 text-left transition-all\r\n                                        ${isSelected\r\n                                            ? 'border-[#00695C] bg-[#E0F2F1]'\r\n                                            : 'border-[#E0E0E0] bg-white hover:border-[#80CBC4]'\r\n                                        }\r\n                                        ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\r\n                                    `}\r\n                                >\r\n                                    <div className={`w-10 h-10 rounded-lg flex items-center justify-center mb-2 ${isSelected ? 'bg-[#00695C] text-white' : 'bg-[#ECEFF1] text-[#546E7A]'\r\n                                        }`}>\r\n                                        <LayoutIcon type={style.icon} size={20} />\r\n                                    </div>\r\n                                    <div className={`font-medium text-sm ${isSelected ? 'text-[#00695C]' : 'text-[#263238]'}`}>\r\n                                        {style.nameTH}\r\n                                    </div>\r\n                                    <div className=\"text-xs text-[#90A4AE] mt-1\">\r\n                                        {style.nameEN}\r\n                                    </div>\r\n                                    <div className=\"text-xs text-[#78909C] mt-2 flex items-center gap-1\">\r\n                                        <span className=\"inline-block w-2 h-2 bg-[#4CAF50] rounded-full\" />\r\n                                        {style.plantsPerSqm} เธ•เนเธ/ใก\r\n                                    </div>\r\n                                    {style.supportsMultipleTiers && (\r\n                                        <div className=\"text-xs text-[#2196F3] mt-1\">\r\n                                            เธฃเธญเธเธฃเธฑเธเธซเธฅเธฒเธขเธเธฑเนเธ (เธชเธนเธเธชเธธเธ” {style.maxTiers} เธเธฑเนเธ)\r\n                                        </div>\r\n                                    )}\r\n                                </button>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Tier Selector (for Vertical style) */}\r\n            {selectedStyleId === 'vertical' && onTiersChange && (\r\n                <div>\r\n                    <label className=\"block text-sm font-semibold text-[#263238] mb-3\">\r\n                        เธเธณเธเธงเธเธเธฑเนเธ (Tiers)\r\n                    </label>\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <input\r\n                            type=\"range\"\r\n                            min={1}\r\n                            max={5}\r\n                            value={tiers}\r\n                            onChange={(e) => onTiersChange(parseInt(e.target.value))}\r\n                            disabled={disabled}\r\n                            className=\"flex-1 h-2 bg-[#E0E0E0] rounded-lg appearance-none cursor-pointer accent-[#00695C]\"\r\n                        />\r\n                        <div className=\"w-16 text-center\">\r\n                            <span className=\"text-2xl font-bold text-[#00695C]\">{tiers}</span>\r\n                            <span className=\"text-sm text-[#78909C] ml-1\">เธเธฑเนเธ</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Plant Estimate Display */}\r\n            {showPlantEstimate && plantEstimate && plantEstimate.count > 0 && (\r\n                <div className=\"bg-[#E8F5E9] border border-[#A5D6A7] rounded-lg p-4\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div>\r\n                            <div className=\"text-sm font-medium text-[#2E7D32]\">\r\n                                เธเธณเธเธงเธเธ•เนเธเนเธ”เธขเธเธฃเธฐเธกเธฒเธ“\r\n                            </div>\r\n                            <div className=\"text-xs text-[#66BB6A] mt-1\">\r\n                                {plantEstimate.formula}\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                            <div className=\"text-3xl font-bold text-[#2E7D32]\">\r\n                                {plantEstimate.count.toLocaleString()}\r\n                            </div>\r\n                            <div className=\"text-sm text-[#66BB6A]\">เธ•เนเธ</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default FarmLayoutSelector;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\FormHint.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\InlineDocumentUpload.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'id' is defined but never used.","line":31,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":7},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":180,"column":29,"nodeType":"JSXOpeningElement","endLine":184,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useRef } from 'react';\r\n\r\ninterface InlineDocumentUploadProps {\r\n    /** Unique ID for the document */\r\n    id: string;\r\n    /** Document type label (Thai) */\r\n    label: string;\r\n    /** English label */\r\n    labelEn?: string;\r\n    /** Whether the document is required */\r\n    required?: boolean;\r\n    /** Accepted file types */\r\n    accept?: string;\r\n    /** Maximum file size in MB */\r\n    maxSizeMB?: number;\r\n    /** Hint text for the document */\r\n    hint?: string;\r\n    /** Current uploaded file URL */\r\n    value?: string;\r\n    /** Callback when file is uploaded */\r\n    onChange?: (file: File | null, url: string | null) => void;\r\n    /** Error message */\r\n    error?: string;\r\n    /** Disabled state */\r\n    disabled?: boolean;\r\n}\r\n\r\nexport function InlineDocumentUpload({\r\n    id,\r\n    label,\r\n    labelEn,\r\n    required = false,\r\n    accept = '.pdf,.jpg,.jpeg,.png',\r\n    maxSizeMB = 10,\r\n    hint,\r\n    value,\r\n    onChange,\r\n    error,\r\n    disabled = false,\r\n}: InlineDocumentUploadProps) {\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [preview, setPreview] = useState<string | null>(value || null);\r\n    const [fileName, setFileName] = useState<string | null>(null);\r\n    const [uploadError, setUploadError] = useState<string | null>(null);\r\n    const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n    const handleFileSelect = (file: File | null) => {\r\n        setUploadError(null);\r\n\r\n        if (!file) {\r\n            setPreview(null);\r\n            setFileName(null);\r\n            onChange?.(null, null);\r\n            return;\r\n        }\r\n\r\n        // Validate file size\r\n        if (file.size > maxSizeMB * 1024 * 1024) {\r\n            setUploadError(`เนเธเธฅเนเธ•เนเธญเธเธกเธตเธเธเธฒเธ”เนเธกเนเน€เธเธดเธ ${maxSizeMB} MB`);\r\n            return;\r\n        }\r\n\r\n        // Validate file type\r\n        const validTypes = accept.split(',').map(t => t.trim());\r\n        const fileExt = '.' + file.name.split('.').pop()?.toLowerCase();\r\n        if (!validTypes.includes(fileExt)) {\r\n            setUploadError(`เธฃเธญเธเธฃเธฑเธเน€เธเธเธฒเธฐเนเธเธฅเน ${accept}`);\r\n            return;\r\n        }\r\n\r\n        setFileName(file.name);\r\n\r\n        // Create preview for images\r\n        if (file.type.startsWith('image/')) {\r\n            const reader = new FileReader();\r\n            reader.onload = (e) => {\r\n                const url = e.target?.result as string;\r\n                setPreview(url);\r\n                onChange?.(file, url);\r\n            };\r\n            reader.readAsDataURL(file);\r\n        } else {\r\n            // For PDFs, just show the file name\r\n            setPreview(null);\r\n            onChange?.(file, file.name);\r\n        }\r\n    };\r\n\r\n    const handleDrop = (e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        setIsDragging(false);\r\n        if (disabled) return;\r\n\r\n        const file = e.dataTransfer.files[0];\r\n        handleFileSelect(file);\r\n    };\r\n\r\n    const handleDragOver = (e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        if (!disabled) setIsDragging(true);\r\n    };\r\n\r\n    const handleDragLeave = () => {\r\n        setIsDragging(false);\r\n    };\r\n\r\n    const handleClick = () => {\r\n        if (!disabled) fileInputRef.current?.click();\r\n    };\r\n\r\n    const handleRemove = (e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n        setPreview(null);\r\n        setFileName(null);\r\n        onChange?.(null, null);\r\n        if (fileInputRef.current) {\r\n            fileInputRef.current.value = '';\r\n        }\r\n    };\r\n\r\n    const displayError = uploadError || error;\r\n    const hasFile = !!preview || !!fileName;\r\n\r\n    return (\r\n        <div className=\"space-y-2\">\r\n            {/* Label */}\r\n            <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-1.5\">\r\n                    <span className=\"text-sm font-bold text-dtam-dark\">\r\n                        {label}\r\n                        {labelEn && <span className=\"text-content-tertiary font-normal ml-1\">({labelEn})</span>}\r\n                        {required && <span className=\"text-red-500 ml-0.5\">*</span>}\r\n                    </span>\r\n                </div>\r\n                {hasFile && (\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={handleRemove}\r\n                        className=\"text-xs font-medium text-red-500 hover:text-red-600 transition-colors\"\r\n                    >\r\n                        เธฅเธเนเธเธฅเน\r\n                    </button>\r\n                )}\r\n            </div>\r\n\r\n            {/* Hint */}\r\n            {hint && (\r\n                <p className=\"text-xs text-content-secondary\">{hint}</p>\r\n            )}\r\n\r\n            {/* Upload Area */}\r\n            <div\r\n                onClick={handleClick}\r\n                onDrop={handleDrop}\r\n                onDragOver={handleDragOver}\r\n                onDragLeave={handleDragLeave}\r\n                className={`\r\n                    group relative border-2 border-dashed rounded-xl p-5 transition-all cursor-pointer overflow-hidden\r\n                    ${isDragging ? 'border-dtam bg-dtam-50' : 'border-surface-300 hover:border-dtam hover:bg-surface-50'}\r\n                    ${hasFile ? 'bg-surface-50 border-dtam' : 'bg-white'}\r\n                    ${disabled ? 'opacity-50 cursor-not-allowed' : ''}\r\n                    ${displayError ? 'border-red-300 bg-red-50' : ''}\r\n                `}\r\n            >\r\n                <input\r\n                    ref={fileInputRef}\r\n                    type=\"file\"\r\n                    accept={accept}\r\n                    onChange={(e) => handleFileSelect(e.target.files?.[0] || null)}\r\n                    className=\"hidden\"\r\n                    disabled={disabled}\r\n                />\r\n\r\n                {hasFile ? (\r\n                    <div className=\"flex items-center gap-4\">\r\n                        {/* Preview or Icon */}\r\n                        {preview && preview.startsWith('data:image') ? (\r\n                            <img\r\n                                src={preview}\r\n                                alt=\"Preview\"\r\n                                className=\"w-14 h-14 object-cover rounded-lg border border-surface-200 shadow-sm\"\r\n                            />\r\n                        ) : (\r\n                            <div className=\"w-14 h-14 bg-dtam-50 text-dtam rounded-lg flex items-center justify-center border border-dtam-100 shadow-sm\">\r\n                                <svg className=\"w-7 h-7\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\r\n                                </svg>\r\n                            </div>\r\n                        )}\r\n                        <div className=\"flex-1 min-w-0\">\r\n                            <p className=\"text-sm font-bold text-dtam-dark truncate\">\r\n                                {fileName}\r\n                            </p>\r\n                            <p className=\"text-xs text-dtam flex items-center gap-1 font-medium mt-0.5\">\r\n                                <svg className=\"w-3.5 h-3.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                                    <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n                                </svg>\r\n                                เธญเธฑเธเนเธซเธฅเธ”เธชเธณเน€เธฃเนเธ\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"text-center py-2\">\r\n                        <div className=\"w-12 h-12 bg-surface-100 text-content-tertiary rounded-full flex items-center justify-center mx-auto mb-3 group-hover:scale-110 group-hover:bg-dtam-50 group-hover:text-dtam transition-all duration-300\">\r\n                            <svg className=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\r\n                            </svg>\r\n                        </div>\r\n                        <p className=\"text-sm font-medium text-content-primary group-hover:text-dtam-dark transition-colors\">\r\n                            เธเธฅเธดเธเธซเธฃเธทเธญเธฅเธฒเธเนเธเธฅเนเธกเธฒเธงเธฒเธ\r\n                        </p>\r\n                        <p className=\"text-xs text-content-tertiary mt-1\">\r\n                            {accept.replace(/\\./g, '').toUpperCase()} (เธชเธนเธเธชเธธเธ” {maxSizeMB} MB)\r\n                        </p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Error */}\r\n            {displayError && (\r\n                <p className=\"text-xs text-red-500 flex items-center gap-1 font-medium animate-shake\">\r\n                    <svg className=\"w-3.5 h-3.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                        <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\r\n                    </svg>\r\n                    {displayError}\r\n                </p>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default InlineDocumentUpload;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\InteractiveMap.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":3,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":29},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[272,275],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[272,275],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { MapContainer, TileLayer, Marker, useMapEvents } from 'react-leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport L from 'leaflet';\r\n\r\n// Fix Leaflet Default Icon\r\ndelete (L.Icon.Default.prototype as any)._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n    iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\r\n    iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\r\n    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\r\n});\r\n\r\nfunction LocationMarker({ position, onLocationSelect }: { position: [number, number] | null, onLocationSelect: (lat: number, lng: number) => void }) {\r\n    const map = useMapEvents({\r\n        click(e) {\r\n            onLocationSelect(e.latlng.lat, e.latlng.lng);\r\n            map.flyTo(e.latlng, map.getZoom());\r\n        },\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (position) {\r\n            map.flyTo(position, map.getZoom());\r\n        }\r\n    }, [position, map]);\r\n\r\n    return position === null ? null : (\r\n        <Marker position={position}></Marker>\r\n    );\r\n}\r\n\r\ninterface InteractiveMapProps {\r\n    initialLat?: number;\r\n    initialLng?: number;\r\n    onLocationSelect: (lat: number, lng: number) => void;\r\n}\r\n\r\nexport default function InteractiveMap({ initialLat, initialLng, onLocationSelect }: InteractiveMapProps) {\r\n    const defaultPosition: [number, number] = [13.7563, 100.5018]; // Bangkok\r\n    const position: [number, number] | null = initialLat && initialLng ? [initialLat, initialLng] : null;\r\n\r\n    return (\r\n        <MapContainer center={position || defaultPosition} zoom={13} scrollWheelZoom={true} style={{ height: '100%', width: '100%' }}>\r\n            <TileLayer\r\n                attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n            />\r\n            <LocationMarker position={position} onLocationSelect={onLocationSelect} />\r\n        </MapContainer>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\PlantQRCalculator.tsx","messages":[{"ruleId":"react-hooks/refs","severity":2,"message":"Error: Cannot access refs during render\n\nReact refs are values that are not needed for rendering. Refs should only be accessed outside of render, such as in event handlers or effects. Accessing a ref value (the `current` property) during render can cause your component not to update as expected (https://react.dev/reference/react/useRef).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\PlantQRCalculator.tsx:75:5\n  73 |     const prevValuesRef = useRef({ qrCount: -1, estimatedCost: -1 });\n  74 |     const onChangeRef = useRef(onChange);\n> 75 |     onChangeRef.current = onChange;\n     |     ^^^^^^^^^^^^^^^^^^^ Cannot update ref during render\n  76 |\n  77 |     useEffect(() => {\n  78 |         const prev = prevValuesRef.current;","line":75,"column":5,"nodeType":null,"endLine":75,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useRef, useEffect } from 'react';\r\n\r\nexport interface PlantQRData {\r\n    /** Unique plant ID */\r\n    plantId: string;\r\n    /** GACP Certificate number */\r\n    certificateNo?: string;\r\n    /** Farm information */\r\n    farm: {\r\n        id: string;\r\n        name: string;\r\n        address: string;\r\n        gpsLat?: number;\r\n        gpsLng?: number;\r\n    };\r\n    /** Cultivation details */\r\n    cultivation: {\r\n        method: 'outdoor' | 'greenhouse' | 'indoor' | 'vertical' | 'hydroponic';\r\n        strain: string;\r\n        strainNameTh: string;\r\n    };\r\n    /** Important dates */\r\n    dates: {\r\n        planted: string; // ISO date\r\n        estimatedHarvest?: string; // ISO date\r\n        actualHarvest?: string; // ISO date\r\n    };\r\n    /** QR metadata */\r\n    qr: {\r\n        generatedAt: string;\r\n        validUntil?: string;\r\n        printedCount: number;\r\n    };\r\n}\r\n\r\ninterface PlantQRCalculatorProps {\r\n    /** Number of plants */\r\n    plantCount: number;\r\n    /** Estimated planting date */\r\n    plantingDate?: string;\r\n    /** Show preview of QR data structure */\r\n    showPreview?: boolean;\r\n    /** Callback when QR count changes */\r\n    onChange?: (count: number, estimatedCost: number) => void;\r\n}\r\n\r\n// Pricing tiers for QR codes\r\nconst QR_PRICING = [\r\n    { min: 1, max: 100, pricePerQR: 5 },\r\n    { min: 101, max: 500, pricePerQR: 4 },\r\n    { min: 501, max: 1000, pricePerQR: 3 },\r\n    { min: 1001, max: Infinity, pricePerQR: 2 },\r\n];\r\n\r\nfunction calculateQRCost(count: number): number {\r\n    const tier = QR_PRICING.find(t => count >= t.min && count <= t.max);\r\n    return count * (tier?.pricePerQR || 5);\r\n}\r\n\r\nexport function PlantQRCalculator({\r\n    plantCount,\r\n    plantingDate,\r\n    showPreview = true,\r\n    onChange,\r\n}: PlantQRCalculatorProps) {\r\n    const qrCount = plantCount;\r\n    const estimatedCost = calculateQRCost(qrCount);\r\n    const tier = QR_PRICING.find(t => qrCount >= t.min && qrCount <= t.max);\r\n\r\n    // Track previous values to prevent infinite loops\r\n    const prevValuesRef = useRef({ qrCount: -1, estimatedCost: -1 });\r\n    const onChangeRef = useRef(onChange);\r\n    onChangeRef.current = onChange;\r\n\r\n    useEffect(() => {\r\n        const prev = prevValuesRef.current;\r\n        // Only call onChange if values actually changed\r\n        if (prev.qrCount !== qrCount || prev.estimatedCost !== estimatedCost) {\r\n            prevValuesRef.current = { qrCount, estimatedCost };\r\n            onChangeRef.current?.(qrCount, estimatedCost);\r\n        }\r\n    }, [qrCount, estimatedCost]);\r\n\r\n    // Format date for display\r\n    const formatDate = (dateStr?: string) => {\r\n        if (!dateStr) return '-';\r\n        try {\r\n            return new Date(dateStr).toLocaleDateString('th-TH', {\r\n                year: 'numeric',\r\n                month: 'long',\r\n                day: 'numeric',\r\n            });\r\n        } catch {\r\n            return dateStr;\r\n        }\r\n    };\r\n\r\n    // Estimate harvest date (typically 3-4 months for cannabis)\r\n    const estimatedHarvestDate = plantingDate\r\n        ? new Date(new Date(plantingDate).getTime() + 90 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]\r\n        : undefined;\r\n\r\n    return (\r\n        <div className=\"space-y-4\">\r\n            {/* QR Summary Card */}\r\n            <div className=\"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-5 border border-emerald-200\">\r\n                <div className=\"flex items-start justify-between mb-4\">\r\n                    <div>\r\n                        <h3 className=\"font-semibold text-slate-800\">\r\n                            ๐ท๏ธ QR Code เธชเธณเธซเธฃเธฑเธเธเธฒเธฃ Trace\r\n                        </h3>\r\n                        <p className=\"text-sm text-slate-600\">\r\n                            1 เธ•เนเธ = 1 QR Code (เธ•เธดเธ”เธ•เธฒเธกเธเธฒเธเธเธฅเธนเธเธ–เธถเธเน€เธเนเธเน€เธเธตเนเธขเธง)\r\n                        </p>\r\n                    </div>\r\n                    <div className=\"text-right\">\r\n                        <div className=\"text-3xl font-bold text-emerald-600\">\r\n                            {qrCount.toLocaleString()}\r\n                        </div>\r\n                        <div className=\"text-xs text-slate-500\">QR Codes</div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Pricing */}\r\n                <div className=\"bg-white/70 rounded-lg p-3 mb-3\">\r\n                    <div className=\"flex justify-between items-center\">\r\n                        <span className=\"text-sm text-slate-600\">\r\n                            เธฃเธฒเธเธฒเธ•เนเธญ QR ({tier?.pricePerQR || 5} เธเธฒเธ—/QR)\r\n                        </span>\r\n                        <span className=\"font-semibold text-slate-800\">\r\n                            เธฟ{estimatedCost.toLocaleString()}\r\n                        </span>\r\n                    </div>\r\n                    <p className=\"text-xs text-slate-400 mt-1\">\r\n                        *เธฃเธฒเธเธฒเธเธฐเธเธณเธเธงเธ“เธฃเธงเธกเนเธเนเธเน€เธชเธเธญเธฃเธฒเธเธฒ\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Pricing Tiers Info */}\r\n                <details className=\"text-xs\">\r\n                    <summary className=\"text-emerald-600 cursor-pointer hover:underline\">\r\n                        เธ”เธนเธญเธฑเธ•เธฃเธฒเธชเนเธงเธเธฅเธ”เธ•เธฒเธกเธเธณเธเธงเธ\r\n                    </summary>\r\n                    <div className=\"mt-2 grid grid-cols-4 gap-2\">\r\n                        {QR_PRICING.map((tier, i) => (\r\n                            <div key={i} className=\"bg-white rounded p-2 text-center\">\r\n                                <div className=\"text-slate-800 font-medium\">\r\n                                    {tier.pricePerQR} เธเธฒเธ—\r\n                                </div>\r\n                                <div className=\"text-slate-400\">\r\n                                    {tier.min}-{tier.max === Infinity ? 'โ' : tier.max} เธ•เนเธ\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </details>\r\n            </div>\r\n\r\n            {/* QR Data Preview */}\r\n            {showPreview && (\r\n                <div className=\"bg-slate-50 rounded-xl p-4 border border-slate-200\">\r\n                    <h4 className=\"font-medium text-slate-700 mb-3 flex items-center gap-2\">\r\n                        <svg className=\"w-4 h-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z\" />\r\n                        </svg>\r\n                        เธเนเธญเธกเธนเธฅเนเธ QR Code\r\n                    </h4>\r\n                    <p className=\"text-xs text-slate-500 mb-3\">\r\n                        เธเนเธญเธกเธนเธฅเธ•เนเธญเนเธเธเธตเนเธเธฐเธ–เธนเธเน€เธเนเธฒเธฃเธซเธฑเธชเนเธ QR Code เนเธ•เนเธฅเธฐเนเธ\r\n                    </p>\r\n                    <div className=\"grid grid-cols-2 gap-2 text-sm\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className=\"text-slate-400\">๐”</span>\r\n                            <span className=\"text-slate-600\">เธฃเธซเธฑเธชเธ•เนเธ (Plant ID)</span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className=\"text-slate-400\">๐ </span>\r\n                            <span className=\"text-slate-600\">เธเนเธญเธกเธนเธฅเธเธฒเธฃเนเธก</span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className=\"text-slate-400\">๐“</span>\r\n                            <span className=\"text-slate-600\">เธเธดเธเธฑเธ” GPS</span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className=\"text-slate-400\">๐ฑ</span>\r\n                            <span className=\"text-slate-600\">เธชเธฒเธขเธเธฑเธเธเธธเน</span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className=\"text-slate-400\">๐พ</span>\r\n                            <span className=\"text-slate-600\">เธงเธดเธเธตเธเธฒเธฃเธเธฅเธนเธ</span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <span className=\"text-slate-400\">๐“…</span>\r\n                            <span className=\"text-slate-600\">เธงเธฑเธเธเธฅเธนเธ / เธงเธฑเธเน€เธเนเธเน€เธเธตเนเธขเธง</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Timeline Preview */}\r\n                    {plantingDate && (\r\n                        <div className=\"mt-4 pt-3 border-t border-slate-200\">\r\n                            <div className=\"flex items-center gap-4\">\r\n                                <div className=\"flex-1\">\r\n                                    <div className=\"text-xs text-slate-400\">เธงเธฑเธเธเธฅเธนเธ</div>\r\n                                    <div className=\"text-sm font-medium text-slate-700\">\r\n                                        {formatDate(plantingDate)}\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex-shrink-0\">\r\n                                    <svg className=\"w-6 h-6 text-emerald-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 8l4 4m0 0l-4 4m4-4H3\" />\r\n                                    </svg>\r\n                                </div>\r\n                                <div className=\"flex-1 text-right\">\r\n                                    <div className=\"text-xs text-slate-400\">เธเธฒเธ”เธเธฒเธฃเธ“เนเน€เธเนเธเน€เธเธตเนเธขเธง</div>\r\n                                    <div className=\"text-sm font-medium text-slate-700\">\r\n                                        ~{formatDate(estimatedHarvestDate)}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport { QR_PRICING, calculateQRCost };\r\nexport default PlantQRCalculator;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\PlantUnitList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'applicationId' is defined but never used.","line":27,"column":49,"nodeType":null,"messageId":"unusedVar","endLine":27,"endColumn":62},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadCycle'. Either include it or remove the dependency array.","line":34,"column":8,"nodeType":"ArrayExpression","endLine":34,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [farmId, loadCycle]","fix":{"range":[862,870],"text":"[farmId, loadCycle]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2468,2471],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2468,2471],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":72,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { apiClient as api } from \"@/lib/api/api-client\";\r\nimport { Icons } from \"@/components/ui/icons\";\r\n\r\ninterface PlantUnit {\r\n    id: string;\r\n    code: string;\r\n    status: string;\r\n}\r\n\r\ninterface PlantingCycle {\r\n    id: string;\r\n    cycleName: string;\r\n    status: string;\r\n    plantUnits: PlantUnit[];\r\n    estimatedPlantCount: number;\r\n}\r\n\r\ninterface PlantUnitListProps {\r\n    farmId: string;\r\n    applicationId?: string;\r\n    canEdit?: boolean;\r\n}\r\n\r\nexport default function PlantUnitList({ farmId, applicationId, canEdit = false }: PlantUnitListProps) {\r\n    const [cycle, setCycle] = useState<PlantingCycle | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [generating, setGenerating] = useState(false);\r\n\r\n    useEffect(() => {\r\n        loadCycle();\r\n    }, [farmId]);\r\n\r\n    const loadCycle = async () => {\r\n        try {\r\n            setLoading(true);\r\n            // Fetch cycles for this farm\r\n            const result = await api.get<PlantingCycle[]>(`/planting-cycles?farmId=${farmId}`);\r\n            if (result.success && result.data && result.data.length > 0) {\r\n                // Determine relevant cycle. For now, take the latest one.\r\n                // In future, we might match by ID if linked.\r\n                const latest = result.data[0];\r\n\r\n                // Fetch full details including units (the list endpoint might not return relations)\r\n                const detailResult = await api.get<{ data: PlantingCycle }>(`/planting-cycles/${latest.id}`);\r\n                if (detailResult.success && detailResult.data.data) {\r\n                    setCycle(detailResult.data.data);\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to load planting cycle:\", error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleGenerate = async () => {\r\n        if (!cycle) return;\r\n        if (!confirm(`เธขเธทเธเธขเธฑเธเธเธฒเธฃเธชเธฃเนเธฒเธเธฃเธซเธฑเธชเธ•เธดเธ”เธ•เธฒเธกเธเธณเธเธงเธ ${cycle.estimatedPlantCount} เธ•เนเธ?\\nเธเธฒเธฃเธเธฃเธฐเธ—เธณเธเธตเนเนเธกเนเธชเธฒเธกเธฒเธฃเธ–เธขเธเน€เธฅเธดเธเนเธ”เน`)) return;\r\n\r\n        try {\r\n            setGenerating(true);\r\n            const result = await api.post(`/planting-cycles/${cycle.id}/generate-units`, {});\r\n            if (result.success) {\r\n                alert(\"เธชเธฃเนเธฒเธเธฃเธซเธฑเธชเธ•เธดเธ”เธ•เธฒเธกเธชเธณเน€เธฃเนเธ\");\r\n                loadCycle(); // Reload to show units\r\n            } else {\r\n                alert(\"เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”: \" + ((result as any).message || \"Unknown error\"));\r\n            }\r\n        } catch (error) {\r\n            alert(\"Connection error\");\r\n        } finally {\r\n            setGenerating(false);\r\n        }\r\n    };\r\n\r\n    if (loading) return <div className=\"text-center p-5 text-gray-500 text-sm\">Loading tracking data...</div>;\r\n\r\n    if (!cycle) return null; // No active cycle found\r\n\r\n    const units = cycle.plantUnits || [];\r\n    const hasUnits = units.length > 0;\r\n\r\n    return (\r\n        <div className=\"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden\">\r\n            <div className=\"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-8 h-8 rounded-lg bg-emerald-100 text-emerald-600 flex items-center justify-center\">\r\n                        <Icons.Tree className=\"w-4 h-4\" />\r\n                    </div>\r\n                    <div>\r\n                        <h3 className=\"font-semibold text-gray-800 text-sm\">เธเธฒเธฃเธ•เธดเธ”เธ•เธฒเธกเธฃเธฒเธขเธ•เนเธ (Tree-by-Tree)</h3>\r\n                        <p className=\"text-xs text-gray-500\">เธฃเธญเธเธเธฅเธนเธ: {cycle.cycleName}</p>\r\n                    </div>\r\n                </div>\r\n                {hasUnits && (\r\n                    <span className=\"text-xs font-medium px-2.5 py-1 bg-emerald-100 text-emerald-700 rounded-md\">\r\n                        {units.length} เธ•เนเธ\r\n                    </span>\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"p-4\">\r\n                {!hasUnits ? (\r\n                    <div className=\"text-center py-6\">\r\n                        <div className=\"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 text-gray-400\">\r\n                            <Icons.QrCode className=\"w-6 h-6\" />\r\n                        </div>\r\n                        <p className=\"text-gray-500 text-sm mb-4\">เธขเธฑเธเนเธกเนเนเธ”เนเธชเธฃเนเธฒเธเธฃเธซเธฑเธชเธ•เธดเธ”เธ•เธฒเธกเธชเธณเธซเธฃเธฑเธเธฃเธญเธเธเธฅเธนเธเธเธตเน</p>\r\n                        {canEdit && (\r\n                            <button\r\n                                onClick={handleGenerate}\r\n                                disabled={generating}\r\n                                className=\"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white text-sm font-medium rounded-lg transition-colors shadow-sm disabled:opacity-70 disabled:cursor-not-allowed flex items-center gap-2 mx-auto\"\r\n                            >\r\n                                {generating ? <Icons.Loader className=\"w-4 h-4 animate-spin\" /> : <Icons.Plus className=\"w-4 h-4\" />}\r\n                                เธชเธฃเนเธฒเธเธฃเธซเธฑเธชเธ•เธดเธ”เธ•เธฒเธก ({cycle.estimatedPlantCount} เธ•เนเธ)\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 max-h-60 overflow-y-auto pr-1\">\r\n                        {units.map((unit) => (\r\n                            <div key={unit.id} className=\"p-2 border border-gray-200 rounded-lg flex items-center justify-between hover:border-emerald-400 transition-colors group bg-white\">\r\n                                <div className=\"min-w-0\">\r\n                                    <div className=\"text-xs font-bold text-gray-700 truncate\" title={unit.code}>\r\n                                        {unit.code}\r\n                                    </div>\r\n                                    <div className=\"text-[10px] text-gray-500\">เธชเธ–เธฒเธเธฐ: {unit.status}</div>\r\n                                </div>\r\n                                <button className=\"text-gray-400 hover:text-emerald-600 p-1\" title=\"เธ”เธน QR Code\">\r\n                                    <Icons.QrCode className=\"w-4 h-4\" />\r\n                                </button>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {hasUnits && (\r\n                <div className=\"p-3 bg-gray-50 border-t border-gray-100 text-center\">\r\n                    <button className=\"text-xs font-semibold text-emerald-600 hover:text-emerald-700 flex items-center justify-center gap-1 w-full\">\r\n                        <Icons.Printer className=\"w-3.5 h-3.5\" />\r\n                        เธเธดเธกเธเน QR Code เธ—เธฑเนเธเธซเธกเธ”\r\n                    </button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\PurposeSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\StrainSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\icons\\PlantIcons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\icons\\WizardIcons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\system-guard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'failedChecks' is assigned a value but never used.","line":23,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":24},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\system-guard.tsx:46:9\n  44 |     useEffect(() => {\n  45 |         // Initial check\n> 46 |         checkServer();\n     |         ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  47 |\n  48 |         // Periodic health check every 30 seconds\n  49 |         const interval = setInterval(checkServer, 30000);","line":46,"column":9,"nodeType":null,"endLine":46,"endColumn":20}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState, ReactNode, useCallback } from \"react\";\r\nimport { apiClient as api } from \"@/lib/api\";\r\nimport { colors } from \"@/lib/design-tokens\";\r\n\r\ninterface SystemGuardProps {\r\n    children: ReactNode;\r\n}\r\n\r\n\r\n/**\r\n * SystemGuard Component\r\n * Wraps the entire application and monitors backend connectivity\r\n * Shows a friendly \"Server Down\" screen when backend is unavailable\r\n */\r\nexport default function SystemGuard({ children }: SystemGuardProps) {\r\n    // Start assuming online so pages load immediately (better UX)\r\n    // Only block if confirmed offline after multiple failed checks\r\n    const [isChecking, setIsChecking] = useState(false); // Don't show checking state initially\r\n    const [isOnline, setIsOnline] = useState(true); // Assume online initially\r\n    const [retryCount, setRetryCount] = useState(0);\r\n    const [failedChecks, setFailedChecks] = useState(0); // Track consecutive failures\r\n\r\n    const checkServer = useCallback(async () => {\r\n        setIsChecking(true);\r\n        const online = await api.health();\r\n        setIsOnline(online);\r\n        setIsChecking(false);\r\n\r\n        if (online) {\r\n            setRetryCount(0);\r\n            setFailedChecks(0);\r\n        } else {\r\n            // Only mark as offline after 2+ consecutive failures\r\n            setFailedChecks(prev => {\r\n                const newCount = prev + 1;\r\n                if (newCount >= 2) setIsOnline(false);\r\n                return newCount;\r\n            });\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        // Initial check\r\n        checkServer();\r\n\r\n        // Periodic health check every 30 seconds\r\n        const interval = setInterval(checkServer, 30000);\r\n\r\n        return () => {\r\n            clearInterval(interval);\r\n        };\r\n    }, [checkServer]);\r\n\r\n    const handleRetry = async () => {\r\n        setRetryCount(prev => prev + 1);\r\n        await checkServer();\r\n    };\r\n\r\n    // CHANGED: Never block page rendering - always show content\r\n    // Health check only for background monitoring, not blocking\r\n    // This allows login/register pages to always be visible\r\n    if (false && !isOnline && !isChecking) {  // Disabled blocking - always show children\r\n        return (\r\n            <div style={{\r\n                minHeight: \"100vh\",\r\n                backgroundColor: colors.background,\r\n                display: \"flex\",\r\n                alignItems: \"center\",\r\n                justifyContent: \"center\",\r\n                padding: \"24px\",\r\n                fontFamily: \"'Sarabun', sans-serif\",\r\n            }}>\r\n                <div style={{\r\n                    backgroundColor: colors.card,\r\n                    borderRadius: \"24px\",\r\n                    padding: \"48px\",\r\n                    maxWidth: \"480px\",\r\n                    width: \"100%\",\r\n                    textAlign: \"center\",\r\n                    boxShadow: \"0 4px 24px rgba(0,0,0,0.08)\",\r\n                }}>\r\n                    {/* Error Icon */}\r\n                    <div style={{\r\n                        width: \"80px\",\r\n                        height: \"80px\",\r\n                        margin: \"0 auto 24px\",\r\n                        backgroundColor: \"#FEE2E2\",\r\n                        borderRadius: \"50%\",\r\n                        display: \"flex\",\r\n                        alignItems: \"center\",\r\n                        justifyContent: \"center\",\r\n                    }}>\r\n                        <svg width=\"40\" height=\"40\" viewBox=\"0 0 24 24\" fill=\"none\" stroke={colors.danger} strokeWidth=\"2\">\r\n                            <circle cx=\"12\" cy=\"12\" r=\"10\" />\r\n                            <path d=\"M12 8V12M12 16H12.01\" strokeLinecap=\"round\" />\r\n                        </svg>\r\n                    </div>\r\n\r\n                    {/* Title */}\r\n                    <h1 style={{\r\n                        fontSize: \"24px\",\r\n                        fontWeight: 700,\r\n                        color: colors.textDark,\r\n                        marginBottom: \"16px\",\r\n                    }}>\r\n                        เน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเนเธกเนเธเธฃเนเธญเธกเนเธซเนเธเธฃเธดเธเธฒเธฃ\r\n                    </h1>\r\n\r\n                    {/* Description */}\r\n                    <p style={{\r\n                        fontSize: \"16px\",\r\n                        color: colors.textGray,\r\n                        marginBottom: \"32px\",\r\n                        lineHeight: 1.6,\r\n                    }}>\r\n                        เธฃเธฐเธเธเธเธณเธฅเธฑเธเธเธฃเธฑเธเธเธฃเธธเธเธซเธฃเธทเธญเน€เธเธดเธ”เธเธฑเธเธซเธฒเธเธฑเนเธงเธเธฃเธฒเธง\r\n                        <br />\r\n                        เธเธฃเธธเธ“เธฒเธฅเธญเธเนเธซเธกเนเธญเธตเธเธเธฃเธฑเนเธเนเธเธญเธตเธเธชเธฑเธเธเธฃเธนเน\r\n                    </p>\r\n\r\n                    {/* Retry Button */}\r\n                    <button\r\n                        onClick={handleRetry}\r\n                        disabled={isChecking}\r\n                        style={{\r\n                            width: \"100%\",\r\n                            padding: \"16px 24px\",\r\n                            backgroundColor: isChecking ? colors.textGray : colors.primary,\r\n                            color: \"#FFFFFF\",\r\n                            border: \"none\",\r\n                            borderRadius: \"12px\",\r\n                            fontSize: \"16px\",\r\n                            fontWeight: 600,\r\n                            cursor: isChecking ? \"not-allowed\" : \"pointer\",\r\n                            display: \"flex\",\r\n                            alignItems: \"center\",\r\n                            justifyContent: \"center\",\r\n                            gap: \"8px\",\r\n                            transition: \"all 0.2s\",\r\n                        }}\r\n                    >\r\n                        {isChecking ? (\r\n                            <>\r\n                                <span className=\"spinner\" />\r\n                                เธเธณเธฅเธฑเธเธ•เธฃเธงเธเธชเธญเธ...\r\n                            </>\r\n                        ) : (\r\n                            <>\r\n                                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                    <path d=\"M1 4V10H7M23 20V14H17\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\r\n                                    <path d=\"M20.49 9A9 9 0 0 0 5.64 5.64L1 10M23 14L18.36 18.36A9 9 0 0 1 3.51 15\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\r\n                                </svg>\r\n                                เธฅเธญเธเน€เธเธทเนเธญเธกเธ•เนเธญเนเธซเธกเน\r\n                            </>\r\n                        )}\r\n                    </button>\r\n\r\n                    {/* Retry Count */}\r\n                    {retryCount > 0 && (\r\n                        <p style={{\r\n                            marginTop: \"16px\",\r\n                            fontSize: \"14px\",\r\n                            color: colors.textGray,\r\n                        }}>\r\n                            เธเธขเธฒเธขเธฒเธกเน€เธเธทเนเธญเธกเธ•เนเธญเนเธฅเนเธง {retryCount} เธเธฃเธฑเนเธ\r\n                        </p>\r\n                    )}\r\n\r\n                    {/* Support Info */}\r\n                    <div style={{\r\n                        marginTop: \"32px\",\r\n                        paddingTop: \"24px\",\r\n                        borderTop: `1px solid ${colors.textGray}33`,\r\n                    }}>\r\n                        <p style={{\r\n                            fontSize: \"14px\",\r\n                            color: colors.textGray,\r\n                        }}>\r\n                            เธซเธฒเธเธเธฑเธเธซเธฒเธขเธฑเธเนเธกเนเธซเธฒเธข เธเธฃเธธเธ“เธฒเธ•เธดเธ”เธ•เนเธญ\r\n                            <br />\r\n                            <strong>02-123-4567</strong> เธซเธฃเธทเธญ <strong>support@gacp.go.th</strong>\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <style jsx global>{`\r\n                    @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;600;700&display=swap');\r\n                    .spinner {\r\n                        width: 20px;\r\n                        height: 20px;\r\n                        border: 2px solid rgba(255,255,255,0.3);\r\n                        border-top-color: #fff;\r\n                        border-radius: 50%;\r\n                        animation: spin 0.8s linear infinite;\r\n                    }\r\n                    @keyframes spin {\r\n                        to { transform: rotate(360deg); }\r\n                    }\r\n                `}</style>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Server is online - render children\r\n    return <>{children}</>;\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\BackButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\Card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\DataTable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\DocumentUploadCard.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":206,"column":33,"nodeType":"JSXOpeningElement","endLine":210,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useRef, useCallback } from 'react';\r\n\r\ninterface DocumentUploadCardProps {\r\n    id: string;\r\n    label: string;\r\n    hint?: string;\r\n    required?: boolean;\r\n    accept?: string;\r\n    maxSize?: number; // MB\r\n    value?: {\r\n        file?: File;\r\n        url?: string;\r\n        name?: string;\r\n        type?: string;\r\n    };\r\n    onChange: (value: { file?: File; url?: string; name?: string; type?: string } | null) => void;\r\n    onPreview?: (file: File) => void;\r\n}\r\n\r\nexport function DocumentUploadCard({\r\n    id,\r\n    label,\r\n    hint,\r\n    required = false,\r\n    accept = '.pdf,.jpg,.jpeg,.png',\r\n    maxSize = 5,\r\n    value,\r\n    onChange,\r\n    onPreview,\r\n}: DocumentUploadCardProps) {\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [previewUrl, setPreviewUrl] = useState<string | null>(null);\r\n    const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n    const validateFile = useCallback((file: File): string | null => {\r\n        const maxBytes = maxSize * 1024 * 1024;\r\n        if (file.size > maxBytes) {\r\n            return `เนเธเธฅเนเธกเธตเธเธเธฒเธ”เน€เธเธดเธ ${maxSize} MB`;\r\n        }\r\n\r\n        const acceptedTypes = accept.split(',').map(t => t.trim().toLowerCase());\r\n        const fileExt = '.' + file.name.split('.').pop()?.toLowerCase();\r\n        const isAccepted = acceptedTypes.some(at => fileExt === at || file.type.includes(at.replace('.', '')));\r\n\r\n        if (!isAccepted) {\r\n            return `เธฃเธญเธเธฃเธฑเธเน€เธเธเธฒเธฐเนเธเธฅเน ${accept}`;\r\n        }\r\n\r\n        return null;\r\n    }, [accept, maxSize]);\r\n\r\n    const handleFile = useCallback((file: File) => {\r\n        setError(null);\r\n\r\n        const validationError = validateFile(file);\r\n        if (validationError) {\r\n            setError(validationError);\r\n            return;\r\n        }\r\n\r\n        // Create preview URL for images\r\n        if (file.type.startsWith('image/')) {\r\n            const url = URL.createObjectURL(file);\r\n            setPreviewUrl(url);\r\n        } else if (file.type === 'application/pdf') {\r\n            setPreviewUrl('pdf');\r\n        } else {\r\n            setPreviewUrl(null);\r\n        }\r\n\r\n        onChange({\r\n            file,\r\n            name: file.name,\r\n            type: file.type,\r\n        });\r\n\r\n        if (onPreview) {\r\n            onPreview(file);\r\n        }\r\n    }, [validateFile, onChange, onPreview]);\r\n\r\n    const handleDrop = useCallback((e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        setIsDragging(false);\r\n        const file = e.dataTransfer.files[0];\r\n        if (file) handleFile(file);\r\n    }, [handleFile]);\r\n\r\n    const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (file) handleFile(file);\r\n        if (inputRef.current) inputRef.current.value = '';\r\n    };\r\n\r\n    const handleRemove = () => {\r\n        if (previewUrl && previewUrl !== 'pdf') {\r\n            URL.revokeObjectURL(previewUrl);\r\n        }\r\n        setPreviewUrl(null);\r\n        setError(null);\r\n        onChange(null);\r\n    };\r\n\r\n    const formatFileSize = (bytes: number): string => {\r\n        if (bytes < 1024) return bytes + ' B';\r\n        if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';\r\n        return (bytes / (1024 * 1024)).toFixed(2) + ' MB';\r\n    };\r\n\r\n    const hasFile = value?.file || value?.url;\r\n\r\n    return (\r\n        <div className=\"mb-4\">\r\n            {/* Label */}\r\n            <label className=\"block text-sm font-semibold text-gray-800 mb-2\">\r\n                {label}\r\n                {required && <span className=\"text-red-500 ml-1\">*</span>}\r\n            </label>\r\n\r\n            {/* Hint */}\r\n            {hint && (\r\n                <p className=\"text-xs text-gray-500 mb-2\">{hint}</p>\r\n            )}\r\n\r\n            {/* Upload Zone */}\r\n            {!hasFile ? (\r\n                <div\r\n                    onClick={() => inputRef.current?.click()}\r\n                    onDragEnter={(e) => { e.preventDefault(); setIsDragging(true); }}\r\n                    onDragLeave={(e) => { e.preventDefault(); setIsDragging(false); }}\r\n                    onDragOver={(e) => e.preventDefault()}\r\n                    onDrop={handleDrop}\r\n                    className={`\r\n                        relative border-2 border-dashed rounded-xl p-6 text-center cursor-pointer\r\n                        transition-all duration-200\r\n                        ${isDragging\r\n                            ? 'border-emerald-500 bg-emerald-50'\r\n                            : 'border-gray-300 bg-gray-50 hover:border-emerald-400 hover:bg-emerald-50/50'\r\n                        }\r\n                        ${error ? 'border-red-400 bg-red-50' : ''}\r\n                    `}\r\n                >\r\n                    <input\r\n                        ref={inputRef}\r\n                        type=\"file\"\r\n                        accept={accept}\r\n                        onChange={handleInputChange}\r\n                        className=\"hidden\"\r\n                        id={id}\r\n                    />\r\n\r\n                    {/* Upload Icon */}\r\n                    <div className={`mx-auto mb-3 ${isDragging ? 'text-emerald-500' : 'text-gray-400'}`}>\r\n                        <svg width=\"40\" height=\"40\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\r\n                            <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\r\n                            <polyline points=\"17 8 12 3 7 8\" />\r\n                            <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\" />\r\n                        </svg>\r\n                    </div>\r\n\r\n                    <p className=\"text-sm font-medium text-gray-700 mb-1\">\r\n                        {isDragging ? 'เธงเธฒเธเนเธเธฅเนเธ—เธตเนเธเธตเน' : 'เธฅเธฒเธเนเธเธฅเนเธกเธฒเธงเธฒเธ เธซเธฃเธทเธญเธเธฅเธดเธเน€เธเธทเนเธญเน€เธฅเธทเธญเธ'}\r\n                    </p>\r\n                    <p className=\"text-xs text-gray-500\">\r\n                        {accept.split(',').map(a => a.replace('.', '').toUpperCase()).join(', ')} โ€ข เธชเธนเธเธชเธธเธ” {maxSize} MB\r\n                    </p>\r\n                </div>\r\n            ) : (\r\n                /* Preview Zone */\r\n                <div className=\"border-2 border-emerald-500 rounded-xl overflow-hidden bg-emerald-50\">\r\n                    {/* Preview Header */}\r\n                    <div className=\"flex items-center justify-between px-4 py-3 bg-emerald-100/50 border-b border-emerald-200\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <div className=\"w-8 h-8 rounded-lg bg-emerald-500 flex items-center justify-center\">\r\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"white\" strokeWidth=\"2\">\r\n                                    <polyline points=\"20 6 9 17 4 12\" />\r\n                                </svg>\r\n                            </div>\r\n                            <div>\r\n                                <p className=\"text-sm font-medium text-gray-800 truncate max-w-48\">\r\n                                    {value?.name || 'เนเธเธฅเนเธ—เธตเนเธญเธฑเธเนเธซเธฅเธ”'}\r\n                                </p>\r\n                                {value?.file && (\r\n                                    <p className=\"text-xs text-gray-500\">\r\n                                        {formatFileSize(value.file.size)}\r\n                                    </p>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                        <button\r\n                            onClick={handleRemove}\r\n                            className=\"px-3 py-1.5 rounded-lg bg-red-100 text-red-600 text-xs font-medium hover:bg-red-200 transition-colors\"\r\n                        >\r\n                            เธฅเธ\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Preview Content */}\r\n                    <div className=\"p-4\">\r\n                        {previewUrl && previewUrl !== 'pdf' ? (\r\n                            /* Image Preview */\r\n                            <div className=\"relative rounded-lg overflow-hidden bg-white border border-gray-200\">\r\n                                <img\r\n                                    src={previewUrl}\r\n                                    alt=\"Preview\"\r\n                                    className=\"w-full h-48 object-contain\"\r\n                                />\r\n                                {/* AI Ready Badge */}\r\n                                <div className=\"absolute bottom-2 right-2 px-2 py-1 bg-black/70 rounded-md\">\r\n                                    <p className=\"text-xs text-white flex items-center gap-1\">\r\n                                        <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                                            <circle cx=\"12\" cy=\"12\" r=\"10\" />\r\n                                            <path d=\"M12 16v-4\" />\r\n                                            <path d=\"M12 8h.01\" />\r\n                                        </svg>\r\n                                        เธเธฃเนเธญเธกเนเธซเน AI เธ•เธฃเธงเธเธชเธญเธ\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        ) : previewUrl === 'pdf' ? (\r\n                            /* PDF Preview */\r\n                            <div className=\"flex items-center justify-center h-32 rounded-lg bg-white border border-gray-200\">\r\n                                <div className=\"text-center\">\r\n                                    <svg className=\"mx-auto text-red-500 mb-2\" width=\"40\" height=\"40\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\r\n                                        <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\" />\r\n                                        <polyline points=\"14 2 14 8 20 8\" />\r\n                                        <path d=\"M10 12h4\" />\r\n                                        <path d=\"M10 16h4\" />\r\n                                    </svg>\r\n                                    <p className=\"text-sm font-medium text-gray-700\">PDF Document</p>\r\n                                    <p className=\"text-xs text-gray-500 mt-1\">เธเธฃเนเธญเธกเนเธซเน AI เธ•เธฃเธงเธเธชเธญเธ</p>\r\n                                </div>\r\n                            </div>\r\n                        ) : value?.url ? (\r\n                            /* URL Preview */\r\n                            <div className=\"flex items-center justify-center h-32 rounded-lg bg-white border border-gray-200\">\r\n                                <div className=\"text-center\">\r\n                                    <svg className=\"mx-auto text-emerald-500 mb-2\" width=\"40\" height=\"40\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\r\n                                        <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\" />\r\n                                        <polyline points=\"14 2 14 8 20 8\" />\r\n                                        <polyline points=\"16 13 12 17 8 13\" />\r\n                                    </svg>\r\n                                    <p className=\"text-sm font-medium text-gray-700\">เธญเธฑเธเนเธซเธฅเธ”เธชเธณเน€เธฃเนเธ</p>\r\n                                </div>\r\n                            </div>\r\n                        ) : null}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Error Message */}\r\n            {error && (\r\n                <p className=\"mt-2 text-sm text-red-600 flex items-center gap-1\">\r\n                    <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                        <circle cx=\"12\" cy=\"12\" r=\"10\" />\r\n                        <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\" />\r\n                        <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\" />\r\n                    </svg>\r\n                    {error}\r\n                </p>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\Skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\StatusBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\WizardUI.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\bottom-nav.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\bottom-nav.tsx:68:9\n  66 |         // Initial load\n  67 |         const currentUser = AuthService.getUser();\n> 68 |         setUser(currentUser);\n     |         ^^^^^^^ Avoid calling setState() directly within an effect\n  69 |\n  70 |         // Listen for updates (login/profile update)\n  71 |         const unsubscribe = AuthService.onAuthChange((event, data) => {","line":68,"column":9,"nodeType":null,"endLine":68,"endColumn":16}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport Link from 'next/link';\r\nimport { usePathname } from 'next/navigation';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { AuthService, AuthUser } from '@/lib/services/auth-service';\r\n\r\nconst NAV_ITEMS = [\r\n    {\r\n        href: '/farmer/dashboard', label: 'เธซเธเนเธฒเธซเธฅเธฑเธ', requiredVerify: false, icon: (c: string) => (\r\n            <svg width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" stroke={c} strokeWidth=\"1.8\" strokeLinecap=\"round\">\r\n                <path d=\"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\" />\r\n                <polyline points=\"9 22 9 12 15 12 15 22\" />\r\n            </svg>\r\n        )\r\n    },\r\n    {\r\n        href: '/farmer/applications', label: 'เธเธณเธเธญ', requiredVerify: true, icon: (c: string) => (\r\n            <svg width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" stroke={c} strokeWidth=\"1.8\" strokeLinecap=\"round\">\r\n                <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\" />\r\n                <polyline points=\"14 2 14 8 20 8\" />\r\n                <line x1=\"16\" y1=\"13\" x2=\"8\" y2=\"13\" />\r\n                <line x1=\"16\" y1=\"17\" x2=\"8\" y2=\"17\" />\r\n            </svg>\r\n        )\r\n    },\r\n    {\r\n        href: '/tracking', label: 'เธ•เธดเธ”เธ•เธฒเธก', requiredVerify: true, icon: (c: string) => (\r\n            <svg width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" stroke={c} strokeWidth=\"1.8\" strokeLinecap=\"round\">\r\n                <circle cx=\"12\" cy=\"12\" r=\"10\" />\r\n                <polygon points=\"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76\" />\r\n            </svg>\r\n        )\r\n    },\r\n    {\r\n        href: '/payments', label: 'เธเธฒเธฃเน€เธเธดเธ', requiredVerify: true, icon: (c: string) => (\r\n            <svg width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" stroke={c} strokeWidth=\"1.8\" strokeLinecap=\"round\">\r\n                <rect x=\"1\" y=\"4\" width=\"22\" height=\"16\" rx=\"2\" ry=\"2\" />\r\n                <line x1=\"1\" y1=\"10\" x2=\"23\" y2=\"10\" />\r\n            </svg>\r\n        )\r\n    },\r\n    {\r\n        href: '/farmer/profile', label: 'เนเธเธฃเนเธเธฅเน', requiredVerify: false, icon: (c: string) => (\r\n            <svg width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" stroke={c} strokeWidth=\"1.8\" strokeLinecap=\"round\">\r\n                <circle cx=\"12\" cy=\"7\" r=\"4\" />\r\n                <path d=\"M5.5 21a7.5 7.5 0 0 1 13 0\" />\r\n            </svg>\r\n        )\r\n    },\r\n];\r\n\r\ninterface BottomNavProps {\r\n    isDark?: boolean;\r\n}\r\n\r\n/**\r\n * Eco-Professional Bottom Navigation\r\n * Mobile-first with Tailwind CSS\r\n */\r\nexport function BottomNav({ isDark = false }: BottomNavProps) {\r\n    const pathname = usePathname();\r\n    const [user, setUser] = useState<AuthUser | null>(null);\r\n\r\n    useEffect(() => {\r\n        // Initial load\r\n        const currentUser = AuthService.getUser();\r\n        setUser(currentUser);\r\n\r\n        // Listen for updates (login/profile update)\r\n        const unsubscribe = AuthService.onAuthChange((event, data) => {\r\n            if (event === 'login' && data && typeof data === 'object' && 'user' in data) {\r\n                setUser((data as { user: AuthUser }).user);\r\n            } else {\r\n                setUser(AuthService.getUser());\r\n            }\r\n        });\r\n\r\n        return () => unsubscribe();\r\n    }, []);\r\n\r\n    const isVerified = user?.verificationStatus === 'APPROVED';\r\n\r\n    // Don't show on wizard pages\r\n    if (pathname?.includes('/applications/new')) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <nav className={`\r\n                fixed bottom-0 left-0 right-0 h-[72px] z-50\r\n                flex justify-around items-center px-2\r\n                border-t md:hidden\r\n                ${isDark\r\n                    ? 'bg-slate-800 border-slate-700'\r\n                    : 'bg-white border-slate-200'\r\n                }\r\n            `}>\r\n                {NAV_ITEMS.map((item) => {\r\n                    // Access Control Rule\r\n                    if (item.requiredVerify && !isVerified) {\r\n                        return null;\r\n                    }\r\n\r\n                    const isActive = pathname === item.href || pathname?.startsWith(item.href + '/');\r\n                    const activeColor = '#10B981';\r\n                    const inactiveColor = isDark ? '#6B7280' : '#9CA3AF';\r\n\r\n                    return (\r\n                        <Link\r\n                            key={item.href}\r\n                            href={item.href}\r\n                            className=\"flex flex-col items-center gap-1 py-2 px-3 min-w-[56px] relative no-underline\"\r\n                        >\r\n                            {isActive && (\r\n                                <span className=\"absolute -top-px left-1/2 -translate-x-1/2 w-6 h-0.5 bg-emerald-500 rounded-b\" />\r\n                            )}\r\n                            <span className={`\r\n                                flex items-center justify-center w-8 h-8 rounded-xl transition-all\r\n                                ${isActive\r\n                                    ? isDark ? 'bg-emerald-900/30' : 'bg-emerald-50'\r\n                                    : 'bg-transparent'\r\n                                }\r\n                            `}>\r\n                                {item.icon(isActive ? activeColor : inactiveColor)}\r\n                            </span>\r\n                            <span className={`\r\n                                text-[10px] font-medium\r\n                                ${isActive ? 'text-emerald-500 font-semibold' : isDark ? 'text-slate-400' : 'text-slate-400'}\r\n                            `}>\r\n                                {item.label}\r\n                            </span>\r\n                        </Link>\r\n                    );\r\n                })}\r\n            </nav>\r\n\r\n            {/* Spacer for bottom nav (mobile only) */}\r\n            <div className=\"h-[72px] md:hidden\" />\r\n        </>\r\n    );\r\n}\r\n\r\nexport default BottomNav;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\error-boundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\file-upload.tsx","messages":[{"ruleId":"react-hooks/preserve-manual-memoization","severity":2,"message":"Compilation Skipped: Existing memoization could not be preserved\n\nReact Compiler has skipped optimizing this component because the existing manual memoization could not be preserved. The inferred dependencies did not match the manually specified dependencies, which could cause the value to change more or less frequently than expected. The inferred dependency was `validateFile`, but the source dependencies were [multiple, selectedFiles, onFileSelect, maxSize, accept]. Inferred different dependency than source.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\file-upload.tsx:128:37\n  126 |     };\n  127 |\n> 128 |     const handleFiles = useCallback((files: FileList | null) => {\n      |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 129 |         if (!files || files.length === 0) return;\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 130 |\n      โ€ฆ\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 145 |         onFileSelect(newFiles);\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 146 |     }, [multiple, selectedFiles, onFileSelect, maxSize, accept]);\n      | ^^^^^^ Could not preserve existing manual memoization\n  147 |\n  148 |     const handleDragEnter = (e: React.DragEvent) => {\n  149 |         e.preventDefault();","line":128,"column":37,"nodeType":null,"endLine":146,"endColumn":6},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'validateFile'. Either include it or remove the dependency array.","line":146,"column":8,"nodeType":"ArrayExpression","endLine":146,"endColumn":64,"suggestions":[{"desc":"Update the dependencies array to be: [multiple, selectedFiles, onFileSelect, validateFile]","fix":{"range":[4941,4997],"text":"[multiple, selectedFiles, onFileSelect, validateFile]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useRef, useCallback } from \"react\";\r\n\r\ninterface FileUploadProps {\r\n    onFileSelect: (files: File[]) => void;\r\n    accept?: string;\r\n    multiple?: boolean;\r\n    maxSize?: number; // in MB\r\n    label?: string;\r\n    hint?: string;\r\n    disabled?: boolean;\r\n    uploading?: boolean;\r\n    uploadProgress?: number;\r\n    theme?: \"light\" | \"dark\";\r\n}\r\n\r\nconst themes = {\r\n    light: {\r\n        bg: \"#FFFFFF\",\r\n        bgHover: \"#F9FAFB\",\r\n        border: \"#E5E7EB\",\r\n        borderActive: \"#16A34A\",\r\n        text: \"#111827\",\r\n        textMuted: \"#6B7280\",\r\n        accent: \"#16A34A\",\r\n        accentBg: \"rgba(22, 163, 74, 0.08)\",\r\n        error: \"#EF4444\",\r\n        errorBg: \"rgba(239, 68, 68, 0.08)\",\r\n    },\r\n    dark: {\r\n        bg: \"rgba(15, 23, 42, 0.6)\",\r\n        bgHover: \"rgba(15, 23, 42, 0.8)\",\r\n        border: \"rgba(255, 255, 255, 0.08)\",\r\n        borderActive: \"#10B981\",\r\n        text: \"#F8FAFC\",\r\n        textMuted: \"#94A3B8\",\r\n        accent: \"#10B981\",\r\n        accentBg: \"rgba(16, 185, 129, 0.15)\",\r\n        error: \"#EF4444\",\r\n        errorBg: \"rgba(239, 68, 68, 0.15)\",\r\n    }\r\n};\r\n\r\nconst Icons = {\r\n    upload: () => (\r\n        <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\r\n            <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\r\n            <polyline points=\"17 8 12 3 7 8\" />\r\n            <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\" />\r\n        </svg>\r\n    ),\r\n    file: () => (\r\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\r\n            <path d=\"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z\" />\r\n            <polyline points=\"13 2 13 9 20 9\" />\r\n        </svg>\r\n    ),\r\n    check: () => (\r\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\">\r\n            <polyline points=\"20 6 9 17 4 12\" />\r\n        </svg>\r\n    ),\r\n    x: () => (\r\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n            <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\r\n            <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\r\n        </svg>\r\n    ),\r\n    image: () => (\r\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\r\n            <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\r\n            <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\" />\r\n            <polyline points=\"21 15 16 10 5 21\" />\r\n        </svg>\r\n    ),\r\n    pdf: () => (\r\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\r\n            <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\" />\r\n            <polyline points=\"14 2 14 8 20 8\" />\r\n            <path d=\"M10 12h4\" />\r\n            <path d=\"M10 16h4\" />\r\n        </svg>\r\n    ),\r\n};\r\n\r\nexport default function FileUpload({\r\n    onFileSelect,\r\n    accept = \".pdf,.jpg,.jpeg,.png\",\r\n    multiple = true,\r\n    maxSize = 10,\r\n    label = \"เธญเธฑเธเนเธซเธฅเธ”เนเธเธฅเน\",\r\n    hint = \"เธฅเธฒเธเนเธเธฅเนเธกเธฒเธงเธฒเธ เธซเธฃเธทเธญเธเธฅเธดเธเน€เธเธทเนเธญเน€เธฅเธทเธญเธ\",\r\n    disabled = false,\r\n    uploading = false,\r\n    uploadProgress = 0,\r\n    theme = \"light\",\r\n}: FileUploadProps) {\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [selectedFiles, setSelectedFiles] = useState<File[]>([]);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const inputRef = useRef<HTMLInputElement>(null);\r\n    const t = themes[theme];\r\n\r\n    const validateFile = (file: File): string | null => {\r\n        const maxBytes = maxSize * 1024 * 1024;\r\n        if (file.size > maxBytes) {\r\n            return `เนเธเธฅเน ${file.name} เธกเธตเธเธเธฒเธ”เน€เธเธดเธ ${maxSize} MB`;\r\n        }\r\n\r\n        const acceptedTypes = accept.split(\",\").map(t => t.trim().toLowerCase());\r\n        const fileExt = \".\" + file.name.split(\".\").pop()?.toLowerCase();\r\n        const mimeType = file.type.toLowerCase();\r\n\r\n        const isAccepted = acceptedTypes.some(at => {\r\n            if (at.startsWith(\".\")) return fileExt === at;\r\n            if (at.includes(\"*\")) return mimeType.startsWith(at.replace(\"*\", \"\"));\r\n            return mimeType === at;\r\n        });\r\n\r\n        if (!isAccepted) {\r\n            return `เธเธฃเธฐเน€เธ เธ—เนเธเธฅเน ${fileExt} เนเธกเนเธฃเธญเธเธฃเธฑเธ`;\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    const handleFiles = useCallback((files: FileList | null) => {\r\n        if (!files || files.length === 0) return;\r\n\r\n        setError(null);\r\n        const fileArray = Array.from(files);\r\n\r\n        // Validate each file\r\n        for (const file of fileArray) {\r\n            const validationError = validateFile(file);\r\n            if (validationError) {\r\n                setError(validationError);\r\n                return;\r\n            }\r\n        }\r\n\r\n        const newFiles = multiple ? [...selectedFiles, ...fileArray] : fileArray;\r\n        setSelectedFiles(newFiles);\r\n        onFileSelect(newFiles);\r\n    }, [multiple, selectedFiles, onFileSelect, maxSize, accept]);\r\n\r\n    const handleDragEnter = (e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        if (!disabled && !uploading) setIsDragging(true);\r\n    };\r\n\r\n    const handleDragLeave = (e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        setIsDragging(false);\r\n    };\r\n\r\n    const handleDragOver = (e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    };\r\n\r\n    const handleDrop = (e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        setIsDragging(false);\r\n        if (!disabled && !uploading) {\r\n            handleFiles(e.dataTransfer.files);\r\n        }\r\n    };\r\n\r\n    const handleClick = () => {\r\n        if (!disabled && !uploading && inputRef.current) {\r\n            inputRef.current.click();\r\n        }\r\n    };\r\n\r\n    const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        handleFiles(e.target.files);\r\n        if (inputRef.current) inputRef.current.value = \"\";\r\n    };\r\n\r\n    const removeFile = (index: number) => {\r\n        const newFiles = selectedFiles.filter((_, i) => i !== index);\r\n        setSelectedFiles(newFiles);\r\n        onFileSelect(newFiles);\r\n    };\r\n\r\n    const formatFileSize = (bytes: number): string => {\r\n        if (bytes < 1024) return bytes + \" B\";\r\n        if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + \" KB\";\r\n        return (bytes / (1024 * 1024)).toFixed(2) + \" MB\";\r\n    };\r\n\r\n    const getFileIcon = (file: File) => {\r\n        if (file.type.startsWith(\"image/\")) return <Icons.image />;\r\n        if (file.type === \"application/pdf\") return <Icons.pdf />;\r\n        return <Icons.file />;\r\n    };\r\n\r\n    return (\r\n        <div style={{ width: \"100%\" }}>\r\n            {/* Label */}\r\n            {label && (\r\n                <label style={{ display: \"block\", fontSize: \"14px\", fontWeight: 500, marginBottom: \"8px\", color: t.text }}>\r\n                    {label}\r\n                </label>\r\n            )}\r\n\r\n            {/* Dropzone */}\r\n            <div\r\n                onClick={handleClick}\r\n                onDragEnter={handleDragEnter}\r\n                onDragLeave={handleDragLeave}\r\n                onDragOver={handleDragOver}\r\n                onDrop={handleDrop}\r\n                style={{\r\n                    padding: \"32px\",\r\n                    borderRadius: \"16px\",\r\n                    border: `2px dashed ${isDragging ? t.borderActive : error ? t.error : t.border}`,\r\n                    backgroundColor: isDragging ? t.accentBg : error ? t.errorBg : t.bg,\r\n                    cursor: disabled || uploading ? \"not-allowed\" : \"pointer\",\r\n                    textAlign: \"center\",\r\n                    transition: \"all 0.2s\",\r\n                    opacity: disabled ? 0.5 : 1,\r\n                }}\r\n            >\r\n                <input\r\n                    ref={inputRef}\r\n                    type=\"file\"\r\n                    accept={accept}\r\n                    multiple={multiple}\r\n                    onChange={handleInputChange}\r\n                    style={{ display: \"none\" }}\r\n                    disabled={disabled || uploading}\r\n                />\r\n\r\n                <div style={{ color: isDragging ? t.accent : t.textMuted, marginBottom: \"12px\" }}>\r\n                    <Icons.upload />\r\n                </div>\r\n\r\n                <p style={{ fontSize: \"14px\", color: t.text, margin: \"0 0 4px\", fontWeight: 500 }}>\r\n                    {hint}\r\n                </p>\r\n                <p style={{ fontSize: \"12px\", color: t.textMuted, margin: 0 }}>\r\n                    {accept.split(\",\").join(\", \")} (เธชเธนเธเธชเธธเธ” {maxSize} MB)\r\n                </p>\r\n\r\n                {uploading && (\r\n                    <div style={{ marginTop: \"16px\" }}>\r\n                        <div style={{ height: \"4px\", backgroundColor: t.border, borderRadius: \"2px\", overflow: \"hidden\" }}>\r\n                            <div style={{\r\n                                height: \"100%\",\r\n                                width: `${uploadProgress}%`,\r\n                                backgroundColor: t.accent,\r\n                                transition: \"width 0.3s\"\r\n                            }} />\r\n                        </div>\r\n                        <p style={{ fontSize: \"12px\", color: t.textMuted, margin: \"8px 0 0\" }}>\r\n                            เธเธณเธฅเธฑเธเธญเธฑเธเนเธซเธฅเธ”... {uploadProgress}%\r\n                        </p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Error */}\r\n            {error && (\r\n                <p style={{ marginTop: \"8px\", fontSize: \"13px\", color: t.error }}>โ ๏ธ {error}</p>\r\n            )}\r\n\r\n            {/* Selected Files */}\r\n            {selectedFiles.length > 0 && (\r\n                <div style={{ marginTop: \"16px\", display: \"flex\", flexDirection: \"column\", gap: \"8px\" }}>\r\n                    {selectedFiles.map((file, index) => (\r\n                        <div\r\n                            key={`${file.name}-${index}`}\r\n                            style={{\r\n                                display: \"flex\",\r\n                                alignItems: \"center\",\r\n                                gap: \"12px\",\r\n                                padding: \"12px\",\r\n                                backgroundColor: t.bg,\r\n                                border: `1px solid ${t.border}`,\r\n                                borderRadius: \"12px\",\r\n                            }}\r\n                        >\r\n                            <div style={{ color: t.accent }}>\r\n                                {getFileIcon(file)}\r\n                            </div>\r\n                            <div style={{ flex: 1, minWidth: 0 }}>\r\n                                <p style={{\r\n                                    fontSize: \"13px\",\r\n                                    fontWeight: 500,\r\n                                    color: t.text,\r\n                                    margin: 0,\r\n                                    overflow: \"hidden\",\r\n                                    textOverflow: \"ellipsis\",\r\n                                    whiteSpace: \"nowrap\",\r\n                                }}>\r\n                                    {file.name}\r\n                                </p>\r\n                                <p style={{ fontSize: \"11px\", color: t.textMuted, margin: \"2px 0 0\" }}>\r\n                                    {formatFileSize(file.size)}\r\n                                </p>\r\n                            </div>\r\n                            {!uploading && (\r\n                                <button\r\n                                    onClick={(e) => { e.stopPropagation(); removeFile(index); }}\r\n                                    style={{\r\n                                        width: \"28px\",\r\n                                        height: \"28px\",\r\n                                        borderRadius: \"8px\",\r\n                                        border: \"none\",\r\n                                        backgroundColor: t.errorBg,\r\n                                        color: t.error,\r\n                                        cursor: \"pointer\",\r\n                                        display: \"flex\",\r\n                                        alignItems: \"center\",\r\n                                        justifyContent: \"center\",\r\n                                    }}\r\n                                >\r\n                                    <Icons.x />\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\form-input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\gacp-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\gacp-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\gacp-input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\icons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\loading-spinner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\modern-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\modern-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\modern-input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\page-components.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\sidebar.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\sidebar.tsx:22:9\n  20 |     useEffect(() => {\n  21 |         const currentUser = AuthService.getUser();\n> 22 |         setUser(currentUser);\n     |         ^^^^^^^ Avoid calling setState() directly within an effect\n  23 |\n  24 |         const unsubscribe = AuthService.onAuthChange((event, data) => {\n  25 |             if (event === 'login' && data && typeof data === 'object' && 'user' in data) {","line":22,"column":9,"nodeType":null,"endLine":22,"endColumn":16}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport Link from \"next/link\";\r\nimport { usePathname } from \"next/navigation\";\r\nimport { Icons } from \"./icons\";\r\nimport { AuthService, AuthUser } from \"@/lib/services/auth-service\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useLanguage } from \"@/lib/i18n/LanguageContext\";\r\n\r\ninterface SidebarProps {\r\n    isDark: boolean;\r\n    toggleTheme: () => void;\r\n}\r\n\r\nexport function Sidebar({ isDark, toggleTheme }: SidebarProps) {\r\n    const pathname = usePathname();\r\n    const [user, setUser] = useState<AuthUser | null>(null);\r\n    const { dict } = useLanguage();\r\n\r\n    useEffect(() => {\r\n        const currentUser = AuthService.getUser();\r\n        setUser(currentUser);\r\n\r\n        const unsubscribe = AuthService.onAuthChange((event, data) => {\r\n            if (event === 'login' && data && typeof data === 'object' && 'user' in data) {\r\n                setUser((data as { user: AuthUser }).user);\r\n            } else {\r\n                setUser(AuthService.getUser());\r\n            }\r\n        });\r\n\r\n        return () => unsubscribe();\r\n    }, []);\r\n\r\n    const isVerified = user?.verificationStatus === 'APPROVED';\r\n\r\n    const navItems = [\r\n        { href: \"/farmer/dashboard\", icon: Icons.Home, label: dict.sidebar.dashboard, requiredVerify: false },\r\n        { href: \"/farmer/applications\", icon: Icons.Document, label: dict.sidebar.applications, requiredVerify: true },\r\n        { href: \"/farmer/establishments\", icon: Icons.Leaf, label: dict.sidebar.establishments, requiredVerify: true },\r\n        { href: \"/farmer/planting\", icon: Icons.Calendar, label: dict.sidebar.planting, requiredVerify: true },\r\n        { href: \"/farmer/certificates\", icon: Icons.Certificate, label: dict.sidebar.certificates, requiredVerify: true },\r\n        { href: \"/farmer/tracking\", icon: Icons.Compass, label: dict.sidebar.tracking, requiredVerify: true },\r\n        { href: \"/farmer/payments\", icon: Icons.CreditCard, label: dict.sidebar.payments, requiredVerify: true },\r\n        { href: \"/farmer/profile\", icon: Icons.User, label: dict.sidebar.profile, requiredVerify: false },\r\n        { href: \"/farmer/settings\", icon: Icons.Settings, label: dict.sidebar.settings, requiredVerify: false },\r\n    ];\r\n\r\n    const handleLogout = () => {\r\n        AuthService.logout();\r\n        window.location.href = \"/login\";\r\n    };\r\n\r\n    return (\r\n        <aside className={`\r\n            fixed left-4 top-4 bottom-4 w-20 rounded-[2.5rem] flex flex-col items-center py-8 transition-all duration-500 z-50\r\n            hidden lg:flex \r\n            ${isDark\r\n                ? 'bg-slate-900/90 border border-slate-700/50 backdrop-blur-xl shadow-2xl'\r\n                : 'bg-white/80 border border-white/40 backdrop-blur-xl shadow-soft'\r\n            }\r\n        `}>\r\n            {/* Logo Section */}\r\n            <div className=\"mb-10 relative group\">\r\n                <div className=\"absolute inset-0 bg-primary/20 rounded-2xl blur-xl group-hover:bg-primary/40 transition-all duration-700 scale-110\"></div>\r\n                <div className=\"w-12 h-12 rounded-2xl bg-gradient-to-br from-primary to-primary-800 flex items-center justify-center text-white font-black text-xl shadow-lg relative z-10 transform group-hover:rotate-12 transition-transform\">\r\n                    G\r\n                </div>\r\n            </div>\r\n\r\n            {/* Navigation */}\r\n            <nav className=\"flex-1 flex flex-col gap-2 w-full px-2 overflow-y-auto no-scrollbar\">\r\n                {navItems.map(item => {\r\n                    if (item.requiredVerify && !isVerified) return null;\r\n\r\n                    const isActive = pathname === item.href || (item.href !== \"/farmer/dashboard\" && pathname.startsWith(item.href));\r\n\r\n                    return (\r\n                        <div key={item.href} className=\"group relative\">\r\n                            <Link\r\n                                href={item.href}\r\n                                className={`\r\n                                    flex flex-col items-center justify-center gap-1.5 py-3.5 rounded-2xl transition-all duration-300 relative\r\n                                    ${isActive\r\n                                        ? 'bg-primary text-white shadow-lg shadow-primary/20 scale-100'\r\n                                        : isDark\r\n                                            ? 'text-slate-500 hover:text-white hover:bg-white/5'\r\n                                            : 'text-gray-400 hover:text-primary hover:bg-primary-50'\r\n                                    }\r\n                                `}\r\n                            >\r\n                                <item.icon className={`w-6 h-6 transition-transform duration-300 ${isActive ? 'scale-110' : 'group-hover:scale-110'}`} />\r\n                                <span className={`text-[9px] font-black uppercase tracking-widest text-center px-1 leading-tight ${isActive ? 'opacity-100' : 'opacity-0 group-hover:opacity-100'} transition-opacity`}>\r\n                                    {item.label}\r\n                                </span>\r\n                            </Link>\r\n\r\n                            {/* Floating Tooltip/Indicator */}\r\n                            {!isActive && (\r\n                                <div className=\"absolute left-[84px] top-1/2 -translate-y-1/2 bg-gray-900 text-white text-[10px] font-bold px-3 py-1.5 rounded-xl opacity-0 scale-95 pointer-events-none group-hover:opacity-100 group-hover:scale-100 transition-all z-[60] whitespace-nowrap shadow-xl\">\r\n                                    <div className=\"absolute left-[-4px] top-1/2 -translate-y-1/2 w-2 h-2 bg-gray-900 rotate-45\"></div>\r\n                                    {item.label}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    );\r\n                })}\r\n            </nav>\r\n\r\n            {/* Bottom Actions */}\r\n            <div className=\"mt-auto flex flex-col items-center gap-4 w-full px-3\">\r\n                <button\r\n                    onClick={toggleTheme}\r\n                    className={`\r\n                        w-12 h-12 rounded-2xl flex items-center justify-center transition-all duration-300\r\n                        ${isDark\r\n                            ? 'bg-slate-800 text-amber-400 hover:bg-slate-700 shadow-inner'\r\n                            : 'bg-gray-50 text-slate-500 hover:bg-white hover:shadow-soft border border-gray-100'\r\n                        }\r\n                    `}\r\n                >\r\n                    {isDark ? <Icons.Sun className=\"w-5 h-5\" /> : <Icons.Moon className=\"w-5 h-5\" />}\r\n                </button>\r\n\r\n                <button\r\n                    onClick={handleLogout}\r\n                    className={`\r\n                        w-12 h-12 rounded-2xl flex items-center justify-center transition-all duration-300 mb-2\r\n                        ${isDark\r\n                            ? 'text-slate-500 hover:text-red-400 hover:bg-red-400/10'\r\n                            : 'text-gray-400 hover:text-red-500 hover:bg-red-50'\r\n                        }\r\n                    `}\r\n                >\r\n                    <Icons.Logout className=\"w-5 h-5\" />\r\n                </button>\r\n            </div>\r\n        </aside>\r\n    );\r\n}\r\n\r\nexport default Sidebar;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\theme-toggle.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\ui\\theme-toggle.tsx:15:9\n  13 |\n  14 |     useEffect(() => {\n> 15 |         setMounted(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  16 |         setIsDark(localStorage.getItem(\"theme\") === \"dark\");\n  17 |     }, []);\n  18 |","line":15,"column":9,"nodeType":null,"endLine":15,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { useEffect, useState } from 'react';\r\n\r\ninterface ThemeToggleProps {\r\n    className?: string;\r\n    size?: 'sm' | 'md';\r\n}\r\n\r\nexport function ThemeToggle({ className = '', size = 'md' }: ThemeToggleProps) {\r\n    const [isDark, setIsDark] = useState(false);\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        setIsDark(localStorage.getItem(\"theme\") === \"dark\");\r\n    }, []);\r\n\r\n    const toggleTheme = () => {\r\n        const newTheme = !isDark;\r\n        setIsDark(newTheme);\r\n        localStorage.setItem(\"theme\", newTheme ? \"dark\" : \"light\");\r\n\r\n        // Trigger storage event for other components\r\n        window.dispatchEvent(new Event('storage'));\r\n\r\n        // Also update document for immediate feedback\r\n        document.documentElement.classList.toggle('dark', newTheme);\r\n    };\r\n\r\n    if (!mounted) {\r\n        return null; // Avoid hydration mismatch\r\n    }\r\n\r\n    const buttonSize = size === 'sm' ? '36px' : '44px';\r\n    const iconSize = size === 'sm' ? '16px' : '20px';\r\n\r\n    return (\r\n        <button\r\n            onClick={toggleTheme}\r\n            className={className}\r\n            style={{\r\n                width: buttonSize,\r\n                height: buttonSize,\r\n                borderRadius: '12px',\r\n                backgroundColor: isDark ? 'rgba(16, 185, 129, 0.15)' : '#ECFDF5',\r\n                border: `1px solid ${isDark ? 'rgba(16, 185, 129, 0.3)' : '#10B981'}`,\r\n                cursor: 'pointer',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                transition: 'all 0.2s ease',\r\n            }}\r\n            title={isDark ? 'Switch to Light Mode' : 'Switch to Dark Mode'}\r\n        >\r\n            {isDark ? (\r\n                // Sun icon\r\n                <svg width={iconSize} height={iconSize} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#FBBF24\" strokeWidth=\"2\" strokeLinecap=\"round\">\r\n                    <circle cx=\"12\" cy=\"12\" r=\"5\" />\r\n                    <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\" />\r\n                    <line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\" />\r\n                    <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\" />\r\n                    <line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\" />\r\n                    <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\" />\r\n                    <line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\" />\r\n                    <line x1=\"4.22\" y1=\"19.78\" x2=\"5.64\" y2=\"18.36\" />\r\n                    <line x1=\"18.36\" y1=\"5.64\" x2=\"19.78\" y2=\"4.22\" />\r\n                </svg>\r\n            ) : (\r\n                // Moon icon\r\n                <svg width={iconSize} height={iconSize} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#10B981\" strokeWidth=\"2\" strokeLinecap=\"round\">\r\n                    <path d=\"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z\" />\r\n                </svg>\r\n            )}\r\n        </button>\r\n    );\r\n}\r\n\r\nexport default ThemeToggle;\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\wizard\\WizardNavigation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\components\\wizard\\WizardStepWrapper.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\config\\api.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\features\\constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\features\\permit-form\\components\\application-selector.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setServiceType' is assigned a value but never used.","line":72,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":72,"endColumn":39},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'calculating' is assigned a value but never used.","line":76,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":76,"endColumn":23},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'calculateFee' and 'onSelectionChange'. Either include them or remove the dependency array. If 'onSelectionChange' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":89,"column":8,"nodeType":"ArrayExpression","endLine":89,"endColumn":50,"suggestions":[{"desc":"Update the dependencies array to be: [plant, objective, areaTypes, serviceType, onSelectionChange, calculateFee]","fix":{"range":[2890,2932],"text":"[plant, objective, areaTypes, serviceType, onSelectionChange, calculateFee]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":93,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":93,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3032,3035],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3032,3035],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":97,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":97,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":107,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3467,3470],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3467,3470],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":117,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":117,"endColumn":23}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { apiClient as api } from '@/lib/api';\r\n\r\ninterface PricingConfig {\r\n    config: {\r\n        docReviewFee: number;\r\n        baseInspectionFee: number;\r\n        areaSurcharge: number;\r\n    };\r\n    areaTypes: { id: string; label: string; labelEn: string }[];\r\n    objectives: { id: string; label: string; labelEn: string }[];\r\n    serviceTypes: { id: string; label: string }[];\r\n}\r\n\r\ninterface FeeBreakdown {\r\n    items: { description: string; quantity: number; unitPrice: number; total: number }[];\r\n    subtotal: number;\r\n    total: number;\r\n    totalText: string;\r\n    requiresTeamReview: boolean;\r\n    message?: string;\r\n}\r\n\r\n// Theme support\r\nconst getTheme = (isDark: boolean) => isDark ? {\r\n    bg: \"rgba(15, 23, 42, 0.6)\", border: \"rgba(255, 255, 255, 0.08)\",\r\n    text: \"#F8FAFC\", textSecondary: \"#94A3B8\", textMuted: \"#64748B\",\r\n    accent: \"#3B82F6\", accentLight: \"#60A5FA\", success: \"#10B981\"\r\n} : {\r\n    bg: \"#FFFFFF\", border: \"rgba(0, 0, 0, 0.08)\",\r\n    text: \"#1A1A1A\", textSecondary: \"#5A5A5A\", textMuted: \"#8A8A8A\",\r\n    accent: \"#2563EB\", accentLight: \"#3B82F6\", success: \"#16A34A\"\r\n};\r\n\r\n// Plant options (6 เธชเธกเธธเธเนเธเธฃ)\r\nconst PLANTS = [\r\n    { id: 'cannabis', label: 'เธเธฑเธเธเธฒ', emoji: '' },\r\n    { id: 'kratom', label: 'เธเธฃเธฐเธ—เนเธญเธก', emoji: '' },\r\n    { id: 'turmeric', label: 'เธเธกเธดเนเธเธเธฑเธ', emoji: '' },\r\n    { id: 'ginger', label: 'เธเธดเธ', emoji: '' },\r\n    { id: 'black_galingale', label: 'เธเธฃเธฐเธเธฒเธขเธ”เธณ', emoji: '' },\r\n    { id: 'plai', label: 'เนเธเธฅ', emoji: '' }\r\n];\r\n\r\ninterface ApplicationSelectorProps {\r\n    isDark?: boolean;\r\n    onSelectionChange?: (selection: {\r\n        plant: string;\r\n        objective: string;\r\n        areaTypes: string[];\r\n        serviceType: string;\r\n    }) => void;\r\n    onFeeCalculated?: (fee: FeeBreakdown | null) => void;\r\n}\r\n\r\nexport default function ApplicationSelector({\r\n    isDark = false,\r\n    onSelectionChange,\r\n    onFeeCalculated\r\n}: ApplicationSelectorProps) {\r\n    const t = getTheme(isDark);\r\n\r\n    const [config, setConfig] = useState<PricingConfig | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // Selections\r\n    const [plant, setPlant] = useState<string>('');\r\n    const [objective, setObjective] = useState<string>('');\r\n    const [areaTypes, setAreaTypes] = useState<string[]>([]);\r\n    const [serviceType, setServiceType] = useState<string>('new_application');\r\n\r\n    // Calculated fee\r\n    const [fee, setFee] = useState<FeeBreakdown | null>(null);\r\n    const [calculating, setCalculating] = useState(false);\r\n\r\n    // Load config\r\n    useEffect(() => {\r\n        loadConfig();\r\n    }, []);\r\n\r\n    // Calculate fee when selections change\r\n    useEffect(() => {\r\n        if (serviceType && areaTypes.length > 0) {\r\n            calculateFee();\r\n        }\r\n        onSelectionChange?.({ plant, objective, areaTypes, serviceType });\r\n    }, [plant, objective, areaTypes, serviceType]);\r\n\r\n    const loadConfig = async () => {\r\n        try {\r\n            const result = await api.get<any>('/api/pricing/fees');\r\n            if (result.success && result.data?.data) {\r\n                setConfig(result.data.data);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to load pricing config');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const calculateFee = async () => {\r\n        setCalculating(true);\r\n        try {\r\n            const result = await api.post<any>('/api/pricing/calculate', {\r\n                serviceType,\r\n                areaTypes,\r\n                plantType: plant,\r\n                objective\r\n            });\r\n            if (result.success && result.data?.data) {\r\n                setFee(result.data.data);\r\n                onFeeCalculated?.(result.data.data);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to calculate fee');\r\n        } finally {\r\n            setCalculating(false);\r\n        }\r\n    };\r\n\r\n    const toggleArea = (areaId: string) => {\r\n        setAreaTypes(prev =>\r\n            prev.includes(areaId)\r\n                ? prev.filter(a => a !== areaId)\r\n                : [...prev, areaId]\r\n        );\r\n    };\r\n\r\n    if (loading) {\r\n        return <div style={{ padding: '20px', textAlign: 'center', color: t.textMuted }}>เธเธณเธฅเธฑเธเนเธซเธฅเธ”...</div>;\r\n    }\r\n\r\n    return (\r\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '24px' }}>\r\n            {/* Plant Selection */}\r\n            <div>\r\n                <label style={{ display: 'block', fontSize: '14px', fontWeight: 600, color: t.text, marginBottom: '12px' }}>\r\n                    1. เน€เธฅเธทเธญเธเธเธฃเธฐเน€เธ เธ—เธชเธกเธธเธเนเธเธฃ <span style={{ color: '#EF4444' }}>*</span>\r\n                </label>\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '8px' }}>\r\n                    {PLANTS.map(p => (\r\n                        <button\r\n                            key={p.id}\r\n                            onClick={() => setPlant(p.id)}\r\n                            style={{\r\n                                padding: '12px', borderRadius: '10px', cursor: 'pointer',\r\n                                border: plant === p.id ? `2px solid ${t.accent}` : `1px solid ${t.border}`,\r\n                                background: plant === p.id ? `${t.accent}15` : 'transparent',\r\n                                color: t.text, fontSize: '13px', textAlign: 'center'\r\n                            }}\r\n                        >\r\n                            <span style={{ fontSize: '20px', display: 'block', marginBottom: '4px' }}>{p.emoji}</span>\r\n                            {p.label}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Objective Selection */}\r\n            <div>\r\n                <label style={{ display: 'block', fontSize: '14px', fontWeight: 600, color: t.text, marginBottom: '12px' }}>\r\n                    2. เธงเธฑเธ•เธ–เธธเธเธฃเธฐเธชเธเธเนเธเธฒเธฃเธเธฅเธดเธ• <span style={{ color: '#EF4444' }}>*</span>\r\n                </label>\r\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>\r\n                    {config?.objectives.map(obj => (\r\n                        <label\r\n                            key={obj.id}\r\n                            style={{\r\n                                display: 'flex', alignItems: 'center', gap: '12px',\r\n                                padding: '12px 16px', borderRadius: '10px', cursor: 'pointer',\r\n                                border: objective === obj.id ? `2px solid ${t.accent}` : `1px solid ${t.border}`,\r\n                                background: objective === obj.id ? `${t.accent}15` : 'transparent'\r\n                            }}\r\n                        >\r\n                            <input\r\n                                type=\"radio\"\r\n                                name=\"objective\"\r\n                                value={obj.id}\r\n                                checked={objective === obj.id}\r\n                                onChange={() => setObjective(obj.id)}\r\n                                style={{ accentColor: t.accent }}\r\n                            />\r\n                            <span style={{ color: t.text, fontSize: '14px' }}>{obj.label}</span>\r\n                            <span style={{ color: t.textMuted, fontSize: '12px' }}>({obj.labelEn})</span>\r\n                        </label>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Area Type Selection (Multi-select) */}\r\n            <div>\r\n                <label style={{ display: 'block', fontSize: '14px', fontWeight: 600, color: t.text, marginBottom: '8px' }}>\r\n                    3. เธฅเธฑเธเธฉเธ“เธฐเธเธทเนเธเธ—เธตเน <span style={{ color: '#EF4444' }}>*</span>\r\n                    <span style={{ fontWeight: 400, fontSize: '12px', color: t.textMuted, marginLeft: '8px' }}>\r\n                        (เน€เธฅเธทเธญเธเนเธ”เนเธซเธฅเธฒเธขเธฃเธฒเธขเธเธฒเธฃ, เธเธดเธ” 5,000 เธเธฒเธ—/เธเธฃเธฐเน€เธ เธ—)\r\n                    </span>\r\n                </label>\r\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>\r\n                    {config?.areaTypes.map(area => (\r\n                        <label\r\n                            key={area.id}\r\n                            style={{\r\n                                display: 'flex', alignItems: 'center', gap: '12px',\r\n                                padding: '12px 16px', borderRadius: '10px', cursor: 'pointer',\r\n                                border: areaTypes.includes(area.id) ? `2px solid ${t.success}` : `1px solid ${t.border}`,\r\n                                background: areaTypes.includes(area.id) ? `${t.success}15` : 'transparent'\r\n                            }}\r\n                        >\r\n                            <input\r\n                                type=\"checkbox\"\r\n                                checked={areaTypes.includes(area.id)}\r\n                                onChange={() => toggleArea(area.id)}\r\n                                style={{ accentColor: t.success, width: '18px', height: '18px' }}\r\n                            />\r\n                            <span style={{ color: t.text, fontSize: '14px' }}>{area.label}</span>\r\n                            <span style={{ color: t.textMuted, fontSize: '12px' }}>({area.labelEn})</span>\r\n                            {areaTypes.includes(area.id) && (\r\n                                <span style={{ marginLeft: 'auto', fontSize: '12px', color: t.success, fontWeight: 600 }}>\r\n                                    +5,000 เธฟ\r\n                                </span>\r\n                            )}\r\n                        </label>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Fee Preview */}\r\n            {fee && !fee.requiresTeamReview && (\r\n                <div style={{\r\n                    padding: '16px', borderRadius: '12px',\r\n                    background: `linear-gradient(135deg, ${t.accent}10, ${t.accentLight}10)`,\r\n                    border: `1px solid ${t.accent}30`\r\n                }}>\r\n                    <div style={{ fontSize: '14px', fontWeight: 600, color: t.text, marginBottom: '12px' }}>\r\n                        เธชเธฃเธธเธเธเนเธฒเธเธฃเธฃเธกเน€เธเธตเธขเธก\r\n                    </div>\r\n\r\n                    {fee.items.map((item, idx) => (\r\n                        <div key={idx} style={{\r\n                            display: 'flex', justifyContent: 'space-between',\r\n                            fontSize: '13px', color: t.textSecondary, marginBottom: '8px'\r\n                        }}>\r\n                            <span>{item.description}</span>\r\n                            <span>{item.total.toLocaleString()} เธฟ</span>\r\n                        </div>\r\n                    ))}\r\n\r\n                    <div style={{\r\n                        borderTop: `1px solid ${t.border}`, paddingTop: '12px', marginTop: '8px',\r\n                        display: 'flex', justifyContent: 'space-between'\r\n                    }}>\r\n                        <span style={{ fontSize: '16px', fontWeight: 700, color: t.text }}>เธฃเธงเธกเธ—เธฑเนเธเธชเธดเนเธ</span>\r\n                        <span style={{ fontSize: '20px', fontWeight: 700, color: t.accent }}>\r\n                            {fee.total.toLocaleString()} เธฟ\r\n                        </span>\r\n                    </div>\r\n                    <div style={{ fontSize: '12px', color: t.textMuted, textAlign: 'right', marginTop: '4px' }}>\r\n                        ({fee.totalText})\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {fee?.requiresTeamReview && (\r\n                <div style={{\r\n                    padding: '16px', borderRadius: '12px',\r\n                    background: '#FEF3C7', border: '1px solid #F59E0B'\r\n                }}>\r\n                    <div style={{ fontSize: '14px', color: '#92400E' }}>\r\n                        {fee.message || 'เธ—เธตเธกเธเธฒเธเธเธฐเธเธฃเธฐเน€เธกเธดเธเนเธฅเธฐเธชเนเธเนเธเน€เธชเธเธญเธฃเธฒเธเธฒเนเธซเนเธ เธฒเธขเธซเธฅเธฑเธ'}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\features\\permit-form\\components\\documents\\invoice-document.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'invoicePhase' is defined but never used.","line":45,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useRef } from \"react\";\r\nimport { useInvoice, DEFAULT_FEES } from \"@/hooks/use-pricing\";\r\n\r\ninterface InvoiceDocumentProps {\r\n    invoiceNumber: string;\r\n    invoiceDate: string;\r\n    quotationReference: string;\r\n    applicantName: string;\r\n    applicantCompany?: string;\r\n    applicantTaxId?: string;\r\n    applicantAddress: string;\r\n    applicantPhone?: string;\r\n    invoicePhase: 1 | 2;  // เธเธงเธ” 1 = 5,000 เธเธฒเธ—, เธเธงเธ” 2 = 25,000 เธเธฒเธ—\r\n    items: Array<{\r\n        description: string;\r\n        quantity: number;\r\n        unitPrice: number;\r\n    }>;\r\n    totalAmount: number;\r\n    totalAmountText: string;\r\n    officerName?: string;\r\n    officerPosition?: string;\r\n}\r\n\r\n// DTAM Official Colors\r\nconst colors = {\r\n    headerBg: \"#4472C4\",\r\n    headerText: \"#FFFFFF\",\r\n    tableBorder: \"#000000\",\r\n    tableHeaderBg: \"#808080\",\r\n    text: \"#000000\",\r\n};\r\n\r\nexport default function InvoiceDocument({\r\n    invoiceNumber,\r\n    invoiceDate,\r\n    quotationReference,\r\n    applicantName,\r\n    applicantCompany,\r\n    applicantTaxId,\r\n    applicantAddress,\r\n    applicantPhone,\r\n    invoicePhase,\r\n    items,\r\n    totalAmount,\r\n    totalAmountText,\r\n    officerName = \"เธเธฒเธขเธฃเธเธ• เนเธกเธเธเธฑเธเธเธธเน\",\r\n    officerPosition = \"เธเธฑเธเธงเธดเธเธฒเธเธฒเธฃเธชเธฒเธเธฒเธฃเธ“เธชเธธเธ\",\r\n}: InvoiceDocumentProps) {\r\n    const documentRef = useRef<HTMLDivElement>(null);\r\n\r\n    const formatAmount = (amount: number) => {\r\n        return new Intl.NumberFormat('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(amount);\r\n    };\r\n\r\n    const handlePrint = () => {\r\n        window.print();\r\n    };\r\n\r\n    return (\r\n        <div style={{ backgroundColor: \"#F5F5F5\", padding: \"24px\", minHeight: \"100vh\" }}>\r\n            {/* Print Button */}\r\n            <div style={{ maxWidth: \"210mm\", margin: \"0 auto 16px\", display: \"flex\", justifyContent: \"flex-end\", gap: \"12px\" }}>\r\n                <button\r\n                    onClick={handlePrint}\r\n                    style={{\r\n                        padding: \"12px 24px\", backgroundColor: \"#34C759\", color: \"#FFF\",\r\n                        border: \"none\", borderRadius: \"8px\", fontSize: \"14px\", fontWeight: 600, cursor: \"pointer\"\r\n                    }}\r\n                >\r\n                    เธเธดเธกเธเนเน€เธญเธเธชเธฒเธฃ / เธ”เธฒเธงเธเนเนเธซเธฅเธ” PDF\r\n                </button>\r\n            </div>\r\n\r\n            {/* Document */}\r\n            <div\r\n                ref={documentRef}\r\n                id=\"invoice-document\"\r\n                style={{\r\n                    width: \"210mm\",\r\n                    minHeight: \"297mm\",\r\n                    margin: \"0 auto\",\r\n                    backgroundColor: \"#FFFFFF\",\r\n                    padding: \"20mm\",\r\n                    boxShadow: \"0 4px 20px rgba(0,0,0,0.1)\",\r\n                    fontFamily: \"'Sarabun', 'TH Sarabun New', sans-serif\",\r\n                    fontSize: \"14pt\",\r\n                    lineHeight: 1.4,\r\n                    color: colors.text,\r\n                }}\r\n            >\r\n                {/* Header */}\r\n                <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"flex-start\", marginBottom: \"16px\" }}>\r\n                    {/* Left: Logo + Department Info */}\r\n                    <div style={{ display: \"flex\", gap: \"12px\" }}>\r\n                        <div style={{ width: \"60px\", height: \"60px\", borderRadius: \"50%\", border: \"2px solid #000\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\", fontSize: \"10px\", textAlign: \"center\" }}>\r\n                            เธเธฃเธกเธเธฒเธฃ<br />เนเธเธ—เธขเน<br />เนเธเธเนเธ—เธขเธฏ\r\n                        </div>\r\n                        <div style={{ fontSize: \"12pt\" }}>\r\n                            <div style={{ fontWeight: 700, fontSize: \"14pt\" }}>เธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน</div>\r\n                            <div>เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</div>\r\n                            <div style={{ fontSize: \"11pt\" }}>88/23 เธซเธกเธนเน 4 เธ–เธเธเธ•เธดเธงเธฒเธเธเธ—เน เธ•.เธ•เธฅเธฒเธ”เธเธงเธฑเธ เธญ.เน€เธกเธทเธญเธ เธ.เธเธเธ—เธเธธเธฃเธต 11000</div>\r\n                            <div style={{ fontSize: \"11pt\" }}>เนเธ—เธฃเธจเธฑเธเธ—เน (02) 5647889 เธซเธฃเธทเธญ 061-4219701 เธญเธตเน€เธกเธฅ tdc.cannabis.gacp@gmail.com</div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Right: Document Type Badge */}\r\n                    <div style={{ backgroundColor: colors.headerBg, color: colors.headerText, padding: \"8px 20px\", fontWeight: 700, fontSize: \"16pt\" }}>\r\n                        เนเธเธงเธฒเธเธเธดเธฅ/เนเธเนเธเนเธเธซเธเธตเน\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Document Info */}\r\n                <div style={{ display: \"flex\", justifyContent: \"flex-end\", marginBottom: \"16px\" }}>\r\n                    <div style={{ textAlign: \"right\", fontSize: \"12pt\" }}>\r\n                        <div>เธ—เธตเนเธง. 18 เธเธฑเธเธงเธฒเธเธก 2568</div>\r\n                        <div>เน€เธฅเธเธ—เธตเนเน€เธญเธเธชเธฒเธฃ: <strong>{invoiceNumber}</strong></div>\r\n                        <div>เธงเธฑเธเธ—เธตเน: <strong>{invoiceDate}</strong></div>\r\n                        <div>เน€เธฅเธเน€เธชเธเธญเธฃเธฒเธเธฒเน€เธฅเธเธ—เธตเน: <strong>{quotationReference}</strong></div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Applicant Info */}\r\n                <div style={{ marginBottom: \"16px\", fontSize: \"12pt\" }}>\r\n                    <div><strong>เน€เธฃเธตเธขเธ</strong> {applicantName}</div>\r\n                    {applicantCompany && <div><strong>เธซเธเนเธงเธขเธเธฒเธ/เธเธนเนเธฃเธฑเธเธเธฃเธดเธเธฒเธฃ:</strong> {applicantCompany}</div>}\r\n                    {applicantTaxId && <div><strong>เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธต:</strong> {applicantTaxId}</div>}\r\n                    <div><strong>เธ—เธตเนเธญเธขเธนเน:</strong> {applicantAddress}</div>\r\n                    {applicantPhone && <div><strong>เธเธนเนเธเธฃเธฐเธชเธฒเธเธเธฒเธ:</strong> {applicantPhone}</div>}\r\n                </div>\r\n\r\n                {/* Description */}\r\n                <div style={{ marginBottom: \"16px\", fontSize: \"12pt\" }}>\r\n                    <p>\r\n                        เธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเนเธเธญเธชเนเธเนเธเธงเธฒเธเธเธดเธฅ/เนเธเนเธเนเธเธซเธเธตเน เธ”เธฑเธเธฃเธฒเธขเธเธฒเธฃเธ•เนเธญเนเธเธเธตเน\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Items Table */}\r\n                <table style={{ width: \"100%\", borderCollapse: \"collapse\", marginBottom: \"16px\", fontSize: \"12pt\" }}>\r\n                    <thead>\r\n                        <tr style={{ backgroundColor: colors.tableHeaderBg, color: \"#FFF\" }}>\r\n                            <th style={{ border: \"1px solid #000\", padding: \"8px\", width: \"8%\", textAlign: \"center\" }}>เธฅเธณเธ”เธฑเธเธ—เธตเน</th>\r\n                            <th style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"center\" }}>เธฃเธฒเธขเธเธฒเธฃ</th>\r\n                            <th style={{ border: \"1px solid #000\", padding: \"8px\", width: \"12%\", textAlign: \"center\" }}>เธเธณเธเธงเธ</th>\r\n                            <th style={{ border: \"1px solid #000\", padding: \"8px\", width: \"12%\", textAlign: \"center\" }}>เธซเธเนเธงเธข</th>\r\n                            <th style={{ border: \"1px solid #000\", padding: \"8px\", width: \"15%\", textAlign: \"center\" }}>เธฃเธฒเธเธฒ/<br />เธซเธเนเธงเธข</th>\r\n                            <th style={{ border: \"1px solid #000\", padding: \"8px\", width: \"15%\", textAlign: \"center\" }}>เธเธณเธเธงเธเน€เธเธดเธ<br />(เธเธฒเธ—)</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {items.map((item, index) => (\r\n                            <tr key={index}>\r\n                                <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"center\" }}>{index + 1}.</td>\r\n                                <td style={{ border: \"1px solid #000\", padding: \"8px\" }}>{item.description}</td>\r\n                                <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"center\" }}>{item.quantity}</td>\r\n                                <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"center\" }}>เธ•เนเธญเธเธณเธเธญ</td>\r\n                                <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"right\" }}>{formatAmount(item.unitPrice)}</td>\r\n                                <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"right\" }}>{formatAmount(item.quantity * item.unitPrice)}</td>\r\n                            </tr>\r\n                        ))}\r\n                        <tr>\r\n                            <td colSpan={4} style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"center\" }}>\r\n                                ({totalAmountText})\r\n                            </td>\r\n                            <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"center\", fontWeight: 700 }}>เธเธณเธเธงเธเน€เธเธดเธเธ—เธฑเนเธเธชเธดเนเธ</td>\r\n                            <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"right\", fontWeight: 700 }}>{formatAmount(totalAmount)}</td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n\r\n                {/* Payment Instructions */}\r\n                <div style={{ marginBottom: \"24px\", fontSize: \"11pt\", backgroundColor: \"#F9F9F9\", padding: \"16px\", borderRadius: \"4px\" }}>\r\n                    <div style={{ fontWeight: 700, marginBottom: \"8px\" }}>เธซเธกเธฒเธขเน€เธซเธ•เธธ:</div>\r\n                    <div>1. เธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ : เธ เธฒเธขเนเธ 3 เธงเธฑเธ เธซเธฅเธฑเธเนเธ”เนเธฃเธฑเธเนเธเธงเธฒเธเธเธดเธฅ/เนเธเนเธเนเธเธซเธเธตเน</div>\r\n                    <div style={{ marginTop: \"8px\", marginLeft: \"16px\" }}>\r\n                        <strong>เนเธญเธเน€เธเธดเธเน€เธเนเธฒเธเธฑเธเธเธต</strong><br />\r\n                        เธเธทเนเธญเธเธฑเธเธเธต: <strong>เน€เธเธดเธเธเธณเธฃเธธเธเธจเธนเธเธขเนเธเธฑเธ’เธเธฒเธขเธฒเนเธ—เธขเนเธฅเธฐเธชเธกเธธเธเนเธเธฃ</strong><br />\r\n                        เธเธฑเธเธเธตเธเธเธฒเธเธฒเธฃเธเธฃเธธเธเนเธ—เธข เน€เธฅเธเธ—เธตเน <strong>4750134376</strong> เธชเธฒเธเธฒเธกเธซเธฒเธงเธดเธ—เธขเธฒเธฅเธฑเธขเธเธฃเธฃเธกเธจเธฒเธชเธ•เธฃเน เธฃเธฑเธเธชเธดเธ•<br />\r\n                        เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธต <strong>0994000036540</strong>\r\n                    </div>\r\n                    <div style={{ marginTop: \"12px\", color: \"#D32F2F\" }}>\r\n                        <strong>เธเธฃเธ“เธตเธ—เธณเน€เธเนเธเธชเธฑเนเธเธเนเธฒเธขเนเธเธเธฒเธก:</strong> เน€เธเธดเธเธเธณเธฃเธธเธเธจเธนเธเธขเนเธเธฑเธ’เธเธฒเธขเธฒเนเธ—เธขเนเธฅเธฐเธชเธกเธธเธเนเธเธฃ\r\n                    </div>\r\n                    <div style={{ marginTop: \"8px\" }}>\r\n                        2. เธเธทเนเธญ-เธ—เธตเนเธญเธขเธนเนเนเธเธเธฒเธฃเธญเธญเธเนเธเน€เธชเธฃเนเธเธฃเธฑเธเน€เธเธดเธ เนเธฅเธฐเธเธฒเธฃเธชเนเธเธซเธฅเธฑเธเธเธฒเธเธเธณเธฃเธฐเน€เธเธดเธ :<br />\r\n                        เน€เธกเธทเนเธญเธเธณเธฃเธฐเน€เธเธดเธเนเธฅเนเธงเธเธฃเธธเธ“เธฒเธชเนเธ เธเธทเนเธญ-เธ—เธตเนเธญเธขเธนเนเนเธเธเธฒเธฃเธญเธญเธเนเธเน€เธชเธฃเนเธ เธเธฃเนเธญเธกเนเธเธเน€เธญเธเธชเธฒเธฃเธซเธฅเธฑเธเธเธฒเธเธเธณเธฃเธฐเน€เธเธดเธ<br />\r\n                        เธกเธฒเธขเธฑเธ เธเธญเธเธเธฑเธ’เธเธฒเธขเธฒเนเธเธเนเธ—เธขเนเธฅเธฐเธชเธกเธธเธเนเธเธฃ เธ—เธฒเธ Google Form\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Signatures */}\r\n                <div style={{ display: \"flex\", justifyContent: \"space-between\", marginTop: \"40px\", fontSize: \"12pt\" }}>\r\n                    {/* Left: Receiver Signature */}\r\n                    <div style={{ width: \"30%\", textAlign: \"center\" }}>\r\n                        <div style={{ fontWeight: 700, marginBottom: \"8px\" }}>เธเธนเนเธฃเธฑเธเธเธฃเธดเธเธฒเธฃ</div>\r\n                        <div style={{ marginTop: \"40px\" }}>\r\n                            <div>.............................................</div>\r\n                            <div>(............................................)</div>\r\n                            <div>เธ•เธณเนเธซเธเนเธ............................</div>\r\n                            <div>เธงเธฑเธเธ—เธตเน........../............./.............</div>\r\n                            <div>{applicantCompany}</div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Center: DTAM Officer Signature */}\r\n                    <div style={{ width: \"30%\", textAlign: \"center\" }}>\r\n                        <div style={{ fontWeight: 700, marginBottom: \"8px\" }}>เธเธนเนเนเธซเนเธเธฃเธดเธเธฒเธฃ</div>\r\n                        <div style={{ marginTop: \"40px\" }}>\r\n                            <div>.............................................</div>\r\n                            <div>( {officerName} )</div>\r\n                            <div>เธ•เธณเนเธซเธเนเธ {officerPosition}</div>\r\n                            <div>เธงเธฑเธเธ—เธตเน........../............./.............</div>\r\n                            <div>เธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน</div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Right: Director Signature */}\r\n                    <div style={{ width: \"30%\", textAlign: \"center\" }}>\r\n                        <div style={{ fontWeight: 700, marginBottom: \"8px\" }}>เธเธนเนเธกเธตเธญเธณเธเธฒเธเธฅเธเธเธฒเธก</div>\r\n                        <div style={{ marginTop: \"40px\" }}>\r\n                            <div>.............................................</div>\r\n                            <div>( เธเธฒเธขเธเธฃเธตเธเธฒ เธซเธเธนเธ—เธดเธก )</div>\r\n                            <div>เธ•เธณเนเธซเธเนเธ เธเธนเนเธญเธณเธเธงเธขเธเธฒเธฃเธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน</div>\r\n                            <div>เธเธเธดเธเธฑเธ•เธดเธฃเธฒเธเธเธฒเธฃเนเธ—เธ เธญเธเธดเธเธ”เธตเธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</div>\r\n                            <div>เธงเธฑเธเธ—เธตเน........../............./.............</div>\r\n                            <div>เธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* QR Code placeholder */}\r\n                <div style={{ marginTop: \"24px\", display: \"flex\", justifyContent: \"flex-end\", alignItems: \"center\", gap: \"12px\" }}>\r\n                    <div style={{ width: \"80px\", height: \"80px\", border: \"2px solid #000\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\", fontSize: \"10px\", textAlign: \"center\" }}>\r\n                        [QR Code<br />PromptPay]\r\n                    </div>\r\n                    <div style={{ fontSize: \"11pt\" }}>เธเธฃเธธเธ“เธฒเธชเนเธเธเธเธดเธงเธญเธฒเธฃเนเนเธเนเธ”</div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Print Styles */}\r\n            <style jsx global>{`\r\n                @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');\r\n                @media print {\r\n                    body * { visibility: hidden; }\r\n                    #invoice-document, #invoice-document * { visibility: visible; }\r\n                    #invoice-document { position: absolute; left: 0; top: 0; width: 210mm; }\r\n                    button { display: none !important; }\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n}\r\n\r\n// Demo with Phase 1 invoice - fetches price from API (One Brain, Many Faces)\r\nexport function InvoiceDocumentDemoPhase1() {\r\n    const { invoice, loading, error } = useInvoice('phase1');\r\n\r\n    // Use API data or fallback\r\n    const amount = invoice?.amount ?? DEFAULT_FEES.applicationFee;\r\n    const description = invoice?.description ?? 'เธเนเธฒเธ•เธฃเธงเธเธชเธญเธเนเธฅเธฐเธเธฃเธฐเน€เธกเธดเธเธเธณเธเธญเธเธฒเธฃเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธเน€เธเธทเนเธญเธเธ•เนเธ';\r\n\r\n    if (loading) {\r\n        return (\r\n            <div style={{ padding: \"40px\", textAlign: \"center\" }}>\r\n                <div>เธเธณเธฅเธฑเธเนเธซเธฅเธ”เธเนเธญเธกเธนเธฅเนเธเนเธเนเธเธซเธเธตเน...</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (error) {\r\n        console.warn('Using fallback prices for Phase 1:', error);\r\n    }\r\n\r\n    return (\r\n        <InvoiceDocument\r\n            invoiceNumber=\"GI-021268017\"\r\n            invoiceDate=\"2 เธเธฑเธเธงเธฒเธเธก 2568\"\r\n            quotationReference=\"G-011268017\"\r\n            applicantName=\"เธเธฃเธฐเธเธฒเธเธเธฃเธฃเธกเธเธฒเธฃ เธเธฃเธดเธฉเธฑเธ— เธชเธกเธธเธ เธเธฃเธนเธง เธเธณเธเธฑเธ”\"\r\n            applicantCompany=\"เธเธฃเธดเธฉเธฑเธ— เธชเธกเธธเธ เธเธฃเธนเธง เธเธณเธเธฑเธ”\"\r\n            applicantTaxId=\"0835566002415\"\r\n            applicantAddress=\"เน€เธฅเธเธ—เธตเน 209/44 เธซเธกเธนเน 5 เธ•.เน€เธเธฒเธฐเนเธเนเธง เธเธฐเธญเธณ เธญ.เธญเธเธญเธฅเธฒเธ เธ.เธซเธกเธนเนเธเธฅเธนเน€เธเธฅเธ• 83110\"\r\n            applicantPhone=\"เธเธธเธ“เธเธธเธเธเธงเธเธฃเธดเธ—เธเธฃเน เธเธงเธเธฃเธต เนเธ—เธฃเธจเธฑเธเธ—เน 0851914649\"\r\n            invoicePhase={1}\r\n            items={[\r\n                { description, quantity: 1, unitPrice: amount },\r\n            ]}\r\n            totalAmount={amount}\r\n            totalAmountText=\"เธซเนเธฒเธเธฑเธเธเธฒเธ—เธ–เนเธงเธ\"\r\n        />\r\n    );\r\n}\r\n\r\n// Demo with Phase 2 invoice - fetches price from API (One Brain, Many Faces)\r\nexport function InvoiceDocumentDemoPhase2() {\r\n    const { invoice, loading, error } = useInvoice('phase2');\r\n\r\n    // Use API data or fallback\r\n    const amount = invoice?.amount ?? DEFAULT_FEES.inspectionFee;\r\n    const description = invoice?.description ?? 'เธเนเธฒเธฃเธฑเธเธฃเธญเธเธเธฅเธเธฒเธฃเธเธฃเธฐเน€เธกเธดเธเนเธฅเธฐเธเธฑเธ”เธ—เธณเธซเธเธฑเธเธชเธทเธญเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธ';\r\n\r\n    if (loading) {\r\n        return (\r\n            <div style={{ padding: \"40px\", textAlign: \"center\" }}>\r\n                <div>เธเธณเธฅเธฑเธเนเธซเธฅเธ”เธเนเธญเธกเธนเธฅเนเธเนเธเนเธเธซเธเธตเน...</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (error) {\r\n        console.warn('Using fallback prices for Phase 2:', error);\r\n    }\r\n\r\n    return (\r\n        <InvoiceDocument\r\n            invoiceNumber=\"GI-021268018\"\r\n            invoiceDate=\"15 เธเธฑเธเธงเธฒเธเธก 2568\"\r\n            quotationReference=\"G-011268017\"\r\n            applicantName=\"เธเธฃเธฐเธเธฒเธเธเธฃเธฃเธกเธเธฒเธฃ เธเธฃเธดเธฉเธฑเธ— เธชเธกเธธเธ เธเธฃเธนเธง เธเธณเธเธฑเธ”\"\r\n            applicantCompany=\"เธเธฃเธดเธฉเธฑเธ— เธชเธกเธธเธ เธเธฃเธนเธง เธเธณเธเธฑเธ”\"\r\n            applicantTaxId=\"0835566002415\"\r\n            applicantAddress=\"เน€เธฅเธเธ—เธตเน 209/44 เธซเธกเธนเน 5 เธ•.เน€เธเธฒเธฐเนเธเนเธง เธเธฐเธญเธณ เธญ.เธญเธเธญเธฅเธฒเธ เธ.เธซเธกเธนเนเธเธฅเธนเน€เธเธฅเธ• 83110\"\r\n            applicantPhone=\"เธเธธเธ“เธเธธเธเธเธงเธเธฃเธดเธ—เธเธฃเน เธเธงเธเธฃเธต เนเธ—เธฃเธจเธฑเธเธ—เน 0851914649\"\r\n            invoicePhase={2}\r\n            items={[\r\n                { description, quantity: 1, unitPrice: amount },\r\n            ]}\r\n            totalAmount={amount}\r\n            totalAmountText=\"เธชเธญเธเธซเธกเธทเนเธเธซเนเธฒเธเธฑเธเธเธฒเธ—เธ–เนเธงเธ\"\r\n        />\r\n    );\r\n}\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\features\\permit-form\\components\\documents\\quotation-document.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DEFAULT_FEES' is defined but never used.","line":4,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":58}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useRef } from \"react\";\r\nimport { usePricing, generateQuotationItems, DEFAULT_FEES } from \"@/hooks/use-pricing\";\r\n\r\ninterface QuotationDocumentProps {\r\n    quotationNumber: string;\r\n    quotationDate: string;\r\n    applicantName: string;\r\n    applicantCompany?: string;\r\n    applicantTaxId?: string;\r\n    applicantAddress: string;\r\n    applicantPhone?: string;\r\n    items: Array<{\r\n        description: string;\r\n        quantity: number;\r\n        unitPrice: number;\r\n    }>;\r\n    totalAmount: number;\r\n    totalAmountText: string;\r\n    officerName?: string;\r\n    officerPosition?: string;\r\n}\r\n\r\n// DTAM Official Colors\r\nconst colors = {\r\n    headerBg: \"#4472C4\",\r\n    headerText: \"#FFFFFF\",\r\n    tableBorder: \"#000000\",\r\n    tableHeaderBg: \"#808080\",\r\n    text: \"#000000\",\r\n};\r\n\r\nexport default function QuotationDocument({\r\n    quotationNumber,\r\n    quotationDate,\r\n    applicantName,\r\n    applicantCompany,\r\n    applicantTaxId,\r\n    applicantAddress,\r\n    applicantPhone,\r\n    items,\r\n    totalAmount,\r\n    totalAmountText,\r\n    officerName = \"เธเธฒเธขเธเธฃเธตเธเธฒ เธซเธเธนเธ—เธดเธก\",\r\n    officerPosition = \"เธเธนเนเธญเธณเธเธงเธขเธเธฒเธฃเธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน\",\r\n}: QuotationDocumentProps) {\r\n    const documentRef = useRef<HTMLDivElement>(null);\r\n\r\n    const formatAmount = (amount: number) => {\r\n        return new Intl.NumberFormat('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(amount);\r\n    };\r\n\r\n    const handlePrint = () => {\r\n        window.print();\r\n    };\r\n\r\n    return (\r\n        <div style={{ backgroundColor: \"#F5F5F5\", padding: \"24px\", minHeight: \"100vh\" }}>\r\n            {/* Print Button */}\r\n            <div style={{ maxWidth: \"210mm\", margin: \"0 auto 16px\", display: \"flex\", justifyContent: \"flex-end\", gap: \"12px\" }}>\r\n                <button\r\n                    onClick={handlePrint}\r\n                    style={{\r\n                        padding: \"12px 24px\", backgroundColor: \"#34C759\", color: \"#FFF\",\r\n                        border: \"none\", borderRadius: \"8px\", fontSize: \"14px\", fontWeight: 600, cursor: \"pointer\"\r\n                    }}\r\n                >\r\n                    เธเธดเธกเธเนเน€เธญเธเธชเธฒเธฃ / เธ”เธฒเธงเธเนเนเธซเธฅเธ” PDF\r\n                </button>\r\n            </div>\r\n\r\n            {/* Document */}\r\n            <div\r\n                ref={documentRef}\r\n                style={{\r\n                    width: \"210mm\",\r\n                    minHeight: \"297mm\",\r\n                    margin: \"0 auto\",\r\n                    backgroundColor: \"#FFFFFF\",\r\n                    padding: \"20mm\",\r\n                    boxShadow: \"0 4px 20px rgba(0,0,0,0.1)\",\r\n                    fontFamily: \"'Sarabun', 'TH Sarabun New', sans-serif\",\r\n                    fontSize: \"14pt\",\r\n                    lineHeight: 1.4,\r\n                    color: colors.text,\r\n                }}\r\n            >\r\n                {/* Header */}\r\n                <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"flex-start\", marginBottom: \"16px\" }}>\r\n                    {/* Left: Logo + Department Info */}\r\n                    <div style={{ display: \"flex\", gap: \"12px\" }}>\r\n                        {/* DTAM Logo placeholder */}\r\n                        <div style={{ width: \"60px\", height: \"60px\", borderRadius: \"50%\", border: \"2px solid #000\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\", fontSize: \"10px\", textAlign: \"center\" }}>\r\n                            เธเธฃเธกเธเธฒเธฃ<br />เนเธเธ—เธขเน<br />เนเธเธเนเธ—เธขเธฏ\r\n                        </div>\r\n                        <div style={{ fontSize: \"12pt\" }}>\r\n                            <div style={{ fontWeight: 700, fontSize: \"14pt\" }}>เธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน</div>\r\n                            <div>เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</div>\r\n                            <div style={{ fontSize: \"11pt\" }}>88/23 เธซเธกเธนเน 4 เธ–เธเธเธ•เธดเธงเธฒเธเธเธ—เน เธ•.เธ•เธฅเธฒเธ”เธเธงเธฑเธ เธญ.เน€เธกเธทเธญเธ เธ.เธเธเธ—เธเธธเธฃเธต 11000</div>\r\n                            <div style={{ fontSize: \"11pt\" }}>เนเธ—เธฃเธจเธฑเธเธ—เน (02) 5647889 เธซเธฃเธทเธญ 061-4219701 เธญเธตเน€เธกเธฅ tdc.cannabis.gacp@gmail.com</div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Right: Document Type Badge */}\r\n                    <div style={{ backgroundColor: colors.headerBg, color: colors.headerText, padding: \"8px 20px\", fontWeight: 700, fontSize: \"16pt\" }}>\r\n                        เนเธเน€เธชเธเธญเธฃเธฒเธเธฒ\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Document Info */}\r\n                <div style={{ display: \"flex\", justifyContent: \"flex-end\", marginBottom: \"16px\" }}>\r\n                    <div style={{ textAlign: \"right\", fontSize: \"12pt\" }}>\r\n                        <div>เธ—เธตเนเธง. 16 เธเธฑเธเธงเธฒเธเธก 2568</div>\r\n                        <div>เน€เธฅเธเธ—เธตเนเน€เธญเธเธชเธฒเธฃ: <strong>{quotationNumber}</strong></div>\r\n                        <div>เธงเธฑเธเธ—เธตเนเน€เธญเธเธชเธฒเธฃ: <strong>{quotationDate}</strong></div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Applicant Info */}\r\n                <div style={{ marginBottom: \"16px\", fontSize: \"12pt\" }}>\r\n                    <div><strong>เน€เธฃเธตเธขเธ</strong> {applicantName}</div>\r\n                    {applicantCompany && <div><strong>เธซเธเนเธงเธขเธเธฒเธ/เธเธนเนเธฃเธฑเธเธเธฃเธดเธเธฒเธฃ:</strong> {applicantCompany}</div>}\r\n                    {applicantTaxId && <div><strong>เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธต:</strong> {applicantTaxId}</div>}\r\n                    <div><strong>เธ—เธตเนเธญเธขเธนเน:</strong> {applicantAddress}</div>\r\n                    {applicantPhone && <div><strong>เธเธนเนเธเธฃเธฐเธชเธฒเธเธเธฒเธ:</strong> {applicantPhone}</div>}\r\n                </div>\r\n\r\n                {/* Description */}\r\n                <div style={{ marginBottom: \"16px\", fontSize: \"12pt\" }}>\r\n                    <p>\r\n                        เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ เนเธ”เธขเธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน\r\n                        เธกเธตเธเธงเธฒเธกเธขเธดเธเธ”เธตเธ—เธตเนเธเธฐเน€เธชเธเธญเธฃเธฒเธเธฒเธเนเธฒเธเธฃเธดเธเธฒเธฃเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธเนเธฅเธฐเธฃเธฑเธเธฃเธญเธเธกเธฒเธ•เธฃเธเธฒเธเธเธฒเธฃเน€เธเธฒเธฐเธเธฅเธนเธเนเธฅเธฐเน€เธเนเธเน€เธเธตเนเธขเธง\r\n                        เธ—เธตเนเธ”เธตเธเธญเธเธเธทเธเธเธฑเธเธเธฒ (Good Agricultural and Collection Practices) เธ”เธฑเธเธฃเธฒเธขเธเธฒเธฃเธ•เนเธญเนเธเธเธตเน\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Items Table */}\r\n                <table style={{ width: \"100%\", borderCollapse: \"collapse\", marginBottom: \"16px\", fontSize: \"12pt\" }}>\r\n                    <thead>\r\n                        <tr style={{ backgroundColor: colors.tableHeaderBg, color: \"#FFF\" }}>\r\n                            <th style={{ border: \"1px solid #000\", padding: \"8px\", width: \"8%\", textAlign: \"center\" }}>เธฅเธณเธ”เธฑเธเธ—เธตเน</th>\r\n                            <th style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"center\" }}>เธฃเธฒเธขเธเธฒเธฃ</th>\r\n                            <th style={{ border: \"1px solid #000\", padding: \"8px\", width: \"12%\", textAlign: \"center\" }}>เธเธณเธเธงเธ</th>\r\n                            <th style={{ border: \"1px solid #000\", padding: \"8px\", width: \"12%\", textAlign: \"center\" }}>เธซเธเนเธงเธข</th>\r\n                            <th style={{ border: \"1px solid #000\", padding: \"8px\", width: \"15%\", textAlign: \"center\" }}>เธฃเธฒเธเธฒ/<br />เธซเธเนเธงเธข</th>\r\n                            <th style={{ border: \"1px solid #000\", padding: \"8px\", width: \"15%\", textAlign: \"center\" }}>เธเธณเธเธงเธเน€เธเธดเธ<br />(เธเธฒเธ—)</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {items.map((item, index) => (\r\n                            <tr key={index}>\r\n                                <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"center\" }}>{index + 1}.</td>\r\n                                <td style={{ border: \"1px solid #000\", padding: \"8px\" }}>{item.description}</td>\r\n                                <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"center\" }}>{item.quantity}</td>\r\n                                <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"center\" }}>เธ•เนเธญเธเธณเธเธญ</td>\r\n                                <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"right\" }}>{formatAmount(item.unitPrice)},-</td>\r\n                                <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"right\" }}>{formatAmount(item.quantity * item.unitPrice)}</td>\r\n                            </tr>\r\n                        ))}\r\n                        <tr>\r\n                            <td colSpan={4} style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"center\" }}>\r\n                                ({totalAmountText})\r\n                            </td>\r\n                            <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"center\", fontWeight: 700 }}>เธเธณเธเธงเธเน€เธเธดเธเธ—เธฑเนเธเธชเธดเนเธ</td>\r\n                            <td style={{ border: \"1px solid #000\", padding: \"8px\", textAlign: \"right\", fontWeight: 700 }}>{formatAmount(totalAmount)},-</td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n\r\n                {/* Verification Note */}\r\n                <div style={{ marginBottom: \"24px\", fontSize: \"11pt\" }}>\r\n                    <p>เธ—เธฑเนเธเธเธตเนเธ—เนเธฒเธเนเธ”เนเธ•เธฃเธงเธเธชเธญเธเธฃเธฒเธขเธเธฒเธฃเธเธณเธเธงเธเนเธฅเธฐเธฃเธฒเธเธฒเธเนเธฒเธเธ•เนเธเน€เธฃเธตเธขเธเธฃเนเธญเธขเนเธฅเนเธง</p>\r\n                </div>\r\n\r\n                {/* Signatures */}\r\n                <div style={{ display: \"flex\", justifyContent: \"space-between\", marginTop: \"40px\", fontSize: \"12pt\" }}>\r\n                    {/* Left: Applicant Signature */}\r\n                    <div style={{ width: \"45%\", textAlign: \"center\" }}>\r\n                        <div style={{ borderTop: \"1px solid #000\", marginBottom: \"8px\", paddingTop: \"8px\" }}>\r\n                            เธขเธทเธเธขเธฑเธเธเธณเธเธญเธฃเธฑเธเธเธฒเธฃเธ•เธฃเธงเธเธชเธญเธเนเธฅเธฐเธเธฃเธฐเน€เธกเธดเธ\r\n                        </div>\r\n                        <div style={{ marginTop: \"40px\" }}>\r\n                            <div>.............................................</div>\r\n                            <div>(...............................................)</div>\r\n                            <div>เธ•เธณเนเธซเธเนเธ..............................................</div>\r\n                            <div>เธงเธฑเธเธ—เธตเน........../............./.............</div>\r\n                            <div style={{ fontWeight: 700, marginTop: \"8px\" }}>เธเธนเนเธญเธเธธเธกเธฑเธ•เธดเธเธณเธเธญ</div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Right: DTAM Officer Signature */}\r\n                    <div style={{ width: \"45%\", textAlign: \"center\" }}>\r\n                        <div style={{ borderTop: \"1px solid #000\", marginBottom: \"8px\", paddingTop: \"8px\" }}>\r\n                            เนเธเธเธฒเธก เธเธญเธเธเธฑเธเธเธฒเธ—เธฒเธเธเธฒเธฃเนเธเธ—เธขเน\r\n                        </div>\r\n                        <div style={{ marginTop: \"40px\" }}>\r\n                            <div>.............................................</div>\r\n                            <div>( {officerName} )</div>\r\n                            <div>เธ•เธณเนเธซเธเนเธ {officerPosition}</div>\r\n                            <div>เธเธเธดเธเธฑเธ•เธดเธฃเธฒเธเธเธฒเธฃเนเธ—เธ เธญเธเธดเธเธ”เธตเธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ</div>\r\n                            <div>เธงเธฑเธเธ—เธตเน........../............./.............</div>\r\n                            <div style={{ fontWeight: 700, marginTop: \"8px\" }}>(เธเธนเนเน€เธชเธเธญเธฃเธฒเธเธฒ)</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Footer Notes */}\r\n                <div style={{ marginTop: \"32px\", fontSize: \"10pt\", borderTop: \"1px solid #ccc\", paddingTop: \"16px\" }}>\r\n                    <div><strong>เธซเธกเธฒเธขเน€เธซเธ•เธธ:</strong> เน€เธเธทเนเธญเธเธเธฒเธ เธเธฃเธดเธเธดเธ•เธญเธฑเธฅ เธชเธกเธธเธ เธงเนเธฒเธเธดเธ เธขเธทเธเธขเธญเธเธชเธฒเธฃเน€เธกเธทเนเธญเธงเธฑเธเธ—เธตเน 6 เธชเธดเธเธซเธฒเธเธก 2568 เธเธถเธเธชเธกเธเธงเธฃเนเธ”เนเธฃเธฑเธเธเธฒเธฃเธญเธเธธเธกเธฑเธ•เธดเธ•เธฃเธฒเธชเธฒเธฃเธเธเธเธฃเธฐเธกเธฒเธ“เน€เธเธดเธ เธเธญเธเธเธฑเธ’เธเธฒเธขเธฒเนเธฅเธฐเธชเธกเธธเธเนเธเธฃ</div>\r\n                    <div>เธ“ เธงเธฑเธเธ—เธตเน 26 เธกเธดเธ–เธธเธเธฒเธขเธ 2568</div>\r\n                    <div style={{ marginTop: \"8px\" }}><strong>เน€เธเธทเนเธญเธเนเธเธเธฒเธฃเธเธณเธฃเธฐเน€เธเธดเธ:</strong> เธเธฃเธธเธ“เธฒเธเธณเธฃเธฐเน€เธเธดเธเธ เธฒเธขเนเธ 3 เธงเธฑเธ</div>\r\n                    <div>เธชเนเธเน€เธญเธเธชเธฒเธฃเธเธธเธ”เธเธณเธเธญเธเนเธฒเธ 2 เธเนเธญเธเธ—เธฒเธ เธ—เธฒเธเนเธเธฃเธฉเธ“เธตเธขเนเธซเธฃเธทเธญเธญเธตเน€เธกเธ—เธตเนเธฃเธฐเธเธธเธ•เธฒเธกเธ”เนเธงเธขเธ—เธฒเธเน€เธญเธ</div>\r\n                    <div><strong>เธเธทเนเธญเธเธฑเธเธเธต:</strong> เน€เธเธดเธเธเธณเธฃเธธเธเธจเธนเธเธขเนเธเธฑเธ’เธเธฒเธขเธฒเนเธ—เธขเนเธฅเธฐเธชเธกเธธเธเนเธเธฃ</div>\r\n                    <div><strong>เธเธฑเธเธเธตเธเธเธฒเธเธฒเธฃเธเธฃเธธเธเนเธ—เธข</strong> เน€เธฅเธเธ—เธตเน 4750134376 เธชเธฒเธเธฒเธกเธซเธฒเธงเธดเธ—เธขเธฒเธฅเธฑเธขเธเธฃเธฃเธกเธจเธฒเธชเธ•เธฃเน เธฃเธฑเธเธชเธดเธ•</div>\r\n                    <div><strong>เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธต:</strong> 0994000036540</div>\r\n                </div>\r\n\r\n                {/* QR Code placeholder */}\r\n                <div style={{ marginTop: \"24px\", display: \"flex\", justifyContent: \"flex-end\", alignItems: \"center\", gap: \"12px\" }}>\r\n                    <div style={{ width: \"80px\", height: \"80px\", border: \"2px solid #000\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\", fontSize: \"10px\", textAlign: \"center\" }}>\r\n                        [QR Code]\r\n                    </div>\r\n                    <div style={{ fontSize: \"11pt\" }}>เธเธฃเธธเธ“เธฒเธชเนเธเธเธเธดเธงเธญเธฒเธฃเนเนเธเนเธ”</div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Print Styles */}\r\n            <style jsx global>{`\r\n                @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');\r\n                @media print {\r\n                    body * { visibility: hidden; }\r\n                    #quotation-document, #quotation-document * { visibility: visible; }\r\n                    #quotation-document { position: absolute; left: 0; top: 0; width: 210mm; }\r\n                    button { display: none !important; }\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n}\r\n\r\n// Demo component that fetches prices from API (One Brain, Many Faces)\r\nexport function QuotationDocumentDemo() {\r\n    const { fees, loading, error } = usePricing();\r\n\r\n    // Use API fees or fallback to defaults\r\n    const items = generateQuotationItems(fees, true); // true = include inspection fee\r\n    const totalAmount = items.reduce((sum, item) => sum + (item.quantity * item.unitPrice), 0);\r\n\r\n    if (loading) {\r\n        return (\r\n            <div style={{ padding: \"40px\", textAlign: \"center\" }}>\r\n                <div>เธเธณเธฅเธฑเธเนเธซเธฅเธ”เธเนเธญเธกเธนเธฅเธฃเธฒเธเธฒ...</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (error) {\r\n        console.warn('Using fallback prices:', error);\r\n    }\r\n\r\n    return (\r\n        <QuotationDocument\r\n            quotationNumber=\"G-011268017\"\r\n            quotationDate=\"1 เธเธฑเธเธงเธฒเธเธก 2568\"\r\n            applicantName=\"เธเธฃเธฐเธเธฒเธเธเธฃเธฃเธกเธเธฒเธฃ เธเธฃเธดเธฉเธฑเธ— เธชเธกเธธเธ เธเธฃเธนเธง เธเธณเธเธฑเธ”\"\r\n            applicantCompany=\"เธเธฃเธดเธฉเธฑเธ— เธชเธกเธธเธ เธเธฃเธนเธง เธเธณเธเธฑเธ”\"\r\n            applicantTaxId=\"0835566002415\"\r\n            applicantAddress=\"เน€เธฅเธเธ—เธตเน 209/44 เธซเธกเธนเน 5 เธ•.เน€เธเธฒเธฐเนเธเนเธง เธเธฐเธญเธณ เธญ.เธญเธเธญเธฅเธฒเธ เธ.เธซเธกเธนเนเธเธฅเธนเน€เธเธฅเธ• 83110\"\r\n            applicantPhone=\"เธเธธเธ“เธเธธเธเธเธงเธเธฃเธดเธ—เธเธฃเน เธเธงเธเธฃเธต เนเธ—เธฃเธจเธฑเธเธ—เน 0851914649\"\r\n            items={items}\r\n            totalAmount={totalAmount}\r\n            totalAmountText=\"เธชเธฒเธกเธซเธกเธทเนเธเธเธฒเธ—เธ–เนเธงเธ\"\r\n        />\r\n    );\r\n}\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\features\\permit-form\\components\\documents\\receipt-document.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\hooks\\use-access.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\hooks\\use-pricing.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\hooks\\useCultivationConfig.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":3,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":51}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { api } from '@/lib/api/api-client';\r\n\r\n/**\r\n * useCultivationConfig Hook\r\n * \r\n * Fetches cultivation configuration from backend API including:\r\n * - Certification purposes (เธงเธฑเธ•เธ–เธธเธเธฃเธฐเธชเธเธเน)\r\n * - Cultivation methods (เธฃเธฐเธเธเธเธฅเธนเธ)\r\n * - Farm layouts (เธฃเธนเธเนเธเธเนเธเธฅเธ)\r\n * - Growing styles (เธฃเธนเธเนเธเธเธเธฅเธนเธ - Indoor)\r\n * - Plant count calculations\r\n * \r\n * @author เธเธฃเธกเธเธฒเธฃเนเธเธ—เธขเนเนเธเธเนเธ—เธขเนเธฅเธฐเธเธฒเธฃเนเธเธ—เธขเนเธ—เธฒเธเน€เธฅเธทเธญเธ (DTAM)\r\n */\r\n\r\n// =====================\r\n// TYPE DEFINITIONS\r\n// =====================\r\n\r\nexport interface CertificationPurpose {\r\n    id: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n    description: string;\r\n    requirements: string[];\r\n    sortOrder: number;\r\n}\r\n\r\nexport interface CultivationMethod {\r\n    id: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n    description: string;\r\n    icon: string;\r\n    pros: string[];\r\n    cons: string[];\r\n    feeMultiplier: number;\r\n    sortOrder: number;\r\n}\r\n\r\nexport interface FarmLayout {\r\n    id: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n    description: string;\r\n    applicableTo: string[];\r\n    plantsPerSqm: number;\r\n    spacingRowCm?: number;\r\n    spacingPlantCm?: number;\r\n    manualPlantCount?: boolean;\r\n    icon: string;\r\n    subTypes?: string[];\r\n}\r\n\r\nexport interface GrowingStyle {\r\n    id: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n    description: string;\r\n    applicableTo: string[];\r\n    plantsPerSqm: number;\r\n    supportsMultipleTiers?: boolean;\r\n    maxTiers?: number;\r\n    icon: string;\r\n}\r\n\r\nexport interface JourneyConfig {\r\n    id: string;\r\n    purpose: string;\r\n    method: string;\r\n    level: string;\r\n    requiredFields: string[];\r\n    documents: DocumentRequirement[];\r\n    security: SecurityRequirement[];\r\n    layouts: FarmLayout[];\r\n    styles?: GrowingStyle[];\r\n}\r\n\r\nexport interface DocumentRequirement {\r\n    id: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n    category: string;\r\n    required: boolean;\r\n}\r\n\r\nexport interface SecurityRequirement {\r\n    id: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n    category: string;\r\n}\r\n\r\nexport interface PlantCalculation {\r\n    input: {\r\n        area: number;\r\n        unit: string;\r\n        layoutId: string;\r\n        styleId?: string;\r\n        tiers?: number;\r\n    };\r\n    areaSqm: number;\r\n    count: number;\r\n    formula: string;\r\n    density: number;\r\n    tiers?: number;\r\n    densitySource?: string;\r\n    manualInput?: boolean;\r\n}\r\n\r\n// =====================\r\n// FALLBACK DATA\r\n// =====================\r\n\r\nconst FALLBACK_PURPOSES: CertificationPurpose[] = [\r\n    { id: 'domestic', nameTH: 'เธเธณเธซเธเนเธฒเธขเนเธเธเธฃเธฐเน€เธ—เธจ', nameEN: 'Domestic Sales (B2B)', description: 'เธเธณเธซเธเนเธฒเธขเนเธซเนเธเธฑเธเธเธนเนเธเธฃเธฐเธเธญเธเธเธฒเธฃเนเธเธเธฃเธฐเน€เธ—เธจ', requirements: ['GACP'], sortOrder: 1 },\r\n    { id: 'export', nameTH: 'เธชเนเธเธญเธญเธ', nameEN: 'Export (International)', description: 'เธชเนเธเธญเธญเธเนเธเธ•เนเธฒเธเธเธฃเธฐเน€เธ—เธจ', requirements: ['GACP_ADVANCED'], sortOrder: 2 },\r\n    { id: 'research', nameTH: 'เธงเธดเธเธฑเธข', nameEN: 'Research', description: 'เธเธฒเธฃเธงเธดเธเธฑเธขเนเธฅเธฐเธเธฑเธ’เธเธฒ', requirements: ['GACP', 'RESEARCH_PROTOCOL'], sortOrder: 3 },\r\n];\r\n\r\nconst FALLBACK_METHODS: CultivationMethod[] = [\r\n    { id: 'outdoor', nameTH: 'เธเธฅเธฒเธเนเธเนเธ', nameEN: 'Outdoor', description: 'เธเธฅเธนเธเนเธเนเธเธฅเธเธเธฅเธฒเธเนเธเนเธ', icon: 'sun', pros: ['เธ•เนเธเธ—เธธเธเธ•เนเธณ'], cons: ['เธเธงเธเธเธธเธกเธขเธฒเธ'], feeMultiplier: 1.0, sortOrder: 1 },\r\n    { id: 'greenhouse', nameTH: 'เนเธฃเธเน€เธฃเธทเธญเธ', nameEN: 'Greenhouse', description: 'เธเธฅเธนเธเนเธเนเธฃเธเน€เธฃเธทเธญเธ', icon: 'home', pros: ['เธเธงเธเธเธธเธกเนเธ”เนเธเธฒเธเธชเนเธงเธ'], cons: ['เธ•เนเธเธ—เธธเธเธชเธนเธเธเธงเนเธฒ'], feeMultiplier: 1.0, sortOrder: 2 },\r\n    { id: 'indoor', nameTH: 'เธฃเธฐเธเธเธเธดเธ”', nameEN: 'Indoor', description: 'เธเธฅเธนเธเนเธเธญเธฒเธเธฒเธฃเธเธดเธ”', icon: 'building', pros: ['เธเธงเธเธเธธเธกเธ—เธธเธเธเธฑเธเธเธฑเธข'], cons: ['เธ•เนเธเธ—เธธเธเธชเธนเธ'], feeMultiplier: 1.0, sortOrder: 3 },\r\n];\r\n\r\n// =====================\r\n// MAIN HOOK\r\n// =====================\r\n\r\nexport function useCultivationConfig() {\r\n    const [purposes, setPurposes] = useState<CertificationPurpose[]>([]);\r\n    const [methods, setMethods] = useState<CultivationMethod[]>([]);\r\n    const [allLayouts, setAllLayouts] = useState<FarmLayout[]>([]);\r\n    const [growingStyles, setGrowingStyles] = useState<GrowingStyle[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    // Fetch all master data on mount\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            try {\r\n                setLoading(true);\r\n                setError(null);\r\n\r\n                // Fetch all endpoints in parallel\r\n                const [purposesRes, methodsRes, layoutsRes, stylesRes] = await Promise.all([\r\n                    api.get<{ data: CertificationPurpose[] }>('/master-data/certification-purposes'),\r\n                    api.get<{ data: CultivationMethod[] }>('/master-data/cultivation-methods'),\r\n                    api.get<{ data: FarmLayout[] }>('/master-data/farm-layouts'),\r\n                    api.get<{ data: GrowingStyle[] }>('/master-data/growing-styles'),\r\n                ]);\r\n\r\n                if (purposesRes.success && purposesRes.data) {\r\n                    setPurposes(purposesRes.data.data || FALLBACK_PURPOSES);\r\n                }\r\n                if (methodsRes.success && methodsRes.data) {\r\n                    setMethods(methodsRes.data.data || FALLBACK_METHODS);\r\n                }\r\n                if (layoutsRes.success && layoutsRes.data) {\r\n                    setAllLayouts(layoutsRes.data.data || []);\r\n                }\r\n                if (stylesRes.success && stylesRes.data) {\r\n                    setGrowingStyles(stylesRes.data.data || []);\r\n                }\r\n            } catch (err) {\r\n                console.error('[useCultivationConfig] Error fetching data:', err);\r\n                setError('เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เนเธซเธฅเธ”เธเนเธญเธกเธนเธฅเธเธฒเธฃเธเธฅเธนเธเนเธ”เน');\r\n                // Use fallback data\r\n                setPurposes(FALLBACK_PURPOSES);\r\n                setMethods(FALLBACK_METHODS);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchData();\r\n    }, []);\r\n\r\n    // Get layouts filtered by cultivation method\r\n    const getLayoutsForMethod = useCallback((methodId: string): FarmLayout[] => {\r\n        return allLayouts.filter(l => l.applicableTo.includes(methodId));\r\n    }, [allLayouts]);\r\n\r\n    // Get growing styles (for indoor only)\r\n    const getGrowingStyles = useCallback((): GrowingStyle[] => {\r\n        return growingStyles;\r\n    }, [growingStyles]);\r\n\r\n    // Fetch journey config for specific purpose and method\r\n    const getJourneyConfig = useCallback(async (purpose: string, method: string): Promise<JourneyConfig | null> => {\r\n        try {\r\n            const response = await api.get<{ data: JourneyConfig }>(`/applications/config/${purpose}/${method}`);\r\n            if (response.success && response.data) {\r\n                return response.data.data;\r\n            }\r\n            return null;\r\n        } catch (err) {\r\n            console.error('[useCultivationConfig] Error fetching journey config:', err);\r\n            return null;\r\n        }\r\n    }, []);\r\n\r\n    // Calculate plant count using API\r\n    const calculatePlantCount = useCallback(async (\r\n        area: number,\r\n        unit: 'Rai' | 'Ngan' | 'Sqm',\r\n        layoutId: string,\r\n        styleId?: string,\r\n        tiers?: number\r\n    ): Promise<PlantCalculation | null> => {\r\n        try {\r\n            const response = await api.post<{ data: PlantCalculation }>('/calculations/plant-count', {\r\n                area,\r\n                unit,\r\n                layoutId,\r\n                styleId,\r\n                tiers,\r\n            });\r\n            if (response.success && response.data) {\r\n                return response.data.data;\r\n            }\r\n            return null;\r\n        } catch (err) {\r\n            console.error('[useCultivationConfig] Error calculating plants:', err);\r\n            return null;\r\n        }\r\n    }, []);\r\n\r\n    // Quick local calculation (fallback)\r\n    const estimatePlantCount = useCallback((\r\n        areaSqm: number,\r\n        layoutId: string,\r\n        styleId?: string,\r\n        tiers: number = 1\r\n    ): { count: number; formula: string } => {\r\n        const layout = allLayouts.find(l => l.id === layoutId);\r\n        if (!layout) {\r\n            return { count: 0, formula: 'เนเธกเนเธเธเธเนเธญเธกเธนเธฅ layout' };\r\n        }\r\n\r\n        if (layout.manualPlantCount) {\r\n            return { count: 0, formula: 'เธเธฃเธธเธ“เธฒเธเธฃเธญเธเธเธณเธเธงเธเธ•เนเธเธ”เนเธงเธขเธ•เธเน€เธญเธ' };\r\n        }\r\n\r\n        let density = layout.plantsPerSqm;\r\n\r\n        // If style provided, use style's density\r\n        if (styleId) {\r\n            const style = growingStyles.find(s => s.id === styleId);\r\n            if (style) {\r\n                density = style.plantsPerSqm;\r\n                if (style.supportsMultipleTiers && tiers > 1) {\r\n                    tiers = Math.min(tiers, style.maxTiers || 5);\r\n                }\r\n            }\r\n        }\r\n\r\n        const count = Math.floor(areaSqm * density * tiers);\r\n        const formula = tiers > 1\r\n            ? `${areaSqm} ใก ร— ${density} เธ•เนเธ/ใก ร— ${tiers} เธเธฑเนเธ = ${count} เธ•เนเธ`\r\n            : `${areaSqm} ใก ร— ${density} เธ•เนเธ/ใก = ${count} เธ•เนเธ`;\r\n\r\n        return { count, formula };\r\n    }, [allLayouts, growingStyles]);\r\n\r\n    // Convert area units to sqm\r\n    const convertToSqm = useCallback((value: number, unit: 'Rai' | 'Ngan' | 'Sqm'): number => {\r\n        switch (unit) {\r\n            case 'Rai': return value * 1600;\r\n            case 'Ngan': return value * 400;\r\n            default: return value;\r\n        }\r\n    }, []);\r\n\r\n    return {\r\n        // State\r\n        loading,\r\n        error,\r\n\r\n        // Master data\r\n        purposes,\r\n        methods,\r\n        allLayouts,\r\n        growingStyles,\r\n\r\n        // Methods\r\n        getLayoutsForMethod,\r\n        getGrowingStyles,\r\n        getJourneyConfig,\r\n        calculatePlantCount,\r\n        estimatePlantCount,\r\n        convertToSqm,\r\n\r\n        // Check if method is indoor (for showing growing styles)\r\n        isIndoorMethod: (methodId: string) => methodId === 'indoor',\r\n    };\r\n}\r\n\r\nexport default useCultivationConfig;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\hooks\\useGACPData.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":199,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":199,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { api } from '@/lib/api/api-client';\r\n\r\n/**\r\n * GACP Data Types from API\r\n */\r\nexport interface GACPCategory {\r\n    id: number;\r\n    nameTH: string;\r\n    nameEN: string;\r\n    steps: number[];\r\n}\r\n\r\nexport interface EnvironmentCheck {\r\n    id: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n    required: boolean;\r\n    gacpCategory: number;\r\n}\r\n\r\nexport interface WaterSource {\r\n    id: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n}\r\n\r\nexport interface SecurityRequirement {\r\n    id: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n    category: string;\r\n}\r\n\r\nexport interface DocumentDef {\r\n    id: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n    category: string;\r\n    required: boolean;\r\n}\r\n\r\nexport interface StepRequirements {\r\n    step: number;\r\n    gacpCategories: GACPCategory[];\r\n    fields: string[];\r\n    requiredDocuments: DocumentDef[];\r\n    optionalDocuments: DocumentDef[];\r\n}\r\n\r\n// Step 5: Plot GACP Data Types\r\nexport interface SoilType {\r\n    id: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n}\r\n\r\nexport interface SeedSource {\r\n    id: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n}\r\n\r\nexport interface IPMMethod {\r\n    id: string;\r\n    nameTH: string;\r\n    nameEN: string;\r\n    description?: string;\r\n}\r\n\r\n/**\r\n * Hook to fetch GACP-specific data from API\r\n * Implements API-First principle for GACP standards\r\n */\r\nexport function useGACPData(stepNumber?: number) {\r\n    // Step 4 data\r\n    const [gacpCategories, setGacpCategories] = useState<GACPCategory[]>([]);\r\n    const [environmentChecklist, setEnvironmentChecklist] = useState<EnvironmentCheck[]>([]);\r\n    const [waterSources, setWaterSources] = useState<WaterSource[]>([]);\r\n    const [securityRequirements, setSecurityRequirements] = useState<SecurityRequirement[]>([]);\r\n    const [stepRequirements, setStepRequirements] = useState<StepRequirements | null>(null);\r\n\r\n    // Step 5 data\r\n    const [soilTypes, setSoilTypes] = useState<SoilType[]>([]);\r\n    const [seedSources, setSeedSources] = useState<SeedSource[]>([]);\r\n    const [ipmMethods, setIpmMethods] = useState<IPMMethod[]>([]);\r\n\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    const fetchGACPCategories = useCallback(async () => {\r\n        try {\r\n            const response = await api.get<{ data: GACPCategory[] }>('/master-data/gacp-categories');\r\n            if (response.success && response.data) {\r\n                setGacpCategories(response.data.data || []);\r\n            }\r\n        } catch (err) {\r\n            console.error('[useGACPData] Error fetching categories:', err);\r\n        }\r\n    }, []);\r\n\r\n    const fetchEnvironmentChecklist = useCallback(async () => {\r\n        try {\r\n            const response = await api.get<{ data: EnvironmentCheck[] }>('/master-data/environment-checklist');\r\n            if (response.success && response.data) {\r\n                setEnvironmentChecklist(response.data.data || []);\r\n            }\r\n        } catch (err) {\r\n            console.error('[useGACPData] Error fetching environment checklist:', err);\r\n        }\r\n    }, []);\r\n\r\n    const fetchWaterSources = useCallback(async () => {\r\n        try {\r\n            const response = await api.get<{ data: WaterSource[] }>('/master-data/water-sources');\r\n            if (response.success && response.data) {\r\n                setWaterSources(response.data.data || []);\r\n            }\r\n        } catch (err) {\r\n            console.error('[useGACPData] Error fetching water sources:', err);\r\n        }\r\n    }, []);\r\n\r\n    const fetchSecurityRequirements = useCallback(async () => {\r\n        try {\r\n            const response = await api.get<{ data: SecurityRequirement[] }>('/master-data/security-requirements');\r\n            if (response.success && response.data) {\r\n                setSecurityRequirements(response.data.data || []);\r\n            }\r\n        } catch (err) {\r\n            console.error('[useGACPData] Error fetching security requirements:', err);\r\n        }\r\n    }, []);\r\n\r\n    const fetchStepRequirements = useCallback(async (step: number) => {\r\n        try {\r\n            const response = await api.get<{ data: StepRequirements }>(`/master-data/step-requirements/${step}`);\r\n            if (response.success && response.data) {\r\n                setStepRequirements(response.data.data || null);\r\n            }\r\n        } catch (err) {\r\n            console.error('[useGACPData] Error fetching step requirements:', err);\r\n        }\r\n    }, []);\r\n\r\n    // Step 5 fetch functions\r\n    const fetchSoilTypes = useCallback(async () => {\r\n        try {\r\n            const response = await api.get<{ data: SoilType[] }>('/master-data/soil-types');\r\n            if (response.success && response.data) {\r\n                setSoilTypes(response.data.data || []);\r\n            }\r\n        } catch (err) {\r\n            console.error('[useGACPData] Error fetching soil types:', err);\r\n        }\r\n    }, []);\r\n\r\n    const fetchSeedSources = useCallback(async () => {\r\n        try {\r\n            const response = await api.get<{ data: SeedSource[] }>('/master-data/seed-sources');\r\n            if (response.success && response.data) {\r\n                setSeedSources(response.data.data || []);\r\n            }\r\n        } catch (err) {\r\n            console.error('[useGACPData] Error fetching seed sources:', err);\r\n        }\r\n    }, []);\r\n\r\n    const fetchIPMMethods = useCallback(async () => {\r\n        try {\r\n            const response = await api.get<{ data: IPMMethod[] }>('/master-data/ipm-methods');\r\n            if (response.success && response.data) {\r\n                setIpmMethods(response.data.data || []);\r\n            }\r\n        } catch (err) {\r\n            console.error('[useGACPData] Error fetching IPM methods:', err);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const fetchAll = async () => {\r\n            setLoading(true);\r\n            try {\r\n                await Promise.all([\r\n                    fetchGACPCategories(),\r\n                    fetchEnvironmentChecklist(),\r\n                    fetchWaterSources(),\r\n                    fetchSecurityRequirements(),\r\n                    fetchSoilTypes(),\r\n                    fetchSeedSources(),\r\n                    fetchIPMMethods(),\r\n                ]);\r\n\r\n                if (stepNumber) {\r\n                    await fetchStepRequirements(stepNumber);\r\n                }\r\n            } catch (err) {\r\n                setError('เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เนเธซเธฅเธ”เธเนเธญเธกเธนเธฅ GACP เนเธ”เน');\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchAll();\r\n    }, [fetchGACPCategories, fetchEnvironmentChecklist, fetchWaterSources, fetchSecurityRequirements, fetchSoilTypes, fetchSeedSources, fetchIPMMethods, fetchStepRequirements, stepNumber]);\r\n\r\n    // Fallback data for offline/error scenarios\r\n    const fallbackEnvironmentChecklist: EnvironmentCheck[] = [\r\n        { id: 'no_waste_dump', nameTH: 'เธเธทเนเธเธ—เธตเนเนเธกเนเน€เธเธขเน€เธเนเธเธ—เธตเนเธ—เธดเนเธเธเธขเธฐ/เธชเธฒเธฃเน€เธเธกเธต', nameEN: 'Not former waste dump', required: true, gacpCategory: 2 },\r\n        { id: 'no_contamination', nameTH: 'เนเธกเนเธญเธขเธนเนเนเธเธฅเนเนเธซเธฅเนเธเธเธเน€เธเธทเนเธญเธ', nameEN: 'Not near contamination', required: true, gacpCategory: 2 },\r\n        { id: 'no_chemicals_3y', nameTH: 'เนเธกเนเน€เธเธขเนเธเนเธชเธฒเธฃเน€เธเธกเธตเน€เธเนเธกเธเนเธเนเธเธเนเธงเธ 3 เธเธต', nameEN: 'No chemicals last 3 years', required: false, gacpCategory: 2 },\r\n        { id: 'suitable_environment', nameTH: 'เธชเธ เธฒเธเนเธงเธ”เธฅเนเธญเธกเน€เธซเธกเธฒเธฐเธชเธก', nameEN: 'Suitable environment', required: true, gacpCategory: 2 },\r\n    ];\r\n\r\n    const fallbackWaterSources: WaterSource[] = [\r\n        { id: 'WELL', nameTH: 'เธเนเธญเธเธฒเธ”เธฒเธฅ', nameEN: 'Well' },\r\n        { id: 'RAIN', nameTH: 'เธเนเธณเธเธ', nameEN: 'Rainwater' },\r\n        { id: 'RIVER', nameTH: 'เนเธกเนเธเนเธณ/เธฅเธณเธเธฅเธญเธ', nameEN: 'River' },\r\n        { id: 'TAP', nameTH: 'เธเนเธณเธเธฃเธฐเธเธฒ', nameEN: 'Tap Water' },\r\n        { id: 'POND', nameTH: 'เธชเธฃเธฐ/เธญเนเธฒเธเน€เธเนเธเธเนเธณ', nameEN: 'Pond' },\r\n    ];\r\n\r\n    const fallbackSecurityRequirements: SecurityRequirement[] = [\r\n        { id: 'fence_2m', nameTH: 'เธฃเธฑเนเธงเธฃเธญเธเธเธญเธเธเธดเธ” เธชเธนเธ 2 เน€เธกเธ•เธฃ', nameEN: 'Fence 2m', category: 'perimeter' },\r\n        { id: 'cctv_entry', nameTH: 'เธเธฅเนเธญเธ CCTV เธ—เธฒเธเน€เธเนเธฒ-เธญเธญเธ', nameEN: 'CCTV Entry', category: 'surveillance' },\r\n        { id: 'cctv_plot', nameTH: 'เธเธฅเนเธญเธ CCTV เนเธเธฅเธเธเธฅเธนเธ', nameEN: 'CCTV Plot', category: 'surveillance' },\r\n        { id: 'access_control', nameTH: 'เธฃเธฐเธเธเธเธงเธเธเธธเธกเธเธฒเธฃเน€เธเนเธฒเธญเธญเธ', nameEN: 'Access Control', category: 'access' },\r\n        { id: 'access_log', nameTH: 'เธเธฑเธเธ—เธถเธเธเธฒเธฃเน€เธเนเธฒเธญเธญเธ', nameEN: 'Access Log', category: 'access' },\r\n        { id: 'warning_signs', nameTH: 'เธเนเธฒเธขเน€เธ•เธทเธญเธ', nameEN: 'Warning Signs', category: 'signage' },\r\n    ];\r\n\r\n    const fallbackSoilTypes: SoilType[] = [\r\n        { id: 'clay', nameTH: 'เธ”เธดเธเน€เธซเธเธตเธขเธง', nameEN: 'Clay' },\r\n        { id: 'loam', nameTH: 'เธ”เธดเธเธฃเนเธงเธ', nameEN: 'Loam' },\r\n        { id: 'sandy', nameTH: 'เธ”เธดเธเธ—เธฃเธฒเธข', nameEN: 'Sandy' },\r\n    ];\r\n\r\n    const fallbackSeedSources: SeedSource[] = [\r\n        { id: 'own', nameTH: 'เน€เธเธฒเธฐเน€เธญเธ', nameEN: 'Self-propagated' },\r\n        { id: 'certified', nameTH: 'เธเธทเนเธญเธเธฒเธเธฃเนเธฒเธเธเธฑเธเธเธธเนเธเธทเธเธฃเธฑเธเธฃเธญเธ', nameEN: 'Certified Seed Shop' },\r\n        { id: 'government', nameTH: 'เธเธฒเธเธซเธเนเธงเธขเธเธฒเธเธฃเธฒเธเธเธฒเธฃ', nameEN: 'Government Agency' },\r\n    ];\r\n\r\n    const fallbackIPMMethods: IPMMethod[] = [\r\n        { id: 'biological', nameTH: 'เธเธฒเธฃเธเธงเธเธเธธเธกเธ—เธฒเธเธเธตเธงเธ เธฒเธ', nameEN: 'Biological Control' },\r\n        { id: 'cultural', nameTH: 'เธเธฒเธฃเธเธฑเธ”เธเธฒเธฃเธ—เธฒเธเน€เธเธ•เธเธฃเธฃเธก', nameEN: 'Cultural Control' },\r\n        { id: 'mechanical', nameTH: 'เธเธฒเธฃเธเธงเธเธเธธเธกเนเธ”เธขเธเธฅ', nameEN: 'Mechanical Control' },\r\n    ];\r\n\r\n    return {\r\n        // Step 4 Data with fallbacks\r\n        gacpCategories: gacpCategories.length > 0 ? gacpCategories : [],\r\n        environmentChecklist: environmentChecklist.length > 0 ? environmentChecklist : fallbackEnvironmentChecklist,\r\n        waterSources: waterSources.length > 0 ? waterSources : fallbackWaterSources,\r\n        securityRequirements: securityRequirements.length > 0 ? securityRequirements : fallbackSecurityRequirements,\r\n        stepRequirements,\r\n\r\n        // Step 5 Data with fallbacks\r\n        soilTypes: soilTypes.length > 0 ? soilTypes : fallbackSoilTypes,\r\n        seedSources: seedSources.length > 0 ? seedSources : fallbackSeedSources,\r\n        ipmMethods: ipmMethods.length > 0 ? ipmMethods : fallbackIPMMethods,\r\n\r\n        // State\r\n        loading,\r\n        error,\r\n\r\n        // Refetch functions\r\n        refetchStepRequirements: fetchStepRequirements,\r\n    };\r\n}\r\n\r\nexport default useGACPData;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\hooks\\useLogin.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\hooks\\useLogin.ts:54:17\n  52 |             try {\n  53 |                 const data = JSON.parse(remembered);\n> 54 |                 setAccountType(data.accountType || \"INDIVIDUAL\");\n     |                 ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  55 |                 setIdentifier(data.identifier || \"\");\n  56 |                 setRememberMe(true);\n  57 |             } catch { }","line":54,"column":17,"nodeType":null,"endLine":54,"endColumn":31}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { formatThaiId } from '@/utils/thai-id-validator';\r\n\r\nexport type LoginState = 'idle' | 'loading' | 'success' | 'error';\r\n\r\nexport interface UseLoginReturn {\r\n    // State\r\n    accountType: string;\r\n    identifier: string;\r\n    password: string;\r\n    showPassword: boolean;\r\n    isLoading: boolean;\r\n    loginState: LoginState;\r\n    error: string;\r\n    rememberMe: boolean;\r\n    capsLockOn: boolean;\r\n\r\n    // Setters\r\n    setAccountType: (type: string) => void;\r\n    setIdentifier: (value: string) => void;\r\n    setPassword: (value: string) => void;\r\n    setShowPassword: (show: boolean) => void;\r\n    setRememberMe: (remember: boolean) => void;\r\n    setCapsLockOn: (isOn: boolean) => void;\r\n\r\n    // Actions\r\n    handleSubmit: (e: React.FormEvent) => Promise<void>;\r\n    formatIdentifier: (value: string) => string;\r\n}\r\n\r\n/**\r\n * useLogin Hook\r\n * ๐ Apple Single Responsibility: Handles all login logic\r\n */\r\nexport function useLogin(): UseLoginReturn {\r\n    const [accountType, setAccountType] = useState(\"INDIVIDUAL\");\r\n    const [identifier, setIdentifier] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [showPassword, setShowPassword] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [loginState, setLoginState] = useState<LoginState>('idle');\r\n    const [error, setError] = useState(\"\");\r\n    const [rememberMe, setRememberMe] = useState(false);\r\n    const [capsLockOn, setCapsLockOn] = useState(false);\r\n\r\n    // Load remembered credentials\r\n    useEffect(() => {\r\n        const remembered = localStorage.getItem(\"remember_login\");\r\n        if (remembered) {\r\n            try {\r\n                const data = JSON.parse(remembered);\r\n                setAccountType(data.accountType || \"INDIVIDUAL\");\r\n                setIdentifier(data.identifier || \"\");\r\n                setRememberMe(true);\r\n            } catch { }\r\n        }\r\n    }, []);\r\n\r\n    const formatIdentifier = (value: string): string => {\r\n        return formatThaiId(value);\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError(\"\");\r\n        setIsLoading(true);\r\n        setLoginState('loading');\r\n\r\n        // Input sanitization\r\n        const cleanIdentifier = identifier.replace(/-/g, \"\").replace(/[<>'\"&]/g, \"\");\r\n        const cleanPassword = password.trim();\r\n\r\n        // Validation\r\n        if (!cleanIdentifier || cleanIdentifier.length < 10) {\r\n            setError(\"เธเธฃเธธเธ“เธฒเธเธฃเธญเธเน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเนเธซเนเธเธฃเธเธ–เนเธงเธ (เธญเธขเนเธฒเธเธเนเธญเธข 10 เธซเธฅเธฑเธ)\");\r\n            setIsLoading(false);\r\n            setLoginState('error');\r\n            return;\r\n        }\r\n        if (!cleanPassword || cleanPassword.length < 8) {\r\n            setError(\"เธฃเธซเธฑเธชเธเนเธฒเธเธ•เนเธญเธเธกเธตเธญเธขเนเธฒเธเธเนเธญเธข 8 เธ•เธฑเธงเธญเธฑเธเธฉเธฃ\");\r\n            setIsLoading(false);\r\n            setLoginState('error');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const controller = new AbortController();\r\n            const timeoutId = setTimeout(() => controller.abort(), 10000);\r\n\r\n            const response = await fetch('/api/auth-farmer/login', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    accountType,\r\n                    identifier: cleanIdentifier,\r\n                    password: cleanPassword,\r\n                }),\r\n                signal: controller.signal,\r\n            });\r\n\r\n            clearTimeout(timeoutId);\r\n            const result = await response.json();\r\n\r\n            if (!result.success) {\r\n                let errorMsg = result.error || 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ';\r\n                if (response.status === 401) {\r\n                    errorMsg = \"เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธซเธฃเธทเธญเธฃเธซเธฑเธชเธเนเธฒเธเนเธกเนเธ–เธนเธเธ•เนเธญเธ เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเธญเธตเธเธเธฃเธฑเนเธ\";\r\n                } else if (response.status === 429) {\r\n                    errorMsg = \"เธกเธตเธเธฒเธฃเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธเธเธดเธ”เธเธฅเธฒเธ”เธซเธฅเธฒเธขเธเธฃเธฑเนเธ เธเธฃเธธเธ“เธฒเธฃเธญ 5 เธเธฒเธ—เธตเนเธฅเนเธงเธฅเธญเธเนเธซเธกเน\";\r\n                } else if (response.status >= 500) {\r\n                    errorMsg = \"เน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเธกเธตเธเธฑเธเธซเธฒเธเธฑเนเธงเธเธฃเธฒเธง เธเธฃเธธเธ“เธฒเธฅเธญเธเนเธซเธกเนเนเธเธญเธตเธเธชเธฑเธเธเธฃเธนเน\";\r\n                }\r\n                setError(errorMsg);\r\n                setIsLoading(false);\r\n                setLoginState('error');\r\n                return;\r\n            }\r\n\r\n            const responseData = result.data?.data || result.data;\r\n            const token = responseData?.tokens?.accessToken || responseData?.token;\r\n\r\n            if (!token) {\r\n                setError(\"เนเธกเนเธเธเธเนเธญเธกเธนเธฅ Token เธเธฒเธเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเน เธเธฃเธธเธ“เธฒเธ•เธดเธ”เธ•เนเธญเธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธ\");\r\n                setIsLoading(false);\r\n                setLoginState('error');\r\n                return;\r\n            }\r\n\r\n            localStorage.setItem(\"user\", JSON.stringify(responseData?.user || {}));\r\n\r\n            if (rememberMe) {\r\n                localStorage.setItem(\"remember_login\", JSON.stringify({ accountType, identifier: cleanIdentifier }));\r\n            } else {\r\n                localStorage.removeItem(\"remember_login\");\r\n            }\r\n\r\n            setIsLoading(false);\r\n            setLoginState('success');\r\n\r\n            setTimeout(() => {\r\n                window.location.href = \"/farmer/dashboard\";\r\n            }, 1500);\r\n\r\n        } catch (err) {\r\n            if (err instanceof Error && err.name === 'AbortError') {\r\n                setError(\"เธเธฒเธฃเน€เธเธทเนเธญเธกเธ•เนเธญเนเธเนเน€เธงเธฅเธฒเธเธฒเธเน€เธเธดเธเนเธ เธเธฃเธธเธ“เธฒเธฅเธญเธเนเธซเธกเนเธญเธตเธเธเธฃเธฑเนเธ\");\r\n            } else {\r\n                setError(\"เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เน€เธเธทเนเธญเธกเธ•เนเธญเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเนเธ”เน เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเธญเธดเธเน€เธ—เธญเธฃเนเน€เธเนเธ•เนเธฅเนเธงเธฅเธญเธเธญเธตเธเธเธฃเธฑเนเธ\");\r\n            }\r\n            setIsLoading(false);\r\n            setLoginState('error');\r\n        }\r\n    };\r\n\r\n    return {\r\n        accountType, identifier, password, showPassword,\r\n        isLoading, loginState, error, rememberMe, capsLockOn,\r\n        setAccountType, setIdentifier, setPassword, setShowPassword,\r\n        setRememberMe, setCapsLockOn,\r\n        handleSubmit, formatIdentifier,\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\hooks\\useMasterData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\hooks\\useRegistration.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":134,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":134,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4951,4954],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4951,4954],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":221,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":221,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8456,8459],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8456,8459],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":228,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":228,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8693,8696],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8693,8696],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useCallback } from 'react';\r\nimport { apiClient as api } from '@/lib/api';\r\n\r\n// Account types\r\nexport const ACCOUNT_TYPES = [\r\n    { type: \"INDIVIDUAL\", label: \"เธเธธเธเธเธฅเธเธฃเธฃเธกเธ”เธฒ\", subtitle: \"เน€เธเธฉเธ•เธฃเธเธฃเธฃเธฒเธขเธขเนเธญเธข\", idLabel: \"เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธ 13 เธซเธฅเธฑเธ\", idHint: \"X-XXXX-XXXXX-XX-X\" },\r\n    { type: \"JURISTIC\", label: \"เธเธดเธ•เธดเธเธธเธเธเธฅ\", subtitle: \"เธเธฃเธดเธฉเธฑเธ— / เธซเนเธฒเธเธซเธธเนเธเธชเนเธงเธ\", idLabel: \"เน€เธฅเธเธ—เธฐเน€เธเธตเธขเธเธเธดเธ•เธดเธเธธเธเธเธฅ\", idHint: \"0-1055-12345-67-8\" },\r\n    { type: \"COMMUNITY_ENTERPRISE\", label: \"เธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ\", subtitle: \"เธเธฅเธธเนเธกเน€เธเธฉเธ•เธฃเธเธฃ\", idLabel: \"เน€เธฅเธเธ—เธฐเน€เธเธตเธขเธเธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธ\", idHint: \"XXXX-XXXX-XXX\" },\r\n];\r\n\r\nexport const STEPS = [\"เธขเธดเธเธขเธญเธก PDPA\", \"เธเธฃเธฐเน€เธ เธ—เธเธฑเธเธเธต\", \"เธขเธทเธเธขเธฑเธเธ•เธฑเธงเธ•เธ\", \"เธเนเธญเธกเธนเธฅเธชเนเธงเธเธ•เธฑเธง\", \"เธ•เธฑเนเธเธฃเธซเธฑเธชเธเนเธฒเธ\"];\r\n\r\nexport interface RegistrationData {\r\n    accountType: string;\r\n    agreedPDPA: boolean;\r\n    identifier: string;\r\n    firstName: string;\r\n    lastName: string;\r\n    phoneNumber: string;\r\n    companyName: string;\r\n    communityName: string;\r\n    password: string;\r\n    confirmPassword: string;\r\n    // Optional fields\r\n    email?: string;\r\n    address?: string;\r\n    province?: string;\r\n}\r\n\r\nexport interface UseRegistrationReturn {\r\n    step: number;\r\n    data: RegistrationData;\r\n    errors: Record<string, string>;\r\n    isLoading: boolean;\r\n    isCheckingId: boolean;\r\n\r\n    setStep: (step: number) => void;\r\n    updateField: (field: keyof RegistrationData, value: string | boolean) => void;\r\n    validateField: (field: string, value: string) => Promise<string>;\r\n    canProceed: () => boolean;\r\n    handleSubmit: () => Promise<boolean>;\r\n    getPasswordStrength: (pwd: string) => { level: number; label: string; color: string };\r\n    validateThaiId: (id: string) => boolean;\r\n}\r\n\r\n/**\r\n * useRegistration Hook\r\n * ๐ Apple Single Responsibility: All registration logic\r\n */\r\nexport function useRegistration(): UseRegistrationReturn {\r\n    const [step, setStep] = useState(0);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [isCheckingId, setIsCheckingId] = useState(false);\r\n    const [errors, setErrors] = useState<Record<string, string>>({});\r\n    const [data, setData] = useState<RegistrationData>({\r\n        accountType: 'INDIVIDUAL',\r\n        agreedPDPA: false,\r\n        identifier: '',\r\n        firstName: '',\r\n        lastName: '',\r\n        phoneNumber: '',\r\n        companyName: '',\r\n        communityName: '',\r\n        password: '',\r\n        confirmPassword: '',\r\n    });\r\n\r\n    const updateField = useCallback((field: keyof RegistrationData, value: string | boolean) => {\r\n        setData(prev => ({ ...prev, [field]: value }));\r\n        // Clear error when field is updated\r\n        if (errors[field]) {\r\n            setErrors(prev => ({ ...prev, [field]: '' }));\r\n        }\r\n    }, [errors]);\r\n\r\n    /**\r\n     * Thai ID Checksum Validation (Modulo 11)\r\n     */\r\n    const validateThaiId = useCallback((id: string): boolean => {\r\n        const cleanId = id.replace(/-/g, '');\r\n        if (cleanId.length !== 13 || !/^\\d+$/.test(cleanId)) return false;\r\n\r\n        let sum = 0;\r\n        for (let i = 0; i < 12; i++) {\r\n            sum += parseInt(cleanId[i]) * (13 - i);\r\n        }\r\n        const checkDigit = (11 - (sum % 11)) % 10;\r\n        return parseInt(cleanId[12]) === checkDigit;\r\n    }, []);\r\n\r\n    /**\r\n     * Password Strength Calculator\r\n     */\r\n    const getPasswordStrength = useCallback((pwd: string) => {\r\n        let score = 0;\r\n        if (pwd.length >= 8) score++;\r\n        if (pwd.length >= 12) score++;\r\n        if (/[a-z]/.test(pwd) && /[A-Z]/.test(pwd)) score++;\r\n        if (/\\d/.test(pwd)) score++;\r\n        if (/[^a-zA-Z0-9]/.test(pwd)) score++;\r\n\r\n        const levels = [\r\n            { level: 0, label: \"เธญเนเธญเธเธกเธฒเธ\", color: \"#EF4444\" },\r\n            { level: 1, label: \"เธญเนเธญเธ\", color: \"#F97316\" },\r\n            { level: 2, label: \"เธเธฒเธเธเธฅเธฒเธ\", color: \"#EAB308\" },\r\n            { level: 3, label: \"เนเธเนเธเนเธฃเธ\", color: \"#22C55E\" },\r\n            { level: 4, label: \"เนเธเนเธเนเธฃเธเธกเธฒเธ\", color: \"#16A34A\" },\r\n        ];\r\n\r\n        return levels[Math.min(score, 4)];\r\n    }, []);\r\n\r\n    /**\r\n     * Field Validation with API check\r\n     */\r\n    const validateField = useCallback(async (field: string, value: string): Promise<string> => {\r\n        switch (field) {\r\n            case 'identifier':\r\n                const cleanId = value.replace(/-/g, '');\r\n                if (data.accountType !== 'COMMUNITY_ENTERPRISE') {\r\n                    if (cleanId.length !== 13) return 'เธ•เนเธญเธเธกเธต 13 เธซเธฅเธฑเธ';\r\n                    if (data.accountType === 'INDIVIDUAL' && !validateThaiId(value)) {\r\n                        return 'เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธเนเธกเนเธ–เธนเธเธ•เนเธญเธ';\r\n                    }\r\n                }\r\n                // Check availability via API\r\n                setIsCheckingId(true);\r\n                try {\r\n                    const result = await api.post('/auth/check-identifier', {\r\n                        identifier: cleanId,\r\n                        accountType: data.accountType\r\n                    }) as any;\r\n                    if (result.success && !result.data?.available) {\r\n                        return result.data?.error || 'เธเนเธญเธกเธนเธฅเธเธตเนเธ–เธนเธเธฅเธเธ—เธฐเน€เธเธตเธขเธเนเธฅเนเธง';\r\n                    }\r\n                } catch {\r\n                    // Ignore API errors, continue with form\r\n                } finally {\r\n                    setIsCheckingId(false);\r\n                }\r\n                return '';\r\n\r\n            case 'phoneNumber':\r\n                if (!/^0\\d{9}$/.test(value.replace(/-/g, ''))) {\r\n                    return 'เน€เธเธญเธฃเนเนเธ—เธฃเนเธกเนเธ–เธนเธเธ•เนเธญเธ (10 เธซเธฅเธฑเธ เน€เธฃเธดเนเธกเธ”เนเธงเธข 0)';\r\n                }\r\n                return '';\r\n\r\n            case 'password':\r\n                if (value.length < 8) return 'เธฃเธซเธฑเธชเธเนเธฒเธเธ•เนเธญเธเธกเธตเธญเธขเนเธฒเธเธเนเธญเธข 8 เธ•เธฑเธงเธญเธฑเธเธฉเธฃ';\r\n                if (!/[A-Z]/.test(value)) return 'เธ•เนเธญเธเธกเธตเธ•เธฑเธงเธเธดเธกเธเนเนเธซเธเนเธญเธขเนเธฒเธเธเนเธญเธข 1 เธ•เธฑเธง';\r\n                if (!/[a-z]/.test(value)) return 'เธ•เนเธญเธเธกเธตเธ•เธฑเธงเธเธดเธกเธเนเน€เธฅเนเธเธญเธขเนเธฒเธเธเนเธญเธข 1 เธ•เธฑเธง';\r\n                if (!/\\d/.test(value)) return 'เธ•เนเธญเธเธกเธตเธ•เธฑเธงเน€เธฅเธเธญเธขเนเธฒเธเธเนเธญเธข 1 เธ•เธฑเธง';\r\n                return '';\r\n\r\n            case 'confirmPassword':\r\n                if (value !== data.password) return 'เธฃเธซเธฑเธชเธเนเธฒเธเนเธกเนเธ•เธฃเธเธเธฑเธ';\r\n                return '';\r\n\r\n            default:\r\n                return '';\r\n        }\r\n    }, [data.accountType, data.password, validateThaiId]);\r\n\r\n    /**\r\n     * Check if current step can proceed\r\n     */\r\n    const canProceed = useCallback((): boolean => {\r\n        switch (step) {\r\n            case 0: return data.agreedPDPA;\r\n            case 1: return !!data.accountType;\r\n            case 2: return data.identifier.replace(/-/g, '').length >= 10 && !errors.identifier;\r\n            case 3:\r\n                if (data.accountType === 'INDIVIDUAL') {\r\n                    return !!data.firstName && !!data.lastName && !!data.phoneNumber;\r\n                } else if (data.accountType === 'JURISTIC') {\r\n                    return !!data.companyName && !!data.phoneNumber;\r\n                } else {\r\n                    return !!data.communityName && !!data.phoneNumber;\r\n                }\r\n            case 4:\r\n                return data.password.length >= 8 &&\r\n                    data.password === data.confirmPassword &&\r\n                    !errors.password;\r\n            default: return false;\r\n        }\r\n    }, [step, data, errors]);\r\n\r\n    /**\r\n     * Submit Registration\r\n     */\r\n    const handleSubmit = useCallback(async (): Promise<boolean> => {\r\n        setIsLoading(true);\r\n\r\n        // Sanitize inputs\r\n        const sanitize = (str: string) => str.replace(/[<>'\"&]/g, '');\r\n\r\n        const payload = {\r\n            accountType: data.accountType,\r\n            identifier: data.identifier.replace(/-/g, ''),\r\n            password: data.password,\r\n            phoneNumber: data.phoneNumber.replace(/-/g, ''),\r\n            ...(data.accountType === 'INDIVIDUAL' && {\r\n                firstName: sanitize(data.firstName),\r\n                lastName: sanitize(data.lastName),\r\n                idCard: data.identifier.replace(/-/g, ''),\r\n            }),\r\n            ...(data.accountType === 'JURISTIC' && {\r\n                companyName: sanitize(data.companyName),\r\n                taxId: data.identifier.replace(/-/g, ''),\r\n            }),\r\n            ...(data.accountType === 'COMMUNITY_ENTERPRISE' && {\r\n                communityName: sanitize(data.communityName),\r\n                communityRegistrationNo: data.identifier.replace(/-/g, ''),\r\n            }),\r\n        };\r\n\r\n        try {\r\n            const result = await api.post('/auth/register', payload) as any;\r\n            if (result.success) {\r\n                return true;\r\n            } else {\r\n                setErrors({ submit: result.error || 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”' });\r\n                return false;\r\n            }\r\n        } catch (error: any) {\r\n            setErrors({ submit: error.message || 'เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เน€เธเธทเนเธญเธกเธ•เนเธญเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเนเธ”เน' });\r\n            return false;\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }, [data]);\r\n\r\n    return {\r\n        step, data, errors, isLoading, isCheckingId,\r\n        setStep, updateField, validateField, canProceed,\r\n        handleSubmit, getPasswordStrength, validateThaiId,\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\hooks\\useStaffDashboard.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":114,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3992,3995],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3992,3995],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":122,"column":126,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":129,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4339,4342],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4339,4342],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":124,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4486,4489],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4486,4489],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":152,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5845,5848],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5845,5848],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { apiClient as api } from '@/lib/api';\r\n\r\n// Role labels\r\nexport const ROLE_LABELS: Record<string, { label: string; icon: string }> = {\r\n    REVIEWER_AUDITOR: { label: \"เธเธนเนเธ•เธฃเธงเธเน€เธญเธเธชเธฒเธฃ/เธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ\", icon: \"๐“\" },\r\n    SCHEDULER: { label: \"เธเธนเนเธเธฑเธ”เธ•เธฒเธฃเธฒเธเธเธฑเธ”เธซเธกเธฒเธข\", icon: \"๐“\" },\r\n    ACCOUNTANT: { label: \"เน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธเธฒเธฃเน€เธเธดเธ\", icon: \"๐’ฐ\" },\r\n    ADMIN: { label: \"เธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธ\", icon: \"โ๏ธ\" },\r\n    SUPER_ADMIN: { label: \"เธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธเธชเธนเธเธชเธธเธ”\", icon: \"๐‘‘\" },\r\n    reviewer: { label: \"เธเธนเนเธ•เธฃเธงเธเธชเธญเธ\", icon: \"๐“\" },\r\n    manager: { label: \"เธเธนเนเธเธฑเธ”เธเธฒเธฃ\", icon: \"๐‘”\" },\r\n    inspector: { label: \"เธเธนเนเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ\", icon: \"๐”\" },\r\n};\r\n\r\nexport interface StaffUser {\r\n    id: string;\r\n    email: string;\r\n    firstName?: string;\r\n    lastName?: string;\r\n    role: string;\r\n}\r\n\r\nexport interface PendingItem {\r\n    id: string;\r\n    applicantName: string;\r\n    plantType: string;\r\n    status: string;\r\n    submittedAt: string;\r\n    submissionCount?: number;\r\n    waitTime: string;\r\n}\r\n\r\nexport interface DashboardStats {\r\n    pendingReview: number;\r\n    pendingAudit: number;\r\n    pendingPayment: number;\r\n    completed: number;\r\n}\r\n\r\nexport interface UseStaffDashboardReturn {\r\n    user: StaffUser | null;\r\n    pendingItems: PendingItem[];\r\n    stats: DashboardStats;\r\n    isLoading: boolean;\r\n    error: string | null;\r\n\r\n    fetchData: () => Promise<void>;\r\n    handleLogout: () => Promise<void>;\r\n    getWaitTime: (submittedAt: string) => string;\r\n    getStatusBadge: (status: string) => { bg: string; text: string; label: string };\r\n}\r\n\r\n/**\r\n * useStaffDashboard Hook\r\n * ๐ Apple Single Responsibility: Staff dashboard data management\r\n */\r\nexport function useStaffDashboard(): UseStaffDashboardReturn {\r\n    const router = useRouter();\r\n    const [user, setUser] = useState<StaffUser | null>(null);\r\n    const [pendingItems, setPendingItems] = useState<PendingItem[]>([]);\r\n    const [stats, setStats] = useState<DashboardStats>({\r\n        pendingReview: 0,\r\n        pendingAudit: 0,\r\n        pendingPayment: 0,\r\n        completed: 0,\r\n    });\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    /**\r\n     * Calculate wait time from submission\r\n     */\r\n    const getWaitTime = useCallback((submittedAt: string): string => {\r\n        const submitted = new Date(submittedAt);\r\n        const now = new Date();\r\n        const days = Math.floor((now.getTime() - submitted.getTime()) / (1000 * 60 * 60 * 24));\r\n\r\n        if (days === 0) return \"เธงเธฑเธเธเธตเน\";\r\n        if (days === 1) return \"1 เธงเธฑเธ\";\r\n        if (days < 7) return `${days} เธงเธฑเธ`;\r\n        if (days < 30) return `${Math.floor(days / 7)} เธชเธฑเธเธ”เธฒเธซเน`;\r\n        return `${Math.floor(days / 30)} เน€เธ”เธทเธญเธ`;\r\n    }, []);\r\n\r\n    /**\r\n     * Get status badge styling\r\n     */\r\n    const getStatusBadge = useCallback((status: string) => {\r\n        const badges: Record<string, { bg: string; text: string; label: string }> = {\r\n            SUBMITTED: { bg: \"#FEF3C7\", text: \"#92400E\", label: \"เธฃเธญเธ•เธฃเธงเธเธชเธญเธ\" },\r\n            UNDER_REVIEW: { bg: \"#DBEAFE\", text: \"#1E40AF\", label: \"เธเธณเธฅเธฑเธเธ•เธฃเธงเธ\" },\r\n            PENDING_PAYMENT: { bg: \"#FCE7F3\", text: \"#9D174D\", label: \"เธฃเธญเธเธณเธฃเธฐเน€เธเธดเธ\" },\r\n            PAID: { bg: \"#D1FAE5\", text: \"#065F46\", label: \"เธเธณเธฃเธฐเนเธฅเนเธง\" },\r\n            PENDING_AUDIT: { bg: \"#FED7AA\", text: \"#9A3412\", label: \"เธฃเธญเธ•เธฃเธงเธเธเธฃเธฐเน€เธกเธดเธ\" },\r\n            APPROVED: { bg: \"#D1FAE5\", text: \"#065F46\", label: \"เธญเธเธธเธกเธฑเธ•เธด\" },\r\n            REJECTED: { bg: \"#FEE2E2\", text: \"#991B1B\", label: \"เนเธกเนเธญเธเธธเธกเธฑเธ•เธด\" },\r\n        };\r\n        return badges[status] || { bg: \"#F3F4F6\", text: \"#374151\", label: status };\r\n    }, []);\r\n\r\n    /**\r\n     * Fetch dashboard data\r\n     */\r\n    const fetchData = useCallback(async () => {\r\n        setIsLoading(true);\r\n        setError(null);\r\n\r\n        try {\r\n            // Fetch staff profile\r\n            const userResult = await api.get('/dtam/me') as any;\r\n            if (!userResult.success) {\r\n                router.push('/staff/login');\r\n                return;\r\n            }\r\n            setUser(userResult.data?.user);\r\n\r\n            // Fetch pending applications\r\n            const appsResult = await api.get('/applications?status=SUBMITTED,UNDER_REVIEW,PENDING_PAYMENT,PENDING_AUDIT') as any;\r\n            if (appsResult.success && appsResult.data?.applications) {\r\n                const items = appsResult.data.applications.map((app: any) => ({\r\n                    id: app.applicationNumber || app.id,\r\n                    applicantName: app.farmer?.firstName\r\n                        ? `${app.farmer.firstName} ${app.farmer.lastName || ''}`\r\n                        : app.farmer?.companyName || 'เนเธกเนเธฃเธฐเธเธธ',\r\n                    plantType: app.formData?.plantType || 'เธเธฑเธเธเธ',\r\n                    status: app.status,\r\n                    submittedAt: app.createdAt,\r\n                    submissionCount: app.rejectCount ? app.rejectCount + 1 : 1,\r\n                    waitTime: getWaitTime(app.createdAt),\r\n                }));\r\n                setPendingItems(items);\r\n\r\n                // Calculate stats\r\n                const newStats = {\r\n                    pendingReview: items.filter((i: PendingItem) =>\r\n                        i.status === 'SUBMITTED' || i.status === 'UNDER_REVIEW'\r\n                    ).length,\r\n                    pendingAudit: items.filter((i: PendingItem) =>\r\n                        i.status === 'PENDING_AUDIT'\r\n                    ).length,\r\n                    pendingPayment: items.filter((i: PendingItem) =>\r\n                        i.status === 'PENDING_PAYMENT'\r\n                    ).length,\r\n                    completed: 0, // Would need separate query\r\n                };\r\n                setStats(newStats);\r\n            }\r\n        } catch (err: any) {\r\n            setError(err.message || 'Failed to fetch data');\r\n            if (err.status === 401) {\r\n                router.push('/staff/login');\r\n            }\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }, [router, getWaitTime]);\r\n\r\n    /**\r\n     * Handle logout\r\n     */\r\n    const handleLogout = useCallback(async () => {\r\n        try {\r\n            await api.post('/dtam/logout', {});\r\n        } catch {\r\n            // Ignore logout errors\r\n        }\r\n        document.cookie = 'dtam_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';\r\n        router.push('/staff/login');\r\n    }, [router]);\r\n\r\n    // Initial data fetch\r\n    useEffect(() => {\r\n        fetchData();\r\n    }, [fetchData]);\r\n\r\n    return {\r\n        user, pendingItems, stats, isLoading, error,\r\n        fetchData, handleLogout, getWaitTime, getStatusBadge,\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\api\\api-client.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'timeout' is assigned a value but never used.","line":190,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":190,"endColumn":42},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'body' is assigned a value but never used.","line":190,"column":66,"nodeType":null,"messageId":"unusedVar","endLine":190,"endColumn":70}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * API Client - Centralized HTTP Client with Auth Interceptor\r\n * \r\n * This client fixes \"Broken Chain\" by automatically attaching\r\n * Authorization headers to all requests.\r\n * \r\n * Usage:\r\n *   import { apiClient } from '@/lib/api/api-client';\r\n *   \r\n *   // GET request:\r\n *   const data = await apiClient.get('/api/users/me');\r\n *   \r\n *   // POST request:\r\n *   const result = await apiClient.post('/api/applications', { name: 'test' });\r\n */\r\n\r\nimport { AuthService } from '../services/auth-service';\r\n\r\n// Response types\r\nexport interface ApiResponse<T = unknown> {\r\n    success: boolean;\r\n    data?: T;\r\n    error?: string;\r\n    message?: string;\r\n}\r\n\r\n// Request options\r\ninterface RequestOptions extends Omit<RequestInit, 'body'> {\r\n    body?: unknown;\r\n    skipAuth?: boolean;\r\n    timeout?: number;\r\n}\r\n\r\nclass ApiClient {\r\n    private baseUrl: string;\r\n    private defaultTimeout: number;\r\n\r\n    constructor(baseUrl = '', timeout = 30000) {\r\n        this.baseUrl = baseUrl;\r\n        this.defaultTimeout = timeout;\r\n    }\r\n\r\n    /**\r\n     * Make HTTP request with automatic auth header injection\r\n     */\r\n    private async request<T>(\r\n        endpoint: string,\r\n        options: RequestOptions = {}\r\n    ): Promise<ApiResponse<T>> {\r\n        const { skipAuth = false, timeout = this.defaultTimeout, body, ...init } = options;\r\n\r\n        // Build headers\r\n        const headers: Record<string, string> = {\r\n            'Content-Type': 'application/json',\r\n            ...(init.headers as Record<string, string>),\r\n        };\r\n\r\n        // Fallback: Only attach Authorization header if no httpOnly cookie available\r\n        // Primary auth is via httpOnly cookie (credentials: 'include')\r\n        // This fallback is for mobile apps that don't use cookies\r\n        if (!skipAuth) {\r\n            const token = AuthService.getToken();\r\n            if (token) {\r\n                headers['Authorization'] = `Bearer ${token}`;\r\n            }\r\n        }\r\n\r\n        // Smart Path Handling: Auto-prefix with /api if needed\r\n        let fullEndpoint = endpoint;\r\n        if (!endpoint.startsWith('http')) {\r\n            if (!endpoint.startsWith('/api')) {\r\n                // Prefix with /api for all paths\r\n                fullEndpoint = `/api${endpoint.startsWith('/') ? endpoint : `/${endpoint}`}`;\r\n            }\r\n        }\r\n\r\n        // Build full URL\r\n        const url = fullEndpoint.startsWith('http') ? fullEndpoint : `${this.baseUrl}${fullEndpoint}`;\r\n\r\n        // Setup abort controller for timeout\r\n        const controller = new AbortController();\r\n        const timeoutId = setTimeout(() => controller.abort(), timeout);\r\n\r\n        // Handle FormData (remove Content-Type to let browser set boundary)\r\n        if (body instanceof FormData) {\r\n            delete headers['Content-Type'];\r\n        }\r\n\r\n        try {\r\n            const response = await fetch(url, {\r\n                ...init,\r\n                headers,\r\n                body: body ? (body instanceof FormData ? body : JSON.stringify(body)) : undefined,\r\n                signal: controller.signal,\r\n                credentials: 'include', // ๐” Send httpOnly cookies automatically\r\n            });\r\n\r\n            clearTimeout(timeoutId);\r\n\r\n            // Handle 401 Unauthorized - auto logout\r\n            if (response.status === 401) {\r\n                console.warn('[ApiClient] 401 Received - Session expired');\r\n                AuthService.clearSession();\r\n\r\n                // Redirect to login if in browser\r\n                if (typeof window !== 'undefined') {\r\n                    window.location.href = '/login?expired=true';\r\n                }\r\n\r\n                return {\r\n                    success: false,\r\n                    error: 'Session เธซเธกเธ”เธญเธฒเธขเธธ เธเธฃเธธเธ“เธฒเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธเนเธซเธกเน',\r\n                };\r\n            }\r\n\r\n            // Parse JSON response\r\n            const data = await response.json();\r\n\r\n            // Handle API error responses\r\n            if (!response.ok) {\r\n                return {\r\n                    success: false,\r\n                    error: data.error || data.message || `HTTP Error: ${response.status}`,\r\n                };\r\n            }\r\n\r\n            return {\r\n                success: true,\r\n                data: data.data ?? data,\r\n            };\r\n        } catch (error) {\r\n            clearTimeout(timeoutId);\r\n\r\n            // Handle abort/timeout\r\n            if (error instanceof Error && error.name === 'AbortError') {\r\n                return {\r\n                    success: false,\r\n                    error: 'Request timeout - เธเธฃเธธเธ“เธฒเธฅเธญเธเนเธซเธกเน',\r\n                };\r\n            }\r\n\r\n            // Handle network errors\r\n            console.error('[ApiClient] Request failed:', error);\r\n            return {\r\n                success: false,\r\n                error: 'เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เน€เธเธทเนเธญเธกเธ•เนเธญเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเนเธ”เน',\r\n            };\r\n        }\r\n    }\r\n\r\n    /**\r\n     * GET request\r\n     */\r\n    async get<T>(endpoint: string, options?: RequestOptions): Promise<ApiResponse<T>> {\r\n        return this.request<T>(endpoint, { ...options, method: 'GET' });\r\n    }\r\n\r\n    /**\r\n     * POST request\r\n     */\r\n    async post<T>(endpoint: string, body?: unknown, options?: RequestOptions): Promise<ApiResponse<T>> {\r\n        return this.request<T>(endpoint, { ...options, method: 'POST', body });\r\n    }\r\n\r\n    /**\r\n     * PUT request\r\n     */\r\n    async put<T>(endpoint: string, body?: unknown, options?: RequestOptions): Promise<ApiResponse<T>> {\r\n        return this.request<T>(endpoint, { ...options, method: 'PUT', body });\r\n    }\r\n\r\n    /**\r\n     * PATCH request\r\n     */\r\n    async patch<T>(endpoint: string, body?: unknown, options?: RequestOptions): Promise<ApiResponse<T>> {\r\n        return this.request<T>(endpoint, { ...options, method: 'PATCH', body });\r\n    }\r\n\r\n    /**\r\n     * DELETE request\r\n     */\r\n    async delete<T>(endpoint: string, options?: RequestOptions): Promise<ApiResponse<T>> {\r\n        return this.request<T>(endpoint, { ...options, method: 'DELETE' });\r\n    }\r\n\r\n    /**\r\n     * GET Blob request (for file downloads)\r\n     */\r\n    async getBlob(endpoint: string, options?: RequestOptions): Promise<Blob | null> {\r\n        const { skipAuth = false, timeout = this.defaultTimeout, body, ...init } = options || {};\r\n\r\n        const headers: Record<string, string> = {\r\n            ...(init.headers as Record<string, string>),\r\n        };\r\n\r\n        if (!skipAuth) {\r\n            const token = AuthService.getToken();\r\n            if (token) {\r\n                headers['Authorization'] = `Bearer ${token}`;\r\n            }\r\n        }\r\n\r\n        let fullEndpoint = endpoint;\r\n        if (!endpoint.startsWith('http')) {\r\n            if (!endpoint.startsWith('/api')) {\r\n                fullEndpoint = `/api${endpoint.startsWith('/') ? endpoint : `/${endpoint}`}`;\r\n            }\r\n        }\r\n        const url = fullEndpoint.startsWith('http') ? fullEndpoint : `${this.baseUrl}${fullEndpoint}`;\r\n\r\n        try {\r\n            const response = await fetch(url, {\r\n                ...init,\r\n                method: 'GET',\r\n                headers,\r\n                credentials: 'include',\r\n            });\r\n\r\n            if (!response.ok) return null;\r\n            return await response.blob();\r\n        } catch {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Health check - for backwards compatibility\r\n     */\r\n    async health(): Promise<boolean> {\r\n        try {\r\n            const response = await this.get('/api/health', { skipAuth: true, timeout: 5000 });\r\n            return response.success;\r\n        } catch {\r\n            return false;\r\n        }\r\n    }\r\n}\r\n\r\n// Export singleton instance\r\nexport const apiClient = new ApiClient();\r\n\r\n// Export class for testing or custom instances\r\nexport { ApiClient };\r\nexport const api = apiClient;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\api\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\calendar.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\dal\\applications.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\dal\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\dal\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\dal\\users.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\design-tokens.ts","messages":[{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":93,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":99,"endColumn":3}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Design Tokens - GACP Platform\r\n * Shared color palette and design constants\r\n * Exact match to Mobile App for consistency\r\n */\r\n\r\n// Primary Colors - DTAM/MOPH Green Theme\r\nexport const colors = {\r\n    // Primary\r\n    primary: \"#1B5E20\",\r\n    primaryLight: \"#1B5E2014\",\r\n    primaryDark: \"#0D3A12\",\r\n\r\n    // Backgrounds\r\n    background: \"#F5F7FA\",\r\n    card: \"#FFFFFF\",\r\n    inputBg: \"#FFFFFF\",\r\n\r\n    // Text\r\n    text: \"#1B5E20\",\r\n    textDark: \"#1E293B\",\r\n    textGray: \"#64748B\",\r\n    textLight: \"#94A3B8\",\r\n\r\n    // Borders & Dividers\r\n    border: \"#E0E0E0\",\r\n    borderLight: \"#F0F0F0\",\r\n\r\n    // Status Colors\r\n    success: \"#22C55E\",\r\n    successBg: \"#F0FDF4\",\r\n    warning: \"#F59E0B\",\r\n    warningBg: \"#FFFBEB\",\r\n    warningLight: \"#FEF3C7\",\r\n    error: \"#EF4444\",\r\n    errorBg: \"#FEF2F2\",\r\n    danger: \"#DC2626\",\r\n    info: \"#3B82F6\",\r\n    infoBg: \"#E8F5E9\",\r\n\r\n    // Document Colors\r\n    accent: \"#2E7D32\",\r\n    secondary: \"#4CAF50\",\r\n\r\n};\r\n\r\n// Typography\r\nexport const typography = {\r\n    fontFamily: {\r\n        primary: \"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif\",\r\n        thai: \"'Sarabun', 'Noto Sans Thai', sans-serif\",\r\n    },\r\n    fontSize: {\r\n        xs: \"12px\",\r\n        sm: \"14px\",\r\n        base: \"16px\",\r\n        lg: \"18px\",\r\n        xl: \"20px\",\r\n        \"2xl\": \"24px\",\r\n        \"3xl\": \"30px\",\r\n    },\r\n};\r\n\r\n// Spacing\r\nexport const spacing = {\r\n    xs: \"4px\",\r\n    sm: \"8px\",\r\n    md: \"16px\",\r\n    lg: \"24px\",\r\n    xl: \"32px\",\r\n    \"2xl\": \"48px\",\r\n};\r\n\r\n// Border Radius\r\nexport const borderRadius = {\r\n    sm: \"4px\",\r\n    md: \"8px\",\r\n    lg: \"12px\",\r\n    xl: \"16px\",\r\n    full: \"9999px\",\r\n};\r\n\r\n// Shadows (Liquid Glass Effect)\r\nexport const shadows = {\r\n    sm: \"0 1px 2px rgba(0, 0, 0, 0.05)\",\r\n    md: \"0 4px 6px rgba(0, 0, 0, 0.1)\",\r\n    lg: \"0 10px 15px rgba(0, 0, 0, 0.1)\",\r\n    xl: \"0 20px 25px rgba(0, 0, 0, 0.15)\",\r\n    glass: \"0 8px 32px rgba(27, 94, 32, 0.15)\",\r\n};\r\n\r\n// Default export for convenience\r\nexport default {\r\n    colors,\r\n    typography,\r\n    spacing,\r\n    borderRadius,\r\n    shadows,\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\i18n.ts","messages":[{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":103,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":110,"endColumn":3}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ๐ Apple-Standard i18n Utility\r\n * \r\n * Simple internationalization helper for client-side string loading\r\n * \r\n * Usage:\r\n * import { t, setLocale, getLocale } from '@/lib/i18n';\r\n * const text = t('auth.login'); // Returns \"เน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ\" or \"Login\"\r\n */\r\n\r\ntype Locale = 'th' | 'en';\r\ntype NestedStrings = { [key: string]: string | NestedStrings };\r\n\r\nlet currentLocale: Locale = 'th';\r\nlet translations: NestedStrings = {};\r\n\r\n/**\r\n * Set the current locale\r\n */\r\nexport function setLocale(locale: Locale): void {\r\n    currentLocale = locale;\r\n}\r\n\r\n/**\r\n * Get the current locale\r\n */\r\nexport function getLocale(): Locale {\r\n    return currentLocale;\r\n}\r\n\r\n/**\r\n * Load translations from JSON file\r\n */\r\nexport async function loadTranslations(locale: Locale = currentLocale): Promise<void> {\r\n    try {\r\n        const response = await fetch(`/locales/${locale}/common.json`);\r\n        if (response.ok) {\r\n            translations = await response.json();\r\n            currentLocale = locale;\r\n        }\r\n    } catch (error) {\r\n        console.error(`Failed to load translations for ${locale}:`, error);\r\n    }\r\n}\r\n\r\n/**\r\n * Get translated string by key path\r\n * \r\n * @param key - Dot-separated path (e.g., 'auth.login', 'status.approved')\r\n * @param fallback - Fallback if key not found\r\n * @returns Translated string\r\n */\r\nexport function t(key: string, fallback?: string): string {\r\n    const keys = key.split('.');\r\n    let result: string | NestedStrings = translations;\r\n\r\n    for (const k of keys) {\r\n        if (result && typeof result === 'object' && k in result) {\r\n            result = result[k];\r\n        } else {\r\n            return fallback || key;\r\n        }\r\n    }\r\n\r\n    return typeof result === 'string' ? result : fallback || key;\r\n}\r\n\r\n/**\r\n * Translate with parameters\r\n * \r\n * @param key - Translation key\r\n * @param params - Parameters to replace {0}, {1}, etc.\r\n * @returns Translated string with replaced parameters\r\n */\r\nexport function tp(key: string, ...params: (string | number)[]): string {\r\n    let text = t(key);\r\n\r\n    params.forEach((param, index) => {\r\n        text = text.replace(`{${index}}`, String(param));\r\n    });\r\n\r\n    return text;\r\n}\r\n\r\n/**\r\n * Check if translation exists\r\n */\r\nexport function hasTranslation(key: string): boolean {\r\n    const keys = key.split('.');\r\n    let result: string | NestedStrings = translations;\r\n\r\n    for (const k of keys) {\r\n        if (result && typeof result === 'object' && k in result) {\r\n            result = result[k];\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return typeof result === 'string';\r\n}\r\n\r\nexport default {\r\n    setLocale,\r\n    getLocale,\r\n    loadTranslations,\r\n    t,\r\n    tp,\r\n    hasTranslation,\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\i18n\\LanguageContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'mounted' is assigned a value but never used.","line":21,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":19},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\i18n\\LanguageContext.tsx:24:9\n  22 |\n  23 |     useEffect(() => {\n> 24 |         setMounted(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  25 |         const savedLang = localStorage.getItem('language') as Language;\n  26 |         if (savedLang && (savedLang === 'th' || savedLang === 'en')) {\n  27 |             setLanguageState(savedLang);","line":24,"column":9,"nodeType":null,"endLine":24,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1406,1409],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1406,1409],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport { Dictionary } from './types';\r\nimport { th } from './dictionaries/th';\r\nimport { en } from './dictionaries/en';\r\n\r\nexport type Language = 'th' | 'en';\r\n\r\ninterface LanguageContextType {\r\n    language: Language;\r\n    setLanguage: (lang: Language) => void;\r\n    dict: Dictionary;\r\n    t: (key: string) => string; // Helper for dynamic keys if strictly typed dict is not enough\r\n}\r\n\r\nconst LanguageContext = createContext<LanguageContextType | undefined>(undefined);\r\n\r\nexport function LanguageProvider({ children }: { children: ReactNode }) {\r\n    const [language, setLanguageState] = useState<Language>('th');\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        const savedLang = localStorage.getItem('language') as Language;\r\n        if (savedLang && (savedLang === 'th' || savedLang === 'en')) {\r\n            setLanguageState(savedLang);\r\n        }\r\n    }, []);\r\n\r\n    const setLanguage = (lang: Language) => {\r\n        setLanguageState(lang);\r\n        localStorage.setItem('language', lang);\r\n    };\r\n\r\n    const dict = language === 'en' ? en : th;\r\n\r\n    // Simple nested key retrieval for t(\"settings.title\") style usage\r\n    const t = (path: string): string => {\r\n        const keys = path.split('.');\r\n        let current: any = dict;\r\n\r\n        for (const key of keys) {\r\n            if (current[key] === undefined) {\r\n                // If on server or first render before mount, fallback might be needed but we default to 'th'\r\n                return path;\r\n            }\r\n            current = current[key];\r\n        }\r\n\r\n        return typeof current === 'string' ? current : path;\r\n    };\r\n\r\n    // To prevent hydration mismatch, we could render only after mount, \r\n    // OR we accept that initial render matches server (th) and then client updates.\r\n    // Given 'th' is default, it usually matches. \r\n\r\n    return (\r\n        <LanguageContext.Provider value={{ language, setLanguage, dict, t }}>\r\n            {children}\r\n        </LanguageContext.Provider>\r\n    );\r\n}\r\n\r\nexport function useLanguage() {\r\n    const context = useContext(LanguageContext);\r\n    if (context === undefined) {\r\n        throw new Error('useLanguage must be used within a LanguageProvider');\r\n    }\r\n    return context;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\i18n\\dictionaries\\en.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\i18n\\dictionaries\\th.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\i18n\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\roleUtils.ts","messages":[{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":267,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":280,"endColumn":3}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ๐ Apple-Standard Role-Based Access Control (RBAC)\r\n * \r\n * Centralized role management and permission checking\r\n * DRI Ownership: Single source of truth for all authorization logic\r\n * \r\n * Usage:\r\n * import { hasPermission, isStaff, requireRole } from '@/lib/roleUtils';\r\n */\r\n\r\n// =============================================================================\r\n// ROLE DEFINITIONS\r\n// =============================================================================\r\n\r\nexport const ROLES = {\r\n    // Farmers (External Users)\r\n    FARMER: 'FARMER',\r\n\r\n    // Staff Roles (Internal Users)\r\n    REVIEWER_AUDITOR: 'REVIEWER_AUDITOR',\r\n    SCHEDULER: 'SCHEDULER',\r\n    ACCOUNTANT: 'ACCOUNTANT',\r\n    ADMIN: 'ADMIN',\r\n    SUPER_ADMIN: 'SUPER_ADMIN',\r\n} as const;\r\n\r\nexport type Role = typeof ROLES[keyof typeof ROLES];\r\n\r\n// Staff roles for access control\r\nexport const STAFF_ROLES: Role[] = [\r\n    ROLES.REVIEWER_AUDITOR,\r\n    ROLES.SCHEDULER,\r\n    ROLES.ACCOUNTANT,\r\n    ROLES.ADMIN,\r\n    ROLES.SUPER_ADMIN,\r\n];\r\n\r\n// Admin roles (can manage other staff)\r\nexport const ADMIN_ROLES: Role[] = [\r\n    ROLES.ADMIN,\r\n    ROLES.SUPER_ADMIN,\r\n];\r\n\r\n// =============================================================================\r\n// PERMISSION DEFINITIONS\r\n// =============================================================================\r\n\r\nexport const PERMISSIONS = {\r\n    // Application Management\r\n    VIEW_APPLICATIONS: 'view_applications',\r\n    REVIEW_APPLICATIONS: 'review_applications',\r\n    APPROVE_APPLICATIONS: 'approve_applications',\r\n\r\n    // Scheduling\r\n    VIEW_CALENDAR: 'view_calendar',\r\n    MANAGE_CALENDAR: 'manage_calendar',\r\n    SCHEDULE_AUDITS: 'schedule_audits',\r\n\r\n    // Finance\r\n    VIEW_INVOICES: 'view_invoices',\r\n    CREATE_INVOICES: 'create_invoices',\r\n    CONFIRM_PAYMENTS: 'confirm_payments',\r\n\r\n    // Certificates\r\n    VIEW_CERTIFICATES: 'view_certificates',\r\n    ISSUE_CERTIFICATES: 'issue_certificates',\r\n\r\n    // Reports (เธ .เธ—. 27-29)\r\n    VIEW_REPORTS: 'view_reports',\r\n    EXPORT_REPORTS: 'export_reports',\r\n\r\n    // User Management\r\n    VIEW_USERS: 'view_users',\r\n    MANAGE_USERS: 'manage_users',\r\n    MANAGE_STAFF: 'manage_staff',\r\n\r\n    // System\r\n    VIEW_AUDIT_LOGS: 'view_audit_logs',\r\n    SYSTEM_SETTINGS: 'system_settings',\r\n} as const;\r\n\r\nexport type Permission = typeof PERMISSIONS[keyof typeof PERMISSIONS];\r\n\r\n// =============================================================================\r\n// ROLE-PERMISSION MAPPING\r\n// =============================================================================\r\n\r\nconst ROLE_PERMISSIONS: Record<Role, Permission[]> = {\r\n    [ROLES.FARMER]: [\r\n        PERMISSIONS.VIEW_APPLICATIONS,\r\n        PERMISSIONS.VIEW_INVOICES,\r\n        PERMISSIONS.VIEW_CERTIFICATES,\r\n    ],\r\n\r\n    [ROLES.REVIEWER_AUDITOR]: [\r\n        PERMISSIONS.VIEW_APPLICATIONS,\r\n        PERMISSIONS.REVIEW_APPLICATIONS,\r\n        PERMISSIONS.VIEW_CALENDAR,\r\n        PERMISSIONS.VIEW_CERTIFICATES,\r\n        PERMISSIONS.VIEW_REPORTS,\r\n    ],\r\n\r\n    [ROLES.SCHEDULER]: [\r\n        PERMISSIONS.VIEW_APPLICATIONS,\r\n        PERMISSIONS.VIEW_CALENDAR,\r\n        PERMISSIONS.MANAGE_CALENDAR,\r\n        PERMISSIONS.SCHEDULE_AUDITS,\r\n    ],\r\n\r\n    [ROLES.ACCOUNTANT]: [\r\n        PERMISSIONS.VIEW_APPLICATIONS,\r\n        PERMISSIONS.VIEW_INVOICES,\r\n        PERMISSIONS.CREATE_INVOICES,\r\n        PERMISSIONS.CONFIRM_PAYMENTS,\r\n        PERMISSIONS.VIEW_REPORTS,\r\n        PERMISSIONS.EXPORT_REPORTS,\r\n    ],\r\n\r\n    [ROLES.ADMIN]: [\r\n        ...Object.values(PERMISSIONS).filter(p => p !== PERMISSIONS.SYSTEM_SETTINGS),\r\n    ],\r\n\r\n    [ROLES.SUPER_ADMIN]: [\r\n        ...Object.values(PERMISSIONS),\r\n    ],\r\n};\r\n\r\n// =============================================================================\r\n// UTILITY FUNCTIONS\r\n// =============================================================================\r\n\r\n/**\r\n * Check if a role is a staff role\r\n */\r\nexport function isStaff(role: string): boolean {\r\n    return STAFF_ROLES.includes(role as Role);\r\n}\r\n\r\n/**\r\n * Check if a role is an admin role\r\n */\r\nexport function isAdmin(role: string): boolean {\r\n    return ADMIN_ROLES.includes(role as Role);\r\n}\r\n\r\n/**\r\n * Check if a role has a specific permission\r\n */\r\nexport function hasPermission(role: string, permission: Permission): boolean {\r\n    const rolePermissions = ROLE_PERMISSIONS[role as Role];\r\n    if (!rolePermissions) return false;\r\n    return rolePermissions.includes(permission);\r\n}\r\n\r\n/**\r\n * Get all permissions for a role\r\n */\r\nexport function getPermissions(role: string): Permission[] {\r\n    return ROLE_PERMISSIONS[role as Role] || [];\r\n}\r\n\r\n/**\r\n * Check if role1 can manage role2 (hierarchy check)\r\n */\r\nexport function canManageRole(managerRole: string, targetRole: string): boolean {\r\n    const hierarchy: Record<Role, number> = {\r\n        [ROLES.FARMER]: 0,\r\n        [ROLES.REVIEWER_AUDITOR]: 1,\r\n        [ROLES.SCHEDULER]: 1,\r\n        [ROLES.ACCOUNTANT]: 1,\r\n        [ROLES.ADMIN]: 2,\r\n        [ROLES.SUPER_ADMIN]: 3,\r\n    };\r\n\r\n    const managerLevel = hierarchy[managerRole as Role] ?? -1;\r\n    const targetLevel = hierarchy[targetRole as Role] ?? -1;\r\n\r\n    return managerLevel > targetLevel;\r\n}\r\n\r\n/**\r\n * Get Thai display name for role\r\n */\r\nexport function getRoleDisplayName(role: string): string {\r\n    const names: Record<Role, string> = {\r\n        [ROLES.FARMER]: 'เน€เธเธฉเธ•เธฃเธเธฃ',\r\n        [ROLES.REVIEWER_AUDITOR]: 'เธเธนเนเธ•เธฃเธงเธเธชเธญเธ',\r\n        [ROLES.SCHEDULER]: 'เธเธนเนเธเธฑเธ”เธ•เธฒเธฃเธฒเธเธเธฑเธ”เธซเธกเธฒเธข',\r\n        [ROLES.ACCOUNTANT]: 'เน€เธเนเธฒเธซเธเนเธฒเธ—เธตเนเธเธฒเธฃเน€เธเธดเธ',\r\n        [ROLES.ADMIN]: 'เธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธ',\r\n        [ROLES.SUPER_ADMIN]: 'เธเธนเนเธ”เธนเนเธฅเธฃเธฐเธเธเธชเธนเธเธชเธธเธ”',\r\n    };\r\n    return names[role as Role] || role;\r\n}\r\n\r\n// =============================================================================\r\n// ROUTE PROTECTION HELPERS\r\n// =============================================================================\r\n\r\n/**\r\n * Protected routes configuration for middleware\r\n */\r\nexport const PROTECTED_ROUTES = {\r\n    // Staff-only routes\r\n    staff: [\r\n        '/staff',\r\n        '/staff/dashboard',\r\n        '/staff/applications',\r\n        '/staff/calendar',\r\n        '/staff/accounting',\r\n        '/staff/analytics',\r\n    ],\r\n\r\n    // Admin-only routes\r\n    admin: [\r\n        '/staff/dashboard/admin',\r\n        '/admin',\r\n    ],\r\n\r\n    // Farmer-only routes\r\n    farmer: [\r\n        '/farmer/dashboard',\r\n        '/farmer/applications',\r\n        '/farmer/certificates',\r\n        '/farmer/payments',\r\n        '/farmer/profile',\r\n        '/farmer/establishments',\r\n    ],\r\n\r\n    // Public routes (no auth required)\r\n    public: [\r\n        '/',\r\n        '/login',\r\n        '/register',\r\n        '/forgot-password',\r\n        '/staff/login',\r\n    ],\r\n} as const;\r\n\r\n/**\r\n * Check if a path requires authentication\r\n */\r\nexport function requiresAuth(path: string): boolean {\r\n    return !PROTECTED_ROUTES.public.some(route =>\r\n        path === route || path.startsWith(route + '/')\r\n    );\r\n}\r\n\r\n/**\r\n * Check if a path is staff-only\r\n */\r\nexport function requiresStaff(path: string): boolean {\r\n    return PROTECTED_ROUTES.staff.some(route =>\r\n        path === route || path.startsWith(route + '/')\r\n    );\r\n}\r\n\r\n/**\r\n * Check if a path is admin-only\r\n */\r\nexport function requiresAdmin(path: string): boolean {\r\n    return PROTECTED_ROUTES.admin.some(route =>\r\n        path === route || path.startsWith(route + '/')\r\n    );\r\n}\r\n\r\nexport default {\r\n    ROLES,\r\n    PERMISSIONS,\r\n    isStaff,\r\n    isAdmin,\r\n    hasPermission,\r\n    getPermissions,\r\n    canManageRole,\r\n    getRoleDisplayName,\r\n    requiresAuth,\r\n    requiresStaff,\r\n    requiresAdmin,\r\n    PROTECTED_ROUTES,\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\services\\admin-service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[154,157],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[154,157],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[636,639],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[636,639],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { apiClient } from '@/lib/api/api-client';\r\n\r\nexport interface Plant {\r\n    id: string;\r\n    name: string;\r\n    productionInputs: Record<string, any>;\r\n    sortOrder: number;\r\n    isActive: boolean;\r\n    createdAt?: string;\r\n    updatedAt?: string;\r\n}\r\n\r\nexport interface SystemConfig {\r\n    key: string;\r\n    value: string;\r\n    type: string;\r\n    description?: string;\r\n    updatedAt?: string;\r\n}\r\n\r\nexport const AdminService = {\r\n    // --- Plants Management ---\r\n    async getPlants() {\r\n        return await apiClient.get<Plant[]>('/admin/plants');\r\n    },\r\n\r\n    async createPlant(data: { name: string; productionInputs: any }) {\r\n        return await apiClient.post<Plant>('/admin/plants', data);\r\n    },\r\n\r\n    async updatePlant(id: string, data: Partial<Plant>) {\r\n        return await apiClient.patch<Plant>(`/admin/plants/${id}`, data);\r\n    },\r\n\r\n    async deletePlant(id: string) {\r\n        return await apiClient.delete(`/admin/plants/${id}`);\r\n    },\r\n\r\n    // --- System Configuration ---\r\n    async getConfigs() {\r\n        return await apiClient.get<SystemConfig[]>('/admin/config');\r\n    },\r\n\r\n    async updateConfig(key: string, value: string) {\r\n        return await apiClient.patch<SystemConfig>(`/admin/config/${key}`, { value });\r\n    },\r\n\r\n    // --- Dashboard Stats ---\r\n    async getDashboardStats() {\r\n        return await apiClient.get<{\r\n            total: number;\r\n            pending: number;\r\n            approved: number;\r\n            revenue: number;\r\n            todayChecked: number;\r\n        }>('/applications/stats');\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\services\\application-service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[923,926],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[923,926],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1354,1357],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1354,1357],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { apiClient } from \"@/lib/api/api-client\";\r\n\r\nexport interface Application {\r\n    _id: string;\r\n    applicationNumber?: string;\r\n    status: string;\r\n    createdAt: string;\r\n    updatedAt: string;\r\n    plantId?: string;\r\n    rejectCount?: number;\r\n    data?: {\r\n        applicantInfo?: { name: string };\r\n        formData?: { plantId: string };\r\n    };\r\n    scheduledDate?: string;\r\n    audit?: {\r\n        mode?: \"ONLINE\" | \"ONSITE\";\r\n        meetingUrl?: string;\r\n        location?: string;\r\n        scheduledDate?: string; // Legacy or redundant, keeping for safe measure\r\n    };\r\n    // [NEW] Expanded fields for UI\r\n    fees?: {\r\n        phase1?: { items: { description: string; amount: number }[] };\r\n        phase2?: { items: { description: string; amount: number }[] };\r\n    };\r\n    applicantData?: {\r\n        firstName?: string;\r\n        lastName?: string;\r\n        address?: string;\r\n        [key: string]: any;\r\n    };\r\n}\r\n\r\nexport interface DashboardStats {\r\n    total: number;\r\n    pending: number;\r\n    approved: number;\r\n    todayChecked: number;\r\n}\r\n\r\nexport const ApplicationService = {\r\n    /**\r\n     * Get statistics for Staff Dashboard\r\n     */\r\n    /**\r\n     * Get statistics for Staff Dashboard\r\n     */\r\n    getStats: async () => {\r\n        // Updated to use the new Reports API\r\n        const response = await apiClient.get<any>(\"/reports/dashboard\");\r\n        if (response.success && response.data) {\r\n            return {\r\n                success: true,\r\n                data: {\r\n                    total: response.data.total,\r\n                    pending: response.data.pendingReview, // Map 'pendingReview' to 'pending'\r\n                    approved: response.data.approved,\r\n                    todayChecked: 0 // Not yet implemented in backend\r\n                }\r\n            };\r\n        }\r\n        return response;\r\n    },\r\n\r\n    /**\r\n     * Get applications for Farmer Dashboard\r\n     */\r\n    getMyApplications: async () => {\r\n        return apiClient.get<Application[]>(\"/applications/my\");\r\n    },\r\n\r\n    /**\r\n     * Get pending reviews for Staff (Document Review)\r\n     */\r\n    getPendingReviews: async () => {\r\n        return apiClient.get<Application[]>(\"/applications/pending-reviews\");\r\n    },\r\n\r\n    /**\r\n     * Get pending audits for Staff (Auditor)\r\n     */\r\n    getPendingAudits: async () => {\r\n        return apiClient.get<Application[]>(\"/applications/auditor/assignments\");\r\n    },\r\n\r\n    /**\r\n     * Get single application by ID\r\n     */\r\n    getMyCertificates: async () => {\r\n        return apiClient.get<Certificate[]>(\"/certificates/my\");\r\n    },\r\n\r\n    /**\r\n     * Download Certificate (Mock)\r\n     */\r\n    downloadCertificate: async (id: string) => {\r\n        // This would typically trigger a blob download\r\n        // For now, we return the URL to open in new tab\r\n        return {\r\n            success: true,\r\n            data: `/api/certificates/${id}/download`\r\n        };\r\n    }\r\n};\r\n\r\nexport interface Certificate {\r\n    _id: string;\r\n    certificateNumber: string;\r\n    siteName: string; // Farm Name\r\n    plantType: string;\r\n    issuedDate: string;\r\n    expiryDate: string;\r\n    status: string;\r\n    qrCode: string;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\services\\auth-provider.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'data' is defined but never used.","line":49,"column":77,"nodeType":null,"messageId":"unusedVar","endLine":49,"endColumn":81},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`checkVerification` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\services\\auth-provider.tsx:55:21\n  53 |                     setUser(u);\n  54 |                     // Check verification on login\n> 55 |                     checkVerification(u);\n     |                     ^^^^^^^^^^^^^^^^^ `checkVerification` accessed before it is declared\n  56 |                     break;\n  57 |                 case 'logout':\n  58 |                 case 'session_expired':\n\nC:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\services\\auth-provider.tsx:77:5\n   75 |\n   76 |     // Verification Check Logic\n>  77 |     const checkVerification = useCallback((u: AuthUser | null) => {\n      |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  78 |         if (!u) return;\n      | ^^^^^^^^^^^^^^^^^^^^^^^\n>  79 |\n      โ€ฆ\n      | ^^^^^^^^^^^^^^^^^^^^^^^\n>  97 |         */\n      | ^^^^^^^^^^^^^^^^^^^^^^^\n>  98 |     }, [pathname, router]);\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ `checkVerification` is declared here\n   99 |\n  100 |     // Check on path change or user update\n  101 |     useEffect(() => {","line":55,"column":21,"nodeType":null,"endLine":55,"endColumn":38},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checkVerification'. Either include it or remove the dependency array.","line":74,"column":8,"nodeType":"ArrayExpression","endLine":74,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [checkVerification]","fix":{"range":[2346,2348],"text":"[checkVerification]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'vStatus' is assigned a value but never used.","line":86,"column":15,"nodeType":null,"messageId":"unusedVar","endLine":86,"endColumn":22},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has unnecessary dependencies: 'pathname' and 'router'. Either exclude them or remove the dependency array.","line":98,"column":8,"nodeType":"ArrayExpression","endLine":98,"endColumn":26,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[3189,3207],"text":"[]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\n/**\r\n * AuthProvider - React component to initialize AuthService\r\n */\r\n\r\nimport React, { createContext, useContext, useEffect, useState, useCallback } from 'react';\r\nimport { useRouter, usePathname } from 'next/navigation';\r\nimport { AuthService, AuthUser, AuthEventType } from './auth-service';\r\n\r\n// Define Context Type\r\ninterface AuthContextValue {\r\n    user: AuthUser | null;\r\n    isAuthenticated: boolean;\r\n    isLoading: boolean;\r\n    login: (token: string, user: AuthUser) => void;\r\n    logout: () => Promise<void>;\r\n    updateUser: (user: AuthUser) => void;\r\n}\r\n\r\n// Create Context\r\nconst AuthContext = createContext<AuthContextValue | null>(null);\r\n\r\ninterface AuthProviderProps {\r\n    children: React.ReactNode;\r\n}\r\n\r\nexport function AuthProvider({ children }: AuthProviderProps) {\r\n    const [user, setUser] = useState<AuthUser | null>(null);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const router = useRouter();\r\n    const pathname = usePathname();\r\n\r\n    // Initialize auth service and sync state\r\n    useEffect(() => {\r\n        // Initialize service (sets up cross-tab sync, timers, etc.)\r\n        AuthService.initialize();\r\n\r\n        // Load initial state\r\n        const currentUser = AuthService.getUser();\r\n        const isAuth = AuthService.isAuthenticated();\r\n\r\n        if (isAuth && currentUser) {\r\n            setUser(currentUser);\r\n        }\r\n        setIsLoading(false);\r\n\r\n        // Subscribe to auth events\r\n        const unsubscribe = AuthService.onAuthChange((event: AuthEventType, data?: unknown) => {\r\n            switch (event) {\r\n                case 'login':\r\n                    const u = AuthService.getUser();\r\n                    setUser(u);\r\n                    // Check verification on login\r\n                    checkVerification(u);\r\n                    break;\r\n                case 'logout':\r\n                case 'session_expired':\r\n                    setUser(null);\r\n                    break;\r\n                case 'tab_sync':\r\n                    if (AuthService.isAuthenticated()) {\r\n                        setUser(AuthService.getUser());\r\n                    } else {\r\n                        setUser(null);\r\n                    }\r\n                    break;\r\n            }\r\n        });\r\n\r\n        return () => {\r\n            unsubscribe();\r\n        };\r\n    }, []);\r\n\r\n    // Verification Check Logic\r\n    const checkVerification = useCallback((u: AuthUser | null) => {\r\n        if (!u) return;\r\n\r\n        // Skip for Staff\r\n        const role = u.role?.toUpperCase();\r\n        if (role && ['ADMIN', 'STAFF', 'SCHEDULER', 'AUDITOR', 'Reviewer', 'JURISTIC_OFFICER'].some(r => role.includes(r))) {\r\n            return;\r\n        }\r\n\r\n        const vStatus = u.verificationStatus || 'NEW';\r\n\r\n        // REMOVED for Gradual Engagement:\r\n        // Users can now access dashboard but will see a warning banner.\r\n        // Actions are gated at the button level.\r\n        /* \r\n        if (vStatus === 'NEW' || vStatus === 'REJECTED') {\r\n            if (pathname !== '/verify-identity' && pathname !== '/login') {\r\n                router.push('/verify-identity');\r\n            }\r\n        } \r\n        */\r\n    }, [pathname, router]);\r\n\r\n    // Check on path change or user update\r\n    useEffect(() => {\r\n        if (!isLoading && user) {\r\n            checkVerification(user);\r\n        }\r\n    }, [isLoading, user, pathname, checkVerification]);\r\n\r\n\r\n    const login = useCallback((token: string, user: AuthUser) => {\r\n        AuthService.saveSession({ token, user });\r\n        setUser(user);\r\n        checkVerification(user);\r\n    }, [checkVerification]);\r\n\r\n    const logout = useCallback(async () => {\r\n        await AuthService.logout();\r\n        setUser(null);\r\n    }, []);\r\n\r\n    const updateUser = useCallback((updatedUser: AuthUser) => {\r\n        AuthService.updateUser(updatedUser);\r\n        setUser(updatedUser);\r\n    }, []);\r\n\r\n    const value: AuthContextValue = {\r\n        user,\r\n        isAuthenticated: !!user && AuthService.isAuthenticated(),\r\n        isLoading,\r\n        login,\r\n        logout,\r\n        updateUser,\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={value}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n}\r\n\r\n/**\r\n * Hook to access auth context\r\n */\r\nexport function useAuth(): AuthContextValue {\r\n    const context = useContext(AuthContext);\r\n    if (!context) {\r\n        throw new Error('useAuth must be used within an AuthProvider');\r\n    }\r\n    return context;\r\n}\r\n\r\n/**\r\n * Hook to require authentication\r\n * Redirects to login if not authenticated\r\n */\r\nexport function useRequireAuth(redirectTo = '/login'): AuthContextValue {\r\n    const auth = useAuth();\r\n\r\n    useEffect(() => {\r\n        if (!auth.isLoading && !auth.isAuthenticated) {\r\n            window.location.href = redirectTo;\r\n        }\r\n    }, [auth.isLoading, auth.isAuthenticated, redirectTo]);\r\n\r\n    return auth;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\services\\auth-service.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":187,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":187,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * AuthService - Enterprise-Grade Authentication Service for Next.js\r\n * \r\n * Features:\r\n * - Centralized token + user storage (fixes State Amnesia)\r\n * - JWT decode & expiry checking\r\n * - Auto token refresh before expiry\r\n * - Cross-tab synchronization (logout syncs all tabs)\r\n * - Session timeout after inactivity\r\n * - Auth event system for reactive updates\r\n * - Cookie sync for middleware compatibility\r\n * \r\n * @version 2.0.0\r\n */\r\n\r\nimport { apiClient } from '../api/api-client';\r\n\r\n// Storage keys - centralized to prevent typos\r\nconst STORAGE_KEYS = {\r\n    ACCESS_TOKEN: 'accessToken',\r\n    REFRESH_TOKEN: 'refreshToken',\r\n    USER: 'user',\r\n    REMEMBER_LOGIN: 'remember_login',\r\n    LAST_ACTIVITY: 'lastActivity',\r\n} as const;\r\n\r\n// Event types for auth state changes\r\nexport type AuthEventType = 'login' | 'logout' | 'token_refresh' | 'session_expired' | 'tab_sync';\r\n\r\nexport type AuthEventCallback = (event: AuthEventType, data?: unknown) => void;\r\n\r\n// User type definition\r\nexport interface AuthUser {\r\n    id: string;\r\n    uuid?: string;\r\n    email?: string;\r\n    firstName?: string;\r\n    lastName?: string;\r\n    accountType?: string;\r\n    userType?: string;\r\n    role?: string;\r\n    status?: string;\r\n    verificationStatus?: string;\r\n    verificationNote?: string;\r\n    verificationSubmittedAt?: string;\r\n    taxId?: string;\r\n    laserCode?: string;\r\n    idCard?: string;\r\n    address?: string;\r\n    province?: string;\r\n    companyName?: string;\r\n    phone?: string;\r\n    applicantType?: string;\r\n    [key: string]: unknown;\r\n}\r\n\r\n// JWT Payload type\r\ninterface JWTPayload {\r\n    exp?: number;\r\n    iat?: number;\r\n    userId?: string;\r\n    email?: string;\r\n    role?: string;\r\n    [key: string]: unknown;\r\n}\r\n\r\n// Session data from API response\r\nexport interface SessionData {\r\n    token?: string;\r\n    accessToken?: string;\r\n    refreshToken?: string;\r\n    user?: AuthUser;\r\n    tokens?: {\r\n        accessToken?: string;\r\n        refreshToken?: string;\r\n    };\r\n}\r\n\r\n// Configuration options\r\ninterface AuthConfig {\r\n    sessionTimeoutMinutes: number;\r\n    tokenRefreshBufferMinutes: number;\r\n    enableCrossTabSync: boolean;\r\n    enableSessionTimeout: boolean;\r\n    onAuthEvent?: AuthEventCallback;\r\n}\r\n\r\nconst DEFAULT_CONFIG: AuthConfig = {\r\n    sessionTimeoutMinutes: 30,\r\n    tokenRefreshBufferMinutes: 5,\r\n    enableCrossTabSync: true,\r\n    enableSessionTimeout: true,\r\n};\r\n\r\nclass AuthServiceClass {\r\n    private config: AuthConfig;\r\n    private refreshTimer: ReturnType<typeof setTimeout> | null = null;\r\n    private activityTimer: ReturnType<typeof setTimeout> | null = null;\r\n    private eventListeners: AuthEventCallback[] = [];\r\n    private initialized = false;\r\n\r\n    constructor(config: Partial<AuthConfig> = {}) {\r\n        this.config = { ...DEFAULT_CONFIG, ...config };\r\n    }\r\n\r\n    // ==================== API ACTIONS ====================\r\n\r\n    /**\r\n     * Login with centralized API client\r\n     */\r\n    async login(credentials: { identifier: string; password: string; accountType?: string }): Promise<{ success: boolean; error?: string }> {\r\n        try {\r\n            const response = await apiClient.post<SessionData>('/auth-farmer/login', credentials);\r\n\r\n            if (!response.success || !response.data) {\r\n                return {\r\n                    success: false,\r\n                    error: response.error || 'เธเธทเนเธญเธเธนเนเนเธเนเธเธฒเธเธซเธฃเธทเธญเธฃเธซเธฑเธชเธเนเธฒเธเนเธกเนเธ–เธนเธเธ•เนเธญเธ'\r\n                };\r\n            }\r\n\r\n            const data = response.data;\r\n            const token = data.tokens?.accessToken || data.token || data.accessToken;\r\n\r\n            if (!token) {\r\n                return { success: false, error: 'เนเธกเนเนเธ”เนเธฃเธฑเธ Token เธเธฒเธเธฃเธฐเธเธ' };\r\n            }\r\n\r\n            // Auto-save session\r\n            this.saveSession({\r\n                ...data,\r\n                token\r\n            });\r\n\r\n            return { success: true };\r\n        } catch (error) {\r\n            console.error('[AuthService] Login failed:', error);\r\n            return { success: false, error: 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเน€เธเธทเนเธญเธกเธ•เนเธญ' };\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Register new farmer\r\n     */\r\n    async register(data: unknown): Promise<{ success: boolean; error?: string; data?: unknown }> {\r\n        try {\r\n            const response = await apiClient.post<{ user: AuthUser }>('/auth-farmer/register', data);\r\n\r\n            if (!response.success) {\r\n                return { success: false, error: response.error };\r\n            }\r\n\r\n            return { success: true, data: response.data };\r\n        } catch (error) {\r\n            console.error('[AuthService] Register failed:', error);\r\n            return { success: false, error: 'เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ”เนเธเธเธฒเธฃเน€เธเธทเนเธญเธกเธ•เนเธญ' };\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Check if identifier exists\r\n     */\r\n    async checkIdentifier(identifier: string, accountType: string): Promise<{ available: boolean; error?: string }> {\r\n        try {\r\n            const response = await apiClient.post<{ available: boolean; error?: string }>('/auth-farmer/check-identifier', {\r\n                identifier,\r\n                accountType\r\n            });\r\n\r\n            if (!response.success) {\r\n                return { available: false, error: response.error };\r\n            }\r\n\r\n            // API returns success: true even if available: false\r\n            // The available flag is inside data if success is true?\r\n            // Checking api-client wrapper response structure vs controller response\r\n            // Controller returns: { success: true, available: false, error: \"...\" }\r\n            // ApiClient returns: { success: true, data: { available, error } }\r\n\r\n            const result = response.data;\r\n            if (!result) return { available: false, error: 'No data' };\r\n\r\n            return {\r\n                available: !!result.available,\r\n                error: result.error\r\n            };\r\n        } catch (error) {\r\n            return { available: false, error: 'Connection Error' };\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Initialize auth service (call once in app layout/provider)\r\n     */\r\n    initialize(): void {\r\n        if (this.initialized || !this.isBrowser()) return;\r\n\r\n        this.initialized = true;\r\n\r\n        // Setup cross-tab synchronization\r\n        if (this.config.enableCrossTabSync) {\r\n            this.setupCrossTabSync();\r\n        }\r\n\r\n        // Setup session timeout tracking\r\n        if (this.config.enableSessionTimeout) {\r\n            this.setupActivityTracking();\r\n        }\r\n\r\n        // Schedule token refresh if authenticated\r\n        if (this.isAuthenticated()) {\r\n            this.scheduleTokenRefresh();\r\n        }\r\n\r\n        console.log('[AuthService] Initialized with config:', {\r\n            sessionTimeout: this.config.sessionTimeoutMinutes,\r\n            crossTabSync: this.config.enableCrossTabSync,\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Check if running in browser environment\r\n     */\r\n    private isBrowser(): boolean {\r\n        return typeof window !== 'undefined';\r\n    }\r\n\r\n    /**\r\n     * Emit auth event to all listeners\r\n     */\r\n    private emit(event: AuthEventType, data?: unknown): void {\r\n        this.eventListeners.forEach(cb => cb(event, data));\r\n        this.config.onAuthEvent?.(event, data);\r\n    }\r\n\r\n    /**\r\n     * Subscribe to auth events\r\n     */\r\n    onAuthChange(callback: AuthEventCallback): () => void {\r\n        this.eventListeners.push(callback);\r\n        return () => {\r\n            this.eventListeners = this.eventListeners.filter(cb => cb !== callback);\r\n        };\r\n    }\r\n\r\n    // ==================== JWT UTILITIES ====================\r\n\r\n    /**\r\n     * Decode JWT token without verification (client-side only)\r\n     */\r\n    decodeToken(token?: string): JWTPayload | null {\r\n        const t = token || this.getToken();\r\n        if (!t) return null;\r\n\r\n        try {\r\n            const parts = t.split('.');\r\n            if (parts.length !== 3) return null;\r\n\r\n            const payload = parts[1];\r\n            const decoded = atob(payload.replace(/-/g, '+').replace(/_/g, '/'));\r\n            return JSON.parse(decoded);\r\n        } catch {\r\n            console.error('[AuthService] Failed to decode JWT');\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get token expiration timestamp (ms)\r\n     */\r\n    getTokenExpiry(): number | null {\r\n        const payload = this.decodeToken();\r\n        if (!payload?.exp) return null;\r\n        return payload.exp * 1000; // Convert to milliseconds\r\n    }\r\n\r\n    /**\r\n     * Check if token is expired\r\n     */\r\n    isTokenExpired(): boolean {\r\n        const expiry = this.getTokenExpiry();\r\n        if (!expiry) return true;\r\n        return Date.now() >= expiry;\r\n    }\r\n\r\n    /**\r\n     * Get time until token expires (ms)\r\n     */\r\n    getTimeUntilExpiry(): number {\r\n        const expiry = this.getTokenExpiry();\r\n        if (!expiry) return 0;\r\n        return Math.max(0, expiry - Date.now());\r\n    }\r\n\r\n    // ==================== SESSION MANAGEMENT ====================\r\n\r\n    /**\r\n     * Save complete auth session (token + user)\r\n     */\r\n    saveSession(data: SessionData): void {\r\n        if (!this.isBrowser()) return;\r\n\r\n        const accessToken = data.tokens?.accessToken || data.accessToken || data.token;\r\n        const refreshToken = data.tokens?.refreshToken || data.refreshToken;\r\n\r\n        if (accessToken) {\r\n            localStorage.setItem(STORAGE_KEYS.ACCESS_TOKEN, accessToken);\r\n            // Sync cookie for middleware\r\n            const isSecure = window.location.protocol === 'https:';\r\n            document.cookie = `auth_token=${accessToken}; path=/; max-age=${60 * 60 * 24 * 7}; SameSite=Lax${isSecure ? '; Secure' : ''}`;\r\n        }\r\n\r\n        if (refreshToken) {\r\n            localStorage.setItem(STORAGE_KEYS.REFRESH_TOKEN, refreshToken);\r\n        }\r\n\r\n        if (data.user) {\r\n            localStorage.setItem(STORAGE_KEYS.USER, JSON.stringify(data.user));\r\n        }\r\n\r\n        // Update last activity\r\n        this.updateLastActivity();\r\n\r\n        // Schedule token refresh\r\n        this.scheduleTokenRefresh();\r\n\r\n        // Emit login event\r\n        this.emit('login', { user: data.user });\r\n\r\n        console.log('[AuthService] Session saved:', {\r\n            hasAccessToken: !!accessToken,\r\n            hasRefreshToken: !!refreshToken,\r\n            expiresIn: this.getTimeUntilExpiry(),\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get access token\r\n     */\r\n    getToken(): string | null {\r\n        if (!this.isBrowser()) return null;\r\n        return localStorage.getItem(STORAGE_KEYS.ACCESS_TOKEN);\r\n    }\r\n\r\n    /**\r\n     * Get refresh token\r\n     */\r\n    getRefreshToken(): string | null {\r\n        if (!this.isBrowser()) return null;\r\n        return localStorage.getItem(STORAGE_KEYS.REFRESH_TOKEN);\r\n    }\r\n\r\n    /**\r\n     * Get current user data\r\n     */\r\n    getUser(): AuthUser | null {\r\n        if (!this.isBrowser()) return null;\r\n\r\n        const userStr = localStorage.getItem(STORAGE_KEYS.USER);\r\n        if (!userStr) return null;\r\n\r\n        try {\r\n            return JSON.parse(userStr) as AuthUser;\r\n        } catch {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Update user data without changing token\r\n     */\r\n    updateUser(user: AuthUser): void {\r\n        if (!this.isBrowser()) return;\r\n        localStorage.setItem(STORAGE_KEYS.USER, JSON.stringify(user));\r\n    }\r\n\r\n    /**\r\n     * Check if user is authenticated (token exists and not expired)\r\n     */\r\n    isAuthenticated(): boolean {\r\n        const token = this.getToken();\r\n        const user = this.getUser();\r\n\r\n        if (!token || !user?.id) return false;\r\n\r\n        // Check token expiry\r\n        if (this.isTokenExpired()) {\r\n            console.log('[AuthService] Token expired');\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Clear all auth data (logout)\r\n     */\r\n    clearSession(): void {\r\n        if (!this.isBrowser()) return;\r\n\r\n        // Clear timers\r\n        if (this.refreshTimer) {\r\n            clearTimeout(this.refreshTimer);\r\n            this.refreshTimer = null;\r\n        }\r\n\r\n        localStorage.removeItem(STORAGE_KEYS.ACCESS_TOKEN);\r\n        localStorage.removeItem(STORAGE_KEYS.REFRESH_TOKEN);\r\n        localStorage.removeItem(STORAGE_KEYS.USER);\r\n        localStorage.removeItem(STORAGE_KEYS.LAST_ACTIVITY);\r\n\r\n        // Clear auth cookie\r\n        document.cookie = 'auth_token=; path=/; max-age=0';\r\n\r\n        // Emit logout event\r\n        this.emit('logout');\r\n\r\n        console.log('[AuthService] Session cleared');\r\n    }\r\n\r\n    // ==================== TOKEN REFRESH ====================\r\n\r\n    /**\r\n     * Schedule automatic token refresh\r\n     */\r\n    private scheduleTokenRefresh(): void {\r\n        if (!this.isBrowser()) return;\r\n\r\n        // Clear existing timer\r\n        if (this.refreshTimer) {\r\n            clearTimeout(this.refreshTimer);\r\n        }\r\n\r\n        const timeUntilExpiry = this.getTimeUntilExpiry();\r\n        if (timeUntilExpiry <= 0) return;\r\n\r\n        // Refresh 5 minutes before expiry\r\n        const bufferMs = this.config.tokenRefreshBufferMinutes * 60 * 1000;\r\n        const refreshIn = Math.max(0, timeUntilExpiry - bufferMs);\r\n\r\n        if (refreshIn > 0) {\r\n            this.refreshTimer = setTimeout(() => {\r\n                this.refreshToken();\r\n            }, refreshIn);\r\n\r\n            console.log('[AuthService] Token refresh scheduled in', Math.round(refreshIn / 1000 / 60), 'minutes');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Refresh the access token using refresh token\r\n     */\r\n    async refreshToken(): Promise<boolean> {\r\n        const refreshToken = this.getRefreshToken();\r\n        if (!refreshToken) {\r\n            console.log('[AuthService] No refresh token available');\r\n            return false;\r\n        }\r\n\r\n        try {\r\n            const response = await fetch('/api/auth/refresh', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ refreshToken }),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                throw new Error('Refresh failed');\r\n            }\r\n\r\n            const data = await response.json();\r\n\r\n            if (data.success && data.data?.accessToken) {\r\n                localStorage.setItem(STORAGE_KEYS.ACCESS_TOKEN, data.data.accessToken);\r\n                const isSecure = window.location.protocol === 'https:';\r\n                document.cookie = `auth_token=${data.data.accessToken}; path=/; max-age=${60 * 60 * 24 * 7}; SameSite=Lax${isSecure ? '; Secure' : ''}`;\r\n\r\n                // Schedule next refresh\r\n                this.scheduleTokenRefresh();\r\n\r\n                this.emit('token_refresh');\r\n                console.log('[AuthService] Token refreshed successfully');\r\n                return true;\r\n            }\r\n\r\n            throw new Error('Invalid refresh response');\r\n        } catch (error) {\r\n            console.error('[AuthService] Token refresh failed:', error);\r\n            // Clear session on refresh failure\r\n            this.clearSession();\r\n            this.emit('session_expired');\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // ==================== CROSS-TAB SYNC ====================\r\n\r\n    /**\r\n     * Setup cross-tab synchronization\r\n     */\r\n    private setupCrossTabSync(): void {\r\n        if (!this.isBrowser()) return;\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            // Logout synced across tabs\r\n            if (e.key === STORAGE_KEYS.ACCESS_TOKEN && !e.newValue) {\r\n                console.log('[AuthService] Logout detected from another tab');\r\n                this.emit('tab_sync', { action: 'logout' });\r\n\r\n                // Redirect to login\r\n                if (window.location.pathname !== '/login') {\r\n                    window.location.href = '/login';\r\n                }\r\n            }\r\n\r\n            // Login synced across tabs\r\n            if (e.key === STORAGE_KEYS.ACCESS_TOKEN && e.newValue && !e.oldValue) {\r\n                console.log('[AuthService] Login detected from another tab');\r\n                this.emit('tab_sync', { action: 'login' });\r\n            }\r\n        });\r\n    }\r\n\r\n    // ==================== SESSION TIMEOUT ====================\r\n\r\n    /**\r\n     * Update last activity timestamp\r\n     */\r\n    updateLastActivity(): void {\r\n        if (!this.isBrowser()) return;\r\n        localStorage.setItem(STORAGE_KEYS.LAST_ACTIVITY, Date.now().toString());\r\n        this.resetActivityTimer();\r\n    }\r\n\r\n    /**\r\n     * Get last activity timestamp\r\n     */\r\n    private getLastActivity(): number {\r\n        const stored = localStorage.getItem(STORAGE_KEYS.LAST_ACTIVITY);\r\n        return stored ? parseInt(stored, 10) : Date.now();\r\n    }\r\n\r\n    /**\r\n     * Check if session has timed out due to inactivity\r\n     */\r\n    isSessionTimedOut(): boolean {\r\n        const lastActivity = this.getLastActivity();\r\n        const timeoutMs = this.config.sessionTimeoutMinutes * 60 * 1000;\r\n        return Date.now() - lastActivity > timeoutMs;\r\n    }\r\n\r\n    /**\r\n     * Setup activity tracking for session timeout\r\n     */\r\n    private setupActivityTracking(): void {\r\n        if (!this.isBrowser()) return;\r\n\r\n        const activityEvents = ['mousedown', 'keydown', 'touchstart', 'scroll'];\r\n\r\n        const handleActivity = () => {\r\n            if (this.isAuthenticated()) {\r\n                this.updateLastActivity();\r\n            }\r\n        };\r\n\r\n        // Throttle activity updates\r\n        let lastUpdate = 0;\r\n        const throttledHandler = () => {\r\n            const now = Date.now();\r\n            if (now - lastUpdate > 60000) { // Update max once per minute\r\n                lastUpdate = now;\r\n                handleActivity();\r\n            }\r\n        };\r\n\r\n        activityEvents.forEach(event => {\r\n            window.addEventListener(event, throttledHandler, { passive: true });\r\n        });\r\n\r\n        // Initial activity timer\r\n        this.resetActivityTimer();\r\n    }\r\n\r\n    /**\r\n     * Reset activity timer\r\n     */\r\n    private resetActivityTimer(): void {\r\n        if (this.activityTimer) {\r\n            clearTimeout(this.activityTimer);\r\n        }\r\n\r\n        if (!this.isAuthenticated()) return;\r\n\r\n        const timeoutMs = this.config.sessionTimeoutMinutes * 60 * 1000;\r\n\r\n        this.activityTimer = setTimeout(() => {\r\n            if (this.isSessionTimedOut()) {\r\n                console.log('[AuthService] Session timed out due to inactivity');\r\n                this.logout(false);\r\n                this.emit('session_expired');\r\n                window.location.href = '/login?timeout=true';\r\n            }\r\n        }, timeoutMs);\r\n    }\r\n\r\n    // ==================== REMEMBER ME ====================\r\n\r\n    saveRememberMe(accountType: string, identifier: string): void {\r\n        if (!this.isBrowser()) return;\r\n        localStorage.setItem(STORAGE_KEYS.REMEMBER_LOGIN, JSON.stringify({ accountType, identifier }));\r\n    }\r\n\r\n    getRememberMe(): { accountType: string; identifier: string } | null {\r\n        if (!this.isBrowser()) return null;\r\n        const data = localStorage.getItem(STORAGE_KEYS.REMEMBER_LOGIN);\r\n        if (!data) return null;\r\n        try {\r\n            return JSON.parse(data);\r\n        } catch {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    clearRememberMe(): void {\r\n        if (!this.isBrowser()) return;\r\n        localStorage.removeItem(STORAGE_KEYS.REMEMBER_LOGIN);\r\n    }\r\n\r\n    // ==================== LOGOUT ====================\r\n\r\n    /**\r\n     * Logout - clear session and optionally call logout API\r\n     */\r\n    async logout(callApi = true): Promise<void> {\r\n        if (callApi) {\r\n            try {\r\n                await fetch('/api/auth/logout', { method: 'POST' });\r\n            } catch {\r\n                // Ignore API errors during logout\r\n            }\r\n        }\r\n        this.clearSession();\r\n    }\r\n}\r\n\r\n// Export singleton instance\r\nexport const AuthService = new AuthServiceClass();\r\n\r\n// Export class for custom instances\r\nexport { AuthServiceClass };\r\n\r\n// Export config type for customization\r\nexport type { AuthConfig };\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\services\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\services\\payment-service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[549,552],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[549,552],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[717,720],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[717,720],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":114,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":117,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[746,749],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[746,749],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[795,798],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[795,798],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'response' is assigned a value but never used.","line":89,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":89,"endColumn":27},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":102,"column":37,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":102,"endColumn":72}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { api } from \"../api/api-client\";\r\n\r\nexport interface PaymentRecord {\r\n    id: string;\r\n    type: \"QUOTATION\" | \"INVOICE\" | \"RECEIPT\";\r\n    documentNumber: string;\r\n    applicationId: string;\r\n    amount: number;\r\n    status: string;\r\n    createdAt: string;\r\n    paidAt?: string;\r\n    serviceType?: string; // APPLICATION_FEE, AUDIT_FEE\r\n}\r\n\r\nexport const PaymentService = {\r\n    /**\r\n     * Fetch user's payments and map to frontend model\r\n     */\r\n    async getMyPayments(): Promise<PaymentRecord[]> {\r\n        const result = await api.get<any[]>(\"/invoices/my\");\r\n        if (!result.success || !result.data) return [];\r\n\r\n        const invoices = Array.isArray(result.data) ? result.data : (result.data as any).data || (result.data as any) || [];\r\n\r\n        return invoices.map((inv: any) => {\r\n            // Map status\r\n            let status = \"PENDING\";\r\n            if (inv.status === \"paid\" || inv.status === \"PAID\") status = \"APPROVED\";\r\n            else if (inv.status === \"payment_verification_pending\") status = \"PENDING_APPROVAL\";\r\n            else if (inv.status === \"pending\" || inv.status === \"PENDING\") status = \"PENDING\";\r\n            else if (inv.status === \"overdue\") status = \"PENDING\"; // Treat overdue as pending for now\r\n\r\n            const type = (inv.status === 'paid' || inv.status === 'PAID') ? 'RECEIPT' : 'INVOICE';\r\n\r\n            // Determine Service Type if not explicitly set\r\n            let sType = inv.serviceType;\r\n            if (!sType) {\r\n                // Infer from amount if missing (Legacy support)\r\n                sType = inv.totalAmount <= 5000 ? 'APPLICATION_FEE' : 'AUDIT_FEE';\r\n            }\r\n\r\n            return {\r\n                id: inv.id,\r\n                type: type,\r\n                documentNumber: inv.invoiceNumber,\r\n                applicationId: inv.application?.applicationNumber || inv.applicationId || 'N/A',\r\n                amount: inv.totalAmount,\r\n                status: status,\r\n                createdAt: inv.createdAt,\r\n                paidAt: inv.paidAt,\r\n                serviceType: sType\r\n            } as PaymentRecord;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Upload payment slip to confirm payment\r\n     */\r\n    async uploadPaymentSlip(invoiceId: string, file: File, transactionId?: string): Promise<boolean> {\r\n        const formData = new FormData();\r\n        formData.append(\"transactionId\", transactionId || '');\r\n        // Note: New API might rely on manual markAsPaid or Ksher webhook. \r\n        // If we need manual slip upload, we should add it to InvoiceService or keep legacy.\r\n        // For now, let's assume this feature is less critical or handled via 'pay' endpoint if extended.\r\n        // Keeping as-is but pointing to invoices if valid, but standard API doesn't have upload slip yet.\r\n        // Let's use the manual pay endpoint if this was intended for manual confirmation?\r\n        // Actually, let's leave this method broken/legacy or point to a valid endpoint?\r\n        // User asked to verify Payment Flow (Mock/Ksher). The `payments/page.tsx` calls `payWithKsher`.\r\n        // It does NOT call `uploadPaymentSlip`. It only imports it.\r\n        // So I will fix `payWithKsher` primarily.\r\n\r\n        return false; // Disabled for now as not in standard Invoice API yet\r\n    },\r\n\r\n    async payWithKsher(invoiceId: string) {\r\n        // Updated to use RESTfule endpoint: POST /api/invoices/:id/pay/ksher\r\n        return await api.post<{ payment_url: string }>(`/invoices/${invoiceId}/pay/ksher`, {});\r\n    },\r\n\r\n    /**\r\n     * Trigger PDF download\r\n     */\r\n    async downloadInvoicePdf(invoiceId: string, invoiceNumber: string) {\r\n        // Direct link approach or blob fetch?\r\n        // Since we need auth headers, we should use fetch/blob approach if simple link doesn't work with headers.\r\n        // Our api-client attaches headers.\r\n\r\n        try {\r\n            const response = await api.get<Blob>(`/invoices/${invoiceId}/pdf`, {\r\n                headers: { 'Accept': 'application/pdf' }\r\n            });\r\n\r\n            // api-client usually returns JSON parsed. We need blob.\r\n            // The api-client `request` method parses JSON by default: \r\n            // const data = await response.json(); \r\n            // This is a problem for binary data.\r\n\r\n            // WORKAROUND: Use direct fetch with auth token for this specific binary call\r\n            // OR modify api-client to handle blobs (too risky given context).\r\n\r\n            // Let's use direct native fetch here using AuthService token\r\n            const { AuthService } = require('../services/auth-service'); // Lazy import to avoid cycle if any\r\n            const token = AuthService.getToken();\r\n\r\n            const res = await fetch(`/api/invoices/${invoiceId}/pdf`, {\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`\r\n                }\r\n            });\r\n\r\n            if (!res.ok) throw new Error('Download failed');\r\n\r\n            const blob = await res.blob();\r\n            const url = window.URL.createObjectURL(blob);\r\n            const a = document.createElement('a');\r\n            a.href = url;\r\n            a.download = `${invoiceNumber}.pdf`;\r\n            document.body.appendChild(a);\r\n            a.click();\r\n            window.URL.revokeObjectURL(url);\r\n            document.body.removeChild(a);\r\n            return true;\r\n        } catch (e) {\r\n            console.error('Download error', e);\r\n            return false;\r\n        }\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\middleware.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isAuthRoute' is assigned a value but never used.","line":93,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":93,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport type { NextRequest } from 'next/server';\r\n\r\n// ๐ Zero-Crash Security Middleware\r\n\r\n// Routes that require farmer authentication\r\n// Routes that require farmer authentication\r\nconst protectedFarmerRoutes = [\r\n    '/farmer', // Protects all /farmer/* routes\r\n];\r\n\r\n// Routes that require staff authentication\r\nconst protectedStaffRoutes = [\r\n    '/staff/dashboard',\r\n    '/staff/applications',\r\n    '/staff/audits',\r\n    '/staff/accounting',\r\n    '/staff/calendar',\r\n    '/staff/analytics',\r\n    '/admin',\r\n];\r\n\r\n// Routes that are only for unauthenticated users\r\nconst authRoutes = ['/login', '/register', '/forgot-password'];\r\nconst staffAuthRoutes = ['/staff/login'];\r\n\r\n// ๐ก๏ธ Enhanced Security Headers (OWASP + Apple Standards)\r\nconst securityHeaders = {\r\n    'X-Frame-Options': 'DENY',\r\n    'X-Content-Type-Options': 'nosniff',\r\n    'X-XSS-Protection': '1; mode=block',\r\n    'Referrer-Policy': 'strict-origin-when-cross-origin',\r\n    'Permissions-Policy': 'camera=(), microphone=(), geolocation=()',\r\n    'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload',\r\n    'Content-Security-Policy': [\r\n        \"default-src 'self'\",\r\n        \"script-src 'self' 'unsafe-inline' 'unsafe-eval'\",\r\n        \"style-src 'self' 'unsafe-inline'\",\r\n        \"img-src 'self' data: blob: https:\",\r\n        \"font-src 'self' data:\",\r\n        \"connect-src 'self' http://47.129.167.71 http://localhost:* https:\",\r\n        \"frame-src 'self' https://*.openstreetmap.org\",\r\n        \"frame-ancestors 'none'\",\r\n        \"base-uri 'self'\",\r\n        \"form-action 'self'\",\r\n    ].join('; '),\r\n};\r\n\r\nexport function middleware(request: NextRequest) {\r\n    const { pathname } = request.nextUrl;\r\n\r\n    // ========================================\r\n    // ๐ก๏ธ CVE-2025-29927 Protection\r\n    // Block x-middleware-subrequest header bypass attack\r\n    // ========================================\r\n    const subrequestHeader = request.headers.get('x-middleware-subrequest');\r\n    if (subrequestHeader) {\r\n        console.warn(`[SECURITY] Blocked middleware bypass attempt: ${subrequestHeader}`);\r\n        return new NextResponse('Forbidden', { status: 403 });\r\n    }\r\n\r\n    // Loading page at / handles redirect to /login itself\r\n    // No middleware redirect needed for root\r\n\r\n    const response = NextResponse.next();\r\n\r\n    // ========================================\r\n    // ๐”’ EARLY EXIT: Apply Security Headers\r\n    // ========================================\r\n    Object.entries(securityHeaders).forEach(([key, value]) => {\r\n        response.headers.set(key, value);\r\n    });\r\n\r\n    // ========================================\r\n    // ๐”’ EARLY EXIT: Block suspicious patterns\r\n    // ========================================\r\n    const suspiciousPatterns = [\r\n        /\\.\\.\\//,           // Path traversal\r\n        /<script/i,         // XSS attempt\r\n        /javascript:/i,     // JS injection\r\n        /\\x00/,             // Null byte\r\n    ];\r\n\r\n    if (suspiciousPatterns.some(pattern => pattern.test(pathname))) {\r\n        return new NextResponse('Forbidden', { status: 403 });\r\n    }\r\n\r\n    // ========================================\r\n    // ๐” Farmer Route Protection\r\n    // ========================================\r\n    const token = request.cookies.get('auth_token')?.value;\r\n    const isProtectedFarmerRoute = protectedFarmerRoutes.some(route => pathname.startsWith(route));\r\n    const isAuthRoute = authRoutes.some(route => pathname.startsWith(route));\r\n\r\n    if (isProtectedFarmerRoute && !token) {\r\n        const loginUrl = new URL('/login', request.url);\r\n        loginUrl.searchParams.set('redirect', pathname);\r\n        return NextResponse.redirect(loginUrl);\r\n    }\r\n\r\n    // NOTE: Disabled to prevent redirect loop when cookie exists but localStorage empty\r\n    // if (isAuthRoute && token) {\r\n    //     return NextResponse.redirect(new URL('/farmer/dashboard', request.url));\r\n    // }\r\n\r\n    // ========================================\r\n    // ๐” Staff Route Protection\r\n    // ========================================\r\n    const staffToken = request.cookies.get('staff_token')?.value;\r\n    const isProtectedStaffRoute = protectedStaffRoutes.some(route => pathname.startsWith(route));\r\n    const isStaffAuthRoute = staffAuthRoutes.some(route => pathname.startsWith(route));\r\n\r\n    if (isProtectedStaffRoute && !staffToken) {\r\n        const loginUrl = new URL('/staff/login', request.url);\r\n        loginUrl.searchParams.set('redirect', pathname);\r\n        return NextResponse.redirect(loginUrl);\r\n    }\r\n\r\n    if (isStaffAuthRoute && staffToken) {\r\n        return NextResponse.redirect(new URL('/staff/dashboard', request.url));\r\n    }\r\n\r\n    return response;\r\n}\r\n\r\nexport const config = {\r\n    matcher: [\r\n        /*\r\n         * Match all request paths except for:\r\n         * - api (API routes)\r\n         * - _next/static (static files)\r\n         * - _next/image (image optimization files)\r\n         * - favicon.ico (favicon file)\r\n         * - public assets\r\n         */\r\n        '/((?!api|_next/static|_next/image|favicon.ico|images|.*\\\\.png$|.*\\\\.jpg$).*)',\r\n    ],\r\n};\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\styles\\design-system.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\types\\database.ts","messages":[{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":519,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":521,"endColumn":3}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ๐ Apple-Standard Database Types\r\n * \r\n * TypeScript interfaces matching Prisma schema\r\n * Auto-generated from apps/backend/prisma/schema.prisma\r\n * \r\n * IMPORTANT: Keep in sync with database schema changes!\r\n * Run: npx prisma generate && copy types\r\n */\r\n\r\n// =============================================================================\r\n// ENUMS\r\n// =============================================================================\r\n\r\nexport type AccountType = 'INDIVIDUAL' | 'JURISTIC' | 'COMMUNITY_ENTERPRISE';\r\n\r\nexport type UserRole =\r\n    | 'FARMER'\r\n    | 'REVIEWER_AUDITOR'\r\n    | 'SCHEDULER'\r\n    | 'ACCOUNTANT'\r\n    | 'ADMIN'\r\n    | 'SUPER_ADMIN';\r\n\r\nexport type UserStatus =\r\n    | 'PENDING_VERIFICATION'\r\n    | 'ACTIVE'\r\n    | 'SUSPENDED'\r\n    | 'LOCKED'\r\n    | 'INACTIVE';\r\n\r\nexport type ApplicationStatus =\r\n    | 'draft'\r\n    | 'submitted'\r\n    | 'under_review'\r\n    | 'document_required'\r\n    | 'pending_payment'\r\n    | 'payment_confirmed'\r\n    | 'scheduled'\r\n    | 'audit_in_progress'\r\n    | 'pending_approval'\r\n    | 'approved'\r\n    | 'rejected'\r\n    | 'cancelled'\r\n    | 'expired';\r\n\r\nexport type ServiceType = 'new' | 'renewal' | 'amendment' | 'replacement';\r\n\r\nexport type PaymentStatus =\r\n    | 'pending'\r\n    | 'awaiting_confirmation'\r\n    | 'confirmed'\r\n    | 'rejected'\r\n    | 'refunded';\r\n\r\nexport type NotificationType =\r\n    | 'application_submitted'\r\n    | 'application_status_changed'\r\n    | 'document_required'\r\n    | 'quote_received'\r\n    | 'invoice_received'\r\n    | 'payment_confirmed'\r\n    | 'audit_scheduled'\r\n    | 'certificate_issued'\r\n    | 'certificate_expiring'\r\n    | 'system_announcement';\r\n\r\nexport type AuditSeverity = 'DEBUG' | 'INFO' | 'WARNING' | 'ERROR' | 'CRITICAL';\r\n\r\n// =============================================================================\r\n// USER MODEL\r\n// =============================================================================\r\n\r\nexport interface User {\r\n    id: string;\r\n    uuid: string;\r\n    createdAt: Date;\r\n    updatedAt: Date;\r\n\r\n    // Account Type\r\n    accountType: AccountType;\r\n\r\n    // Login Credentials\r\n    email: string | null;\r\n    password: string;\r\n\r\n    // Individual Farmer Fields\r\n    firstName: string | null;\r\n    lastName: string | null;\r\n    phoneNumber: string | null;\r\n    idCard: string | null; // Encrypted\r\n    idCardHash: string | null;\r\n    laserCode: string | null; // Encrypted\r\n\r\n    // Juristic Person Fields\r\n    companyName: string | null;\r\n    taxId: string | null;\r\n    taxIdHash: string | null;\r\n    representativeName: string | null;\r\n    representativePosition: string | null;\r\n\r\n    // Community Enterprise Fields\r\n    communityName: string | null;\r\n    communityRegistrationNo: string | null;\r\n    communityRegistrationNoHash: string | null;\r\n\r\n    // Role & Status\r\n    role: UserRole;\r\n    status: UserStatus;\r\n\r\n    // Address\r\n    address: string | null;\r\n    province: string | null;\r\n    district: string | null;\r\n    subdistrict: string | null;\r\n    zipCode: string | null;\r\n\r\n    // Verification\r\n    isEmailVerified: boolean;\r\n    emailVerificationToken: string | null;\r\n    emailVerificationExpiry: Date | null;\r\n    passwordResetToken: string | null;\r\n    passwordResetExpiry: Date | null;\r\n\r\n    // Login History\r\n    lastLoginAt: Date | null;\r\n    loginAttempts: number;\r\n    isLocked: boolean;\r\n    lockedUntil: Date | null;\r\n\r\n    // Audit Trail\r\n    createdBy: string | null;\r\n    updatedBy: string | null;\r\n    createdByIp: string | null;\r\n    updatedByIp: string | null;\r\n\r\n    // Soft Delete\r\n    isDeleted: boolean;\r\n    deletedAt: Date | null;\r\n    deletedBy: string | null;\r\n    deleteReason: string | null;\r\n\r\n    // Legal Retention\r\n    retainUntil: Date;\r\n    legalHold: boolean;\r\n}\r\n\r\n// =============================================================================\r\n// APPLICATION MODEL\r\n// =============================================================================\r\n\r\nexport interface Application {\r\n    id: string;\r\n    uuid: string;\r\n    createdAt: Date;\r\n    updatedAt: Date;\r\n\r\n    // References\r\n    applicationNumber: string;\r\n    userId: string;\r\n    farmId: string | null;\r\n\r\n    // Application Type\r\n    serviceType: ServiceType;\r\n    previousCertificateId: string | null;\r\n\r\n    // Status Tracking\r\n    status: ApplicationStatus;\r\n    submittedAt: Date | null;\r\n    approvedAt: Date | null;\r\n    rejectedAt: Date | null;\r\n\r\n    // Review Process\r\n    assignedReviewerId: string | null;\r\n    reviewNotes: string | null;\r\n    rejectionReason: string | null;\r\n\r\n    // Plant Info\r\n    plantSpeciesId: string | null;\r\n    cultivationArea: number | null;\r\n\r\n    // Audit\r\n    createdBy: string | null;\r\n    updatedBy: string | null;\r\n\r\n    // Soft Delete\r\n    isDeleted: boolean;\r\n    deletedAt: Date | null;\r\n}\r\n\r\n// =============================================================================\r\n// FARM MODEL\r\n// =============================================================================\r\n\r\nexport interface Farm {\r\n    id: string;\r\n    uuid: string;\r\n    createdAt: Date;\r\n    updatedAt: Date;\r\n\r\n    // Owner\r\n    userId: string;\r\n\r\n    // Farm Info\r\n    farmName: string;\r\n    farmAddress: string;\r\n    province: string;\r\n    district: string;\r\n    subdistrict: string;\r\n    zipCode: string | null;\r\n\r\n    // Coordinates\r\n    latitude: number | null;\r\n    longitude: number | null;\r\n\r\n    // Size\r\n    totalArea: number;\r\n    cultivatedArea: number;\r\n\r\n    // Status\r\n    isActive: boolean;\r\n\r\n    // Audit\r\n    createdBy: string | null;\r\n    updatedBy: string | null;\r\n\r\n    // Soft Delete\r\n    isDeleted: boolean;\r\n    deletedAt: Date | null;\r\n}\r\n\r\n// =============================================================================\r\n// CERTIFICATE MODEL\r\n// =============================================================================\r\n\r\nexport interface Certificate {\r\n    id: string;\r\n    uuid: string;\r\n    createdAt: Date;\r\n    updatedAt: Date;\r\n\r\n    // References\r\n    certificateNumber: string;\r\n    applicationId: string;\r\n    userId: string;\r\n    farmId: string;\r\n\r\n    // Validity\r\n    issueDate: Date;\r\n    expiryDate: Date;\r\n\r\n    // Status\r\n    isActive: boolean;\r\n    revokedAt: Date | null;\r\n    revokedReason: string | null;\r\n\r\n    // Plant\r\n    plantSpeciesId: string | null;\r\n\r\n    // Audit\r\n    issuedBy: string | null;\r\n\r\n    // Soft Delete\r\n    isDeleted: boolean;\r\n    deletedAt: Date | null;\r\n}\r\n\r\n// =============================================================================\r\n// INVOICE MODEL\r\n// =============================================================================\r\n\r\nexport interface Invoice {\r\n    id: string;\r\n    uuid: string;\r\n    createdAt: Date;\r\n    updatedAt: Date;\r\n\r\n    // References\r\n    invoiceNumber: string;\r\n    applicationId: string;\r\n    userId: string;\r\n\r\n    // Financial\r\n    subtotal: number;\r\n    tax: number;\r\n    total: number;\r\n    currency: string;\r\n\r\n    // Payment\r\n    paymentStatus: PaymentStatus;\r\n    paidAt: Date | null;\r\n    paymentMethod: string | null;\r\n    paymentSlipUrl: string | null;\r\n    confirmedBy: string | null;\r\n\r\n    // Dates\r\n    dueDate: Date;\r\n\r\n    // Audit\r\n    createdBy: string | null;\r\n\r\n    // Soft Delete\r\n    isDeleted: boolean;\r\n    deletedAt: Date | null;\r\n}\r\n\r\n// =============================================================================\r\n// NOTIFICATION MODEL\r\n// =============================================================================\r\n\r\nexport interface Notification {\r\n    id: string;\r\n    uuid: string;\r\n    createdAt: Date;\r\n\r\n    // Recipient\r\n    userId: string;\r\n\r\n    // Content\r\n    type: NotificationType;\r\n    title: string;\r\n    message: string;\r\n    link: string | null;\r\n\r\n    // Status\r\n    isRead: boolean;\r\n    readAt: Date | null;\r\n\r\n    // Expiry\r\n    expiresAt: Date | null;\r\n\r\n    // Soft Delete\r\n    isDeleted: boolean;\r\n}\r\n\r\n// =============================================================================\r\n// DOCUMENT MODEL\r\n// =============================================================================\r\n\r\nexport interface Document {\r\n    id: string;\r\n    uuid: string;\r\n    createdAt: Date;\r\n    updatedAt: Date;\r\n\r\n    // References\r\n    applicationId: string | null;\r\n    userId: string;\r\n\r\n    // File Info\r\n    documentType: string;\r\n    fileName: string;\r\n    fileUrl: string;\r\n    fileSize: number;\r\n    mimeType: string;\r\n\r\n    // Verification\r\n    isVerified: boolean;\r\n    verifiedAt: Date | null;\r\n    verifiedBy: string | null;\r\n\r\n    // Status\r\n    rejectionReason: string | null;\r\n\r\n    // Audit\r\n    uploadedBy: string;\r\n\r\n    // Soft Delete\r\n    isDeleted: boolean;\r\n    deletedAt: Date | null;\r\n}\r\n\r\n// =============================================================================\r\n// AUDIT LOG MODEL\r\n// =============================================================================\r\n\r\nexport interface AuditLog {\r\n    id: string;\r\n    createdAt: Date;\r\n    logId: string;\r\n    sequenceNumber: number;\r\n\r\n    // Classification\r\n    category: string;\r\n    action: string;\r\n    severity: AuditSeverity;\r\n\r\n    // Actor\r\n    actorId: string;\r\n    actorType: string;\r\n    actorEmail: string | null;\r\n    actorRole: string;\r\n\r\n    // Resource\r\n    resourceType: string;\r\n    resourceId: string;\r\n\r\n    // Context\r\n    ipAddress: string;\r\n    userAgent: string;\r\n\r\n    // Data\r\n    metadata: Record<string, unknown> | null;\r\n\r\n    // Result\r\n    result: string;\r\n    errorCode: string | null;\r\n    errorMessage: string | null;\r\n\r\n    // Hash Chain\r\n    previousHash: string;\r\n    currentHash: string;\r\n    hashAlgorithm: string;\r\n}\r\n\r\n// =============================================================================\r\n// PLANT SPECIES MODEL\r\n// =============================================================================\r\n\r\nexport interface PlantSpecies {\r\n    id: string;\r\n    uuid: string;\r\n    createdAt: Date;\r\n    updatedAt: Date;\r\n\r\n    // Names\r\n    thaiName: string;\r\n    scientificName: string;\r\n    commonName: string | null;\r\n\r\n    // Category\r\n    category: string;\r\n\r\n    // Requirements\r\n    requiresSpecialPermit: boolean;\r\n    documentRequirements: string[] | null;\r\n\r\n    // Status\r\n    isActive: boolean;\r\n}\r\n\r\n// =============================================================================\r\n// API RESPONSE TYPES\r\n// =============================================================================\r\n\r\nexport interface ApiResponse<T> {\r\n    success: boolean;\r\n    data?: T;\r\n    message?: string;\r\n    error?: string;\r\n    errors?: Record<string, string[]>;\r\n}\r\n\r\nexport interface PaginatedResponse<T> {\r\n    success: boolean;\r\n    data: T[];\r\n    pagination: {\r\n        page: number;\r\n        limit: number;\r\n        total: number;\r\n        totalPages: number;\r\n    };\r\n}\r\n\r\n// =============================================================================\r\n// FORM INPUT TYPES (Frontend)\r\n// =============================================================================\r\n\r\nexport interface RegistrationInput {\r\n    accountType: AccountType;\r\n    email?: string;\r\n    password: string;\r\n    confirmPassword: string;\r\n\r\n    // Individual\r\n    firstName?: string;\r\n    lastName?: string;\r\n    idCard?: string;\r\n    laserCode?: string;\r\n    phoneNumber?: string;\r\n\r\n    // Juristic\r\n    companyName?: string;\r\n    taxId?: string;\r\n    representativeName?: string;\r\n    representativePosition?: string;\r\n\r\n    // Community\r\n    communityName?: string;\r\n    communityRegistrationNo?: string;\r\n}\r\n\r\nexport interface LoginInput {\r\n    identifier: string; // email, idCard, or taxId\r\n    password: string;\r\n}\r\n\r\nexport interface ApplicationInput {\r\n    serviceType: ServiceType;\r\n    farmId?: string;\r\n    plantSpeciesId?: string;\r\n    cultivationArea?: number;\r\n    previousCertificateId?: string;\r\n}\r\n\r\nexport interface FarmInput {\r\n    farmName: string;\r\n    farmAddress: string;\r\n    province: string;\r\n    district: string;\r\n    subdistrict: string;\r\n    zipCode?: string;\r\n    latitude?: number;\r\n    longitude?: number;\r\n    totalArea: number;\r\n    cultivatedArea: number;\r\n}\r\n\r\nexport default {\r\n    // Re-export for convenience\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\utils\\__tests__\\error-translator.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\utils\\__tests__\\thai-id-validator.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\utils\\api-mapper.ts","messages":[{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":285,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":298,"endColumn":3}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ๐ Apple-Standard API Mapper\r\n * \r\n * Bidirectional mapping between snake_case (PostgreSQL/API) and camelCase (Frontend)\r\n * Ensures data consistency across Database โ” Backend โ” Frontend\r\n * \r\n * Usage:\r\n * import { toApi, fromApi, mapFields } from '@/utils/api-mapper';\r\n * const apiData = toApi(frontendData);    // camelCase โ’ snake_case\r\n * const frontendData = fromApi(apiData);  // snake_case โ’ camelCase\r\n */\r\n\r\n// =============================================================================\r\n// CASE CONVERSION UTILITIES\r\n// =============================================================================\r\n\r\n/**\r\n * Convert camelCase to snake_case\r\n * Example: \"firstName\" โ’ \"first_name\"\r\n */\r\nexport function camelToSnake(str: string): string {\r\n    return str.replace(/[A-Z]/g, letter => `_${letter.toLowerCase()}`);\r\n}\r\n\r\n/**\r\n * Convert snake_case to camelCase\r\n * Example: \"first_name\" โ’ \"firstName\"\r\n */\r\nexport function snakeToCamel(str: string): string {\r\n    return str.replace(/_([a-z])/g, (_, letter) => letter.toUpperCase());\r\n}\r\n\r\n// =============================================================================\r\n// OBJECT MAPPERS\r\n// =============================================================================\r\n\r\n/**\r\n * Convert object keys from camelCase to snake_case (Frontend โ’ API)\r\n * Deep conversion for nested objects and arrays\r\n */\r\nexport function toApi<T extends Record<string, unknown>>(obj: T): Record<string, unknown> {\r\n    if (obj === null || obj === undefined) return obj as unknown as Record<string, unknown>;\r\n\r\n    if (Array.isArray(obj)) {\r\n        return obj.map(item =>\r\n            typeof item === 'object' && item !== null\r\n                ? toApi(item as Record<string, unknown>)\r\n                : item\r\n        ) as unknown as Record<string, unknown>;\r\n    }\r\n\r\n    if (typeof obj !== 'object') return obj as unknown as Record<string, unknown>;\r\n\r\n    const result: Record<string, unknown> = {};\r\n\r\n    for (const [key, value] of Object.entries(obj)) {\r\n        const snakeKey = camelToSnake(key);\r\n\r\n        if (value !== null && typeof value === 'object') {\r\n            result[snakeKey] = toApi(value as Record<string, unknown>);\r\n        } else {\r\n            result[snakeKey] = value;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Convert object keys from snake_case to camelCase (API โ’ Frontend)\r\n * Deep conversion for nested objects and arrays\r\n */\r\nexport function fromApi<T = Record<string, unknown>>(obj: Record<string, unknown>): T {\r\n    if (obj === null || obj === undefined) return obj as unknown as T;\r\n\r\n    if (Array.isArray(obj)) {\r\n        return obj.map(item =>\r\n            typeof item === 'object' && item !== null\r\n                ? fromApi(item as Record<string, unknown>)\r\n                : item\r\n        ) as unknown as T;\r\n    }\r\n\r\n    if (typeof obj !== 'object') return obj as unknown as T;\r\n\r\n    const result: Record<string, unknown> = {};\r\n\r\n    for (const [key, value] of Object.entries(obj)) {\r\n        const camelKey = snakeToCamel(key);\r\n\r\n        if (value !== null && typeof value === 'object') {\r\n            result[camelKey] = fromApi(value as Record<string, unknown>);\r\n        } else {\r\n            result[camelKey] = value;\r\n        }\r\n    }\r\n\r\n    return result as T;\r\n}\r\n\r\n// =============================================================================\r\n// FIELD MAPPING\r\n// =============================================================================\r\n\r\n/**\r\n * Explicit field mapping for known database columns\r\n * More reliable than automatic conversion for edge cases\r\n */\r\nexport const FIELD_MAP = {\r\n    // API (snake_case) โ’ Frontend (camelCase)\r\n    toFrontend: {\r\n        // User fields\r\n        id_card: 'idCard',\r\n        id_card_hash: 'idCardHash',\r\n        laser_code: 'laserCode',\r\n        first_name: 'firstName',\r\n        last_name: 'lastName',\r\n        phone_number: 'phoneNumber',\r\n        account_type: 'accountType',\r\n        tax_id: 'taxId',\r\n        tax_id_hash: 'taxIdHash',\r\n        company_name: 'companyName',\r\n        community_name: 'communityName',\r\n        community_registration_no: 'communityRegistrationNo',\r\n        representative_name: 'representativeName',\r\n        representative_position: 'representativePosition',\r\n\r\n        // Timestamps\r\n        created_at: 'createdAt',\r\n        updated_at: 'updatedAt',\r\n        deleted_at: 'deletedAt',\r\n        submitted_at: 'submittedAt',\r\n        approved_at: 'approvedAt',\r\n        issued_at: 'issuedAt',\r\n        expires_at: 'expiresAt',\r\n        last_login_at: 'lastLoginAt',\r\n\r\n        // Application fields\r\n        application_id: 'applicationId',\r\n        service_type: 'serviceType',\r\n        application_status: 'applicationStatus',\r\n\r\n        // Certificate fields\r\n        certificate_number: 'certificateNumber',\r\n        issue_date: 'issueDate',\r\n        expiry_date: 'expiryDate',\r\n\r\n        // Farm fields\r\n        farm_id: 'farmId',\r\n        farm_name: 'farmName',\r\n        total_area: 'totalArea',\r\n\r\n        // Document fields\r\n        document_type: 'documentType',\r\n        file_url: 'fileUrl',\r\n        file_size: 'fileSize',\r\n        uploaded_at: 'uploadedAt',\r\n\r\n        // Audit fields\r\n        created_by: 'createdBy',\r\n        updated_by: 'updatedBy',\r\n        deleted_by: 'deletedBy',\r\n        created_by_ip: 'createdByIp',\r\n        updated_by_ip: 'updatedByIp',\r\n\r\n        // Flags\r\n        is_deleted: 'isDeleted',\r\n        is_locked: 'isLocked',\r\n        is_email_verified: 'isEmailVerified',\r\n    } as Record<string, string>,\r\n\r\n    // Frontend (camelCase) โ’ API (snake_case)\r\n    toApi: {} as Record<string, string>,\r\n};\r\n\r\n// Build reverse mapping\r\nfor (const [snake, camel] of Object.entries(FIELD_MAP.toFrontend)) {\r\n    FIELD_MAP.toApi[camel] = snake;\r\n}\r\n\r\n/**\r\n * Map a single field name using explicit mapping\r\n * Falls back to automatic conversion\r\n */\r\nexport function mapFieldName(field: string, direction: 'toApi' | 'toFrontend'): string {\r\n    const mapping = direction === 'toApi' ? FIELD_MAP.toApi : FIELD_MAP.toFrontend;\r\n\r\n    if (field in mapping) {\r\n        return mapping[field];\r\n    }\r\n\r\n    // Fallback to automatic conversion\r\n    return direction === 'toApi' ? camelToSnake(field) : snakeToCamel(field);\r\n}\r\n\r\n/**\r\n * Map object fields using explicit mapping\r\n */\r\nexport function mapFields<T extends Record<string, unknown>>(\r\n    obj: T,\r\n    direction: 'toApi' | 'toFrontend'\r\n): Record<string, unknown> {\r\n    if (!obj || typeof obj !== 'object') return obj as Record<string, unknown>;\r\n\r\n    const result: Record<string, unknown> = {};\r\n\r\n    for (const [key, value] of Object.entries(obj)) {\r\n        const mappedKey = mapFieldName(key, direction);\r\n\r\n        if (value !== null && typeof value === 'object' && !Array.isArray(value)) {\r\n            result[mappedKey] = mapFields(value as Record<string, unknown>, direction);\r\n        } else if (Array.isArray(value)) {\r\n            result[mappedKey] = value.map(item =>\r\n                typeof item === 'object' && item !== null\r\n                    ? mapFields(item as Record<string, unknown>, direction)\r\n                    : item\r\n            );\r\n        } else {\r\n            result[mappedKey] = value;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n// =============================================================================\r\n// API RESPONSE HELPERS\r\n// =============================================================================\r\n\r\n/**\r\n * Parse API response and convert to frontend format\r\n */\r\nexport function parseApiResponse<T>(response: { data?: unknown; success?: boolean }): T | null {\r\n    if (!response.success || !response.data) {\r\n        return null;\r\n    }\r\n\r\n    return fromApi(response.data as Record<string, unknown>) as T;\r\n}\r\n\r\n/**\r\n * Prepare data for API request\r\n */\r\nexport function prepareApiRequest<T extends Record<string, unknown>>(data: T): Record<string, unknown> {\r\n    return toApi(data);\r\n}\r\n\r\n// =============================================================================\r\n// DATE HANDLING\r\n// =============================================================================\r\n\r\n/**\r\n * Parse ISO date string to Date object\r\n */\r\nexport function parseDate(dateString: string | null | undefined): Date | null {\r\n    if (!dateString) return null;\r\n    const date = new Date(dateString);\r\n    return isNaN(date.getTime()) ? null : date;\r\n}\r\n\r\n/**\r\n * Format Date to ISO string for API\r\n */\r\nexport function formatDateForApi(date: Date | null | undefined): string | null {\r\n    if (!date) return null;\r\n    return date.toISOString();\r\n}\r\n\r\n/**\r\n * Format date for Thai display (DD/MM/YYYY + เธ.เธจ.)\r\n */\r\nexport function formatThaiDate(date: Date | string | null | undefined): string {\r\n    if (!date) return '-';\r\n\r\n    const d = typeof date === 'string' ? new Date(date) : date;\r\n    if (isNaN(d.getTime())) return '-';\r\n\r\n    const day = d.getDate().toString().padStart(2, '0');\r\n    const month = (d.getMonth() + 1).toString().padStart(2, '0');\r\n    const year = d.getFullYear() + 543; // Convert to Buddhist Era\r\n\r\n    return `${day}/${month}/${year}`;\r\n}\r\n\r\nexport default {\r\n    toApi,\r\n    fromApi,\r\n    mapFields,\r\n    mapFieldName,\r\n    camelToSnake,\r\n    snakeToCamel,\r\n    parseApiResponse,\r\n    prepareApiRequest,\r\n    parseDate,\r\n    formatDateForApi,\r\n    formatThaiDate,\r\n    FIELD_MAP,\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\utils\\error-translator.ts","messages":[{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":69,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":69,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Error Translator Utility\r\n * Translates English API errors to Thai for user-friendly display\r\n * \r\n * @author GACP Engineering Team\r\n * @version 1.0.0\r\n */\r\n\r\n// Error message mapping (English โ’ Thai)\r\nconst errorMap: Record<string, string> = {\r\n    // Login errors\r\n    \"Invalid credentials\": \"เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธซเธฃเธทเธญเธฃเธซเธฑเธชเธเนเธฒเธเนเธกเนเธ–เธนเธเธ•เนเธญเธ\",\r\n    \"Invalid email or password\": \"เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธซเธฃเธทเธญเธฃเธซเธฑเธชเธเนเธฒเธเนเธกเนเธ–เธนเธเธ•เนเธญเธ\",\r\n    \"User not found\": \"เนเธกเนเธเธเธเธฑเธเธเธตเธเธนเนเนเธเนเธเธตเน เธเธฃเธธเธ“เธฒเธฅเธเธ—เธฐเน€เธเธตเธขเธเธเนเธญเธ\",\r\n    \"Account is locked\": \"เธเธฑเธเธเธตเธ–เธนเธเธฅเนเธญเธ เธเธฃเธธเธ“เธฒเธฃเธญ 30 เธเธฒเธ—เธตเนเธฅเนเธงเธฅเธญเธเนเธซเธกเน\",\r\n    \"Account locked. Try again in\": \"เธเธฑเธเธเธตเธ–เธนเธเธฅเนเธญเธเธเธฑเนเธงเธเธฃเธฒเธง เธเธฃเธธเธ“เธฒเธฃเธญเธชเธฑเธเธเธฃเธนเนเนเธฅเนเธงเธฅเธญเธเนเธซเธกเน\",\r\n    \"Account is disabled\": \"เธเธฑเธเธเธตเธเธตเนเธ–เธนเธเธฃเธฐเธเธฑเธเธเธฒเธฃเนเธเนเธเธฒเธ\",\r\n    \"Account not verified\": \"เธเธฑเธเธเธตเธขเธฑเธเนเธกเนเนเธ”เนเธขเธทเธเธขเธฑเธเธ•เธฑเธงเธ•เธ\",\r\n    \"Password incorrect\": \"เธฃเธซเธฑเธชเธเนเธฒเธเนเธกเนเธ–เธนเธเธ•เนเธญเธ\",\r\n\r\n    // Registration errors\r\n    \"User already exists\": \"เธกเธตเธเธฑเธเธเธตเธเธนเนเนเธเนเธเธตเนเนเธฅเนเธง เธเธฃเธธเธ“เธฒเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ\",\r\n    \"Email already registered\": \"เธญเธตเน€เธกเธฅเธเธตเนเธ–เธนเธเนเธเนเธเธฒเธเนเธฅเนเธง\",\r\n    \"Phone already registered\": \"เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เนเธเธตเนเธ–เธนเธเนเธเนเธเธฒเธเนเธฅเนเธง\",\r\n    \"Invalid Laser Code format\": \"เธฃเธนเธเนเธเธเน€เธฅเธ Laser Code เนเธกเนเธ–เธนเธเธ•เนเธญเธ\",\r\n    \"Invalid ID format\": \"เธฃเธนเธเนเธเธเน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเนเธกเนเธ–เธนเธเธ•เนเธญเธ\",\r\n\r\n    // Network errors\r\n    \"Failed to fetch\": \"เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เน€เธเธทเนเธญเธกเธ•เนเธญเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเนเธ”เน เธเธฃเธธเธ“เธฒเธ•เธฃเธงเธเธชเธญเธเธญเธดเธเน€เธ—เธญเธฃเนเน€เธเนเธ•\",\r\n    \"Network Error\": \"เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เน€เธเธทเนเธญเธกเธ•เนเธญเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเนเธ”เน\",\r\n    \"Internal Server Error\": \"เน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเธกเธตเธเธฑเธเธซเธฒ เธเธฃเธธเธ“เธฒเธฅเธญเธเนเธซเธกเนเธ เธฒเธขเธซเธฅเธฑเธ\",\r\n    \"Service Unavailable\": \"เธฃเธฐเธเธเนเธกเนเธเธฃเนเธญเธกเนเธซเนเธเธฃเธดเธเธฒเธฃเธเธฑเนเธงเธเธฃเธฒเธง\",\r\n\r\n    // Validation errors\r\n    \"Password too weak\": \"เธฃเธซเธฑเธชเธเนเธฒเธเนเธกเนเธเธฅเธญเธ”เธ เธฑเธขเน€เธเธตเธขเธเธเธญ\",\r\n    \"Passwords do not match\": \"เธฃเธซเธฑเธชเธเนเธฒเธเนเธกเนเธ•เธฃเธเธเธฑเธ\",\r\n    \"Invalid phone number\": \"เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เนเนเธกเนเธ–เธนเธเธ•เนเธญเธ\",\r\n    \"Invalid email\": \"เธญเธตเน€เธกเธฅเนเธกเนเธ–เธนเธเธ•เนเธญเธ\",\r\n};\r\n\r\n/**\r\n * Translate English API error to Thai\r\n * @param englishError - Error message from API\r\n * @returns Thai translated error message\r\n */\r\nexport function translateError(englishError: string): string {\r\n    // Check exact match first\r\n    if (errorMap[englishError]) {\r\n        return errorMap[englishError];\r\n    }\r\n\r\n    // Check partial matches (case-insensitive)\r\n    for (const [key, value] of Object.entries(errorMap)) {\r\n        if (englishError.toLowerCase().includes(key.toLowerCase())) {\r\n            return value;\r\n        }\r\n    }\r\n\r\n    // If error contains English, return generic Thai error\r\n    if (/[a-z]/i.test(englishError)) {\r\n        return \"เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ” เธเธฃเธธเธ“เธฒเธฅเธญเธเนเธซเธกเนเธญเธตเธเธเธฃเธฑเนเธ\";\r\n    }\r\n\r\n    // Return original if already in Thai or unknown format\r\n    return englishError;\r\n}\r\n\r\n// Default export\r\nexport default { translateError };\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\utils\\thai-date.ts","messages":[{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":98,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":104,"endColumn":3}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ๐“… Thai Date Utilities\r\n * เธชเธณเธซเธฃเธฑเธเธฃเธฐเธเธเธฃเธฒเธเธเธฒเธฃเนเธ—เธข GACP\r\n */\r\n\r\n/**\r\n * Format date to Thai short format (8 เธ.เธ. 67)\r\n */\r\nexport function formatThaiDate(dateString: string | Date | null | undefined): string {\r\n    if (!dateString) return \"-\";\r\n\r\n    const date = typeof dateString === 'string' ? new Date(dateString) : dateString;\r\n    if (isNaN(date.getTime())) return \"-\";\r\n\r\n    return date.toLocaleDateString('th-TH', {\r\n        day: 'numeric',\r\n        month: 'short',\r\n        year: '2-digit',\r\n    });\r\n}\r\n\r\n/**\r\n * Format date to Thai long format (8 เธเธฑเธเธงเธฒเธเธก 2567)\r\n */\r\nexport function formatThaiDateLong(dateString: string | Date | null | undefined): string {\r\n    if (!dateString) return \"-\";\r\n\r\n    const date = typeof dateString === 'string' ? new Date(dateString) : dateString;\r\n    if (isNaN(date.getTime())) return \"-\";\r\n\r\n    return date.toLocaleDateString('th-TH', {\r\n        day: 'numeric',\r\n        month: 'long',\r\n        year: 'numeric',\r\n    });\r\n}\r\n\r\n/**\r\n * Format date to numeric format (08/12/2567)\r\n */\r\nexport function formatThaiDateNumeric(dateString: string | Date | null | undefined): string {\r\n    if (!dateString) return \"-\";\r\n\r\n    const date = typeof dateString === 'string' ? new Date(dateString) : dateString;\r\n    if (isNaN(date.getTime())) return \"-\";\r\n\r\n    const day = date.getDate().toString().padStart(2, '0');\r\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\r\n    const thaiYear = date.getFullYear() + 543;\r\n\r\n    return `${day}/${month}/${thaiYear}`;\r\n}\r\n\r\n/**\r\n * Format datetime to Thai format with time\r\n */\r\nexport function formatThaiDateTime(dateString: string | Date | null | undefined): string {\r\n    if (!dateString) return \"-\";\r\n\r\n    const date = typeof dateString === 'string' ? new Date(dateString) : dateString;\r\n    if (isNaN(date.getTime())) return \"-\";\r\n\r\n    const dateStr = date.toLocaleDateString('th-TH', {\r\n        day: 'numeric',\r\n        month: 'short',\r\n        year: '2-digit',\r\n    });\r\n\r\n    const timeStr = date.toLocaleTimeString('th-TH', {\r\n        hour: '2-digit',\r\n        minute: '2-digit',\r\n    });\r\n\r\n    return `${dateStr} ${timeStr} เธ.`;\r\n}\r\n\r\n/**\r\n * Get relative time in Thai (เธงเธฑเธเธเธตเน, เน€เธกเธทเนเธญเธงเธฒเธ, 3 เธงเธฑเธเธเนเธญเธ)\r\n */\r\nexport function formatThaiRelative(dateString: string | Date | null | undefined): string {\r\n    if (!dateString) return \"-\";\r\n\r\n    const date = typeof dateString === 'string' ? new Date(dateString) : dateString;\r\n    if (isNaN(date.getTime())) return \"-\";\r\n\r\n    const now = new Date();\r\n    const diffMs = now.getTime() - date.getTime();\r\n    const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\r\n\r\n    if (diffDays === 0) return \"เธงเธฑเธเธเธตเน\";\r\n    if (diffDays === 1) return \"เน€เธกเธทเนเธญเธงเธฒเธ\";\r\n    if (diffDays < 7) return `${diffDays} เธงเธฑเธเธเนเธญเธ`;\r\n    if (diffDays < 30) return `${Math.floor(diffDays / 7)} เธชเธฑเธเธ”เธฒเธซเนเธเนเธญเธ`;\r\n    if (diffDays < 365) return `${Math.floor(diffDays / 30)} เน€เธ”เธทเธญเธเธเนเธญเธ`;\r\n    return `${Math.floor(diffDays / 365)} เธเธตเธเนเธญเธ`;\r\n}\r\n\r\nexport default {\r\n    formatThaiDate,\r\n    formatThaiDateLong,\r\n    formatThaiDateNumeric,\r\n    formatThaiDateTime,\r\n    formatThaiRelative,\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\utils\\thai-id-validator.ts","messages":[{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":159,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":165,"endColumn":3}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Thai National ID Validator\r\n * ๐ Apple Zero-Crash Production Standard\r\n * \r\n * Validates 13-digit Thai National ID (Laser Code) using Checksum Algorithm:\r\n * CheckDigit = (11 - (ฮฃ digit[i] ร— (13-i)) % 11) % 10\r\n * \r\n * @author GACP Engineering Team\r\n * @version 1.0.0\r\n */\r\n\r\nexport interface ThaiIdValidationResult {\r\n    isValid: boolean;\r\n    formatted: string;\r\n    error?: string;\r\n    idType?: 'INDIVIDUAL' | 'JURISTIC' | 'COMMUNITY_ENTERPRISE';\r\n}\r\n\r\n/**\r\n * Validates Thai 13-digit National ID\r\n * @param id - The 13-digit ID string (with or without dashes)\r\n * @returns Validation result with formatted ID\r\n */\r\nexport function validateThaiId(id: string): ThaiIdValidationResult {\r\n    // Remove all non-digit characters\r\n    const cleanId = id.replace(/\\D/g, '');\r\n\r\n    // Check length\r\n    if (cleanId.length !== 13) {\r\n        return {\r\n            isValid: false,\r\n            formatted: id,\r\n            error: 'เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธ•เนเธญเธเธกเธต 13 เธซเธฅเธฑเธ',\r\n        };\r\n    }\r\n\r\n    // Calculate checksum using Apple-recommended formula\r\n    // CheckDigit = (11 - (ฮฃ digit[i] ร— (13-i)) % 11) % 10\r\n    let sum = 0;\r\n    for (let i = 0; i < 12; i++) {\r\n        sum += parseInt(cleanId[i], 10) * (13 - i);\r\n    }\r\n\r\n    const calculatedCheckDigit = (11 - (sum % 11)) % 10;\r\n    const actualCheckDigit = parseInt(cleanId[12], 10);\r\n\r\n    if (calculatedCheckDigit !== actualCheckDigit) {\r\n        return {\r\n            isValid: false,\r\n            formatted: formatThaiId(cleanId),\r\n            error: 'เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเนเธกเนเธ–เธนเธเธ•เนเธญเธ (เธเธฅเธฃเธงเธกเธ•เธฃเธงเธเธชเธญเธเนเธกเนเธ•เธฃเธ)',\r\n        };\r\n    }\r\n\r\n    // Determine ID type based on first digit\r\n    const firstDigit = cleanId[0];\r\n    let idType: 'INDIVIDUAL' | 'JURISTIC' | 'COMMUNITY_ENTERPRISE' = 'INDIVIDUAL';\r\n\r\n    if (firstDigit === '0') {\r\n        idType = 'JURISTIC'; // Juristic person ID\r\n    } else if (['1', '2', '3', '4', '5', '6', '7', '8'].includes(firstDigit)) {\r\n        idType = 'INDIVIDUAL'; // Thai National ID\r\n    }\r\n\r\n    return {\r\n        isValid: true,\r\n        formatted: formatThaiId(cleanId),\r\n        idType,\r\n    };\r\n}\r\n\r\n/**\r\n * Format Thai ID with dashes: X-XXXX-XXXXX-XX-X\r\n * @param id - Clean 13-digit ID\r\n * @returns Formatted ID string\r\n */\r\nexport function formatThaiId(id: string): string {\r\n    const clean = id.replace(/\\D/g, '');\r\n    if (clean.length !== 13) return id;\r\n\r\n    return `${clean[0]}-${clean.slice(1, 5)}-${clean.slice(5, 10)}-${clean.slice(10, 12)}-${clean[12]}`;\r\n}\r\n\r\n/**\r\n * Validates Juristic Person ID (13 digits starting with 0)\r\n * @param id - The juristic ID string\r\n * @returns Validation result\r\n */\r\nexport function validateJuristicId(id: string): ThaiIdValidationResult {\r\n    const result = validateThaiId(id);\r\n\r\n    if (result.isValid) {\r\n        const clean = id.replace(/\\D/g, '');\r\n        if (clean[0] !== '0') {\r\n            return {\r\n                isValid: false,\r\n                formatted: result.formatted,\r\n                error: 'เน€เธฅเธเธ—เธฐเน€เธเธตเธขเธเธเธดเธ•เธดเธเธธเธเธเธฅเธ•เนเธญเธเธเธถเนเธเธ•เนเธเธ”เนเธงเธข 0',\r\n            };\r\n        }\r\n        result.idType = 'JURISTIC';\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Validates Community Enterprise ID (format: XXXX-XXXX-XXX)\r\n * @param id - The community enterprise ID string\r\n * @returns Validation result\r\n */\r\nexport function validateCommunityEnterpriseId(id: string): ThaiIdValidationResult {\r\n    const clean = id.replace(/\\D/g, '');\r\n\r\n    // Community enterprise IDs are typically 11-13 digits\r\n    if (clean.length < 11 || clean.length > 13) {\r\n        return {\r\n            isValid: false,\r\n            formatted: id,\r\n            error: 'เน€เธฅเธเธ—เธฐเน€เธเธตเธขเธเธงเธดเธชเธฒเธซเธเธดเธเธเธธเธกเธเธเนเธกเนเธ–เธนเธเธ•เนเธญเธ',\r\n        };\r\n    }\r\n\r\n    // Format as XXXX-XXXX-XXX\r\n    const formatted = clean.length >= 11\r\n        ? `${clean.slice(0, 4)}-${clean.slice(4, 8)}-${clean.slice(8)}`\r\n        : id;\r\n\r\n    return {\r\n        isValid: true,\r\n        formatted,\r\n        idType: 'COMMUNITY_ENTERPRISE',\r\n    };\r\n}\r\n\r\n/**\r\n * Unified ID validator based on account type\r\n * @param id - The ID string\r\n * @param accountType - Type of account\r\n * @returns Validation result\r\n */\r\nexport function validateIdByType(\r\n    id: string,\r\n    accountType: 'INDIVIDUAL' | 'JURISTIC' | 'COMMUNITY_ENTERPRISE'\r\n): ThaiIdValidationResult {\r\n    switch (accountType) {\r\n        case 'INDIVIDUAL':\r\n            return validateThaiId(id);\r\n        case 'JURISTIC':\r\n            return validateJuristicId(id);\r\n        case 'COMMUNITY_ENTERPRISE':\r\n            return validateCommunityEnterpriseId(id);\r\n        default:\r\n            return validateThaiId(id);\r\n    }\r\n}\r\n\r\n// Default export for convenience\r\nexport default {\r\n    validateThaiId,\r\n    validateJuristicId,\r\n    validateCommunityEnterpriseId,\r\n    validateIdByType,\r\n    formatThaiId,\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\usEr\\Documents\\GitHub\\GACP-Certification-Application\\apps\\web-app\\src\\utils\\validation.ts","messages":[{"ruleId":"prefer-const","severity":2,"message":"'checkDigit' is never reassigned. Use 'const' instead.","line":54,"column":9,"nodeType":"Identifier","messageId":"useConst","endLine":54,"endColumn":19,"fix":{"range":[1669,1709],"text":"const checkDigit = (11 - (sum % 11)) % 10;"}},{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":308,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":321,"endColumn":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\r\n * ๐ Apple-Standard Validation Utilities\r\n * \r\n * Centralized validation functions for Thai documents and business rules\r\n * Unit tested for accuracy (critical for DTAM compliance)\r\n * \r\n * Usage:\r\n * import { validateThaiIdCard, validateLaserCode } from '@/utils/validation';\r\n */\r\n\r\n// =============================================================================\r\n// THAI ID CARD VALIDATION\r\n// =============================================================================\r\n\r\n/**\r\n * Validate Thai National ID Card (13 digits)\r\n * Uses checksum algorithm as per Thai ID card standard\r\n * \r\n * Algorithm:\r\n * 1. First 12 digits ร— weights [13,12,11,10,9,8,7,6,5,4,3,2]\r\n * 2. Sum all products\r\n * 3. Mod 11, subtract from 11\r\n * 4. If result > 9, mod 10\r\n * 5. Compare with 13th digit (check digit)\r\n * \r\n * @param idCard - 13-digit Thai ID card number\r\n * @returns Validation result with error message if invalid\r\n */\r\nexport function validateThaiIdCard(idCard: string): { valid: boolean; error?: string } {\r\n    // Remove all non-digits\r\n    const cleanId = idCard.replace(/\\D/g, '');\r\n\r\n    // Must be exactly 13 digits\r\n    if (cleanId.length !== 13) {\r\n        return { valid: false, error: 'เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธเธ•เนเธญเธเธกเธต 13 เธซเธฅเธฑเธ' };\r\n    }\r\n\r\n    // Convert to array of numbers\r\n    const digits = cleanId.split('').map(Number);\r\n\r\n    // Cannot start with 0\r\n    if (digits[0] === 0) {\r\n        return { valid: false, error: 'เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธเนเธกเนเธ–เธนเธเธ•เนเธญเธ' };\r\n    }\r\n\r\n    // Calculate checksum\r\n    const weights = [13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2];\r\n    let sum = 0;\r\n\r\n    for (let i = 0; i < 12; i++) {\r\n        sum += digits[i] * weights[i];\r\n    }\r\n\r\n    let checkDigit = (11 - (sum % 11)) % 10;\r\n\r\n    // Compare with last digit\r\n    if (checkDigit !== digits[12]) {\r\n        return { valid: false, error: 'เน€เธฅเธเธเธฑเธ•เธฃเธเธฃเธฐเธเธฒเธเธเนเธกเนเธ–เธนเธเธ•เนเธญเธ (checksum เนเธกเนเธ•เธฃเธ)' };\r\n    }\r\n\r\n    return { valid: true };\r\n}\r\n\r\n/**\r\n * Format Thai ID card for display (X-XXXX-XXXXX-XX-X)\r\n */\r\nexport function formatThaiIdCard(idCard: string): string {\r\n    const clean = idCard.replace(/\\D/g, '');\r\n    if (clean.length !== 13) return idCard;\r\n\r\n    return `${clean[0]}-${clean.slice(1, 5)}-${clean.slice(5, 10)}-${clean.slice(10, 12)}-${clean[12]}`;\r\n}\r\n\r\n/**\r\n * Mask Thai ID card for privacy (X-XXXX-XXXXX-XX-X โ’ X-XXXX-XXXXX-**-*)\r\n */\r\nexport function maskThaiIdCard(idCard: string): string {\r\n    const clean = idCard.replace(/\\D/g, '');\r\n    if (clean.length !== 13) return idCard;\r\n\r\n    return `${clean[0]}-${clean.slice(1, 5)}-${clean.slice(5, 10)}-**-*`;\r\n}\r\n\r\n// =============================================================================\r\n// LASER CODE VALIDATION\r\n// =============================================================================\r\n\r\n/**\r\n * Validate Thai ID Card Laser Code\r\n * Format: XX0-XXXXXXX-XX (12 characters with hyphens)\r\n * \r\n * @param laserCode - Laser code from Thai ID card\r\n * @returns Validation result with error message if invalid\r\n */\r\nexport function validateLaserCode(laserCode: string): { valid: boolean; error?: string } {\r\n    // Remove all non-alphanumeric\r\n    const clean = laserCode.replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n\r\n    // Must be exactly 12 characters\r\n    if (clean.length !== 12) {\r\n        return { valid: false, error: 'เธฃเธซเธฑเธช Laser เธ•เนเธญเธเธกเธต 12 เธ•เธฑเธงเธญเธฑเธเธฉเธฃ' };\r\n    }\r\n\r\n    // Format: 2 letters + 1 digit + 7 digits + 2 digits\r\n    const pattern = /^[A-Z]{2}[0-9]{10}$/;\r\n\r\n    if (!pattern.test(clean)) {\r\n        return { valid: false, error: 'เธฃเธนเธเนเธเธเธฃเธซเธฑเธช Laser เนเธกเนเธ–เธนเธเธ•เนเธญเธ' };\r\n    }\r\n\r\n    return { valid: true };\r\n}\r\n\r\n/**\r\n * Format Laser Code for display (XX0-XXXXXXX-XX)\r\n */\r\nexport function formatLaserCode(laserCode: string): string {\r\n    const clean = laserCode.replace(/[^A-Za-z0-9]/g, '').toUpperCase();\r\n    if (clean.length !== 12) return laserCode;\r\n\r\n    return `${clean.slice(0, 3)}-${clean.slice(3, 10)}-${clean.slice(10)}`;\r\n}\r\n\r\n// =============================================================================\r\n// TAX ID VALIDATION\r\n// =============================================================================\r\n\r\n/**\r\n * Validate Thai Tax ID (13 digits for companies)\r\n * \r\n * @param taxId - 13-digit Tax ID\r\n * @returns Validation result\r\n */\r\nexport function validateTaxId(taxId: string): { valid: boolean; error?: string } {\r\n    const clean = taxId.replace(/\\D/g, '');\r\n\r\n    if (clean.length !== 13) {\r\n        return { valid: false, error: 'เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธตเธ•เนเธญเธเธกเธต 13 เธซเธฅเธฑเธ' };\r\n    }\r\n\r\n    // First digit should be 0 for companies\r\n    if (clean[0] !== '0') {\r\n        return { valid: false, error: 'เน€เธฅเธเธเธฃเธฐเธเธณเธ•เธฑเธงเธเธนเนเน€เธชเธตเธขเธ เธฒเธฉเธตเธเธดเธ•เธดเธเธธเธเธเธฅเธ•เนเธญเธเธเธถเนเธเธ•เนเธเธ”เนเธงเธข 0' };\r\n    }\r\n\r\n    return { valid: true };\r\n}\r\n\r\n// =============================================================================\r\n// PHONE NUMBER VALIDATION\r\n// =============================================================================\r\n\r\n/**\r\n * Validate Thai Phone Number\r\n * Accepts formats: 0XXXXXXXXX, 66XXXXXXXXX, +66XXXXXXXXX\r\n * \r\n * @param phone - Phone number\r\n * @returns Validation result\r\n */\r\nexport function validateThaiPhone(phone: string): { valid: boolean; error?: string } {\r\n    // Remove all non-digits except +\r\n    let clean = phone.replace(/[^\\d+]/g, '');\r\n\r\n    // Convert international format to local\r\n    if (clean.startsWith('+66')) {\r\n        clean = '0' + clean.slice(3);\r\n    } else if (clean.startsWith('66')) {\r\n        clean = '0' + clean.slice(2);\r\n    }\r\n\r\n    // Must be 10 digits starting with 0\r\n    if (!/^0[0-9]{9}$/.test(clean)) {\r\n        return { valid: false, error: 'เธซเธกเธฒเธขเน€เธฅเธเนเธ—เธฃเธจเธฑเธเธ—เนเนเธกเนเธ–เธนเธเธ•เนเธญเธ' };\r\n    }\r\n\r\n    // Check valid prefixes (mobile: 06, 08, 09 | landline: 02, 03, 04, 05, 07)\r\n    const validPrefixes = ['02', '03', '04', '05', '06', '07', '08', '09'];\r\n    const prefix = clean.slice(0, 2);\r\n\r\n    if (!validPrefixes.includes(prefix)) {\r\n        return { valid: false, error: 'เธซเธกเธฒเธขเน€เธฅเธเนเธ—เธฃเธจเธฑเธเธ—เนเนเธกเนเธ–เธนเธเธ•เนเธญเธ' };\r\n    }\r\n\r\n    return { valid: true };\r\n}\r\n\r\n/**\r\n * Format Thai phone for display\r\n */\r\nexport function formatThaiPhone(phone: string): string {\r\n    const clean = phone.replace(/[^\\d]/g, '');\r\n\r\n    // Mobile: 0XX-XXX-XXXX\r\n    if (clean.length === 10 && /^0[6-9]/.test(clean)) {\r\n        return `${clean.slice(0, 3)}-${clean.slice(3, 6)}-${clean.slice(6)}`;\r\n    }\r\n\r\n    // Landline: 0X-XXX-XXXX\r\n    if (clean.length === 9 && /^0[2-5]/.test(clean)) {\r\n        return `${clean.slice(0, 2)}-${clean.slice(2, 5)}-${clean.slice(5)}`;\r\n    }\r\n\r\n    return phone;\r\n}\r\n\r\n// =============================================================================\r\n// EMAIL VALIDATION\r\n// =============================================================================\r\n\r\n/**\r\n * Validate email address\r\n * Uses RFC 5322 compliant regex\r\n */\r\nexport function validateEmail(email: string): { valid: boolean; error?: string } {\r\n    const pattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\r\n\r\n    if (!pattern.test(email)) {\r\n        return { valid: false, error: 'เธฃเธนเธเนเธเธเธญเธตเน€เธกเธฅเนเธกเนเธ–เธนเธเธ•เนเธญเธ' };\r\n    }\r\n\r\n    return { valid: true };\r\n}\r\n\r\n// =============================================================================\r\n// PASSWORD VALIDATION\r\n// =============================================================================\r\n\r\n/**\r\n * Validate password strength (DTAM security requirements)\r\n * \r\n * Requirements:\r\n * - Minimum 8 characters\r\n * - At least 1 uppercase letter\r\n * - At least 1 lowercase letter\r\n * - At least 1 number\r\n * - At least 1 special character\r\n */\r\nexport function validatePassword(password: string): {\r\n    valid: boolean;\r\n    error?: string;\r\n    strength: 'weak' | 'medium' | 'strong';\r\n    requirements: {\r\n        minLength: boolean;\r\n        hasUppercase: boolean;\r\n        hasLowercase: boolean;\r\n        hasNumber: boolean;\r\n        hasSpecial: boolean;\r\n    };\r\n} {\r\n    const requirements = {\r\n        minLength: password.length >= 8,\r\n        hasUppercase: /[A-Z]/.test(password),\r\n        hasLowercase: /[a-z]/.test(password),\r\n        hasNumber: /[0-9]/.test(password),\r\n        hasSpecial: /[!@#$%^&*()_+\\-=\\[\\]{};':\"\\\\|,.<>\\/?]/.test(password),\r\n    };\r\n\r\n    const passedCount = Object.values(requirements).filter(Boolean).length;\r\n\r\n    let strength: 'weak' | 'medium' | 'strong' = 'weak';\r\n    if (passedCount >= 5) strength = 'strong';\r\n    else if (passedCount >= 3) strength = 'medium';\r\n\r\n    const allPassed = Object.values(requirements).every(Boolean);\r\n\r\n    if (!allPassed) {\r\n        const errors: string[] = [];\r\n        if (!requirements.minLength) errors.push('เธญเธขเนเธฒเธเธเนเธญเธข 8 เธ•เธฑเธงเธญเธฑเธเธฉเธฃ');\r\n        if (!requirements.hasUppercase) errors.push('เธกเธตเธ•เธฑเธงเธเธดเธกเธเนเนเธซเธเน');\r\n        if (!requirements.hasLowercase) errors.push('เธกเธตเธ•เธฑเธงเธเธดเธกเธเนเน€เธฅเนเธ');\r\n        if (!requirements.hasNumber) errors.push('เธกเธตเธ•เธฑเธงเน€เธฅเธ');\r\n        if (!requirements.hasSpecial) errors.push('เธกเธตเธญเธฑเธเธเธฃเธฐเธเธดเน€เธจเธฉ');\r\n\r\n        return {\r\n            valid: false,\r\n            error: `เธฃเธซเธฑเธชเธเนเธฒเธเธ•เนเธญเธ: ${errors.join(', ')}`,\r\n            strength,\r\n            requirements,\r\n        };\r\n    }\r\n\r\n    return { valid: true, strength, requirements };\r\n}\r\n\r\n// =============================================================================\r\n// GENERAL UTILITIES\r\n// =============================================================================\r\n\r\n/**\r\n * Check if a string is empty or only whitespace\r\n */\r\nexport function isEmpty(value: string | null | undefined): boolean {\r\n    return !value || value.trim().length === 0;\r\n}\r\n\r\n/**\r\n * Sanitize input for display (prevent XSS)\r\n */\r\nexport function sanitizeInput(input: string): string {\r\n    return input\r\n        .replace(/&/g, '&amp;')\r\n        .replace(/</g, '&lt;')\r\n        .replace(/>/g, '&gt;')\r\n        .replace(/\"/g, '&quot;')\r\n        .replace(/'/g, '&#x27;');\r\n}\r\n\r\nexport default {\r\n    validateThaiIdCard,\r\n    formatThaiIdCard,\r\n    maskThaiIdCard,\r\n    validateLaserCode,\r\n    formatLaserCode,\r\n    validateTaxId,\r\n    validateThaiPhone,\r\n    formatThaiPhone,\r\n    validateEmail,\r\n    validatePassword,\r\n    isEmpty,\r\n    sanitizeInput,\r\n};\r\n","usedDeprecatedRules":[]}]